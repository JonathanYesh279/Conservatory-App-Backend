const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["chunks/Dashboard-D262rKzj.js","chunks/vendor-B2j9q2e_.js","chunks/StatsCard-Bc2TVD7v.js","chunks/utils-x1PSU_OZ.js","chunks/Card-CAaO3RGR.js","chunks/cascade-deletion-DAN0Gkem.js","chunks/query-BI61muSV.js","chunks/ui-DR_ddEk_.js","chunks/teacherDetailsApi-BGs4ypj_.js","chunks/Students-LHcjV5uW.js","chunks/Table-CbhvHbbs.js","chunks/StudentDetailsPageSimple-D2iurl-6.js","chunks/TeacherNameDisplay-DQYxRlUC.js","chunks/apiCache-T5b6VToj.js","chunks/theoryEnrollmentService-Bgf_GhXN.js","chunks/Teachers-uPUiyt2Z.js","chunks/TheoryLessons-CBxOFSLi.js","chunks/TheoryLessonDetails-B4m1NP_N.js","chunks/Orchestras-DgZF7wb6.js","chunks/Rehearsals-CBk4OzPV.js","chunks/RehearsalDetails-DVvqlHsl.js","chunks/Bagruts-D9x-LIrc.js","chunks/useBagrut-DEeyEkFH.js","chunks/BagrutDetails-D1gMKxlv.js","chunks/Profile-ClbUwTNi.js","chunks/RehearsalAttendance-CAlUJ4YT.js","chunks/OrchestraEnrollmentManager-Cx-kHUUf.js","chunks/TeacherDetailsPage-CXgtuhVl.js","chunks/OrchestraDetailsPage-SBlUCd6E.js"])))=>i.map(i=>d[i]);
var xs=Object.defineProperty;var fs=(t,s,a)=>s in t?xs(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var et=(t,s,a)=>fs(t,typeof s!="symbol"?s+"":s,a);import{r as m,a as ps,u as ys,b as Ve,L as be,c as bs,d as js,e as Y,N as Pe,R as Le,B as vs}from"../chunks/vendor-B2j9q2e_.js";import{a as X,t as Ns,s as ws,o as Ts,b as Ft,_ as J,e as Is}from"../chunks/cascade-deletion-DAN0Gkem.js";import{Q as Bt,c as Ut}from"../chunks/query-BI61muSV.js";import{X as he,A as nt,a as ht,U as ge,C as je,b as de,B as _e,M as Ye,T as ot,P as ve,c as te,d as Fe,F as Tt,e as le,f as Ee,g as ie,S as gt,h as lt,i as Ss,R as ks,j as It,k as Cs,l as tt,m as Ds,n as Es,H as Ae,G as Mt,o as xt,p as He,q as Vt,r as _s,s as St,t as kt,u as As,L as Os}from"../chunks/ui-DR_ddEk_.js";import"../chunks/utils-x1PSU_OZ.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=a(n);fetch(n.href,o)}})();var Yt={exports:{}},We={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rs=m,$s=Symbol.for("react.element"),Ps=Symbol.for("react.fragment"),Ls=Object.prototype.hasOwnProperty,Fs=Rs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Bs={key:!0,ref:!0,__self:!0,__source:!0};function Ht(t,s,a){var i,n={},o=null,l=null;a!==void 0&&(o=""+a),s.key!==void 0&&(o=""+s.key),s.ref!==void 0&&(l=s.ref);for(i in s)Ls.call(s,i)&&!Bs.hasOwnProperty(i)&&(n[i]=s[i]);if(t&&t.defaultProps)for(i in s=t.defaultProps,s)n[i]===void 0&&(n[i]=s[i]);return{$$typeof:$s,type:t,key:o,ref:l,props:n,_owner:Fs.current}}We.Fragment=Ps;We.jsx=Ht;We.jsxs=Ht;Yt.exports=We;var e=Yt.exports,it={},Ct=ps;it.createRoot=Ct.createRoot,it.hydrateRoot=Ct.hydrateRoot;const Wt=m.createContext(null),Ne=()=>{const t=m.useContext(Wt);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},Us=({children:t})=>{const[s,a]=m.useState(!1),[i,n]=m.useState(!0),[o,l]=m.useState(null),[f,u]=m.useState(null),[d,g]=m.useState(null),b=m.useRef(!1),D=m.useRef(null),T=m.useRef(!0);m.useEffect(()=>{T.current=!0;const C=setTimeout(()=>{T.current&&R()},100);return()=>{T.current=!1,D.current&&clearTimeout(D.current),clearTimeout(C)}},[]);const R=m.useCallback(async(C=!1)=>{if(b.current&&!C){console.log("ğŸ” AUTH CONTEXT - Validation already in progress, skipping");return}const O=Date.now();if(!C&&d&&O-d<3e4){console.log("ğŸ” AUTH CONTEXT - Using cached authentication status");return}b.current=!0,u(null);try{if(X.auth.isAuthenticated()){console.log("ğŸ” AUTH CONTEXT - Token found, validating with server");const _=await X.auth.validateToken();if(!T.current)return;const F=_?.data?.user||_?.user||_?.data||_;console.log("ğŸ” AUTH CONTEXT - Token validation successful, fetching full teacher data");let S=null;if(F?._id)try{S=await X.teachers.getTeacher(F._id),console.log("ğŸ” AUTH CONTEXT - Full teacher data fetched:",{hasPersonalInfo:!!S?.personalInfo,hasRoles:!!S?.roles,fullName:S?.personalInfo?.fullName})}catch(B){console.warn("ğŸ” AUTH CONTEXT - Could not fetch full teacher data:",B),S=F}const P=S||F,A={...P,teacherId:P?.teacherId||P?._id,personalInfo:P?.personalInfo||{fullName:P?.fullName||F?.fullName||"",email:P?.email||F?.email||"",phone:P?.phone||"",address:P?.address||""},roles:P?.roles||F?.roles||[],role:P?.role||P?.roles?.[0]||F?.roles?.[0]||""};console.log("ğŸ” AUTH CONTEXT - User data normalized:",{hasUserData:!!A,userRole:A?.role||A?.roles,userId:A?.teacherId||A?._id,fullName:A?.personalInfo?.fullName}),a(!0),l(A),g(O)}else console.log("ğŸ” AUTH CONTEXT - No valid token found"),a(!1),l(null),g(O)}catch(_){if(console.error("ğŸ” AUTH CONTEXT - Auth validation failed:",_),!T.current)return;u(_.message),a(!1),l(null),g(O),_.message.includes("Authentication failed")&&X.auth.isAuthenticated()&&console.log("ğŸ” AUTH CONTEXT - Attempting token refresh")}finally{T.current&&n(!1),b.current=!1}},[d]),L=async(C,O)=>{try{n(!0),u(null);const _=await X.auth.login(C,O);if(!T.current)return;console.log("ğŸ” AUTH CONTEXT - Login successful:",{hasToken:!!_.token,hasUserData:!!(_.teacher||_.user)});const{token:F}=_,S=_.teacher||_.user||_.data?.teacher||_.data?.user||_.data;if(!F||!S)throw new Error("Invalid login response: missing token or user data");console.log("ğŸ” AUTH CONTEXT - Fetching full teacher data after login");let P=null;if(S?._id||S?.teacherId)try{const Z=S._id||S.teacherId;P=await X.teachers.getTeacher(Z),console.log("ğŸ” AUTH CONTEXT - Full teacher data fetched after login:",{hasPersonalInfo:!!P?.personalInfo,hasRoles:!!P?.roles,fullName:P?.personalInfo?.fullName})}catch(Z){console.warn("ğŸ” AUTH CONTEXT - Could not fetch full teacher data after login:",Z),P=S}const A=P||S,B={...A,teacherId:A?.teacherId||A?._id,personalInfo:A?.personalInfo||{fullName:A?.fullName||S?.personalInfo?.fullName||S?.fullName||"",email:A?.email||S?.credentials?.email||S?.personalInfo?.email||S?.email||C,phone:A?.phone||S?.personalInfo?.phone||"",address:A?.address||S?.personalInfo?.address||""},roles:A?.roles||S?.roles||[],role:A?.role||A?.roles?.[0]||S?.roles?.[0]||""};return console.log("ğŸ” AUTH CONTEXT - User data normalized after login:",{hasUserData:!!B,userRole:B?.role||B?.roles,userId:B?.teacherId||B?._id,fullName:B?.personalInfo?.fullName}),a(!0),l(B),g(Date.now()),{success:!0,user:B}}catch(_){throw console.error("ğŸ” AUTH CONTEXT - Login failed:",_),T.current&&(u(_.message),a(!1),l(null)),_}finally{T.current&&n(!1)}},k=async()=>{try{n(!0),await X.auth.logout(),console.log("ğŸ” AUTH CONTEXT - Logout successful")}catch(C){console.warn("ğŸ” AUTH CONTEXT - Logout API call failed:",C)}finally{T.current&&(a(!1),l(null),u(null),g(null),n(!1))}},M=m.useCallback(async()=>{try{return console.log("ğŸ” AUTH CONTEXT - Attempting token refresh"),await R(!0),s}catch(C){return console.error("ğŸ” AUTH CONTEXT - Token refresh failed:",C),await k(),!1}},[s]),p=m.useCallback(()=>({isAuthenticated:s,isLoading:i,user:o?{id:o.teacherId||o.id,role:o.role}:null,authError:f,lastValidation:d?new Date(d).toISOString():null,isValidating:b.current,cacheAge:d?Date.now()-d:null}),[s,i,o,f,d]),j={isAuthenticated:s,isLoading:i,user:o,authError:f,login:L,logout:k,checkAuthStatus:R,refreshToken:M,debugAuth:p};return e.jsx(Wt.Provider,{value:j,children:t})},zt=m.createContext(null),Xt=()=>{const t=m.useContext(zt);if(!t)throw new Error("useSchoolYear must be used within a SchoolYearProvider");return t},Ms=({children:t})=>{const{isAuthenticated:s}=Ne(),[a,i]=m.useState(null),[n,o]=m.useState([]),[l,f]=m.useState(!0),[u,d]=m.useState(null);m.useEffect(()=>{s?g():(i(null),o([]),f(!1),d(null))},[s]);const g=async()=>{try{f(!0),d(null);const p=await X.schoolYears.getSchoolYears();o(p);const j=await X.schoolYears.getCurrentSchoolYear();if(j)i(j);else if(p.length>0){const C=p.sort((O,_)=>new Date(_.startDate)-new Date(O.startDate))[0];i(C)}console.log(`ğŸ“ Loaded ${p.length} school years, current: ${j?.name||"None"}`)}catch(p){console.error("Failed to load school years:",p),d(p.message||"×©×’×™××” ×‘×˜×¢×™× ×ª ×©× ×•×ª ×”×œ×™××•×“")}finally{f(!1)}},b=async p=>{try{const j=n.find(C=>C._id===p);if(j)i(j),console.log(`ğŸ¯ Switched to school year: ${j.name}`);else{const C=await X.schoolYears.getSchoolYear(p);i(C),console.log(`ğŸ¯ Switched to fetched school year: ${C.name}`)}}catch(j){console.error("Failed to set school year:",j),d(j.message||"×©×’×™××” ×‘×¢×“×›×•×Ÿ ×©× ×ª ×”×œ×™××•×“")}},D=async p=>{try{const j=await X.schoolYears.createSchoolYear(p);return o(C=>[...C,j]),p.isCurrent&&i(j),console.log(`â• Created new school year: ${j.name}`),j}catch(j){throw console.error("Failed to create school year:",j),d(j.message||"×©×’×™××” ×‘×™×¦×™×¨×ª ×©× ×ª ×”×œ×™××•×“"),j}},T=async(p,j)=>{try{const C=await X.schoolYears.updateSchoolYear(p,j);return o(O=>O.map(_=>_._id===p?C:_)),a&&a._id===p&&i(C),console.log(`âœï¸ Updated school year: ${C.name}`),C}catch(C){throw console.error("Failed to update school year:",C),d(C.message||"×©×’×™××” ×‘×¢×“×›×•×Ÿ ×©× ×ª ×”×œ×™××•×“"),C}},R=async p=>{try{if(await X.schoolYears.deleteSchoolYear(p),o(j=>j.filter(C=>C._id!==p)),a&&a._id===p){const j=n.filter(C=>C._id!==p);j.length>0?i(j[0]):i(null)}console.log(`ğŸ—‘ï¸ Deleted school year: ${p}`)}catch(j){throw console.error("Failed to delete school year:",j),d(j.message||"×©×’×™××” ×‘××—×™×§×ª ×©× ×ª ×”×œ×™××•×“"),j}},L=p=>{if(!p)return!1;const j=new Date,C=new Date(p.startDate),O=new Date(p.endDate);return j>=C&&j<=O&&p.isActive},M={currentSchoolYear:a,schoolYears:n,isLoading:l,error:u,loadSchoolYears:g,setCurrentSchoolYearById:b,createSchoolYear:D,updateSchoolYear:T,deleteSchoolYear:R,isSchoolYearActive:L,getSchoolYearDisplayName:p=>{if(!p)return"×œ× × ×‘×—×¨×” ×©× ×”";const j=p.isCurrent,C=L(p);let O=p.name;return j?O+=" (× ×•×›×—×™×ª)":C&&(O+=" (×¤×¢×™×œ×”)"),O}};return e.jsx(zt.Provider,{value:M,children:t})},Vs={currentBagrut:null,bagruts:[],loading:!1,error:null,validation:{errors:{},warnings:{}}},Ys=t=>{if(!t[3]?.detailedGrading)return 0;const s=t[3].detailedGrading;return(s.playingSkills?.points||0)+(s.musicalUnderstanding?.points||0)+(s.textKnowledge?.points||0)+(s.playingByHeart?.points||0)},Hs=(t,s)=>{const a=t/100*100,i=s/100*100;return a*.9+i*.1},Ws=t=>t>=95?"××¦×•×™×Ÿ (100-95)":t>=85?"×˜×•×‘ ×××“ (94-85)":t>=75?"×˜×•×‘ (84-75)":t>=65?"×›××¢×˜ ×˜×•×‘ (74-65)":t>=55?"××¡×¤×™×§ (64-55)":"×œ× ××¡×¤×™×§ (54-0)",zs=t=>({presentations:[t.presentations?.[0]?.completed||!1,t.presentations?.[1]?.completed||!1,t.presentations?.[2]?.completed||!1,t.presentations?.[3]?.completed||!1],directorEvaluation:!!t.directorEvaluation?.points,recitalConfig:!!(t.recitalConfiguration?.units&&t.recitalConfiguration?.field),program:t.program?.length>0}),De=(t,s,a)=>t<0?`${a} ×œ× ×™×›×•×œ ×œ×”×™×•×ª ×©×œ×™×œ×™`:t>s?`${a} ×œ× ×™×›×•×œ ×œ×¢×œ×•×ª ×¢×œ ${s} × ×§×•×“×•×ª`:null,Xs=t=>t!==3&&t!==5?"×™×—×™×“×•×ª ×¨×¡×™×˜×œ ×—×™×™×‘×•×ª ×œ×”×™×•×ª 3 ××• 5":null,qs=(t,s)=>{switch(s.type){case"SET_LOADING":return{...t,loading:s.payload};case"SET_ERROR":return{...t,error:s.payload};case"SET_CURRENT_BAGRUT":return console.log("âœ… BagrutContext: SET_CURRENT_BAGRUT reducer:",s.payload?._id),{...t,currentBagrut:s.payload};case"SET_BAGRUTS":return{...t,bagruts:s.payload};case"UPDATE_DIRECTOR_EVALUATION":{const{bagrutId:a,evaluation:i}=s.payload,n=t.currentBagrut?._id===a?{...t.currentBagrut,directorEvaluation:i}:t.currentBagrut,o=t.bagruts.map(l=>l._id===a?{...l,directorEvaluation:i}:l);return{...t,currentBagrut:n,bagruts:o}}case"UPDATE_RECITAL_CONFIG":{const{bagrutId:a,config:i}=s.payload,n={units:i.recitalUnits,field:i.recitalField},o=t.currentBagrut?._id===a?{...t.currentBagrut,recitalConfiguration:n,recitalUnits:i.recitalUnits,recitalField:i.recitalField}:t.currentBagrut,l=t.bagruts.map(f=>f._id===a?{...f,recitalConfiguration:n,recitalUnits:i.recitalUnits,recitalField:i.recitalField}:f);return{...t,currentBagrut:o,bagruts:l}}case"UPDATE_PRESENTATION":{const{bagrutId:a,index:i,data:n}=s.payload,o=(u=[])=>{const d=[...u];return d[i]={...d[i],...n},d},l=t.currentBagrut?._id===a?{...t.currentBagrut,presentations:o(t.currentBagrut.presentations)}:t.currentBagrut,f=t.bagruts.map(u=>u._id===a?{...u,presentations:o(u.presentations)}:u);return{...t,currentBagrut:l,bagruts:f}}case"CALCULATE_COMPUTED_VALUES":{const{bagrutId:a}=s.payload,i=n=>{if(n._id!==a)return n;const o=Ys(n.presentations||[]),l=n.directorEvaluation?.points||0,f=Hs(o,l),u=Ws(f),d=zs(n);return{...n,computedValues:{totalPerformancePoints:o,weightedFinalGrade:f,gradeLevel:u,completionStatus:d},finalGrade:f,finalGradeLevel:u}};return{...t,currentBagrut:t.currentBagrut?i(t.currentBagrut):null,bagruts:t.bagruts.map(i)}}case"SET_VALIDATION_ERROR":return{...t,validation:{...t.validation,errors:{...t.validation.errors,[s.payload.field]:s.payload.message}}};case"CLEAR_VALIDATION_ERRORS":return{...t,validation:{...t.validation,errors:{}}};default:return t}},qt=m.createContext(null),Gs=({children:t})=>{const[s,a]=m.useReducer(qs,Vs),i=m.useMemo(()=>({setLoading:o=>a({type:"SET_LOADING",payload:o}),setError:o=>a({type:"SET_ERROR",payload:o}),setCurrentBagrut:o=>{console.log("ğŸ’¾ BagrutContext: setCurrentBagrut action called with:",o?._id),a({type:"SET_CURRENT_BAGRUT",payload:o})},setBagruts:o=>a({type:"SET_BAGRUTS",payload:o}),updateDirectorEvaluation:(o,l)=>{const f=De(l.points||0,100,"×”×¢×¨×›×ª ×× ×”×œ");if(f){a({type:"SET_VALIDATION_ERROR",payload:{field:"directorEvaluation",message:f}});return}a({type:"UPDATE_DIRECTOR_EVALUATION",payload:{bagrutId:o,evaluation:l}}),a({type:"CALCULATE_COMPUTED_VALUES",payload:{bagrutId:o}})},updateRecitalConfig:(o,l)=>{const f=Xs(l.recitalUnits);if(f){a({type:"SET_VALIDATION_ERROR",payload:{field:"recitalUnits",message:f}});return}a({type:"UPDATE_RECITAL_CONFIG",payload:{bagrutId:o,config:l}}),a({type:"CALCULATE_COMPUTED_VALUES",payload:{bagrutId:o}})},updatePresentation:(o,l,f)=>{if(f.detailedGrading){const u=f.detailedGrading,d=[];if(u.playingSkills?.points!==void 0){const g=De(u.playingSkills.points,40,"×›×™×©×•×¨×™ × ×’×™× ×”");g&&d.push(g)}if(u.musicalUnderstanding?.points!==void 0){const g=De(u.musicalUnderstanding.points,30,"×”×‘× ×” ××•×–×™×§×œ×™×ª");g&&d.push(g)}if(u.textKnowledge?.points!==void 0){const g=De(u.textKnowledge.points,20,"×™×“×¢ ×˜×§×¡×˜");g&&d.push(g)}if(u.playingByHeart?.points!==void 0){const g=De(u.playingByHeart.points,10,"× ×’×™× ×” ×‘×¢×œ ×¤×”");g&&d.push(g)}if(d.length>0){a({type:"SET_VALIDATION_ERROR",payload:{field:`presentation${l}`,message:d[0]}});return}}a({type:"UPDATE_PRESENTATION",payload:{bagrutId:o,index:l,data:f}}),a({type:"CALCULATE_COMPUTED_VALUES",payload:{bagrutId:o}})},recalculateGrade:o=>{a({type:"CALCULATE_COMPUTED_VALUES",payload:{bagrutId:o}})},setValidationError:(o,l)=>{a({type:"SET_VALIDATION_ERROR",payload:{field:o,message:l}})},clearValidationErrors:()=>{a({type:"CLEAR_VALIDATION_ERRORS"})},validatePointTotal:o=>(o.playingSkills?.points||0)+(o.musicalUnderstanding?.points||0)+(o.textKnowledge?.points||0)+(o.playingByHeart?.points||0)>100?(a({type:"SET_VALIDATION_ERROR",payload:{field:"totalPoints",message:"×¡×š ×”× ×§×•×“×•×ª ×œ× ×™×›×•×œ ×œ×¢×œ×•×ª ×¢×œ 100"}}),!1):!0,validateSequentialPresentation:(o,l)=>o>0&&!l[o-1]?.completed?(a({type:"SET_VALIDATION_ERROR",payload:{field:`presentation${o}`,message:`×™×© ×œ×”×©×œ×™× ×ª×—×™×œ×” ××¦×’×ª ${o}`}}),!1):!0}),[]),n=m.useMemo(()=>({state:s,actions:i}),[s,i]);return e.jsx(qt.Provider,{value:n,children:t})},Ha=()=>{const t=m.useContext(qt);if(!t)throw new Error("useBagrutContext must be used within a BagrutProvider");return t},Wa={getCurrentBagrut:t=>t.currentBagrut,getAllBagruts:t=>t.bagruts,getLoadingState:t=>t.loading,getError:t=>t.error,getValidationErrors:t=>t.validation.errors,getBagrutById:(t,s)=>t.bagruts.find(a=>a._id===s),getCompletedPresentations:(t,s)=>t.bagruts.find(i=>i._id===s)?.presentations?.filter(i=>i.completed)||[],getTotalPerformancePoints:(t,s)=>t.bagruts.find(i=>i._id===s)?.computedValues?.totalPerformancePoints||0,getWeightedFinalGrade:(t,s)=>t.bagruts.find(i=>i._id===s)?.computedValues?.weightedFinalGrade||0,getCompletionStatus:(t,s)=>t.bagruts.find(i=>i._id===s)?.computedValues?.completionStatus||{presentations:[!1,!1,!1,!1],directorEvaluation:!1,recitalConfig:!1,program:!1}},we=new Bt({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!0,refetchOnMount:!0,retry:(t,s)=>{const a=s?.response?.status;return a>=400&&a<500?!1:t<2},retryDelay:t=>Math.min(1e3*2**t,3e4),networkMode:"online"},mutations:{retry:1,networkMode:"online",onError:t=>{console.error("Mutation error:",t)}}}});we.setQueryDefaults(["students"],{staleTime:2*60*1e3,gcTime:5*60*1e3});we.setQueryDefaults(["teachers"],{staleTime:10*60*1e3,gcTime:30*60*1e3});we.setQueryDefaults(["theory-lessons"],{staleTime:2*60*1e3,gcTime:5*60*1e3});we.setQueryDefaults(["orchestras"],{staleTime:5*60*1e3,gcTime:15*60*1e3});we.setQueryDefaults(["school-years"],{staleTime:30*60*1e3,gcTime:60*60*1e3});function Qs({children:t}){return e.jsxs(Ut,{client:we,children:[t,!1]})}const Gt=m.createContext(void 0);function Ks({children:t}){const[s,a]=m.useState(!0),[i,n]=m.useState(!1);return m.useEffect(()=>{const o=()=>{n(window.innerWidth<768)};return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]),e.jsx(Gt.Provider,{value:{isDesktopOpen:s,setIsDesktopOpen:a,isMobile:i},children:t})}function ft(){const t=m.useContext(Gt);if(t===void 0)throw new Error("useSidebar must be used within a SidebarProvider");return t}const Js=({isOpen:t,onClose:s,title:a,children:i,maxWidth:n="md",showCloseButton:o=!0,closeOnBackdrop:l=!0,darkBackdrop:f=!1,className:u=""})=>{if(!t)return null;const d={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","4xl":"max-w-4xl"},g=f?"bg-opacity-75":"bg-opacity-50",b=D=>{l&&D.target===D.currentTarget&&s()};return e.jsx("div",{className:`fixed inset-0 bg-black ${g} flex items-center justify-center z-50 p-4`,onClick:b,children:e.jsxs("div",{className:`bg-white rounded-xl shadow-2xl w-full ${d[n]} max-h-[90vh] overflow-hidden transform transition-all ${u}`,children:[(a||o)&&e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a&&e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:a}),o&&e.jsx("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",type:"button",children:e.jsx(he,{className:"w-5 h-5 text-gray-500"})})]}),e.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-140px)]",children:i})]})})},Zs=({isOpen:t,title:s,message:a,confirmText:i="××™×©×•×¨",cancelText:n="×‘×™×˜×•×œ",onConfirm:o,onCancel:l,variant:f="danger"})=>{if(!t)return null;const d=(()=>{switch(f){case"danger":return{icon:"text-red-600",confirmButton:"bg-red-600 hover:bg-red-700 text-white",iconBg:"bg-red-100"};case"warning":return{icon:"text-yellow-600",confirmButton:"bg-yellow-600 hover:bg-yellow-700 text-white",iconBg:"bg-yellow-100"};case"info":return{icon:"text-blue-600",confirmButton:"bg-blue-600 hover:bg-blue-700 text-white",iconBg:"bg-blue-100"};default:return{icon:"text-red-600",confirmButton:"bg-red-600 hover:bg-red-700 text-white",iconBg:"bg-red-100"}}})();return e.jsxs(Js,{isOpen:t,onClose:l,maxWidth:"md",showCloseButton:!1,closeOnBackdrop:!0,children:[e.jsx("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d.iconBg}`,children:e.jsx(nt,{className:`w-5 h-5 ${d.icon}`})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s})]})}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-700 text-sm leading-relaxed",children:a})}),e.jsxs("div",{className:"flex gap-3 p-6 pt-0",children:[e.jsx("button",{onClick:l,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:n}),e.jsx("button",{onClick:o,className:`flex-1 px-4 py-2 rounded-lg transition-colors font-medium ${d.confirmButton}`,children:i})]})]})},er=["×","×‘","×’","×“","×”","×•","×–","×—","×˜","×™","×™×","×™×‘","××—×¨"],tr=[1,2,3,4,5,6,7,8],sr=["×—×œ×™×œ×™×ª","×—×œ×™×œ ×¦×“","××‘×•×‘","×‘×¡×•×Ÿ","×¡×§×¡×•×¤×•×Ÿ","×§×œ×¨×™× ×˜","×—×¦×•×¦×¨×”","×§×¨×Ÿ ×™×¢×¨","×˜×¨×•××‘×•×Ÿ","×˜×•×‘×”/×‘×¨×™×˜×•×Ÿ","×©×™×¨×”","×›×™× ×•×¨","×•×™×•×œ×”","×¦'×œ×•","×§×•× ×˜×¨×‘×¡","×¤×¡× ×ª×¨","×’×™×˜×¨×”","×’×™×˜×¨×” ×‘×¡","×ª×•×¤×™×"],rr=["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™"],ar=[30,45,60],Dt=["×œ× × ×‘×—×Ÿ","×¢×‘×¨/×”","×œ× ×¢×‘×¨/×”","×¢×‘×¨/×” ×‘×”×¦×˜×™×™× ×•×ª","×¢×‘×¨/×” ×‘×”×¦×˜×™×™× ×•×ª ×™×ª×¨×”"],nr=({initialData:t,onSubmit:s,onCancel:a,isEdit:i=!1})=>{const[n,o]=m.useState({personalInfo:{fullName:"",phone:"",age:null,address:"",parentName:"",parentPhone:"",parentEmail:"",studentEmail:""},academicInfo:{instrumentProgress:[{instrumentName:"",isPrimary:!0,currentStage:1,tests:{stageTest:{status:"×œ× × ×‘×—×Ÿ"},technicalTest:{status:"×œ× × ×‘×—×Ÿ"}}}],class:"×",tests:{bagrutId:null}},enrollments:{orchestraIds:[],ensembleIds:[],theoryLessonIds:[],schoolYears:[]},teacherIds:[],teacherAssignments:[],isActive:!0,...t}),[l,f]=m.useState({}),[u,d]=m.useState(!1),[g,b]=m.useState({personal:!0,academic:!0,instruments:!0,teachers:!0,enrollments:!1}),[D,T]=m.useState([]),[R,L]=m.useState([]),[k,M]=m.useState([]),[p,j]=m.useState([]),[C,O]=m.useState(""),[_,F]=m.useState(!1);m.useState([]);const[S,P]=m.useState({duration:null,selectedDays:[],startTime:"",endTime:""}),[A,B]=m.useState(!0),[Z,c]=m.useState({isOpen:!1,message:"",conflictingSlot:null});m.useEffect(()=>{const r=async()=>{try{const v=await X.teachers.getTeachers();T(v)}catch(v){console.error("Error fetching teachers:",v)}},h=async()=>{try{const v=await X.orchestras.getOrchestras();console.log("Fetched orchestras:",v);const N=await Promise.all((v||[]).map(async V=>{if(V.rehearsalIds&&V.rehearsalIds.length>0)try{const H=await X.rehearsals.getRehearsalById(V.rehearsalIds[0]);return{...V,rehearsalSchedule:H?{day:H.day||H.dayOfWeek,startTime:H.startTime,endTime:H.endTime,location:H.location||V.location}:null}}catch{return console.log("Could not fetch rehearsal for orchestra:",V.name),V}return V}));M(N)}catch(v){console.error("Error fetching orchestras:",v),M([])}},x=async()=>{try{const v=await X.theory.getTheoryLessons();console.log("Fetched theory lessons:",v);const N=Array.isArray(v)?v:v?.data||[];j(N)}catch(v){console.error("Error fetching theory lessons:",v),j([])}};r(),h(),x()},[]);const w=(r,h)=>{const[x,v]=r.split(":").map(Number),N=x*60+v+h,V=Math.floor(N/60),H=N%60;return`${V.toString().padStart(2,"0")}:${H.toString().padStart(2,"0")}`},U=(r,h,x,v)=>{const N=ne=>{const[pe,Se]=ne.split(":").map(Number);return pe*60+Se},V=N(r),H=N(h),fe=N(x),G=N(v);return V<G&&H>fe};m.useEffect(()=>{C&&(y(C),B(!0))},[C]);const y=async r=>{F(!0);try{const h=await X.teachers.getTeacherById(r);console.log("Teacher data for slots:",h);const x=await X.teachers.getTeacherStudents(r);console.log("Teacher students:",x);const v=[];x.forEach(G=>{G.teacherAssignments&&Array.isArray(G.teacherAssignments)&&G.teacherAssignments.forEach(ne=>{ne.teacherId===r&&v.push({day:ne.day,time:ne.time,duration:ne.duration})})}),console.log("ğŸš« Occupied slots from other students:",v),console.log("ğŸ“‹ Teacher teaching data:",{hasTeaching:!!h.teaching,hasSchedule:!!h.teaching?.schedule,scheduleLength:h.teaching?.schedule?.length,hasTimeBlocks:!!h.teaching?.timeBlocks,timeBlocksLength:h.teaching?.timeBlocks?.length});const N=h.teaching?.schedule?.filter(G=>G.isAvailable!==!1&&G.isActive!==!1)||[],V=h.teaching?.timeBlocks?.filter(G=>G.isAvailable!==!1&&G.isActive!==!1)||[],H=[...N];V.forEach(G=>{H.some(pe=>pe.day===G.day&&pe.startTime===G.startTime&&pe.endTime===G.endTime)||H.push(G)}),console.log("ğŸ“… Time blocks found (schedule + timeBlocks):",H.length);const fe=[];H.forEach(G=>{const ne=G.startTime,pe=G.endTime,Se=G.day,[ns,os]=ne.split(":").map(Number),[ls,is]=pe.split(":").map(Number),bt=ns*60+os,jt=ls*60+is,Pa=jt-bt;ar.forEach(ye=>{for(let ke=bt;ke+ye<=jt;ke+=15){const vt=ke+ye,cs=Math.floor(ke/60),ds=ke%60,us=Math.floor(vt/60),ms=vt%60,Ce=`${cs.toString().padStart(2,"0")}:${ds.toString().padStart(2,"0")}`,Ze=`${us.toString().padStart(2,"0")}:${ms.toString().padStart(2,"0")}`,hs=v.some(se=>{if(se.day!==Se)return!1;const Nt=w(se.time,se.duration),wt=U(Ce,Ze,se.time,Nt);return wt&&ye===60&&console.log(`ğŸ”´ Blocking slot ${Ce}-${Ze} (${ye}min) - overlaps with ${se.time}-${Nt}`),wt}),gs=n.teacherAssignments.some(se=>se.teacherId===h._id&&se.day===Se&&se.time===Ce&&se.duration===ye);if(!hs&&!gs){const se=`${G._id}-${ye}-${Ce.replace(":","")}`;fe.push({_id:se,day:Se,startTime:Ce,endTime:Ze,duration:ye,isAvailable:!0,location:G.location,teacherName:h.personalInfo?.fullName,teacherId:h._id,instrument:h.professionalInfo?.instrument})}}})}),console.log("Generated available slots (after filtering occupied):",fe),L(fe)}catch(h){console.error("Error fetching teacher slots:",h),L([])}finally{F(!1)}},E=r=>{b(h=>({...h,[r]:!h[r]}))},I=(r,h,x)=>{o(v=>({...v,[r]:{...v[r],[h]:x}})),f(v=>({...v,[`${r}.${h}`]:""}))},$=(r,h,x)=>{const v=[...n.academicInfo.instrumentProgress];h==="tests"?v[r]={...v[r],tests:x}:v[r]={...v[r],[h]:x},h==="isPrimary"&&x===!0&&v.forEach((N,V)=>{V!==r&&(N.isPrimary=!1)}),o(N=>({...N,academicInfo:{...N.academicInfo,instrumentProgress:v}}))},Q=()=>{const r=n.academicInfo.instrumentProgress.some(h=>h.isPrimary);o(h=>({...h,academicInfo:{...h.academicInfo,instrumentProgress:[...h.academicInfo.instrumentProgress,{instrumentName:"",isPrimary:!r,currentStage:1,tests:{stageTest:{status:"×œ× × ×‘×—×Ÿ"},technicalTest:{status:"×œ× × ×‘×—×Ÿ"}}}]}}))},q=r=>{const h=n.academicInfo.instrumentProgress.filter((x,v)=>v!==r);h.length>0&&!h.some(x=>x.isPrimary)&&(h[0].isPrimary=!0),o(x=>({...x,academicInfo:{...x.academicInfo,instrumentProgress:h}}))},Te=r=>{const h=w(r.startTime,r.duration);for(const N of n.teacherAssignments)if(N.day===r.day){const V=w(N.time,N.duration);if(U(r.startTime,h,N.time,V)){const H=D.find(fe=>fe._id===N.teacherId)?.personalInfo?.fullName||"××•×¨×”";return`×”×ª×–××•×Ÿ ××ª× ×’×© ×¢× ×©×™×¢×•×¨ ×§×™×™×:
${N.day} ${N.time}-${V} ×¢× ${H}`}}const x=k.find(N=>N._id===n.enrollments.orchestraIds[0]);if(x?.rehearsalSchedule){const N=x.rehearsalSchedule;if(N.day===r.day&&U(r.startTime,h,N.startTime,N.endTime))return`×”×ª×–××•×Ÿ ××ª× ×’×© ×¢× ×—×–×¨×ª ×ª×–××•×¨×ª:
${N.day} ${N.startTime}-${N.endTime} - ${x.name}`}const v=p.find(N=>N._id===n.enrollments.theoryLessonIds[0]);if(v?.schedule){for(const N of v.schedule)if(N.day===r.day&&U(r.startTime,h,N.startTime,N.endTime))return`×”×ª×–××•×Ÿ ××ª× ×’×© ×¢× ×©×™×¢×•×¨ ×ª×™××•×¨×™×”:
${N.day} ${N.startTime}-${N.endTime} - ${v.name}`}return null},Ie=r=>{const h=Te(r);if(h){c({isOpen:!0,message:h,conflictingSlot:r});return}Re(r)},Re=r=>{const h={teacherId:r.teacherId,day:r.day,time:r.startTime,duration:r.duration,isActive:!0,isRecurring:!0,...r.location&&{location:r.location}};o(x=>({...x,teacherAssignments:[...x.teacherAssignments,h],teacherIds:x.teacherIds.includes(r.teacherId)?x.teacherIds:[...x.teacherIds,r.teacherId]})),L(x=>x.filter(v=>v._id!==r._id)),B(!1)},qe=()=>{Z.conflictingSlot&&Re(Z.conflictingSlot),c({isOpen:!1,message:"",conflictingSlot:null})},Ge=()=>{c({isOpen:!1,message:"",conflictingSlot:null})},Qe=r=>{const h=n.teacherAssignments[r];o(x=>{const v=x.teacherAssignments.filter((V,H)=>H!==r),N=v.some(V=>V.teacherId===h.teacherId);return{...x,teacherAssignments:v,teacherIds:N?x.teacherIds:x.teacherIds.filter(V=>V!==h.teacherId)}}),C===h.teacherId&&setTimeout(()=>{y(h.teacherId)},100)},Ke=()=>{const r={};n.personalInfo.fullName.trim()||(r["personalInfo.fullName"]="×©× ××œ× ×”×•× ×©×“×” ×—×•×‘×”"),n.personalInfo.phone&&!/^05\d{8}$/.test(n.personalInfo.phone)&&(r["personalInfo.phone"]="××¡×¤×¨ ×˜×œ×¤×•×Ÿ ×œ× ×ª×§×™×Ÿ (×“×•×’××”: 0501234567)"),n.personalInfo.parentPhone&&!/^05\d{8}$/.test(n.personalInfo.parentPhone)&&(r["personalInfo.parentPhone"]="××¡×¤×¨ ×˜×œ×¤×•×Ÿ ×”×•×¨×” ×œ× ×ª×§×™×Ÿ"),n.personalInfo.parentEmail&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.personalInfo.parentEmail)&&(r["personalInfo.parentEmail"]="××™××™×™×œ ×”×•×¨×” ×œ× ×ª×§×™×Ÿ"),n.personalInfo.studentEmail&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.personalInfo.studentEmail)&&(r["personalInfo.studentEmail"]="××™××™×™×œ ×ª×œ××™×“ ×œ× ×ª×§×™×Ÿ"),n.academicInfo.class||(r["academicInfo.class"]="×›×™×ª×” ×”×™× ×©×“×” ×—×•×‘×”"),n.academicInfo.instrumentProgress.length===0?r["academicInfo.instruments"]="×™×© ×œ×”×•×¡×™×£ ×œ×¤×—×•×ª ×›×œ×™ × ×’×™× ×” ××—×“":n.academicInfo.instrumentProgress.forEach((x,v)=>{x.instrumentName||(r[`instrument.${v}.name`]="×©× ×”×›×œ×™ ×”×•× ×©×“×” ×—×•×‘×”")});const h=n.academicInfo.instrumentProgress.some(x=>x.isPrimary);return n.academicInfo.instrumentProgress.length>0&&!h&&(r["academicInfo.primaryInstrument"]="×™×© ×œ×‘×—×•×¨ ×›×œ×™ ×¨××©×™"),f(r),Object.keys(r).length===0},Je=async r=>{if(r.preventDefault(),!!Ke()){d(!0);try{console.log("ğŸ“‹ Form data being submitted:",JSON.stringify(n,null,2)),console.log("ğŸ‘¥ Teacher assignments:",JSON.stringify(n.teacherAssignments,null,2)),console.log("ğŸ‘¨â€ğŸ« Teacher IDs:",n.teacherIds),await s(n)}catch(h){console.error("Error submitting form:",h),f({submit:"×©×’×™××” ×‘×©××™×¨×ª ×”× ×ª×•× ×™×"})}finally{d(!1)}}};return e.jsxs("form",{onSubmit:Je,className:"space-y-6 max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:i?"×¢×¨×™×›×ª ×ª×œ××™×“":"×”×•×¡×¤×ª ×ª×œ××™×“ ×—×“×©"}),e.jsx("button",{type:"button",onClick:a,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(he,{className:"w-5 h-5"})})]}),l.submit&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-2",children:[e.jsx(ht,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"text-red-700",children:l.submit})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>E("personal"),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5 text-primary-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"×¤×¨×˜×™× ××™×©×™×™×"})]}),g.personal?e.jsx(je,{}):e.jsx(de,{})]}),g.personal&&e.jsx("div",{className:"p-6 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["×©× ××œ× ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n.personalInfo.fullName,onChange:r=>I("personalInfo","fullName",r.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900 ${l["personalInfo.fullName"]?"border-red-500":"border-gray-300"}`,placeholder:"×”×›× ×¡ ×©× ××©×¤×—×” ×•××– ×©× ×¤×¨×˜×™ (×œ×“×•×’××”: ×›×”×Ÿ ×™×•×¡×™)"}),l["personalInfo.fullName"]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l["personalInfo.fullName"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×˜×œ×¤×•×Ÿ ×ª×œ××™×“"}),e.jsx("input",{type:"tel",value:n.personalInfo.phone,onChange:r=>I("personalInfo","phone",r.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900 ${l["personalInfo.phone"]?"border-red-500":"border-gray-300"}`,placeholder:"0501234567"}),l["personalInfo.phone"]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l["personalInfo.phone"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×’×™×œ"}),e.jsx("input",{type:"number",value:n.personalInfo.age||"",onChange:r=>I("personalInfo","age",r.target.value?parseInt(r.target.value):null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",placeholder:"×’×™×œ ×”×ª×œ××™×“",min:"0",max:"99"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"××™××™×™×œ ×ª×œ××™×“"}),e.jsx("input",{type:"email",value:n.personalInfo.studentEmail,onChange:r=>I("personalInfo","studentEmail",r.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900 ${l["personalInfo.studentEmail"]?"border-red-500":"border-gray-300"}`,placeholder:"student@example.com"}),l["personalInfo.studentEmail"]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l["personalInfo.studentEmail"]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×›×ª×•×‘×ª"}),e.jsx("input",{type:"text",value:n.personalInfo.address,onChange:r=>I("personalInfo","address",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",placeholder:"×”×›× ×¡ ×›×ª×•×‘×ª ××œ××”"})]}),e.jsx("div",{className:"md:col-span-2 border-t pt-4 mt-2",children:e.jsx("h4",{className:"text-md font-medium text-gray-800 mb-4",children:"×¤×¨×˜×™ ×”×•×¨×”"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©× ×”×•×¨×”"}),e.jsx("input",{type:"text",value:n.personalInfo.parentName,onChange:r=>I("personalInfo","parentName",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",placeholder:"×©× ×”×”×•×¨×”"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×˜×œ×¤×•×Ÿ ×”×•×¨×”"}),e.jsx("input",{type:"tel",value:n.personalInfo.parentPhone,onChange:r=>I("personalInfo","parentPhone",r.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900 ${l["personalInfo.parentPhone"]?"border-red-500":"border-gray-300"}`,placeholder:"0501234567"}),l["personalInfo.parentPhone"]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l["personalInfo.parentPhone"]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"××™××™×™×œ ×”×•×¨×”"}),e.jsx("input",{type:"email",value:n.personalInfo.parentEmail,onChange:r=>I("personalInfo","parentEmail",r.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900 ${l["personalInfo.parentEmail"]?"border-red-500":"border-gray-300"}`,placeholder:"parent@example.com"}),l["personalInfo.parentEmail"]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l["personalInfo.parentEmail"]})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>E("academic"),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"w-5 h-5 text-primary-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"×¤×¨×˜×™× ××§×“××™×™×"})]}),g.academic?e.jsx(je,{}):e.jsx(de,{})]}),g.academic&&e.jsx("div",{className:"p-6 border-t border-gray-200",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["×›×™×ª×” ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:n.academicInfo.class,onChange:r=>I("academicInfo","class",r.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900 ${l["academicInfo.class"]?"border-red-500":"border-gray-300"}`,children:er.map(r=>e.jsx("option",{value:r,children:r},r))}),l["academicInfo.class"]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l["academicInfo.class"]})]})})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>E("instruments"),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"w-5 h-5 text-primary-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"×›×œ×™ × ×’×™× ×”"})]}),g.instruments?e.jsx(je,{}):e.jsx(de,{})]}),g.instruments&&e.jsxs("div",{className:"p-6 border-t border-gray-200",children:[l["academicInfo.instruments"]&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700 text-sm",children:l["academicInfo.instruments"]})}),l["academicInfo.primaryInstrument"]&&e.jsx("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("p",{className:"text-yellow-700 text-sm",children:l["academicInfo.primaryInstrument"]})}),e.jsxs("div",{className:"space-y-4",children:[n.academicInfo.instrumentProgress.map((r,h)=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:["×›×œ×™ × ×’×™× ×” ",h+1]}),n.academicInfo.instrumentProgress.length>1&&e.jsx("button",{type:"button",onClick:()=>q(h),className:"p-1 hover:bg-red-50 rounded text-red-600",children:e.jsx(ot,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["×©× ×”×›×œ×™ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:r.instrumentName,onChange:x=>$(h,"instrumentName",x.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900 ${l[`instrument.${h}.name`]?"border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×›×œ×™"}),sr.map(x=>e.jsx("option",{value:x,children:x},x))]}),l[`instrument.${h}.name`]&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l[`instrument.${h}.name`]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×©×œ×‘ × ×•×›×—×™"}),e.jsx("select",{value:r.currentStage,onChange:x=>$(h,"currentStage",parseInt(x.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",children:tr.map(x=>e.jsxs("option",{value:x,children:["×©×œ×‘ ",x]},x))})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.isPrimary,onChange:x=>$(h,"isPrimary",x.target.checked),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"×›×œ×™ ×¨××©×™"})]})}),e.jsxs("div",{className:"md:col-span-2 grid grid-cols-2 gap-4 mt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"××‘×—×Ÿ ×©×œ×‘"}),e.jsx("select",{value:r.tests.stageTest.status,onChange:x=>$(h,"tests",{...r.tests,stageTest:{...r.tests.stageTest,status:x.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",children:Dt.map(x=>e.jsx("option",{value:x,children:x},x))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"××‘×—×Ÿ ×˜×›× ×™"}),e.jsx("select",{value:r.tests.technicalTest.status,onChange:x=>$(h,"tests",{...r.tests,technicalTest:{...r.tests.technicalTest,status:x.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",children:Dt.map(x=>e.jsx("option",{value:x,children:x},x))})]})]})]})]},h)),e.jsxs("button",{type:"button",onClick:Q,className:"w-full py-2 border-2 border-dashed border-gray-300 rounded-lg hover:border-primary-500 transition-colors flex items-center justify-center gap-2 text-gray-600 hover:text-primary-600",children:[e.jsx(ve,{className:"w-4 h-4"}),"×”×•×¡×£ ×›×œ×™ × ×’×™× ×”"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>E("teachers"),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5 text-primary-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"××•×¨×™× ×•×©×™×¢×•×¨×™×"}),n.teacherAssignments.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-primary-100 text-primary-700 rounded-full text-xs",children:[n.teacherAssignments.length," ×©×™×‘×•×¦×™×"]})]}),g.teachers?e.jsx(je,{}):e.jsx(de,{})]}),g.teachers&&e.jsxs("div",{className:"p-6 border-t border-gray-200",children:[n.teacherAssignments.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"×©×™×¢×•×¨×™× ××ª×•×›× × ×™×"}),e.jsx("div",{className:"space-y-2",children:n.teacherAssignments.map((r,h)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Fe,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:["××•×¨×” - ",D.find(x=>x._id===r.teacherId)?.professionalInfo?.instrument||"×›×œ×™"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[r.day," | ",r.time,"-",w(r.time,r.duration)," | ",r.duration," ×“×§×•×ª",r.location&&` | ${r.location}`]})]})]}),e.jsx("button",{type:"button",onClick:()=>Qe(h),className:"p-1 hover:bg-red-50 rounded text-red-600",children:e.jsx(ot,{className:"w-4 h-4"})})]},h))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×‘×—×¨ ××•×¨×”"}),e.jsxs("select",{value:C,onChange:r=>O(r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",children:[e.jsx("option",{value:"",children:"×‘×—×¨ ××•×¨×” ×œ×¨××•×ª ×–×× ×™× ×¤× ×•×™×™×"}),D.map(r=>e.jsxs("option",{value:r._id,children:[r.personalInfo?.fullName," - ",r.professionalInfo?.instrument||"×œ×œ× ×›×œ×™"]},r._id))]})]}),C&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:["×–×× ×™× ×¤× ×•×™×™× - ",D.find(r=>r._id===C)?.personalInfo?.fullName||"××•×¨×”"]}),!A&&R.length>0&&e.jsx("div",{className:"mb-4",children:e.jsxs("button",{type:"button",onClick:()=>B(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[e.jsx(ve,{className:"w-4 h-4"}),"×‘×—×¨ ×©×™×¢×•×¨ × ×•×¡×£"]})}),A&&!_&&R.length>0&&e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(Tt,{className:"w-4 h-4"}),"×¡×™× ×•×Ÿ ×–×× ×™×"]}),(S.duration||S.selectedDays.length>0||S.startTime||S.endTime)&&e.jsxs("button",{type:"button",onClick:()=>P({duration:null,selectedDays:[],startTime:"",endTime:""}),className:"text-xs text-primary-600 hover:text-primary-700 flex items-center gap-1",children:[e.jsx(he,{className:"w-3 h-3"}),"× ×§×” ×¡×™× ×•×Ÿ"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"××©×š ×©×™×¢×•×¨"}),e.jsxs("select",{value:S.duration||"",onChange:r=>P(h=>({...h,duration:r.target.value?Number(r.target.value):null})),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-primary-500 focus:border-primary-500 text-gray-900 bg-white",children:[e.jsx("option",{value:"",children:"×›×œ ×”××©×›×™×"}),e.jsx("option",{value:"30",children:"30 ×“×§×•×ª"}),e.jsx("option",{value:"45",children:"45 ×“×§×•×ª"}),e.jsx("option",{value:"60",children:"60 ×“×§×•×ª"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"×™××™×"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md bg-white text-right flex items-center justify-between text-gray-900",onClick:r=>{const h=r.currentTarget.nextElementSibling;h&&h.classList.toggle("hidden")},children:[e.jsx("span",{className:"truncate",children:S.selectedDays.length>0?`${S.selectedDays.length} ×™××™× × ×‘×—×¨×•`:"×›×œ ×”×™××™×"}),e.jsx(de,{className:"w-4 h-4 flex-shrink-0"})]}),e.jsx("div",{className:"hidden absolute top-full mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg z-10",children:rr.map(r=>e.jsxs("label",{className:"flex items-center px-3 py-2 hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S.selectedDays.includes(r),onChange:h=>{h.target.checked?P(x=>({...x,selectedDays:[...x.selectedDays,r]})):P(x=>({...x,selectedDays:x.selectedDays.filter(v=>v!==r)}))},className:"ml-2 text-primary-600 rounded"}),e.jsx("span",{className:"text-sm text-gray-900",children:r})]},r))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"××©×¢×”"}),e.jsx("input",{type:"time",value:S.startTime,onChange:r=>P(h=>({...h,startTime:r.target.value})),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-primary-500 focus:border-primary-500 text-gray-900 bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"×¢×“ ×©×¢×”"}),e.jsx("input",{type:"time",value:S.endTime,onChange:r=>P(h=>({...h,endTime:r.target.value})),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-primary-500 focus:border-primary-500 text-gray-900 bg-white"})]})]})]}),_?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"×˜×•×¢×Ÿ ×–×× ×™× ×¤× ×•×™×™×..."})]}):A&&R.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"×‘×—×¨ ×–××Ÿ ×•××©×š ×©×™×¢×•×¨ ××”××¤×©×¨×•×™×•×ª ×”×–××™× ×•×ª:"}),(()=>{const r=R.filter(x=>!(S.duration&&x.duration!==S.duration||S.selectedDays.length>0&&!S.selectedDays.includes(x.day)||S.startTime&&x.startTime<S.startTime||S.endTime&&x.endTime>S.endTime));if(r.length===0)return e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx(Tt,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"××™×Ÿ ×–×× ×™× ×”×ª×•×××™× ×œ×¡×™× ×•×Ÿ ×©×‘×—×¨×ª"}),e.jsx("button",{type:"button",onClick:()=>P({duration:null,selectedDays:[],startTime:"",endTime:""}),className:"text-xs text-primary-600 hover:text-primary-700",children:"× ×§×” ×¡×™× ×•×Ÿ ×•×ª×¨××” ××ª ×›×œ ×”×–×× ×™×"})]});const h=r.reduce((x,v)=>(x[v.day]||(x[v.day]=[]),x[v.day].push(v),x),{});return Object.entries(h).map(([x,v])=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-600 mb-2 flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),x]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:v.sort((N,V)=>N.startTime.localeCompare(V.startTime)).map(N=>e.jsx("button",{type:"button",onClick:()=>Ie(N),className:`p-3 border rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-colors text-right ${N.duration===30?"border-green-300 bg-green-50":N.duration===45?"border-blue-300 bg-blue-50":"border-purple-300 bg-purple-50"}`,children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"w-3 h-3"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[N.startTime,"-",N.endTime]})]}),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${N.duration===30?"bg-green-100 text-green-800":N.duration===45?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:[N.duration," ×“×§×³"]})]}),N.location&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[e.jsx(Ee,{className:"w-3 h-3"}),N.location]}),e.jsx("div",{className:"text-xs text-gray-600",children:N.instrument})]})},N._id))})]},x))})()]}):C&&!_&&A&&R.length===0?e.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-lg",children:[e.jsx(le,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"××™×Ÿ ×–×× ×™× ×¤× ×•×™×™× ×œ××•×¨×” ×–×”"}),e.jsx("p",{className:"text-xs text-gray-400",children:"×™×™×ª×›×Ÿ ×©×›×œ ×”×–×× ×™× ×”×¤× ×•×™×™× ×›×‘×¨ ×ª×¤×•×¡×™× ××• ×©×”××•×¨×” ×œ× ×”×’×“×™×¨ ×–×× ×™ ×”×•×¨××”"})]}):null]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>E("enrollments"),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"w-5 h-5 text-primary-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"×”×¨×©××•×ª"})]}),g.enrollments?e.jsx(je,{}):e.jsx(de,{})]}),g.enrollments&&e.jsx("div",{className:"p-6 border-t border-gray-200",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª×–××•×¨×ª"}),e.jsxs("select",{value:n.enrollments.orchestraIds[0]||"",onChange:r=>{o(h=>({...h,enrollments:{...h.enrollments,orchestraIds:r.target.value?[r.target.value]:[]}}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×ª×–××•×¨×ª"}),k.map(r=>{const h=r.rehearsalSchedule||r.schedule&&r.schedule[0]||r.rehearsals&&r.rehearsals[0]||null;let x=r.name;if(h){const v=h.day||h.dayOfWeek||"",N=h.startTime||"",V=h.endTime||"",H=h.location||r.location||"";v&&N&&V&&(x+=` | ${v} ${N}-${V}`),H&&(x+=` | ${H}`)}else r.location&&(x+=` | ${r.location}`);return e.jsx("option",{value:r._id,children:x},r._id)})]}),n.enrollments.orchestraIds[0]&&e.jsx("div",{className:"mt-2 p-3 bg-purple-50 rounded-lg border border-purple-200",children:(()=>{const r=k.find(h=>h._id===n.enrollments.orchestraIds[0]);return r?e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"font-medium text-purple-900",children:r.name}),e.jsxs("div",{className:"text-sm text-purple-700 space-y-1",children:[r.rehearsalSchedule&&e.jsxs("div",{className:"p-2 bg-purple-100 rounded",children:[e.jsx("strong",{children:"×–×× ×™ ×—×–×¨×•×ª:"})," ",r.rehearsalSchedule.day," ",r.rehearsalSchedule.startTime,"-",r.rehearsalSchedule.endTime,r.rehearsalSchedule.location&&e.jsxs("span",{children:[" | ",r.rehearsalSchedule.location]})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"×¡×•×’:"})," ",r.type||"×ª×–××•×¨×ª"]}),!r.rehearsalSchedule&&r.location&&e.jsxs("div",{children:[e.jsx("strong",{children:"××™×§×•×:"})," ",r.location]}),r.memberIds&&e.jsxs("div",{children:[e.jsx("strong",{children:"××¡×¤×¨ ×—×‘×¨×™×:"})," ",r.memberIds.length]}),e.jsxs("div",{children:[e.jsx("strong",{children:"×¡×˜×˜×•×¡:"})," ",r.isActive?"×¤×¢×™×œ":"×œ× ×¤×¢×™×œ"]}),r.rehearsalIds&&r.rehearsalIds.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"××¡×¤×¨ ×—×–×¨×•×ª ×©××•×¨×•×ª:"})," ",r.rehearsalIds.length]})]})]}):null})()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©×™×¢×•×¨ ×ª×™××•×¨×™×”"}),e.jsxs("select",{value:n.enrollments.theoryLessonIds[0]||"",onChange:r=>{o(h=>({...h,enrollments:{...h.enrollments,theoryLessonIds:r.target.value?[r.target.value]:[]}}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×©×™×¢×•×¨ ×ª×™××•×¨×™×”"}),p.map(r=>{const h=r.schedule&&r.schedule.length>0?r.schedule[0]:null,x=h?`${h.day} ${h.startTime}-${h.endTime}${h.location?` | ${h.location}`:""}`:"";return e.jsxs("option",{value:r._id,children:[r.name||r.title||r.category," ",x?`| ${x}`:"",r.teacher?.personalInfo?.fullName&&` | ××•×¨×”: ${r.teacher.personalInfo.fullName}`]},r._id)})]}),n.enrollments.theoryLessonIds[0]&&e.jsx("div",{className:"mt-2 p-3 bg-blue-50 rounded-lg border border-blue-200",children:(()=>{const r=p.find(h=>h._id===n.enrollments.theoryLessonIds[0]);return r?e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"font-medium text-blue-900",children:r.name}),e.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"×¨××”:"})," ",r.level]}),r.teacher?.personalInfo?.fullName&&e.jsxs("div",{children:[e.jsx("strong",{children:"××•×¨×”:"})," ",r.teacher.personalInfo.fullName]}),r.description&&e.jsxs("div",{children:[e.jsx("strong",{children:"×ª×™××•×¨:"})," ",r.description]}),r.maxStudents&&e.jsxs("div",{children:[e.jsx("strong",{children:"××§×¡×™××•× ×ª×œ××™×“×™×:"})," ",r.maxStudents]}),r.currentStudents!==void 0&&e.jsxs("div",{children:[e.jsx("strong",{children:"×ª×œ××™×“×™× × ×•×›×—×™×™×:"})," ",r.currentStudents,"/",r.maxStudents||"âˆ"]}),r.schedule&&r.schedule.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"×–×× ×™ ×©×™×¢×•×¨:"}),e.jsx("div",{className:"mt-1 space-y-1",children:r.schedule.map((h,x)=>e.jsxs("div",{className:"text-xs bg-blue-100 px-2 py-1 rounded",children:[h.day," ",h.startTime,"-",h.endTime,h.location&&` | ${h.location}`]},x))})]}),r.prerequisites&&e.jsxs("div",{className:"text-xs text-blue-600 mt-2",children:[e.jsx("strong",{children:"×“×¨×™×©×•×ª ×§×“×:"})," ",r.prerequisites]})]})]}):null})()})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-6",children:[e.jsx("button",{type:"button",onClick:a,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"×‘×™×˜×•×œ"}),e.jsx("button",{type:"submit",disabled:u,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"×©×•××¨..."]}):e.jsxs(e.Fragment,{children:[e.jsx(gt,{className:"w-4 h-4"}),i?"×¢×“×›×Ÿ ×ª×œ××™×“":"×”×•×¡×£ ×ª×œ××™×“"]})})]}),e.jsx(Zs,{isOpen:Z.isOpen,title:"×”×ª× ×’×©×•×ª ×‘×œ×•×— ×–×× ×™×",message:Z.message,confirmText:"×”××©×š ×‘×›×œ ×–××ª",cancelText:"×‘×™×˜×•×œ",onConfirm:qe,onCancel:Ge,variant:"warning"})]})},ct=["××•×œ× ×¢×¨×Ÿ","×¡×˜×•×“×™×• ×§×××¨×™ 1","×¡×˜×•×“×™×• ×§×××¨×™ 2","××•×œ×¤×Ÿ ×”×§×œ×˜×•×ª","×—×“×¨ ×—×–×¨×•×ª 1","×—×“×¨ ×—×–×¨×•×ª 2","×—×“×¨ ××—×©×‘×™×","×—×“×¨ 1","×—×“×¨ 2","×—×“×¨ ×—×–×¨×•×ª","×—×“×¨ 5","×—×“×¨ 6","×—×“×¨ 7","×—×“×¨ 8","×—×“×¨ 9","×—×“×¨ 10","×—×“×¨ 11","×—×“×¨ 12","×—×“×¨ 13","×—×“×¨ 14","×—×“×¨ 15","×—×“×¨ 16","×—×“×¨ 17","×—×“×¨ 18","×—×“×¨ 19","×—×“×¨ 20","×—×“×¨ 21","×—×“×¨ 22","×—×“×¨ 23","×—×“×¨ 24","×—×“×¨ 25","×—×“×¨ 26","×—×“×¨ ×ª××•×¨×™×” ×","×—×“×¨ ×ª××•×¨×™×” ×‘"],or=["××•×¨×”","×× ×¦×—","××“×¨×™×š ×”×¨×›×‘","×× ×”×œ","××•×¨×” ×ª××•×¨×™×”","××’××”"],lr=["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™"],ir=["×—×œ×™×œ×™×ª","×—×œ×™×œ ×¦×“","××‘×•×‘","×‘×¡×•×Ÿ","×¡×§×¡×•×¤×•×Ÿ","×§×œ×¨×™× ×˜","×—×¦×•×¦×¨×”","×§×¨×Ÿ ×™×¢×¨","×˜×¨×•××‘×•×Ÿ","×˜×•×‘×”/×‘×¨×™×˜×•×Ÿ","×©×™×¨×”","×›×™× ×•×¨","×•×™×•×œ×”","×¦'×œ×•","×§×•× ×˜×¨×‘×¡","×¤×¡× ×ª×¨","×’×™×˜×¨×”","××•×¨×’×Ÿ","×—×¨××•× ×™×§×”","×× ×“×•×œ×™× ×”","×›×™× ×•×¨ ×‘××¨×•×§","×•×™×•×œ×” ×“×” ×’××‘×”","×¤×œ×•×˜×” ×¨×§×•×¨×“×¨","××•×§×¨×™× ×”","×—×œ×™×œ ×¤××Ÿ","×“×•×œ×¦×™××¨","××•×˜×•-×”×¨×¤","×¤×¡× ×ª×¨ ××œ×§×˜×¨×•× ×™","×’×™×˜×¨×” ×‘×¡","×’×™×˜×¨×” ××§×•×¡×˜×™×ª","×’×™×˜×¨×” ×§×œ××¡×™×ª","×‘× ×’×³×•","×—×œ×™×œ ××™×¨×™","×›×™× ×•×¨ ×§×œ×˜×™","×‘×•×“×”×¨××Ÿ"],dt=(t,s)=>{if(!t||!s)return 0;const[a,i]=t.split(":").map(Number),[n,o]=s.split(":").map(Number),l=a*60+i,f=n*60+o;return f<=l?0:f-l},Et=(t,s)=>{if(!t||!s)return null;const a=dt(t,s);return a<=0?"×©×¢×ª ×”×¡×™×•× ×—×™×™×‘×ª ×œ×”×™×•×ª ××—×¨×™ ×©×¢×ª ×”×”×ª×—×œ×”":a<30?"×™×•× ×œ×™××•×“ ×—×™×™×‘ ×œ×”×™×•×ª ×œ×¤×—×•×ª 30 ×“×§×•×ª":a>480?"×™×•× ×œ×™××•×“ ×œ× ×™×›×•×œ ×œ×”×™×•×ª ×™×•×ª×¨ ×-8 ×©×¢×•×ª":null},cr=({isOpen:t,onClose:s,onTeacherAdded:a,teacherToEdit:i,mode:n="add"})=>{const{currentSchoolYear:o}=Xt(),[l,f]=m.useState("personal"),[u,d]=m.useState({personalInfo:{fullName:"",phone:"",email:"",address:""},roles:[],professionalInfo:{instrument:"",isActive:!0},teaching:{schedule:[]},conducting:{orchestraIds:[]},ensemblesIds:[]}),[g,b]=m.useState([]),[D,T]=m.useState([]),[R,L]=m.useState(!1),[k,M]=m.useState({}),[p,j]=m.useState("");m.useEffect(()=>{t&&n==="edit"&&i?O(i):t&&n==="add"&&c()},[t,n,i]),m.useEffect(()=>{t&&C()},[t]);const C=async()=>{try{const[y,E]=await Promise.all([X.orchestras.getOrchestras(),X.orchestras.getOrchestras({type:"ensemble"})]);b(y||[]),T(E||[])}catch(y){console.error("Failed to load orchestras/ensembles:",y)}},O=y=>{d({personalInfo:{fullName:y.personalInfo?.fullName||"",phone:y.personalInfo?.phone||"",email:y.personalInfo?.email||"",address:y.personalInfo?.address||""},roles:y.roles||[],professionalInfo:{instrument:y.professionalInfo?.instrument||"",isActive:y.professionalInfo?.isActive??!0},teaching:{schedule:y.teaching?.schedule||[]},conducting:{orchestraIds:y.conducting?.orchestraIds||[]},ensemblesIds:y.ensemblesIds||[]})},_=()=>{const y={};return u.personalInfo.fullName.trim()||(y["personalInfo.fullName"]="×©× ××œ× × ×“×¨×©"),u.personalInfo.phone.match(/^05\d{8}$/)||(y["personalInfo.phone"]="××¡×¤×¨ ×˜×œ×¤×•×Ÿ ×—×™×™×‘ ×œ×”×™×•×ª ×‘×¤×•×¨××˜: 05XXXXXXXX"),u.personalInfo.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)||(y["personalInfo.email"]="×›×ª×•×‘×ª ××™××™×™×œ ×œ× ×ª×§×™× ×”"),u.personalInfo.address.trim()||(y["personalInfo.address"]="×›×ª×•×‘×ª × ×“×¨×©×ª"),u.roles.length===0&&(y.roles="×™×© ×œ×‘×—×•×¨ ×œ×¤×—×•×ª ×ª×¤×§×™×“ ××—×“"),(u.roles.includes("××•×¨×”")||u.roles.includes("××’××”")||!u.roles.includes("××•×¨×” ×ª××•×¨×™×”"))&&!u.professionalInfo.instrument&&(y["professionalInfo.instrument"]="×™×© ×œ×‘×—×•×¨ ×›×œ×™ × ×’×™× ×”"),u.teaching.schedule.forEach((I,$)=>{if(I.startTime||(y[`schedule.${$}.startTime`]="×©×¢×ª ×”×ª×—×œ×” × ×“×¨×©×ª"),I.endTime||(y[`schedule.${$}.endTime`]="×©×¢×ª ×¡×™×•× × ×“×¨×©×ª"),I.location?ct.includes(I.location)||(y[`schedule.${$}.location`]="××™×§×•× ×œ× ×ª×§×™×Ÿ"):y[`schedule.${$}.location`]="×™×© ×œ×‘×—×•×¨ ××™×§×•×",I.startTime&&I.endTime){const Q=Et(I.startTime,I.endTime);Q&&(y[`schedule.${$}.timeRange`]=Q)}}),M(y),Object.keys(y).length===0},F=(y,E,I)=>{d(Q=>({...Q,[y]:{...Q[y],[E]:I}}));const $=`${y}.${E}`;k[$]&&M(Q=>{const q={...Q};return delete q[$],q})},S=(y,E)=>{const I=E?[...u.roles,y]:u.roles.filter($=>$!==y);d($=>({...$,roles:I})),k.roles&&M($=>{const Q={...$};return delete Q.roles,Q})},P=()=>{const y={day:"×¨××©×•×Ÿ",startTime:"14:00",endTime:"15:30",location:"",notes:""};d(E=>({...E,teaching:{...E.teaching,schedule:[...E.teaching.schedule,y]}}))},A=y=>{d(E=>({...E,teaching:{...E.teaching,schedule:E.teaching.schedule.filter((I,$)=>$!==y)}}))},B=(y,E,I)=>{d($=>({...$,teaching:{...$.teaching,schedule:$.teaching.schedule.map((Q,q)=>q===y?{...Q,[E]:I}:Q)}}))},Z=async y=>{if(y.preventDefault(),!!_()){L(!0),j("");try{const E={personalInfo:u.personalInfo,roles:u.roles,professionalInfo:u.professionalInfo,teaching:{studentIds:[],schedule:u.teaching.schedule.map(I=>({day:I.day,startTime:I.startTime,endTime:I.endTime,duration:dt(I.startTime,I.endTime),location:I.location||null,notes:I.notes||null,isAvailable:!0,studentId:null,recurring:{isRecurring:!0,excludeDates:[]}}))},conducting:u.conducting,ensemblesIds:u.ensemblesIds,schoolYears:o?[{schoolYearId:o._id,isActive:!0}]:[],credentials:{email:u.personalInfo.email,password:null,isInvitationAccepted:!1},isActive:!0};if(n==="edit"&&i){console.log("ğŸ”„ Updating teacher:",E);const I=await X.teachers.updateTeacher(i._id,E);console.log("âœ… Teacher updated successfully:",I),a(I)}else{console.log("ğŸ”„ Creating teacher:",E);const I=await X.teachers.addTeacher(E);console.log("âœ… Teacher created successfully:",I),a(I)}c(),s()}catch(E){console.error(`âŒ Failed to ${n==="edit"?"update":"create"} teacher:`,E),j(E.message||`×©×’×™××” ×‘${n==="edit"?"×¢×“×›×•×Ÿ":"×™×¦×™×¨×ª"} ×”××•×¨×”. × ×¡×” ×©×•×‘.`)}finally{L(!1)}}},c=()=>{d({personalInfo:{fullName:"",phone:"",email:"",address:""},roles:[],professionalInfo:{instrument:"",isActive:!0},teaching:{schedule:[]},conducting:{orchestraIds:[]},ensemblesIds:[]}),f("personal"),M({}),j("")},w=()=>{c(),s()};if(!t)return null;const U=[{id:"personal",label:"××™×“×¢ ××™×©×™",icon:ge},{id:"professional",label:"××™×“×¢ ××§×¦×•×¢×™",icon:Ss},{id:"schedule",label:"×œ×•×— ×–×× ×™×",icon:te},{id:"conducting",label:"× ×™×¦×•×—",icon:lt}];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl h-[85vh] overflow-hidden border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:n==="edit"?"×¢×¨×™×›×ª ×¤×¨×˜×™ ××•×¨×”":"×”×•×¡×¤×ª ××•×¨×” ×—×“×©"}),e.jsx("button",{onClick:w,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(he,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:U.map(({id:y,label:E,icon:I})=>e.jsxs("button",{onClick:()=>f(y),className:`flex items-center gap-2 py-4 px-2 border-b-2 font-medium text-sm ${l===y?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(I,{className:"w-4 h-4"}),E]},y))})}),e.jsxs("form",{onSubmit:Z,children:[e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[l==="personal"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©× ××œ× *"}),e.jsx("input",{type:"text",value:u.personalInfo.fullName,onChange:y=>F("personalInfo","fullName",y.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 text-gray-900 placeholder-gray-500 bg-white ${k["personalInfo.fullName"]?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-primary-500"}`,placeholder:"×”×›× ×¡ ×©× ××œ×"}),k["personalInfo.fullName"]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k["personalInfo.fullName"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×˜×œ×¤×•×Ÿ *"}),e.jsx("input",{type:"tel",value:u.personalInfo.phone,onChange:y=>F("personalInfo","phone",y.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 text-gray-900 placeholder-gray-500 bg-white ${k["personalInfo.phone"]?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-primary-500"}`,placeholder:"05XXXXXXXX"}),k["personalInfo.phone"]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k["personalInfo.phone"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"××™××™×™×œ *"}),e.jsx("input",{type:"email",value:u.personalInfo.email,onChange:y=>F("personalInfo","email",y.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 text-gray-900 placeholder-gray-500 bg-white ${k["personalInfo.email"]?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-primary-500"}`,placeholder:"teacher@example.com"}),k["personalInfo.email"]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k["personalInfo.email"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×›×ª×•×‘×ª *"}),e.jsx("input",{type:"text",value:u.personalInfo.address,onChange:y=>F("personalInfo","address",y.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 text-gray-900 placeholder-gray-500 bg-white ${k["personalInfo.address"]?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-primary-500"}`,placeholder:"×¨×—×•×‘ ××¡×¤×¨, ×¢×™×¨"}),k["personalInfo.address"]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k["personalInfo.address"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"×ª×¤×§×™×“×™× *"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:or.map(y=>e.jsxs("label",{className:"flex items-center p-2 hover:bg-gray-50 rounded-lg cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:u.roles.includes(y),onChange:E=>S(y,E.target.checked),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500 w-4 h-4"}),e.jsx("span",{className:"mr-3 text-sm text-gray-700 font-medium",children:y})]},y))}),k.roles&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k.roles})]})]}),l==="professional"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["×›×œ×™ × ×’×™× ×” ",!u.roles.includes("××•×¨×” ×ª××•×¨×™×”")&&"*"]}),e.jsxs("select",{value:u.professionalInfo.instrument,onChange:y=>F("professionalInfo","instrument",y.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 text-gray-900 bg-white ${k["professionalInfo.instrument"]?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-primary-500"}`,disabled:u.roles.includes("××•×¨×” ×ª××•×¨×™×”")&&u.roles.length===1,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×›×œ×™ × ×’×™× ×”"}),ir.map(y=>e.jsx("option",{value:y,children:y},y))]}),k["professionalInfo.instrument"]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k["professionalInfo.instrument"]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:u.professionalInfo.isActive,onChange:y=>F("professionalInfo","isActive",y.target.checked),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"××•×¨×” ×¤×¢×™×œ"})]})})]}),l==="schedule"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"×‘×œ×•×§×™ ×–××Ÿ ×œ×”×•×¨××”"}),e.jsxs("button",{type:"button",onClick:P,className:"flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(ve,{className:"w-4 h-4 ml-2"}),"×”×•×¡×£ ×‘×œ×•×§ ×–××Ÿ"]})]}),u.teaching.schedule.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(te,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"×œ× ×”×•×’×“×¨×• ×‘×œ×•×§×™ ×–××Ÿ"}),e.jsx("p",{className:"text-sm",children:"×”×•×¡×£ ×‘×œ×•×§ ×–××Ÿ ×›×“×™ ×œ×§×‘×•×¢ ××ª×™ ×”××•×¨×” ×–××™×Ÿ ×œ×”×•×¨××”"})]}):e.jsx("div",{className:"space-y-4",children:u.teaching.schedule.map((y,E)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×™×•×"}),e.jsx("select",{value:y.day,onChange:I=>B(E,"day",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900 bg-white",children:lr.map(I=>e.jsx("option",{value:I,children:I},I))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×©×¢×ª ×”×ª×—×œ×”"}),e.jsx("input",{type:"time",value:y.startTime,onChange:I=>B(E,"startTime",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900 bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×©×¢×ª ×¡×™×•×"}),e.jsx("input",{type:"time",value:y.endTime,onChange:I=>B(E,"endTime",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900 bg-white"}),y.startTime&&y.endTime&&e.jsx("div",{className:"mt-1 text-xs",children:(()=>{const I=dt(y.startTime,y.endTime),$=Et(y.startTime,y.endTime);return $?e.jsx("span",{className:"text-red-600",children:$}):I>0?e.jsxs("span",{className:"text-gray-500",children:["××©×š: ",I," ×“×§×•×ª"]}):null})()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"××™×§×•×"}),e.jsxs("select",{value:y.location,onChange:I=>B(E,"location",I.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900 bg-white ${k[`schedule.${E}.location`]?"border-red-300 focus:ring-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ××™×§×•×..."}),ct.map(I=>e.jsx("option",{value:I,children:I},I))]}),k[`schedule.${E}.location`]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k[`schedule.${E}.location`]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×”×¢×¨×•×ª"}),e.jsx("input",{type:"text",value:y.notes,onChange:I=>B(E,"notes",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900 placeholder-gray-500 bg-white",placeholder:"×”×¢×¨×•×ª × ×•×¡×¤×•×ª"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"button",onClick:()=>A(E),className:"flex items-center px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[e.jsx(ot,{className:"w-4 h-4 ml-1"}),"×”×¡×¨"]})})]},E))})]}),l==="conducting"&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl p-6 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx(lt,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-gray-900",children:"×ª×–××•×¨×•×ª ×œ× ×™×¦×•×—"}),e.jsx("p",{className:"text-sm text-gray-600",children:"×‘×—×¨ ××ª ×”×ª×–××•×¨×•×ª ×©×”××•×¨×” ×™× ×¦×—"})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3 max-h-64 overflow-y-auto",children:g.map(y=>e.jsxs("label",{className:"flex items-center p-4 bg-white border-2 border-gray-200 rounded-xl hover:border-purple-300 hover:shadow-md transition-all duration-200 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:u.conducting.orchestraIds.includes(y._id),onChange:E=>{const I=E.target.checked?[...u.conducting.orchestraIds,y._id]:u.conducting.orchestraIds.filter($=>$!==y._id);F("conducting","orchestraIds",I)},className:"rounded-lg border-gray-300 text-purple-600 focus:ring-purple-500 w-5 h-5"}),e.jsxs("div",{className:"mr-4 flex-1",children:[e.jsx("div",{className:"text-base font-semibold text-gray-900 group-hover:text-purple-700 transition-colors",children:y.name}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:y.description||"×ª×–××•×¨×ª ×œ×œ× ×ª×™××•×¨"}),y.memberCount&&e.jsxs("div",{className:"text-xs text-purple-600 mt-1",children:["ğŸ‘¥ ",y.memberCount," ×—×‘×¨×™×"]})]})]},y._id))})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-teal-50 rounded-xl p-6 border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(ge,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-gray-900",children:"×× ×¡××‘×œ×™× ×œ×”×“×¨×›×”"}),e.jsx("p",{className:"text-sm text-gray-600",children:"×‘×—×¨ ××ª ×”×× ×¡××‘×œ×™× ×©×”××•×¨×” ×™×“×¨×™×š"})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3 max-h-64 overflow-y-auto",children:D.map(y=>e.jsxs("label",{className:"flex items-center p-4 bg-white border-2 border-gray-200 rounded-xl hover:border-green-300 hover:shadow-md transition-all duration-200 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:u.ensemblesIds.includes(y._id),onChange:E=>{const I=E.target.checked?[...u.ensemblesIds,y._id]:u.ensemblesIds.filter($=>$!==y._id);d($=>({...$,ensemblesIds:I}))},className:"rounded-lg border-gray-300 text-green-600 focus:ring-green-500 w-5 h-5"}),e.jsxs("div",{className:"mr-4 flex-1",children:[e.jsx("div",{className:"text-base font-semibold text-gray-900 group-hover:text-green-700 transition-colors",children:y.name}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:y.description||"×× ×¡××‘×œ ×œ×œ× ×ª×™××•×¨"}),y.memberCount&&e.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["ğŸµ ",y.memberCount," ×—×‘×¨×™×"]})]})]},y._id))})]})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200",children:[p&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-start gap-2",children:[e.jsx(ht,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm text-red-700",children:p})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:w,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",disabled:R,children:"×‘×™×˜×•×œ"}),e.jsxs("button",{type:"submit",disabled:R,className:"flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[R?e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin ml-2"}):e.jsx(gt,{className:"w-4 h-4 ml-2"}),R?"×©×•××¨...":n==="edit"?"×¢×“×›×Ÿ ××•×¨×”":"×©××•×¨ ××•×¨×”"]})]})]})]})]})})};function dr({theoryLesson:t,theoryLessons:s,teachers:a,onSubmit:i,onCancel:n,mode:o="create"}){const[l,f]=m.useState("single"),[u,d]=m.useState({category:"××’××”",teacherId:"",date:"",dayOfWeek:0,startTime:"14:00",endTime:"15:00",location:"××•×œ× ×¢×¨×Ÿ",studentIds:[],attendance:{present:[],absent:[]},notes:"",syllabus:"",homework:"",schoolYearId:""}),[g,b]=m.useState({category:"××’××”",teacherId:"",startDate:"",endDate:"",dayOfWeek:0,startTime:"14:00",endTime:"15:00",location:"××•×œ× ×¢×¨×Ÿ",studentIds:[],notes:"",syllabus:"",excludeDates:[],schoolYearId:""}),[D,T]=m.useState(a||[]),[R,L]=m.useState(!1),[k,M]=m.useState(!1),[p,j]=m.useState(""),[C,O]=m.useState(""),_=["×ª×œ××™×“×™× ×—×“×©×™× ×‘-×“","××ª×—×™×œ×™×","××ª×—×™×œ×™× ×‘","××ª×—×™×œ×™× ×“","××ª×§×“××™× ×‘","××ª×§×“××™× ×","××ª×§×“××™× ×’","×ª×œ××™×“×™× ×—×“×©×™× ×‘×•×’×¨×™× (×” - ×˜)","×ª×œ××™×“×™× ×—×“×©×™× ×¦×¢×™×¨×™×","×”×›× ×” ×œ×¨×¡×™×˜×œ ×§×œ××¡×™ ×™×","×”×›× ×” ×œ×¨×¡×™×˜×œ ×¨×•×§\\×¤×•×¤\\×’'××– ×™×","×”×›× ×” ×œ×¨×¡×™×˜×œ ×¨×•×§\\×¤×•×¤\\×’'××– ×™×‘","××’××”","×ª××•×¨×™×” ×›×œ×™"],F={0:"×¨××©×•×Ÿ",1:"×©× ×™",2:"×©×œ×™×©×™",3:"×¨×‘×™×¢×™",4:"×—××™×©×™",5:"×©×™×©×™",6:"×©×‘×ª"};m.useEffect(()=>{a||S(),P()},[a]),m.useEffect(()=>{if(o==="edit"&&t){const c=new Date(t.date);d({category:t.category||"××’××”",teacherId:t.teacherId||"",date:t.date?new Date(t.date).toISOString().split("T")[0]:"",dayOfWeek:t.dayOfWeek!==void 0?t.dayOfWeek:c.getDay(),startTime:t.startTime||"14:00",endTime:t.endTime||"15:00",location:t.location||"××•×œ× ×¢×¨×Ÿ",studentIds:t.studentIds||[],attendance:t.attendance||{present:[],absent:[]},notes:t.notes||"",syllabus:t.syllabus||"",homework:t.homework||"",schoolYearId:t.schoolYearId||""}),b(w=>({...w,category:t.category||"××’××”",teacherId:t.teacherId||"",location:t.location||"××•×œ× ×¢×¨×Ÿ",startTime:t.startTime||"14:00",endTime:t.endTime||"15:00",notes:t.notes||"",syllabus:t.syllabus||"",schoolYearId:t.schoolYearId||""}))}else if(o==="bulk-edit"&&s&&s.length>0){const c=s[0],w=s.every(q=>q.category===c.category)?c.category:"",U=s.every(q=>q.teacherId===c.teacherId)?c.teacherId:"",y=s.every(q=>q.location===c.location)?c.location:"",E=s.every(q=>q.startTime===c.startTime)?c.startTime:"",I=s.every(q=>q.endTime===c.endTime)?c.endTime:"",$=s.every(q=>q.notes===c.notes)?c.notes:"",Q=s.every(q=>q.syllabus===c.syllabus)?c.syllabus:"";b({category:w||"××’××”",teacherId:U||"",startDate:"",endDate:"",dayOfWeek:0,startTime:E||"14:00",endTime:I||"15:00",location:y||"××•×œ× ×¢×¨×Ÿ",studentIds:[],notes:$||"",syllabus:Q||"",excludeDates:[],schoolYearId:c.schoolYearId||""})}},[t,s,o]);const S=async()=>{try{const w=(await Ns.getTeachers()).filter(U=>U.roles&&U.roles.includes("××•×¨×” ×ª××•×¨×™×”"));T(w)}catch(c){console.error("Error loading teachers:",c)}},P=async()=>{try{const c=await ws.getCurrentSchoolYear();c&&(u.schoolYearId||d(w=>({...w,schoolYearId:c._id})),g.schoolYearId||b(w=>({...w,schoolYearId:c._id})))}catch(c){console.error("Error loading current school year:",c)}},A=(c,w)=>{if(o==="edit"||o==="create"&&l==="single"){if(d(U=>({...U,[c]:w})),c==="date"&&w){const y=new Date(w).getDay();d(E=>({...E,date:w,dayOfWeek:y}))}}else b(U=>({...U,[c]:w}))},B=()=>{if(l==="single"){if(!u.category.trim())return j("×™×© ×œ×‘×—×•×¨ ×§×˜×’×•×¨×™×” ×œ×©×™×¢×•×¨"),!1;if(!u.teacherId)return j("×™×© ×œ×‘×—×•×¨ ××•×¨×” ×œ×©×™×¢×•×¨"),!1;if(!u.date)return j("×™×© ×œ×‘×—×•×¨ ×ª××¨×™×š ×œ×©×™×¢×•×¨"),!1;if(!u.startTime||!u.endTime)return j("×™×© ×œ×”×–×™×Ÿ ×©×¢×•×ª ×”×ª×—×œ×” ×•×¡×™×•×"),!1;if(!u.location.trim())return j("×™×© ×œ×”×–×™×Ÿ ××™×§×•× ×œ×©×™×¢×•×¨"),!1;const c=u.startTime.split(":").map(Number),w=u.endTime.split(":").map(Number),U=c[0]*60+c[1];if(w[0]*60+w[1]<=U)return j("×©×¢×ª ×”×¡×™×•× ×—×™×™×‘×ª ×œ×”×™×•×ª ××—×¨×™ ×©×¢×ª ×”×”×ª×—×œ×”"),!1}else{if(!g.category.trim())return j("×™×© ×œ×‘×—×•×¨ ×§×˜×’×•×¨×™×” ×œ×©×™×¢×•×¨×™×"),!1;if(!g.teacherId)return j("×™×© ×œ×‘×—×•×¨ ××•×¨×” ×œ×©×™×¢×•×¨×™×"),!1;if(!g.startDate||!g.endDate)return j("×™×© ×œ×‘×—×•×¨ ×ª××¨×™×›×™ ×”×ª×—×œ×” ×•×¡×™×•×"),!1;if(!g.startTime||!g.endTime)return j("×™×© ×œ×”×–×™×Ÿ ×©×¢×•×ª ×”×ª×—×œ×” ×•×¡×™×•×"),!1;if(!g.location.trim())return j("×™×© ×œ×”×–×™×Ÿ ××™×§×•× ×œ×©×™×¢×•×¨×™×"),!1;if(g.dayOfWeek<0||g.dayOfWeek>6)return j("×™×© ×œ×‘×—×•×¨ ×™×•× ×‘×©×‘×•×¢"),!1;if(!g.schoolYearId)return j("×™×© ×œ×‘×—×•×¨ ×©× ×ª ×œ×™××•×“×™×"),!1;if(new Date(g.endDate)<=new Date(g.startDate))return j("×ª××¨×™×š ×”×¡×™×•× ×—×™×™×‘ ×œ×”×™×•×ª ××—×¨×™ ×ª××¨×™×š ×”×”×ª×—×œ×”"),!1;const c=g.startTime.split(":").map(Number),w=g.endTime.split(":").map(Number),U=c[0]*60+c[1];if(w[0]*60+w[1]<=U)return j("×©×¢×ª ×”×¡×™×•× ×—×™×™×‘×ª ×œ×”×™×•×ª ××—×¨×™ ×©×¢×ª ×”×”×ª×—×œ×”"),!1}return!0},Z=async c=>{if(c.preventDefault(),j(""),O(""),!!B()){L(!0);try{if(o==="edit"){const w={...u,date:new Date(u.date+"T"+u.startTime+":00.000Z").toISOString(),mode:"edit",lessonId:t?._id};await i(w),O("×©×™×¢×•×¨ ×”×ª×™××•×¨×™×” ×¢×•×“×›×Ÿ ×‘×”×¦×œ×—×”")}else if(o==="bulk-edit"){const w={};g.category&&g.category.trim()&&(w.category=g.category),g.teacherId&&g.teacherId.trim()&&(w.teacherId=g.teacherId),g.location&&g.location.trim()&&(w.location=g.location),g.startTime&&g.startTime.trim()&&(w.startTime=g.startTime),g.endTime&&g.endTime.trim()&&(w.endTime=g.endTime),g.notes&&g.notes.trim()&&(w.notes=g.notes),g.syllabus&&g.syllabus.trim()&&(w.syllabus=g.syllabus);const U={mode:"bulk-edit",lessonIds:s?.map(y=>y._id)||[],updateData:w};await i(U),O(`${s?.length||0} ×©×™×¢×•×¨×™ ×ª×™××•×¨×™×” ×¢×•×“×›× ×• ×‘×”×¦×œ×—×”`)}else if(l==="single"){const w={...u,date:new Date(u.date+"T"+u.startTime+":00.000Z").toISOString(),mode:"create"};await i(w),O("×©×™×¢×•×¨ ×”×ª×™××•×¨×™×” × ×•×¦×¨ ×‘×”×¦×œ×—×”")}else{const w={...g,isBulk:!0,mode:"bulk-create"};console.log("ğŸš€ Bulk theory lesson creation data:",JSON.stringify(w,null,2));const y=["category","teacherId","startDate","endDate","dayOfWeek","startTime","endTime","location","schoolYearId"].filter(E=>{const I=w[E];return I==null||typeof I=="string"&&I.trim()===""});if(y.length>0){console.error("âŒ Missing required fields:",y),j(`×—×¡×¨×™× ×©×“×•×ª ×—×•×‘×”: ${y.join(", ")}`);return}await i(w),O("×¨×¦×£ ×©×™×¢×•×¨×™ ×”×ª×™××•×¨×™×” × ×•×¦×¨ ×‘×”×¦×œ×—×”")}}catch(w){console.error("Error submitting theory lesson form:",w),j(w.message||"×©×’×™××” ×‘×©××™×¨×ª ×”×©×™×¢×•×¨")}finally{L(!1)}}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:o==="edit"?"×¢×¨×™×›×ª ×©×™×¢×•×¨ ×ª×™××•×¨×™×”":o==="bulk-edit"?"×¢×¨×™×›×” ×§×‘×•×¦×ª×™×ª ×©×œ ×©×™×¢×•×¨×™ ×ª×™××•×¨×™×”":"×©×™×¢×•×¨ ×ª×™××•×¨×™×” ×—×“×©"}),e.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(he,{className:"w-5 h-5 text-gray-500"})})]}),o==="create"&&e.jsxs("div",{className:"flex space-x-4 rtl:space-x-reverse",children:[e.jsxs("button",{type:"button",onClick:()=>f("single"),className:`flex items-center px-4 py-2 rounded-lg font-medium transition-colors ${l==="single"?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(te,{className:"w-4 h-4 ml-2"}),"×©×™×¢×•×¨ ×‘×•×“×“"]}),e.jsxs("button",{type:"button",onClick:()=>f("bulk"),className:`flex items-center px-4 py-2 rounded-lg font-medium transition-colors ${l==="bulk"?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(ks,{className:"w-4 h-4 ml-2"}),"×¨×¦×£ ×©×™×¢×•×¨×™×"]})]}),o==="bulk-edit"&&s&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ie,{className:"w-5 h-5 text-blue-600 ml-2"}),e.jsxs("p",{className:"text-blue-800",children:["×¢×¨×™×›×” ×§×‘×•×¦×ª×™×ª ×©×œ ",s.length," ×©×™×¢×•×¨×™ ×ª×™××•×¨×™×”"]})]}),e.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"×©×“×•×ª ×¨×™×§×™× ×™×™×©××¨×• ×œ×œ× ×©×™× ×•×™, ×¨×§ ×©×“×•×ª ×©×™××•×œ××• ×™×¢×•×“×›× ×•"})]})]}),e.jsxs("form",{onSubmit:Z,className:"p-6 space-y-6",children:[k&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 ml-2"}),e.jsx("p",{className:"text-blue-800 text-sm",children:"×˜×•×¢×Ÿ × ×ª×•× ×™ ×©×™×¢×•×¨..."})]})}),C&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsx("p",{className:"text-green-800 text-sm",children:C})}),p&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800 text-sm",children:p})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(_e,{className:"w-4 h-4 inline ml-1"}),"×§×˜×’×•×¨×™×” *"]}),e.jsxs("select",{value:o==="edit"||o==="create"&&l==="single"?u.category:g.category,onChange:c=>A("category",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:o!=="bulk-edit",children:[o==="bulk-edit"&&e.jsx("option",{value:"",children:"×”×©××¨ ×œ×œ× ×©×™× ×•×™"}),_.map(c=>e.jsx("option",{value:c,children:c},c))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"××•×¨×” *"}),e.jsxs("select",{value:o==="edit"||o==="create"&&l==="single"?u.teacherId:g.teacherId,onChange:c=>A("teacherId",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:o!=="bulk-edit",children:[e.jsx("option",{value:"",children:o==="bulk-edit"?"×”×©××¨ ×œ×œ× ×©×™× ×•×™":"×‘×—×¨ ××•×¨×”"}),D.map(c=>e.jsx("option",{value:c._id,children:c.personalInfo?.fullName},c._id))]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Ee,{className:"w-4 h-4 inline ml-1"}),"××™×§×•× *"]}),e.jsxs("select",{value:o==="edit"||o==="create"&&l==="single"?u.location:g.location,onChange:c=>A("location",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:o!=="bulk-edit",children:[o==="bulk-edit"&&e.jsx("option",{value:"",children:"×”×©××¨ ×œ×œ× ×©×™× ×•×™"}),ct.map(c=>e.jsx("option",{value:c,children:c},c))]})]}),o==="edit"||o==="create"&&l==="single"?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª××¨×™×š *"}),e.jsx("input",{type:"date",value:u.date,onChange:c=>A("date",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×™×•× ×‘×©×‘×•×¢"}),e.jsx("input",{type:"text",value:F[u.dayOfWeek]||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-700",disabled:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(le,{className:"w-4 h-4 inline ml-1"}),"×©×¢×ª ×”×ª×—×œ×” *"]}),e.jsx("input",{type:"time",value:u.startTime,onChange:c=>A("startTime",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©×¢×ª ×¡×™×•× *"}),e.jsx("input",{type:"time",value:u.endTime,onChange:c=>A("endTime",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0})]})]}):o==="bulk-edit"?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(le,{className:"w-4 h-4 inline ml-1"}),"×©×¢×ª ×”×ª×—×œ×”"]}),e.jsx("input",{type:"time",value:g.startTime,onChange:c=>A("startTime",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",placeholder:"×”×©××¨ ×œ×œ× ×©×™× ×•×™"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©×¢×ª ×¡×™×•×"}),e.jsx("input",{type:"time",value:g.endTime,onChange:c=>A("endTime",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",placeholder:"×”×©××¨ ×œ×œ× ×©×™× ×•×™"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª××¨×™×š ×”×ª×—×œ×” *"}),e.jsx("input",{type:"date",value:g.startDate,onChange:c=>A("startDate",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª××¨×™×š ×¡×™×•× *"}),e.jsx("input",{type:"date",value:g.endDate,onChange:c=>A("endDate",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×™×•× ×‘×©×‘×•×¢ *"}),e.jsx("select",{value:g.dayOfWeek,onChange:c=>A("dayOfWeek",parseInt(c.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0,children:Object.entries(F).map(([c,w])=>e.jsx("option",{value:c,children:w},c))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(le,{className:"w-4 h-4 inline ml-1"}),"×©×¢×ª ×”×ª×—×œ×” *"]}),e.jsx("input",{type:"time",value:g.startTime,onChange:c=>A("startTime",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©×¢×ª ×¡×™×•× *"}),e.jsx("input",{type:"time",value:g.endTime,onChange:c=>A("endTime",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×¡×™×œ×‘×•×¡"}),e.jsx("textarea",{value:o==="edit"||o==="create"&&l==="single"?u.syllabus:g.syllabus,onChange:c=>A("syllabus",c.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",placeholder:o==="bulk-edit"?"×”×©××¨ ×œ×œ× ×©×™× ×•×™ - × ×•×©××™ ×”×©×™×¢×•×¨...":o==="edit"||l==="single"?"× ×•×©××™ ×”×©×™×¢×•×¨...":"× ×•×©××™ ×”×©×™×¢×•×¨×™×..."})]}),o==="edit"||o==="create"&&l==="single"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©×™×¢×•×¨×™ ×‘×™×ª"}),e.jsx("textarea",{value:u.homework,onChange:c=>A("homework",c.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",placeholder:"××©×™××•×ª ×œ×‘×™×ª..."})]}):null,e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×”×¢×¨×•×ª"}),e.jsx("textarea",{value:o==="edit"||o==="create"&&l==="single"?u.notes:g.notes,onChange:c=>A("notes",c.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",placeholder:o==="bulk-edit"?"×”×©××¨ ×œ×œ× ×©×™× ×•×™ - ×”×¢×¨×•×ª ×›×œ×œ×™×•×ª...":"×”×¢×¨×•×ª ×›×œ×œ×™×•×ª..."})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",disabled:R,children:"×‘×™×˜×•×œ"}),e.jsxs("button",{type:"submit",disabled:R,className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50",children:[R?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white ml-2"}):e.jsx(gt,{className:"w-4 h-4 ml-2"}),o==="edit"?"×¢×“×›×Ÿ ×©×™×¢×•×¨":o==="bulk-edit"?"×¢×“×›×Ÿ ×©×™×¢×•×¨×™×":l==="single"?"×¦×•×¨ ×©×™×¢×•×¨":"×¦×•×¨ ×¨×¦×£ ×©×™×¢×•×¨×™×"]})]})]})]})})}const Qt={0:"×¨××©×•×Ÿ",1:"×©× ×™",2:"×©×œ×™×©×™",3:"×¨×‘×™×¢×™",4:"×—××™×©×™",5:"×©×™×©×™",6:"×©×‘×ª"},ur=Object.entries(Qt).map(([t,s])=>({value:parseInt(t),label:s})),pt=t=>Qt[t]||"×œ× ×™×“×•×¢",mr=t=>{const s=new Date(t.date).toLocaleDateString("he-IL"),a=`${t.startTime} - ${t.endTime}`,i=pt(t.dayOfWeek),n=`${i}, ${s} ${a}`;return{date:s,time:a,dayName:i,fullDateTime:n}},Ue=(t,s)=>{const a=me(t);return me(s)-a},me=t=>{const[s,a]=t.split(":").map(Number);return s*60+a},_t=t=>{const s=t.attendance?.present?.length||0,a=t.attendance?.absent?.length||0,i=t.orchestra?.memberIds?.length||s+a,n=i>0?Math.round(s/i*100):0;return{presentCount:s,absentCount:a,totalMembers:i,attendanceRate:n,hasAttendanceData:s>0||a>0}},hr=t=>{if(!t.isActive)return{status:"cancelled",text:"×‘×•×˜×œ×”",colorClass:"bg-gray-100 text-gray-800"};const s=new Date;new Date(t.date);const a=new Date(`${t.date}T${t.startTime}:00`),i=new Date(`${t.date}T${t.endTime}:00`);return s<a?{status:"upcoming",text:"×¢×ª×™×“×”",colorClass:"bg-blue-100 text-blue-800"}:s>=a&&s<=i?{status:"in_progress",text:"××ª×§×™×™××ª ×›×¢×ª",colorClass:"bg-green-100 text-green-800"}:{status:"completed",text:"×”×¡×ª×™×™××”",colorClass:"bg-orange-100 text-orange-800"}},At=(t,s)=>{if(t.date!==s.date)return{hasConflict:!1,conflictType:"none",severity:"none",message:""};if(t.groupId===s.groupId)return{hasConflict:!1,conflictType:"none",severity:"none",message:"××•×ª×” ×ª×–××•×¨×ª"};const a=me(t.startTime),i=me(t.endTime),n=me(s.startTime),o=me(s.endTime);if(a<o&&n<i){if(t.location===s.location)return{hasConflict:!0,conflictType:"location",severity:"critical",message:`×—×¤×™×¤×” ×‘××™×§×•×: ${t.location}`};const f=t.orchestra?.conductor?._id,u=s.orchestra?.conductor?._id;if(f&&u&&f===u)return{hasConflict:!0,conflictType:"conductor",severity:"critical",message:"××•×ª×• ×× ×¦×— ×‘×©× ×™ ××§×•××•×ª"};const d=new Set(t.orchestra?.memberIds||[]),g=new Set(s.orchestra?.memberIds||[]),b=[...d].filter(D=>g.has(D));return b.length>0?{hasConflict:!0,conflictType:"members",severity:"warning",message:`${b.length} ×—×‘×¨×™× ××©×•×ª×¤×™×`}:{hasConflict:!0,conflictType:"time",severity:"warning",message:"×—×¤×™×¤×ª ×–×× ×™×"}}return{hasConflict:!1,conflictType:"none",severity:"none",message:""}},za=(t,s)=>t.filter(a=>{if(s.searchQuery){const i=s.searchQuery.toLowerCase();if(!(a.orchestra?.name?.toLowerCase().includes(i)||a.location?.toLowerCase().includes(i)||a.notes?.toLowerCase().includes(i)||pt(a.dayOfWeek).toLowerCase().includes(i)))return!1}if(s.orchestraId&&a.groupId!==s.orchestraId||s.type&&a.type!==s.type||s.dayOfWeek!==""&&s.dayOfWeek!==void 0&&a.dayOfWeek!==s.dayOfWeek||s.location&&a.location!==s.location)return!1;if(s.startDate){const i=new Date(a.date),n=new Date(s.startDate);if(i<n)return!1}if(s.endDate){const i=new Date(a.date),n=new Date(s.endDate);if(i>n)return!1}return!(s.status&&s.status!=="all"&&hr(a).status!==s.status||s.isActive!==void 0&&a.isActive!==s.isActive)}),Xa=(t,s="date",a="asc")=>[...t].sort((n,o)=>{let l=0;switch(s){case"date":l=new Date(n.date).getTime()-new Date(o.date).getTime();break;case"time":l=me(n.startTime)-me(o.startTime);break;case"orchestra":const f=n.orchestra?.name||"",u=o.orchestra?.name||"";l=f.localeCompare(u,"he");break;case"location":l=n.location.localeCompare(o.location,"he");break;case"attendance":const d=_t(n).attendanceRate,g=_t(o).attendanceRate;l=d-g;break;case"duration":const b=Ue(n.startTime,n.endTime),D=Ue(o.startTime,o.endTime);l=b-D;break;default:l=0}return a==="desc"?-l:l}),gr=t=>{const s=[],a=new Date(t.startDate),i=new Date(t.endDate),n=t.dayOfWeek,o=new Set(t.excludeDates||[]),l=new Date(a);for(;l.getDay()!==n&&l<=i;)l.setDate(l.getDate()+1);for(;l<=i;){const f=l.toISOString().split("T")[0];o.has(f)||s.push(f),l.setDate(l.getDate()+7)}return s},xr=t=>{const s={};if(t.groupId?.trim()||(s.groupId="×™×© ×œ×‘×—×•×¨ ×ª×–××•×¨×ª"),t.type||(s.type="×™×© ×œ×‘×—×•×¨ ×¡×•×’ ×”×¨×›×‘"),!t.date)s.date="×™×© ×œ×‘×—×•×¨ ×ª××¨×™×š";else{const a=new Date(t.date),i=new Date;i.setHours(0,0,0,0),a<i&&(s.date="×œ× × ×™×ª×Ÿ ×œ×§×‘×•×¢ ×—×–×¨×” ×‘×¢×‘×¨")}if(t.startTime||(s.startTime="×™×© ×œ×”×–×™×Ÿ ×©×¢×ª ×”×ª×—×œ×”"),t.endTime||(s.endTime="×™×© ×œ×”×–×™×Ÿ ×©×¢×ª ×¡×™×•×"),t.startTime&&t.endTime){const a=Ue(t.startTime,t.endTime);a<=0?s.endTime="×©×¢×ª ×”×¡×™×•× ×—×™×™×‘×ª ×œ×”×™×•×ª ××—×¨×™ ×©×¢×ª ×”×”×ª×—×œ×”":a>300&&(s.endTime="××©×š ×”×—×–×¨×” ×œ× ×™×›×•×œ ×œ×”×™×•×ª ×™×•×ª×¨ ×-5 ×©×¢×•×ª")}return t.location?.trim()||(s.location="×™×© ×œ×‘×—×•×¨ ××™×§×•×"),{isValid:Object.keys(s).length===0,errors:s}},fr=t=>{const s={};if(t.orchestraId?.trim()||(s.orchestraId="×™×© ×œ×‘×—×•×¨ ×ª×–××•×¨×ª"),t.startDate||(s.startDate="×™×© ×œ×‘×—×•×¨ ×ª××¨×™×š ×”×ª×—×œ×”"),t.endDate||(s.endDate="×™×© ×œ×‘×—×•×¨ ×ª××¨×™×š ×¡×™×•×"),t.startDate&&t.endDate){const a=new Date(t.startDate),i=new Date(t.endDate);a>=i&&(s.endDate="×ª××¨×™×š ×”×¡×™×•× ×—×™×™×‘ ×œ×”×™×•×ª ××—×¨×™ ×ª××¨×™×š ×”×”×ª×—×œ×”"),(i.getTime()-a.getTime())/(1e3*60*60*24)>365&&(s.endDate="×ª×§×•×¤×” ×œ× ×™×›×•×œ×” ×œ×”×™×•×ª ×™×•×ª×¨ ××©× ×”")}return(t.dayOfWeek===void 0||t.dayOfWeek<0||t.dayOfWeek>6)&&(s.dayOfWeek="×™×© ×œ×‘×—×•×¨ ×™×•× ×‘×©×‘×•×¢"),t.startTime||(s.startTime="×™×© ×œ×”×–×™×Ÿ ×©×¢×ª ×”×ª×—×œ×”"),t.endTime||(s.endTime="×™×© ×œ×”×–×™×Ÿ ×©×¢×ª ×¡×™×•×"),t.startTime&&t.endTime&&Ue(t.startTime,t.endTime)<=0&&(s.endTime="×©×¢×ª ×”×¡×™×•× ×—×™×™×‘×ª ×œ×”×™×•×ª ××—×¨×™ ×©×¢×ª ×”×”×ª×—×œ×”"),t.location?.trim()||(s.location="×™×© ×œ×‘×—×•×¨ ××™×§×•×"),{isValid:Object.keys(s).length===0,errors:s}},qa=t=>{switch(t.orchestra?.type||t.type){case"×ª×–××•×¨×ª":return"bg-blue-500";case"×”×¨×›×‘":return"bg-pink-500";default:return"bg-gray-500"}};function pr({newRehearsal:t,bulkData:s,existingRehearsals:a,orchestras:i,onConflictsChanged:n}){const[o,l]=m.useState([]),[f,u]=m.useState(!1);m.useEffect(()=>{t||s?d():l([])},[t,s,a]),m.useEffect(()=>{n?.(o)},[o,n]);const d=async()=>{u(!0);try{let p=[];t?p=await g(t):s&&(p=await b(s)),l(p)}catch(p){console.error("Error detecting conflicts:",p)}finally{u(!1)}},g=async p=>{const j=[],C={_id:"temp",groupId:p.groupId,type:p.type,date:p.date,dayOfWeek:new Date(p.date).getDay(),startTime:p.startTime,endTime:p.endTime,location:p.location,attendance:{present:[],absent:[]},notes:p.notes||"",schoolYearId:"current",isActive:p.isActive,orchestra:i.find(O=>O._id===p.groupId)};for(const O of a){if(O.groupId===p.groupId&&O.date===p.date)continue;const _=At(C,O);_.hasConflict&&j.push({..._,conflictingRehearsal:O,affectedDate:p.date})}return j},b=async p=>{const j=[],C=D(p),O=i.find(_=>_._id===p.orchestraId);for(const _ of C){const F={_id:"temp",groupId:p.orchestraId,type:O?.type||"×ª×–××•×¨×ª",date:_,dayOfWeek:new Date(_).getDay(),startTime:p.startTime,endTime:p.endTime,location:p.location,attendance:{present:[],absent:[]},notes:p.notes||"",schoolYearId:p.schoolYearId,isActive:!0,orchestra:O};for(const S of a){if(S.groupId===p.orchestraId&&S.date===_)continue;const P=At(F,S);P.hasConflict&&j.push({...P,conflictingRehearsal:S,affectedDate:_})}}return j},D=p=>{const j=[],C=new Date(p.startDate),O=new Date(p.endDate),_=p.dayOfWeek,F=new Set(p.excludeDates||[]),S=new Date(C);for(;S.getDay()!==_&&S<=O;)S.setDate(S.getDate()+1);for(;S<=O;){const P=S.toISOString().split("T")[0];F.has(P)||j.push(P),S.setDate(S.getDate()+7)}return j},T=p=>{switch(p){case"critical":return e.jsx(It,{className:"w-5 h-5 text-red-600"});case"warning":return e.jsx(nt,{className:"w-5 h-5 text-yellow-600"});default:return e.jsx(Fe,{className:"w-5 h-5 text-green-600"})}},R=p=>{switch(p){case"location":return e.jsx(Ee,{className:"w-4 h-4"});case"conductor":return e.jsx(ge,{className:"w-4 h-4"});case"members":return e.jsx(ie,{className:"w-4 h-4"});case"time":return e.jsx(le,{className:"w-4 h-4"});default:return e.jsx(Fe,{className:"w-4 h-4"})}},L=p=>{switch(p){case"critical":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";default:return"bg-green-50 border-green-200 text-green-800"}},k=o.filter(p=>p.severity==="critical"),M=o.filter(p=>p.severity==="warning");return f?e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary-600 ml-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"×‘×•×“×§ ×”×ª× ×’×©×•×™×•×ª..."})]})}):o.length===0&&(t||s)?e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Fe,{className:"w-5 h-5 text-green-600 ml-2"}),e.jsx("span",{className:"text-sm text-green-800",children:"×œ× × ××¦××• ×”×ª× ×’×©×•×™×•×ª - × ×™×ª×Ÿ ×œ×™×¦×•×¨ ××ª ×”×—×–×¨×”"})]})}):o.length===0?null:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"×¡×™×›×•× ×”×ª× ×’×©×•×™×•×ª"}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[k.length>0&&e.jsxs("div",{className:"flex items-center text-red-600",children:[e.jsx(It,{className:"w-4 h-4 ml-1"}),e.jsxs("span",{children:[k.length," ×§×¨×™×˜×™×•×ª"]})]}),M.length>0&&e.jsxs("div",{className:"flex items-center text-yellow-600",children:[e.jsx(nt,{className:"w-4 h-4 ml-1"}),e.jsxs("span",{children:[M.length," ××–×”×¨×•×ª"]})]})]})]}),k.length>0&&e.jsx("p",{className:"text-sm text-red-800",children:"× ××¦××• ×”×ª× ×’×©×•×™×•×ª ×§×¨×™×˜×™×•×ª ×©××•× ×¢×•×ª ×™×¦×™×¨×ª ×”×—×–×¨×”. ×™×© ×œ×¤×ª×•×¨ ××•×ª×Ÿ ×œ×¤× ×™ ×”××©×š."}),M.length>0&&k.length===0&&e.jsx("p",{className:"text-sm text-yellow-800",children:"× ××¦××• ××–×”×¨×•×ª ×©×›×“××™ ×œ×‘×“×•×§. × ×™×ª×Ÿ ×œ×”××©×™×š ×‘×™×¦×™×¨×ª ×”×—×–×¨×” ××š ××•××œ×¥ ×œ×•×•×“×."})]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:o.map((p,j)=>e.jsx("div",{className:`border rounded-lg p-3 ${L(p.severity)}`,children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-start gap-2",children:[T(p.severity),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[R(p.conflictType),e.jsx("span",{className:"font-medium text-sm",children:p.message})]}),p.conflictingRehearsal&&e.jsx("div",{className:"text-xs opacity-75",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{children:p.conflictingRehearsal.orchestra?.name}),e.jsx("span",{children:mr(p.conflictingRehearsal).fullDateTime}),e.jsx("span",{children:p.conflictingRehearsal.location})]})}),p.affectedDate&&e.jsxs("div",{className:"text-xs opacity-75 mt-1",children:["×ª××¨×™×š ××ª× ×’×©: ",new Date(p.affectedDate).toLocaleDateString("he-IL")]})]})]})})},j))}),k.length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-red-900 mb-2",children:"×¤×¢×•×œ×•×ª ××•××œ×¦×•×ª ×œ×¤×ª×¨×•×Ÿ:"}),e.jsxs("ul",{className:"text-sm text-red-800 space-y-1 list-disc list-inside",children:[k.some(p=>p.conflictType==="location")&&e.jsx("li",{children:"×©× ×” ××ª ××™×§×•× ×”×—×–×¨×” ××• ×‘×—×¨ ×–××Ÿ ××—×¨"}),k.some(p=>p.conflictType==="conductor")&&e.jsx("li",{children:"×ª×× ×¢× ×”×× ×¦×— ××• ×©× ×” ××ª ×–××Ÿ ×”×—×–×¨×”"}),k.some(p=>p.conflictType==="time")&&e.jsx("li",{children:"×‘×—×¨ ×–××Ÿ ××—×¨ ××• ×ª××¨×™×š ××—×¨"})]})]})]})}function yr({orchestras:t,existingRehearsals:s=[],onSubmit:a,onCancel:i,initialData:n}){const[o,l]=m.useState("single"),[f,u]=m.useState(!1),[d,g]=m.useState({}),[b,D]=m.useState({groupId:"",type:"×ª×–××•×¨×ª",date:"",startTime:"19:00",endTime:"21:00",location:"",notes:"",isActive:!0,...n}),[T,R]=m.useState({orchestraId:"",startDate:"",endDate:"",dayOfWeek:0,startTime:"19:00",endTime:"21:00",location:"",notes:"",excludeDates:[],schoolYearId:"current"}),[L,k]=m.useState(""),[M,p]=m.useState([]),[j,C]=m.useState(!1),[O,_]=m.useState(!1);m.useEffect(()=>{if(o==="single"&&b.groupId){const c=t.find(w=>w._id===b.groupId);c&&!b.location&&D(w=>({...w,location:c.location,type:c.type}))}},[b.groupId,t,o]),m.useEffect(()=>{if(o==="bulk"&&T.orchestraId){const c=t.find(w=>w._id===T.orchestraId);c&&!T.location&&R(w=>({...w,location:c.location}))}},[T.orchestraId,t,o]),m.useEffect(()=>{if(o==="bulk"&&T.startDate&&T.endDate&&T.dayOfWeek!==void 0)try{const c=gr(T);p(c)}catch{p([])}else p([])},[o,T.startDate,T.endDate,T.dayOfWeek,T.excludeDates]);const F=(c,w)=>{D(U=>({...U,[c]:w})),d[c]&&g(U=>({...U,[c]:""}))},S=(c,w)=>{R(U=>({...U,[c]:w})),d[c]&&g(U=>({...U,[c]:""}))},P=()=>{L&&(R(c=>({...c,excludeDates:[...c.excludeDates||[],L]})),k(""))},A=c=>{R(w=>({...w,excludeDates:(w.excludeDates||[]).filter(U=>U!==c)}))},B=c=>{C(c.length>0),_(c.some(w=>w.severity==="critical"))},Z=async c=>{c.preventDefault(),u(!0),g({});try{if(O){g({submit:"×™×© ×œ×¤×ª×•×¨ ×”×ª× ×’×©×•×™×•×ª ×§×¨×™×˜×™×•×ª ×œ×¤× ×™ ×™×¦×™×¨×ª ×”×—×–×¨×”"});return}if(o==="single"){const w=xr(b);if(!w.isValid){g(w.errors);return}const y=new Date(b.date).getDay(),E={...b,dayOfWeek:y};await a(E,!1)}else{const w=fr(T);if(!w.isValid){g(w.errors);return}await a(T,!0)}}catch(w){g({submit:w.message||"×©×’×™××” ×‘×©××™×¨×ª ×”×—×–×¨×”"})}finally{u(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:i,children:e.jsx("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto transform transition-all",onClick:c=>c.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("button",{onClick:i,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(he,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n?"×¢×¨×•×š ×—×–×¨×”":"×—×–×¨×” ×—×“×©×”"}),!n&&e.jsx("div",{className:"flex justify-center mt-3",children:e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{type:"button",onClick:()=>l("single"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${o==="single"?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"×—×–×¨×” ×™×—×™×“×”"}),e.jsx("button",{type:"button",onClick:()=>l("bulk"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${o==="bulk"?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"×—×–×¨×•×ª ×—×•×–×¨×•×ª"})]})})]}),e.jsx("div",{className:"w-8"})]}),e.jsxs("form",{onSubmit:Z,className:"space-y-6",children:[o==="single"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ie,{className:"w-4 h-4 inline ml-1"}),"×ª×–××•×¨×ª"]}),e.jsxs("select",{value:b.groupId||"",onChange:c=>F("groupId",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.groupId?"border-red-300":"border-gray-300"}`,disabled:!!n,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×ª×–××•×¨×ª"}),t.map(c=>e.jsxs("option",{value:c._id,children:[c.name," (",c.type,")"]},c._id))]}),d.groupId&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.groupId})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(te,{className:"w-4 h-4 inline ml-1"}),"×ª××¨×™×š"]}),e.jsx("input",{type:"date",value:b.date||"",onChange:c=>F("date",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.date?"border-red-300":"border-gray-300"}`}),d.date&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.date})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(le,{className:"w-4 h-4 inline ml-1"}),"×©×¢×ª ×”×ª×—×œ×”"]}),e.jsx("input",{type:"time",value:b.startTime||"",onChange:c=>F("startTime",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.startTime?"border-red-300":"border-gray-300"}`}),d.startTime&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.startTime})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©×¢×ª ×¡×™×•×"}),e.jsx("input",{type:"time",value:b.endTime||"",onChange:c=>F("endTime",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.endTime?"border-red-300":"border-gray-300"}`}),d.endTime&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.endTime})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Ee,{className:"w-4 h-4 inline ml-1"}),"××™×§×•×"]}),e.jsx("input",{type:"text",value:b.location||"",onChange:c=>F("location",c.target.value),placeholder:"×›×’×•×Ÿ: ××•×œ× ×¢×¨×Ÿ, ×¡×˜×•×“×™×• ×§×××¨×™ 1",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.location?"border-red-300":"border-gray-300"}`}),d.location&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.location})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×”×¢×¨×•×ª"}),e.jsx("textarea",{value:b.notes||"",onChange:c=>F("notes",c.target.value),rows:3,placeholder:"×”×¢×¨×•×ª × ×•×¡×¤×•×ª ×¢×‘×•×¨ ×”×—×–×¨×”...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ie,{className:"w-4 h-4 inline ml-1"}),"×ª×–××•×¨×ª"]}),e.jsxs("select",{value:T.orchestraId||"",onChange:c=>S("orchestraId",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.orchestraId?"border-red-300":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×ª×–××•×¨×ª"}),t.map(c=>e.jsxs("option",{value:c._id,children:[c.name," (",c.type,")"]},c._id))]}),d.orchestraId&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.orchestraId})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(te,{className:"w-4 h-4 inline ml-1"}),"×ª××¨×™×š ×”×ª×—×œ×”"]}),e.jsx("input",{type:"date",value:T.startDate||"",onChange:c=>S("startDate",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.startDate?"border-red-300":"border-gray-300"}`}),d.startDate&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.startDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª××¨×™×š ×¡×™×•×"}),e.jsx("input",{type:"date",value:T.endDate||"",onChange:c=>S("endDate",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.endDate?"border-red-300":"border-gray-300"}`}),d.endDate&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.endDate})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×™×•× ×‘×©×‘×•×¢"}),e.jsx("select",{value:T.dayOfWeek||0,onChange:c=>S("dayOfWeek",parseInt(c.target.value)),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.dayOfWeek?"border-red-300":"border-gray-300"}`,children:ur.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))}),d.dayOfWeek&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.dayOfWeek})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(le,{className:"w-4 h-4 inline ml-1"}),"×©×¢×ª ×”×ª×—×œ×”"]}),e.jsx("input",{type:"time",value:T.startTime||"",onChange:c=>S("startTime",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.startTime?"border-red-300":"border-gray-300"}`}),d.startTime&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.startTime})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©×¢×ª ×¡×™×•×"}),e.jsx("input",{type:"time",value:T.endTime||"",onChange:c=>S("endTime",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.endTime?"border-red-300":"border-gray-300"}`}),d.endTime&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.endTime})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Ee,{className:"w-4 h-4 inline ml-1"}),"××™×§×•×"]}),e.jsx("input",{type:"text",value:T.location||"",onChange:c=>S("location",c.target.value),placeholder:"×›×’×•×Ÿ: ××•×œ× ×¢×¨×Ÿ, ×¡×˜×•×“×™×• ×§×××¨×™ 1",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.location?"border-red-300":"border-gray-300"}`}),d.location&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.location})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª××¨×™×›×™× ×œ×“×™×œ×•×’"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"date",value:L,onChange:c=>k(c.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"×‘×—×¨ ×ª××¨×™×š ×œ×“×™×œ×•×’"}),e.jsx("button",{type:"button",onClick:P,disabled:!L,className:"px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(ve,{className:"w-4 h-4"})})]}),T.excludeDates&&T.excludeDates.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:T.excludeDates.map(c=>e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg px-2 py-1",children:[e.jsx("span",{className:"text-sm text-gray-700",children:new Date(c).toLocaleDateString("he-IL")}),e.jsx("button",{type:"button",onClick:()=>A(c),className:"mr-1 text-gray-500 hover:text-red-600",children:e.jsx(Cs,{className:"w-3 h-3"})})]},c))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×”×¢×¨×•×ª"}),e.jsx("textarea",{value:T.notes||"",onChange:c=>S("notes",c.target.value),rows:3,placeholder:"×”×¢×¨×•×ª × ×•×¡×¤×•×ª ×¢×‘×•×¨ ×›×œ ×”×—×–×¨×•×ª...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),M.length>0&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(ht,{className:"w-4 h-4 text-blue-600 ml-1"}),e.jsxs("span",{className:"text-sm font-medium text-blue-900",children:["×ª×™×•×•×¦×¨×• ",M.length," ×—×–×¨×•×ª"]})]}),e.jsxs("div",{className:"text-xs text-blue-700 max-h-32 overflow-y-auto",children:[M.slice(0,10).map(c=>e.jsxs("div",{children:[new Date(c).toLocaleDateString("he-IL")," - ",pt(new Date(c).getDay())]},c)),M.length>10&&e.jsxs("div",{className:"text-blue-600",children:["...×•×¢×•×“ ",M.length-10]})]})]})]}),e.jsx(pr,{newRehearsal:o==="single"?b:null,bulkData:o==="bulk"?T:null,existingRehearsals:s,orchestras:t,onConflictsChanged:B}),d.submit&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800 text-sm",children:d.submit})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"×‘×™×˜×•×œ"}),e.jsx("button",{type:"submit",disabled:f||O,className:`px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors ${f||O?"opacity-50 cursor-not-allowed":""}`,children:f?"×©×•××¨...":n?"×¢×“×›×Ÿ ×—×–×¨×”":o==="single"?"×¦×•×¨ ×—×–×¨×”":`×¦×•×¨ ${M.length} ×—×–×¨×•×ª`})]})]})]})})})}const br=[{name:"××™×“×¢ ×›×œ×œ×™",href:"/dashboard",icon:Ae,category:"general"},{name:"×ª×œ××™×“×™×",href:"/students",icon:ie,category:"management",roles:["admin"]},{name:"××•×¨×™×",href:"/teachers",icon:Mt,category:"management",roles:["admin"]},{name:"×©×™×¢×•×¨×™ ×ª×™××•×¨×™×”",href:"/theory-lessons",icon:_e,category:"management",roles:["admin"]},{name:"×ª×–××•×¨×•×ª",href:"/orchestras",icon:Ye,category:"management",roles:["admin"]},{name:"×—×–×¨×•×ª",href:"/rehearsals",icon:te,category:"management",roles:["admin"]},{name:"×‘×’×¨×•×™×•×ª",href:"/bagruts",icon:xt,category:"management",roles:["admin"]},{name:"× ×•×›×—×•×ª",href:"/teachers",icon:He,category:"operations",roles:["admin"]},{name:"×”×’×“×¨×•×ª",href:"/settings",icon:lt,category:"system",roles:["admin"]}],jr=[{name:"×œ×•×— ×‘×§×¨×”",href:"/dashboard",icon:Ae,category:"general"},{name:"×”×ª×œ××™×“×™× ×©×œ×™",href:"/students",icon:ie,category:"personal",roles:["teacher"]},{name:"×œ×•×— ×–×× ×™× ×©×œ×™",href:"/profile",icon:te,category:"personal",roles:["teacher"]},{name:"× ×•×›×—×•×ª",href:"/profile?tab=attendance",icon:He,category:"operations",roles:["teacher"]},{name:"× ×™×”×•×œ ×‘×’×¨×•×™×•×ª",href:"/bagruts",icon:xt,category:"operations",roles:["teacher"]},{name:"×¤×¨×•×¤×™×œ",href:"/profile",icon:ge,category:"personal"}],vr=[{name:"×œ×•×— ×‘×§×¨×”",href:"/dashboard",icon:Ae,category:"general"},{name:"×”×ª×–××•×¨×•×ª ×©×œ×™",href:"/orchestras",icon:Ye,category:"personal",roles:["conductor"]},{name:"×—×–×¨×•×ª",href:"/rehearsals",icon:te,category:"personal",roles:["conductor"]},{name:"× ×•×›×—×•×ª",href:"/profile?tab=orchestras",icon:He,category:"operations",roles:["conductor"]},{name:"× ×™×”×•×œ ×¨×™×©×•××™×",href:"/conductor/enrollment",icon:Vt,category:"operations",roles:["conductor"]},{name:"×¤×¨×•×¤×™×œ",href:"/profile",icon:ge,category:"personal"}],Nr=[{name:"×œ×•×— ×‘×§×¨×”",href:"/dashboard",icon:Ae,category:"general"},{name:"×”×©×™×¢×•×¨×™× ×©×œ×™",href:"/theory-lessons",icon:_e,category:"personal",roles:["theory-teacher"]},{name:"×§×‘×•×¦×•×ª ×ª×™××•×¨×™×”",href:"/theory-lessons",icon:ie,category:"personal",roles:["theory-teacher"]},{name:"× ×•×›×—×•×ª",href:"/profile?tab=lessons",icon:He,category:"operations",roles:["theory-teacher"]},{name:"×ª×›× ×™×ª ×œ×™××•×“×™×",href:"/theory-lessons",icon:_s,category:"personal",roles:["theory-teacher"]},{name:"×¤×¨×•×¤×™×œ",href:"/profile",icon:ge,category:"personal"}],wr={admin:[{name:"×”×•×¡×£ ×ª×œ××™×“ ×—×“×©",href:"/students/new",icon:ie,role:"admin"},{name:"×”×•×¡×£ ××•×¨×” ×—×“×©",href:"/teachers/new",icon:Mt,role:"admin"},{name:"×¦×•×¨ ×©×™×¢×•×¨ ×ª×™××•×¨×™×”",href:"/theory-lessons/new",icon:_e,role:"admin"},{name:"×ª×–××Ÿ ×—×–×¨×”",href:"/rehearsals/new",icon:te,role:"admin"}],teacher:[{name:"×”×•×¡×£ ×©×™×¢×•×¨",href:"/profile?tab=students&action=addStudent",icon:ve,role:"teacher"},{name:"×¡××Ÿ × ×•×›×—×•×ª",href:"/profile?tab=attendance",icon:St,role:"teacher"},{name:"×¦×¤×” ×‘×œ×•×— ×–×× ×™×",href:"/profile?tab=schedule",icon:le,role:"teacher"}],conductor:[{name:"×ª×–××Ÿ ×—×–×¨×”",href:"/rehearsals/new",icon:kt,role:"conductor"},{name:"× ×”×œ ×ª×–××•×¨×ª",href:"/orchestras",icon:Ye,role:"conductor"},{name:"×¡××Ÿ × ×•×›×—×•×ª",href:"/profile?tab=orchestras",icon:St,role:"conductor"}],"theory-teacher":[{name:"×ª×–××Ÿ ×©×™×¢×•×¨ ×ª×™××•×¨×™×”",href:"/theory-lessons/new",icon:kt,role:"theory-teacher"},{name:"× ×”×œ ×§×‘×•×¦×•×ª",href:"/theory-lessons",icon:Vt,role:"theory-teacher"},{name:"×“×¨×’ ×ª×œ××™×“×™×",href:"/theory-lessons",icon:xt,role:"theory-teacher"}]};function Tr(){const t=ys(),s=Ve(),{user:a,isLoading:i}=Ne(),{isDesktopOpen:n,setIsDesktopOpen:o,isMobile:l}=ft(),[f,u]=m.useState(""),[d,g]=m.useState(!1),[b,D]=m.useState(new Set),[T,R]=m.useState(!1),[L,k]=m.useState(!1),[M,p]=m.useState(!1),[j,C]=m.useState(!1),[O,_]=m.useState([]),[F,S]=m.useState(!1),P=r=>t.pathname===r,B=(()=>{if(!a)return[];const r=[];return a.role&&r.push(a.role),a.roles&&Array.isArray(a.roles)&&r.push(...a.roles),a.teaching?.studentIds?.length>0&&!r.includes("teacher")&&!r.includes("××•×¨×”")&&r.push("teacher"),a.conducting?.orchestraIds?.length>0&&!r.includes("conductor")&&!r.includes("×× ×¦×—")&&r.push("conductor"),[...new Set(r.map(h=>h==="theory_teacher"?"theory-teacher":h==="×× ×”×œ"?"admin":h==="××•×¨×”"?"teacher":h==="×× ×¦×—"?"conductor":h==="××•×¨×” ×ª×™××•×¨×™×”"?"theory-teacher":h))]})(),Z=B.includes("admin"),c=B.length>1,w=()=>{if(Z){const x=[...br],v=x.findIndex(N=>N.name==="× ×•×›×—×•×ª");if(v!==-1){let N="/teachers";B.includes("teacher")?N="/profile?tab=attendance":B.includes("conductor")?N="/profile?tab=orchestras":B.includes("theory-teacher")&&(N="/profile?tab=lessons"),x[v]={...x[v],href:N}}return x}const r=new Map,h=[];return B.includes("teacher")&&h.push(...jr),B.includes("conductor")&&h.push(...vr),B.includes("theory-teacher")&&h.push(...Nr),h.forEach(x=>{const v=x.href;if(!r.has(v))r.set(v,x);else{const N=r.get(v);x.roles&&N.roles&&(N.roles=[...new Set([...N.roles,...x.roles])])}}),Array.from(r.values())},U=()=>{const r=[],h=new Map;return B.forEach(x=>{const v=wr[x];v&&v.forEach(N=>{const V=`${N.href}-${N.name}`;h.has(V)||(h.set(V,!0),r.push(N))})}),r},y=r=>{const h={general:{label:"×›×œ×œ×™",items:[]},personal:{label:"××–×•×¨ ××™×©×™",items:[]},management:{label:"× ×™×”×•×œ ××¢×¨×›×ª",items:[]},operations:{label:"×¤×¢×•×œ×•×ª",items:[]},system:{label:"××¢×¨×›×ª",items:[]}};return r.forEach(x=>{const v=x.category||"general";h[v]&&h[v].items.push(x)}),Object.entries(h).filter(([x,v])=>v.items.length>0).map(([x,v])=>({key:x,...v}))},E=w(),I=y(E),$=U();console.log("ğŸ“‹ Sidebar Debug:",{hasUser:!!a,isLoading:i,userRoles:B,isAdmin:Z,hasMultipleRoles:c,isMobile:l,isDesktopOpen:n,isOpen:d,navigationItemsCount:E?.length||0,groupedNavigationCount:I?.length||0,quickActionsCount:$?.length||0}),m.useEffect(()=>{l||g(!1)},[l]),m.useEffect(()=>{const r=h=>{if(l&&d){const x=document.getElementById("mobile-sidebar"),v=document.getElementById("hamburger-button");x&&!x.contains(h.target)&&v&&!v.contains(h.target)&&g(!1)}};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[l,d]),m.useEffect(()=>(l&&d?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[l,d]);const Q=()=>{l&&g(!1)},q=r=>{const h=new Set(b);h.has(r)?h.delete(r):h.add(r),D(h)},Te=r=>{switch(r){case"admin":return"×× ×”×œ";case"teacher":return"××•×¨×”";case"conductor":return"×× ×¦×—";case"theory-teacher":return"××•×¨×” ×ª×™××•×¨×™×”";default:return r}},Ie=r=>{switch(r){case"admin":return"bg-red-100 text-red-700";case"teacher":return"bg-blue-100 text-blue-700";case"conductor":return"bg-green-100 text-green-700";case"theory-teacher":return"bg-yellow-100 text-yellow-700";default:return"bg-gray-100 text-gray-700"}},Re=async(r,h)=>{Q(),r==="×”×•×¡×£ ×ª×œ××™×“ ×—×“×©"?R(!0):r==="×”×•×¡×£ ××•×¨×” ×—×“×©"?k(!0):r==="×¦×•×¨ ×©×™×¢×•×¨ ×ª×™××•×¨×™×”"?p(!0):r==="×ª×–××Ÿ ×—×–×¨×”"?(await qe(),C(!0)):s(h)},qe=async()=>{try{S(!0);const r=await Ts.getOrchestras();_(r||[])}catch(r){console.error("Failed to load orchestras:",r),_([])}finally{S(!1)}},Ge=async r=>{R(!1)},Qe=async()=>{k(!1)},Ke=async r=>{p(!1)},Je=async r=>{C(!1)};return e.jsxs(e.Fragment,{children:[l&&e.jsx("button",{id:"hamburger-button",onClick:()=>g(!d),className:"fixed top-[20px] right-4 z-[60] p-2 bg-white rounded-lg shadow-lg border border-gray-200 hover:bg-gray-50 transition-colors duration-200","aria-label":"Toggle menu",children:d?e.jsx(he,{className:"w-6 h-6 text-gray-600"}):e.jsx(tt,{className:"w-6 h-6 text-gray-600"})}),!l&&!n&&e.jsx("button",{onClick:()=>o(!0),className:"fixed top-[20px] right-4 z-[60] p-2 bg-white rounded-lg shadow-lg border border-gray-200 hover:bg-indigo-50 hover:border-indigo-300 transition-all duration-200","aria-label":"Open sidebar",children:e.jsx(tt,{className:"w-5 h-5 text-indigo-600"})}),l&&d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[50] transition-opacity duration-300",onClick:()=>g(!1)}),e.jsxs("div",{id:"sidebar",className:`fixed top-0 right-0 w-[280px] h-screen bg-white border-l border-gray-200 shadow-[-4px_0_6px_-1px_rgba(0,0,0,0.1)] rtl z-[55] transition-transform duration-300 ease-in-out flex flex-col ${l?d?"translate-x-0":"translate-x-full":n?"translate-x-0":"translate-x-full"}`,children:[!l&&e.jsx("button",{onClick:()=>o(!n),className:"absolute top-4 left-4 p-2 bg-gray-50 rounded-lg border border-gray-200 hover:bg-indigo-50 hover:border-indigo-300 transition-all duration-200 z-10","aria-label":"Toggle sidebar",children:n?e.jsx(he,{className:"w-5 h-5 text-gray-600"}):e.jsx(tt,{className:"w-5 h-5 text-indigo-600"})}),e.jsx("div",{className:"p-4 border-b border-gray-100 flex-shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ds,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"×—×™×¤×•×©...",value:f,onChange:r=>u(r.target.value),className:"w-full pr-10 pl-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm font-reisinger-yonatan text-right rtl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),c&&e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 flex-shrink-0",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:B.map(r=>e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${Ie(r)}`,children:[e.jsx(Es,{className:"w-3 h-3"}),Te(r)]},r))})}),e.jsx("nav",{className:"flex-1 px-3 py-4 overflow-y-auto overflow-x-hidden min-h-0 custom-scrollbar",children:i?e.jsx("div",{className:"space-y-2 px-4 py-8",children:e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded"})]})}):e.jsxs(e.Fragment,{children:[I.map((r,h)=>e.jsxs("div",{className:h>0?"mt-6":"",children:[e.jsx("div",{className:"px-4 mb-2",children:e.jsxs("button",{onClick:()=>q(r.key),className:"flex items-center justify-between w-full text-xs font-semibold text-gray-500 uppercase tracking-wider hover:text-gray-700 transition-colors",children:[e.jsx("span",{children:r.label}),e.jsx(de,{className:`w-3 h-3 transition-transform ${b.has(r.key)?"rotate-180":""}`})]})}),!b.has(r.key)&&e.jsx("div",{className:"space-y-1",children:r.items.map(x=>{const v=x.icon,N=P(x.href);return e.jsxs(be,{to:x.href,onClick:Q,className:`flex items-center justify-between px-4 py-3 mx-3 rounded-lg text-sm font-medium transition-all duration-150 rtl font-reisinger-yonatan ${N?"bg-primary-50 text-primary-700 border border-primary-200":"text-gray-600 hover:bg-gray-50 hover:text-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-right",children:x.name}),c&&x.roles&&x.roles.length===1&&e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded-full ${Ie(x.roles[0])}`,children:Te(x.roles[0])})]}),e.jsx(v,{className:"w-4 h-4 flex-shrink-0"})]},`${r.key}-${x.href}-${x.name}`)})})]},r.key)),$.length>0&&e.jsxs("div",{className:"space-y-1 border-t border-gray-200 pt-6 mt-6",children:[e.jsx("h3",{className:"px-4 text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"×¤×¢×•×œ×•×ª ××”×™×¨×•×ª"}),$.map(r=>{const h=r.icon;return e.jsxs("button",{onClick:()=>Re(r.name,r.href),className:"w-full flex items-center justify-between px-4 py-2 mx-3 rounded-lg text-sm font-medium transition-all duration-150 rtl font-reisinger-yonatan text-gray-600 hover:bg-green-50 hover:text-green-700 group",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-right",children:r.name}),c&&r.role&&e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded-full ${Ie(r.role)}`,children:Te(r.role)})]}),e.jsxs("div",{className:"flex items-center space-x-1 space-x-reverse",children:[e.jsx(ve,{className:"w-3 h-3 group-hover:text-green-500"}),e.jsx(h,{className:"w-3.5 h-3.5"})]})]},`${r.href}-${r.name}-${r.role}`)})]})]})})]}),T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100] p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsx(nr,{onSubmit:Ge,onCancel:()=>R(!1),isEdit:!1,initialData:null})})}),L&&e.jsx(cr,{isOpen:L,onClose:()=>k(!1),onSuccess:Qe}),M&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100] p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsx(dr,{onSubmit:Ke,onCancel:()=>p(!1)})})}),j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100] p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:F?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"×˜×•×¢×Ÿ ×ª×–××•×¨×•×ª..."})]}):e.jsx(yr,{orchestras:O,onSubmit:Je,onCancel:()=>C(!1)})})})]})}function Ir(){const[t,s]=m.useState(!1),a=m.useRef(null),{currentSchoolYear:i,schoolYears:n,isLoading:o,setCurrentSchoolYearById:l,getSchoolYearDisplayName:f}=Xt();m.useEffect(()=>{const d=g=>{a.current&&!a.current.contains(g.target)&&s(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const u=async d=>{await l(d),s(!1)};return o?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx(te,{className:"w-4 h-4 text-gray-400"}),e.jsx("div",{className:"w-24 h-4 bg-gray-200 rounded animate-pulse"})]}):e.jsxs("div",{className:"relative",ref:a,children:[e.jsxs("button",{onClick:()=>s(!t),className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-gray-300 transition-all duration-150 ease-in-out min-w-[200px]",style:{direction:"rtl"},children:[e.jsx(te,{className:"w-4 h-4 text-indigo-600 flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 font-reisinger-yonatan flex-grow text-right truncate",children:i?f(i):"×‘×—×¨ ×©× ×ª ×œ×™××•×“"}),t?e.jsx(je,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}):e.jsx(de,{className:"w-4 h-4 text-gray-500 flex-shrink-0"})]}),t&&e.jsxs("div",{className:"absolute right-0 mt-2 w-full min-w-[250px] bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-[1000]",children:[e.jsx("div",{className:"px-4 py-2 border-b border-gray-100",children:e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide font-reisinger-yonatan text-right",children:"×©× ×•×ª ×œ×™××•×“"})}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:n.length===0?e.jsx("div",{className:"px-4 py-3 text-sm text-gray-500 font-reisinger-yonatan text-center",children:"×œ× × ××¦××• ×©× ×•×ª ×œ×™××•×“"}):n.sort((d,g)=>new Date(g.startDate).getTime()-new Date(d.startDate).getTime()).map(d=>{const g=i?._id===d._id,b=d.isCurrent,D=d.isActive;return e.jsxs("button",{onClick:()=>u(d._id),className:`w-full px-4 py-3 text-right hover:bg-gray-50 flex items-center justify-between transition-colors duration-150 ${g?"bg-indigo-50 border-l-4 border-indigo-500":""}`,style:{direction:"rtl"},children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-medium font-reisinger-yonatan ${g?"text-indigo-700":"text-gray-700"}`,children:d.name}),b&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"× ×•×›×—×™×ª"}),!D&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"×œ× ×¤×¢×™×œ×”"})]}),e.jsxs("span",{className:"text-xs text-gray-500 font-reisinger-yonatan",children:[new Date(d.startDate).toLocaleDateString("he-IL")," - ",new Date(d.endDate).toLocaleDateString("he-IL")]})]}),g&&e.jsx(As,{className:"w-4 h-4 text-indigo-600 flex-shrink-0"})]},d._id)})}),e.jsx("div",{className:"px-4 py-2 border-t border-gray-100",children:e.jsx("button",{className:"text-xs text-indigo-600 hover:text-indigo-700 font-medium font-reisinger-yonatan",children:"+ ×”×•×¡×£ ×©× ×ª ×œ×™××•×“ ×—×“×©×”"})})]})]})}function Sr(){const[t,s]=m.useState(!1),a=m.useRef(null),i=Ve(),{user:n,logout:o}=Ne(),{isDesktopOpen:l,isMobile:f}=ft(),u=n&&(n.role==="admin"||n.roles?.includes("admin")||n.role==="×× ×”×œ"||n.roles?.includes("×× ×”×œ")),d=n&&(n.role==="admin"||n.roles?.includes("admin")||n.role==="×× ×”×œ"||n.roles?.includes("×× ×”×œ")||n.role==="teacher"||n.roles?.includes("teacher")||n.role==="××•×¨×”"||n.roles?.includes("××•×¨×”")||n.role==="conductor"||n.roles?.includes("conductor")||n.role==="×× ×¦×—"||n.roles?.includes("×× ×¦×—")||n.role==="theory-teacher"||n.roles?.includes("theory-teacher")||n.role==="theory_teacher"||n.roles?.includes("theory_teacher")||n.role==="××•×¨×” ×ª×™××•×¨×™×”"||n.roles?.includes("××•×¨×” ×ª×™××•×¨×™×”")||n.teaching?.studentIds?.length>0||n.conducting?.orchestraIds?.length>0);m.useEffect(()=>{const k=M=>{a.current&&!a.current.contains(M.target)&&s(!1)};return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]);const g=()=>{i("/profile"),s(!1)},b=async()=>{try{await o(),i("/login")}catch(k){console.error("Logout error:",k)}s(!1)},D=()=>{i("/dashboard")},T=()=>{const k=n?.personalInfo?.fullName||n?.fullName||n?.name||"";if(!k)return"×";const M=k.trim().split(" ");return M.length>=2?M[0][0]+M[1][0]:M[0][0]||"×"},R=()=>n?.personalInfo?.fullName||n?.fullName||n?.name||"××©×ª××©",L=()=>{const k=n?.role||n?.roles?.[0]||"";switch(k){case"teacher":return"××•×¨×”";case"××•×¨×”":return"××•×¨×”";case"conductor":return"×× ×¦×—";case"×× ×¦×—":return"×× ×¦×—";case"theory_teacher":return"××•×¨×” ×ª×™××•×¨×™×”";case"××•×¨×” ×ª×™××•×¨×™×”":return"××•×¨×” ×ª×™××•×¨×™×”";case"admin":return"×× ×”×œ";case"×× ×”×œ":return"×× ×”×œ";default:return k||"××©×ª××©"}};return e.jsxs("header",{className:"fixed top-0 left-0 h-16 bg-white border-b border-gray-200 flex items-center justify-between z-[45] transition-all duration-300",style:{direction:"rtl",width:d&&!f&&l?"calc(100% - 280px)":"100%",paddingLeft:"1.5rem",paddingRight:d&&!f&&!l?"4rem":"1.5rem"},children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:"/logo.png",alt:"Logo",className:"h-10 w-auto object-contain"}),e.jsx(Ir,{})]}),e.jsxs("div",{className:"flex items-center gap-4",style:{direction:"ltr"},children:[!f&&e.jsx(e.Fragment,{children:!u&&e.jsx("button",{onClick:D,className:"w-10 h-10 rounded-lg bg-indigo-50 border border-indigo-200 flex items-center justify-center hover:bg-indigo-100 hover:border-indigo-300 transition-all duration-150 ease-in-out cursor-pointer",title:"×œ×•×— ×‘×§×¨×”",children:e.jsx(Ae,{className:"w-5 h-5 text-indigo-600"})})}),e.jsxs("div",{className:"relative",ref:a,children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center cursor-pointer hover:bg-indigo-700 transition-colors",onClick:()=>s(!t),children:e.jsx("span",{className:"text-sm font-semibold text-white font-reisinger-yonatan",children:T()})}),t&&e.jsxs("div",{className:"absolute left-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-[70]",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 font-reisinger-yonatan",children:R()}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:L()})]}),e.jsxs("button",{onClick:g,className:"w-full px-4 py-3 text-right hover:bg-gray-50 flex items-center justify-between transition-colors duration-150",style:{direction:"rtl"},children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 font-reisinger-yonatan",children:"×¢××•×“ ××™×©×™"}),e.jsx(ge,{className:"w-4 h-4 text-gray-500"})]}),e.jsxs("button",{onClick:b,className:"w-full px-4 py-3 text-right hover:bg-gray-50 flex items-center justify-between transition-colors duration-150 text-red-600 hover:bg-red-50",style:{direction:"rtl"},children:[e.jsx("span",{className:"text-sm font-medium font-reisinger-yonatan",children:"×™×¦×™××”"}),e.jsx(Os,{className:"w-4 h-4"})]})]})]})]})]})}function W({children:t}){const{user:s}=Ne(),{isDesktopOpen:a,isMobile:i}=ft(),n=s&&(s.role==="admin"||s.roles?.includes("admin")||s.role==="×× ×”×œ"||s.roles?.includes("×× ×”×œ")||s.role==="teacher"||s.roles?.includes("teacher")||s.role==="××•×¨×”"||s.roles?.includes("××•×¨×”")||s.role==="conductor"||s.roles?.includes("conductor")||s.role==="×× ×¦×—"||s.roles?.includes("×× ×¦×—")||s.role==="theory-teacher"||s.roles?.includes("theory-teacher")||s.role==="theory_teacher"||s.roles?.includes("theory_teacher")||s.role==="××•×¨×” ×ª×™××•×¨×™×”"||s.roles?.includes("××•×¨×” ×ª×™××•×¨×™×”")||s.teaching?.studentIds?.length>0||s.conducting?.orchestraIds?.length>0);return console.log("ğŸ¨ Layout Debug:",{hasUser:!!s,userRole:s?.role,userRoles:s?.roles,userObject:s,shouldShowSidebar:n,isMobile:i,isDesktopOpen:a,conditions:{hasRole:!!s?.role,hasRolesArray:!!s?.roles,isAdmin:s?.role==="admin"||s?.roles?.includes("admin"),isTeacher:s?.role==="teacher"||s?.roles?.includes("teacher"),hasConductor:s?.role==="conductor"||s?.roles?.includes("conductor"),hasTheoryTeacher:s?.role==="theory-teacher"||s?.roles?.includes("theory-teacher"),hasTeaching:s?.teaching?.studentIds?.length>0,hasConducting:s?.conducting?.orchestraIds?.length>0}}),e.jsxs("div",{className:"min-h-screen bg-gray-50",dir:"rtl",children:[n&&e.jsx(Tr,{}),e.jsx(Sr,{}),e.jsx("main",{className:"mt-16 ml-0 p-0 bg-gray-50 min-h-[calc(100vh-64px)] rtl transition-all duration-300",style:{marginRight:n&&!i&&a?"280px":"0"},children:e.jsx("div",{className:"p-6 bg-gray-50",children:t})})]})}function kr(){const[t,s]=m.useState(""),[a,i]=m.useState(""),[n,o]=m.useState(""),[l,f]=m.useState(!1),u=Ve(),{login:d}=Ne(),g=async b=>{b.preventDefault(),o(""),f(!0),console.log("ğŸ” Login attempt started:",{email:t,password:"***"}),console.log("ğŸŒ API Base URL:","/api"),console.log("ğŸ”§ Environment check:",{VITE_API_URL:"/api",fallback:"http://localhost:3001/api",actual:"/api"});try{console.log("ğŸ“¤ Sending login request to API service...");const D=await d(t,a);console.log("âœ… Login successful:",{user:D.user?.personalInfo?.fullName||"Unknown"}),console.log("ğŸ”‘ Authentication token stored successfully"),console.log("ğŸ§­ Navigating to dashboard..."),u("/dashboard")}catch(D){console.error("âŒ Login failed:",D),console.error("ğŸ“ Error details:",{message:D.message,stack:D.stack}),o(D.message||"×©×’×™××” ×‘×”×ª×—×‘×¨×•×ª. ×× × ×‘×“×•×§ ××ª ×”×¤×¨×˜×™× ×•× ×¡×” ×©×•×‘.")}finally{f(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 relative",style:{backgroundImage:'url("/login-background.jpg")',backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},dir:"rtl",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),e.jsx("div",{className:"max-w-md w-full space-y-8 relative z-10",children:e.jsxs("div",{className:"backdrop-blur-lg bg-white/10 border border-white/20 rounded-2xl shadow-xl p-8",children:[e.jsx("div",{children:e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white drop-shadow-lg",style:{fontFamily:"'Reisinger Yonatan', 'Arial Hebrew', 'Noto Sans Hebrew', Arial, sans-serif"},children:"×›× ×™×¡×” ×œ××¢×¨×›×ª"})}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:g,children:[n&&e.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg backdrop-blur-sm",children:e.jsx("p",{className:"text-red-100 text-sm text-center font-reisinger-yonatan",children:n})}),e.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"sr-only font-reisinger-yonatan",children:'×›×ª×•×‘×ª ×“×•×"×œ'}),e.jsx("input",{id:"email",name:"email",type:"email",required:!0,disabled:l,className:"relative block w-full px-3 py-3 border border-white/30 placeholder-gray-400 text-gray-900 rounded-lg bg-white/80 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:z-10 sm:text-sm placeholder:text-right font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"×›×ª×•×‘×ª ×“×•××´×œ",value:t,onChange:b=>s(b.target.value),dir:"ltr",style:{textAlign:"left"}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only font-reisinger-yonatan",children:"×¡×™×¡××”"}),e.jsx("input",{id:"password",name:"password",type:"password",required:!0,disabled:l,className:"relative block w-full px-3 py-3 border border-white/30 placeholder-gray-400 text-gray-900 rounded-lg bg-white/80 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:z-10 sm:text-sm placeholder:text-right font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"×¡×™×¡××”",value:a,onChange:b=>i(b.target.value),dir:"ltr",style:{textAlign:"left"}})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600/90 hover:bg-blue-700/90 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 shadow-lg font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",children:l?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"××ª×—×‘×¨..."]}):"×›× ×™×¡×”"})}),e.jsx("div",{className:"text-center",children:e.jsx(be,{to:"/forgot-password",className:"font-medium text-white/90 hover:text-white drop-shadow transition-colors duration-200 font-reisinger-yonatan underline",children:"×©×›×—×ª×™ ×¡×™×¡××"})})]})]})})]})}function Cr(){const[t,s]=m.useState(""),[a,i]=m.useState(!1),[n,o]=m.useState(!1),[l,f]=m.useState(""),u=async d=>{d.preventDefault(),f(""),i(!0);try{await Ft.forgotPassword(t),o(!0)}catch(g){f(g.message||"×©×’×™××” ×‘×©×œ×™×—×ª ×‘×§×©×ª ××™×¤×•×¡ ×¡×™×¡××”")}finally{i(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 relative",style:{backgroundImage:'url("/login-background.jpg")',backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},dir:"rtl",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),e.jsx("div",{className:"max-w-md w-full space-y-8 relative z-10",children:e.jsxs("div",{className:"backdrop-blur-lg bg-white/10 border border-white/20 rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white drop-shadow-lg",style:{fontFamily:"'Reisinger Yonatan', 'Arial Hebrew', 'Noto Sans Hebrew', Arial, sans-serif"},children:"×©×›×—×ª×™ ×¡×™×¡××"}),e.jsx("p",{className:"mt-2 text-center text-sm text-white/80 font-reisinger-yonatan",children:'×”×–×Ÿ ××ª ×›×ª×•×‘×ª ×”×“×•×"×œ ×©×œ×š ×•× ×©×œ×— ×œ×š ×§×™×©×•×¨ ×œ××™×¤×•×¡ ×¡×™×¡××”'})]}),n?e.jsxs("div",{className:"mt-8 space-y-6",children:[e.jsx("div",{className:"p-4 bg-green-500/20 border border-green-500/50 rounded-lg backdrop-blur-sm",children:e.jsx("p",{className:"text-green-100 text-sm text-center font-reisinger-yonatan",children:'×× ×§×™×™× ×—×©×‘×•×Ÿ ×¢× ×›×ª×•×‘×ª ×“×•×"×œ ×–×•, × ×©×œ×— ××œ×™×š ×§×™×©×•×¨ ×œ××™×¤×•×¡ ×¡×™×¡××”. ×× × ×‘×“×•×§ ××ª ×ª×™×‘×ª ×”×“×•××¨ ×©×œ×š.'})}),e.jsx("div",{className:"text-center",children:e.jsx(be,{to:"/login",className:"font-medium text-white/90 hover:text-white drop-shadow transition-colors duration-200 font-reisinger-yonatan underline",children:"×—×–×•×¨ ×œ×“×£ ×”×›× ×™×¡×”"})})]}):e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:u,children:[l&&e.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg backdrop-blur-sm",children:e.jsx("p",{className:"text-red-100 text-sm text-center font-reisinger-yonatan",children:l})}),e.jsx("div",{className:"rounded-md shadow-sm",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"sr-only font-reisinger-yonatan",children:'×›×ª×•×‘×ª ×“×•×"×œ'}),e.jsx("input",{id:"email",name:"email",type:"email",required:!0,disabled:a,className:"relative block w-full px-3 py-3 border border-white/30 placeholder-gray-400 text-gray-900 rounded-lg bg-white/80 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:z-10 sm:text-sm placeholder:text-right font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"×›×ª×•×‘×ª ×“×•××´×œ",value:t,onChange:d=>s(d.target.value),dir:"ltr",style:{textAlign:"left"}})]})}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:a,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600/90 hover:bg-blue-700/90 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 shadow-lg font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",children:a?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"×©×•×œ×—..."]}):"×©×œ×— ×§×™×©×•×¨ ×œ××™×¤×•×¡ ×¡×™×¡××”"})}),e.jsx("div",{className:"text-center",children:e.jsx(be,{to:"/login",className:"font-medium text-white/90 hover:text-white drop-shadow transition-colors duration-200 font-reisinger-yonatan underline",children:"×—×–×•×¨ ×œ×“×£ ×”×›× ×™×¡×”"})})]})]})})]})}function Dr(){const{token:t}=bs(),[s,a]=m.useState(""),[i,n]=m.useState(""),[o,l]=m.useState(!1),[f,u]=m.useState(""),[d,g]=m.useState(!1),b=Ve();m.useEffect(()=>{localStorage.removeItem("authToken"),sessionStorage.removeItem("authToken"),t||u("×§×™×©×•×¨ ×œ× ×ª×§×™×Ÿ. ×× × ×‘×§×© ×§×™×©×•×¨ ×—×“×© ×œ××™×¤×•×¡ ×¡×™×¡××”.")},[t]);const D=async T=>{if(T.preventDefault(),u(""),s.length<6){u("×”×¡×™×¡××” ×—×™×™×‘×ª ×œ×”×›×™×œ ×œ×¤×—×•×ª 6 ×ª×•×•×™×");return}if(s!==i){u("×”×¡×™×¡×××•×ª ××™× ×Ÿ ×ª×•×××•×ª");return}if(!t){u("×§×™×©×•×¨ ×œ× ×ª×§×™×Ÿ");return}l(!0);try{await Ft.resetPassword(t,s),g(!0),setTimeout(()=>{b("/login")},3e3)}catch(R){const L=R.message||R.error||"×©×’×™××” ×‘××™×¤×•×¡ ×”×¡×™×¡××”";L.includes("expired")||L.includes("RESET_TOKEN_EXPIRED")?u("×ª×•×§×£ ×”×§×™×©×•×¨ ×¤×’. ×× × ×‘×§×© ×§×™×©×•×¨ ×—×“×© ×œ××™×¤×•×¡ ×¡×™×¡××”."):L.includes("invalid")||L.includes("INVALID_RESET_TOKEN")?u("×§×™×©×•×¨ ×œ× ×ª×§×™×Ÿ. ×× × ×‘×§×© ×§×™×©×•×¨ ×—×“×© ×œ××™×¤×•×¡ ×¡×™×¡××”."):L.includes("password")||L.includes("WEAK_PASSWORD")?u("×”×¡×™×¡××” ×—×™×™×‘×ª ×œ×”×›×™×œ ×œ×¤×—×•×ª 6 ×ª×•×•×™×"):u(L)}finally{l(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 relative",style:{backgroundImage:'url("/login-background.jpg")',backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},dir:"rtl",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),e.jsx("div",{className:"max-w-md w-full space-y-8 relative z-10",children:e.jsxs("div",{className:"backdrop-blur-lg bg-white/10 border border-white/20 rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white drop-shadow-lg",style:{fontFamily:"'Reisinger Yonatan', 'Arial Hebrew', 'Noto Sans Hebrew', Arial, sans-serif"},children:"××™×¤×•×¡ ×¡×™×¡××”"}),e.jsx("p",{className:"mt-2 text-center text-sm text-white/80 font-reisinger-yonatan",children:"×”×–×Ÿ ×¡×™×¡××” ×—×“×©×” ×œ×—×©×‘×•×Ÿ ×©×œ×š"})]}),d?e.jsxs("div",{className:"mt-8 space-y-6",children:[e.jsxs("div",{className:"p-4 bg-green-500/20 border border-green-500/50 rounded-lg backdrop-blur-sm",children:[e.jsx("p",{className:"text-green-100 text-center font-reisinger-yonatan",children:"×”×¡×™×¡××” ××•×¤×¡×” ×‘×”×¦×œ×—×”! ×¢×›×©×™×• ×ª×•×›×œ ×œ×”×ª×—×‘×¨ ×¢× ×”×¡×™×¡××” ×”×—×“×©×”."}),e.jsx("p",{className:"text-green-100 text-sm text-center font-reisinger-yonatan mt-2",children:"××¢×‘×™×¨ ××•×ª×š ×œ×“×£ ×”×›× ×™×¡×”..."})]}),e.jsx("div",{className:"text-center",children:e.jsx(be,{to:"/login",className:"font-medium text-white/90 hover:text-white drop-shadow transition-colors duration-200 font-reisinger-yonatan underline",children:"×—×–×•×¨ ×œ×“×£ ×”×›× ×™×¡×” ×¢×›×©×™×•"})})]}):e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:D,children:[f&&e.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg backdrop-blur-sm",children:e.jsx("p",{className:"text-red-100 text-sm text-center font-reisinger-yonatan",children:f})}),e.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only font-reisinger-yonatan",children:"×¡×™×¡××” ×—×“×©×”"}),e.jsx("input",{id:"password",name:"password",type:"password",required:!0,disabled:o||!t,className:"relative block w-full px-3 py-3 border border-white/30 placeholder-gray-400 text-gray-900 rounded-lg bg-white/80 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:z-10 sm:text-sm placeholder:text-right font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"×¡×™×¡××” ×—×“×©×” (×œ×¤×—×•×ª 6 ×ª×•×•×™×)",value:s,onChange:T=>a(T.target.value),dir:"ltr",style:{textAlign:"left"}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"sr-only font-reisinger-yonatan",children:"××™××•×ª ×¡×™×¡××”"}),e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,disabled:o||!t,className:"relative block w-full px-3 py-3 border border-white/30 placeholder-gray-400 text-gray-900 rounded-lg bg-white/80 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:z-10 sm:text-sm placeholder:text-right font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"××™××•×ª ×¡×™×¡××”",value:i,onChange:T=>n(T.target.value),dir:"ltr",style:{textAlign:"left"}})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:o||!t,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600/90 hover:bg-blue-700/90 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 shadow-lg font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",children:o?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"×××¤×¡ ×¡×™×¡××”..."]}):"××™×¤×•×¡ ×¡×™×¡××”"})}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(be,{to:"/forgot-password",className:"block font-medium text-white/90 hover:text-white drop-shadow transition-colors duration-200 font-reisinger-yonatan underline",children:"×‘×§×© ×§×™×©×•×¨ ×—×“×©"}),e.jsx(be,{to:"/login",className:"block font-medium text-white/90 hover:text-white drop-shadow transition-colors duration-200 font-reisinger-yonatan underline",children:"×—×–×•×¨ ×œ×“×£ ×”×›× ×™×¡×”"})]})]})]})})]})}function ee(t,s,a=3){return m.lazy(()=>{let i=0;const n=async()=>{try{const o=await t();return console.log(`âœ… Successfully loaded ${s}`),o}catch(o){if(console.error(`âŒ Failed to load ${s}, attempt ${i+1}/${a}:`,o),i<a-1){i++;const l=Math.min(1e3*Math.pow(2,i),5e3);return await new Promise(f=>setTimeout(f,l)),n()}else throw console.error(`âŒ All retry attempts failed for ${s}`),o}};return n()})}class Er{constructor(){et(this,"preloadedComponents",new Set);et(this,"preloadPromises",new Map)}preload(s,a){if(this.preloadedComponents.has(s))return Promise.resolve();if(this.preloadPromises.has(s))return this.preloadPromises.get(s);const i=a().then(n=>(this.preloadedComponents.add(s),console.log(`âœ… Preloaded ${s}`),n)).catch(n=>{throw console.error(`âŒ Failed to preload ${s}:`,n),n}).finally(()=>{this.preloadPromises.delete(s)});return this.preloadPromises.set(s,i),i}preloadOnHover(s,a){return()=>{this.preloadedComponents.has(s)||this.preload(s,a)}}getPreloadStats(){return{preloadedComponents:Array.from(this.preloadedComponents),pendingPreloads:Array.from(this.preloadPromises.keys())}}}const st=new Er,rt={STUDENT_DETAILS:"StudentDetailsPage",THEORY_TAB:"TheoryTab",ORCHESTRA_TAB:"OrchestraTab",DASHBOARD:"Dashboard",STUDENTS_LIST:"Students"};function _r(){setTimeout(()=>{st.preload(rt.DASHBOARD,()=>J(()=>import("../chunks/Dashboard-D262rKzj.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),st.preload(rt.STUDENTS_LIST,()=>J(()=>import("../chunks/Students-LHcjV5uW.js"),__vite__mapDeps([9,1,3,4,10,7,5,6])))},1e3),setTimeout(()=>{st.preload(rt.STUDENT_DETAILS,()=>J(()=>import("../chunks/StudentDetailsPageSimple-D2iurl-6.js"),__vite__mapDeps([11,1,7,5,6,3,12,13,14,4])))},3e3)}function Ar(){const t=document.head,s=document.createElement("link");s.rel="dns-prefetch",s.href="//localhost",t.appendChild(s);const a=document.createElement("link");a.rel="preconnect",a.href="http://localhost:3001",a.crossOrigin="anonymous",t.appendChild(a);const i=document.createElement("link");i.rel="prefetch",i.as="style",i.href="/src/index.css",t.appendChild(i)}function Or(){typeof window>"u"||(Ar(),_r(),console.log("ğŸš€ Bundle optimizations initialized"))}let Rr={data:""},$r=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||Rr,Pr=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Lr=/\/\*[^]*?\*\/|  +/g,Ot=/\n+/g,ue=(t,s)=>{let a="",i="",n="";for(let o in t){let l=t[o];o[0]=="@"?o[1]=="i"?a=o+" "+l+";":i+=o[1]=="f"?ue(l,o):o+"{"+ue(l,o[1]=="k"?"":s)+"}":typeof l=="object"?i+=ue(l,s?s.replace(/([^,])+/g,f=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,f):f?f+" "+u:u)):o):l!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=ue.p?ue.p(o,l):o+":"+l+";")}return a+(s&&n?s+"{"+n+"}":n)+i},oe={},Kt=t=>{if(typeof t=="object"){let s="";for(let a in t)s+=a+Kt(t[a]);return s}return t},Fr=(t,s,a,i,n)=>{let o=Kt(t),l=oe[o]||(oe[o]=(u=>{let d=0,g=11;for(;d<u.length;)g=101*g+u.charCodeAt(d++)>>>0;return"go"+g})(o));if(!oe[l]){let u=o!==t?t:(d=>{let g,b,D=[{}];for(;g=Pr.exec(d.replace(Lr,""));)g[4]?D.shift():g[3]?(b=g[3].replace(Ot," ").trim(),D.unshift(D[0][b]=D[0][b]||{})):D[0][g[1]]=g[2].replace(Ot," ").trim();return D[0]})(t);oe[l]=ue(n?{["@keyframes "+l]:u}:u,a?"":"."+l)}let f=a&&oe.g?oe.g:null;return a&&(oe.g=oe[l]),((u,d,g,b)=>{b?d.data=d.data.replace(b,u):d.data.indexOf(u)===-1&&(d.data=g?u+d.data:d.data+u)})(oe[l],s,i,f),l},Br=(t,s,a)=>t.reduce((i,n,o)=>{let l=s[o];if(l&&l.call){let f=l(a),u=f&&f.props&&f.props.className||/^go/.test(f)&&f;l=u?"."+u:f&&typeof f=="object"?f.props?"":ue(f,""):f===!1?"":f}return i+n+(l??"")},"");function ze(t){let s=this||{},a=t.call?t(s.p):t;return Fr(a.unshift?a.raw?Br(a,[].slice.call(arguments,1),s.p):a.reduce((i,n)=>Object.assign(i,n&&n.call?n(s.p):n),{}):a,$r(s.target),s.g,s.o,s.k)}let Jt,ut,mt;ze.bind({g:1});let ce=ze.bind({k:1});function Ur(t,s,a,i){ue.p=s,Jt=t,ut=a,mt=i}function xe(t,s){let a=this||{};return function(){let i=arguments;function n(o,l){let f=Object.assign({},o),u=f.className||n.className;a.p=Object.assign({theme:ut&&ut()},f),a.o=/ *go\d+/.test(u),f.className=ze.apply(a,i)+(u?" "+u:"");let d=t;return t[0]&&(d=f.as||t,delete f.as),mt&&d[0]&&mt(f),Jt(d,f)}return n}}var Mr=t=>typeof t=="function",Me=(t,s)=>Mr(t)?t(s):t,Vr=(()=>{let t=0;return()=>(++t).toString()})(),Zt=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let s=matchMedia("(prefers-reduced-motion: reduce)");t=!s||s.matches}return t}})(),Yr=20,yt="default",es=(t,s)=>{let{toastLimit:a}=t.settings;switch(s.type){case 0:return{...t,toasts:[s.toast,...t.toasts].slice(0,a)};case 1:return{...t,toasts:t.toasts.map(l=>l.id===s.toast.id?{...l,...s.toast}:l)};case 2:let{toast:i}=s;return es(t,{type:t.toasts.find(l=>l.id===i.id)?1:0,toast:i});case 3:let{toastId:n}=s;return{...t,toasts:t.toasts.map(l=>l.id===n||n===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(l=>l.id!==s.toastId)};case 5:return{...t,pausedAt:s.time};case 6:let o=s.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+o}))}}},Be=[],ts={toasts:[],pausedAt:void 0,settings:{toastLimit:Yr}},ae={},ss=(t,s=yt)=>{ae[s]=es(ae[s]||ts,t),Be.forEach(([a,i])=>{a===s&&i(ae[s])})},rs=t=>Object.keys(ae).forEach(s=>ss(t,s)),Hr=t=>Object.keys(ae).find(s=>ae[s].toasts.some(a=>a.id===t)),Xe=(t=yt)=>s=>{ss(s,t)},Wr={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},zr=(t={},s=yt)=>{let[a,i]=m.useState(ae[s]||ts),n=m.useRef(ae[s]);m.useEffect(()=>(n.current!==ae[s]&&i(ae[s]),Be.push([s,i]),()=>{let l=Be.findIndex(([f])=>f===s);l>-1&&Be.splice(l,1)}),[s]);let o=a.toasts.map(l=>{var f,u,d;return{...t,...t[l.type],...l,removeDelay:l.removeDelay||((f=t[l.type])==null?void 0:f.removeDelay)||t?.removeDelay,duration:l.duration||((u=t[l.type])==null?void 0:u.duration)||t?.duration||Wr[l.type],style:{...t.style,...(d=t[l.type])==null?void 0:d.style,...l.style}}});return{...a,toasts:o}},Xr=(t,s="blank",a)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:s,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...a,id:a?.id||Vr()}),Oe=t=>(s,a)=>{let i=Xr(s,t,a);return Xe(i.toasterId||Hr(i.id))({type:2,toast:i}),i.id},K=(t,s)=>Oe("blank")(t,s);K.error=Oe("error");K.success=Oe("success");K.loading=Oe("loading");K.custom=Oe("custom");K.dismiss=(t,s)=>{let a={type:3,toastId:t};s?Xe(s)(a):rs(a)};K.dismissAll=t=>K.dismiss(void 0,t);K.remove=(t,s)=>{let a={type:4,toastId:t};s?Xe(s)(a):rs(a)};K.removeAll=t=>K.remove(void 0,t);K.promise=(t,s,a)=>{let i=K.loading(s.loading,{...a,...a?.loading});return typeof t=="function"&&(t=t()),t.then(n=>{let o=s.success?Me(s.success,n):void 0;return o?K.success(o,{id:i,...a,...a?.success}):K.dismiss(i),n}).catch(n=>{let o=s.error?Me(s.error,n):void 0;o?K.error(o,{id:i,...a,...a?.error}):K.dismiss(i)}),t};var qr=1e3,Gr=(t,s="default")=>{let{toasts:a,pausedAt:i}=zr(t,s),n=m.useRef(new Map).current,o=m.useCallback((b,D=qr)=>{if(n.has(b))return;let T=setTimeout(()=>{n.delete(b),l({type:4,toastId:b})},D);n.set(b,T)},[]);m.useEffect(()=>{if(i)return;let b=Date.now(),D=a.map(T=>{if(T.duration===1/0)return;let R=(T.duration||0)+T.pauseDuration-(b-T.createdAt);if(R<0){T.visible&&K.dismiss(T.id);return}return setTimeout(()=>K.dismiss(T.id,s),R)});return()=>{D.forEach(T=>T&&clearTimeout(T))}},[a,i,s]);let l=m.useCallback(Xe(s),[s]),f=m.useCallback(()=>{l({type:5,time:Date.now()})},[l]),u=m.useCallback((b,D)=>{l({type:1,toast:{id:b,height:D}})},[l]),d=m.useCallback(()=>{i&&l({type:6,time:Date.now()})},[i,l]),g=m.useCallback((b,D)=>{let{reverseOrder:T=!1,gutter:R=8,defaultPosition:L}=D||{},k=a.filter(j=>(j.position||L)===(b.position||L)&&j.height),M=k.findIndex(j=>j.id===b.id),p=k.filter((j,C)=>C<M&&j.visible).length;return k.filter(j=>j.visible).slice(...T?[p+1]:[0,p]).reduce((j,C)=>j+(C.height||0)+R,0)},[a]);return m.useEffect(()=>{a.forEach(b=>{if(b.dismissed)o(b.id,b.removeDelay);else{let D=n.get(b.id);D&&(clearTimeout(D),n.delete(b.id))}})},[a,o]),{toasts:a,handlers:{updateHeight:u,startPause:f,endPause:d,calculateOffset:g}}},Qr=ce`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Kr=ce`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Jr=ce`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Zr=xe("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Qr} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Kr} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Jr} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,ea=ce`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,ta=xe("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${ea} 1s linear infinite;
`,sa=ce`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,ra=ce`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,aa=xe("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${sa} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${ra} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,na=xe("div")`
  position: absolute;
`,oa=xe("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,la=ce`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,ia=xe("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${la} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,ca=({toast:t})=>{let{icon:s,type:a,iconTheme:i}=t;return s!==void 0?typeof s=="string"?m.createElement(ia,null,s):s:a==="blank"?null:m.createElement(oa,null,m.createElement(ta,{...i}),a!=="loading"&&m.createElement(na,null,a==="error"?m.createElement(Zr,{...i}):m.createElement(aa,{...i})))},da=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,ua=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,ma="0%{opacity:0;} 100%{opacity:1;}",ha="0%{opacity:1;} 100%{opacity:0;}",ga=xe("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,xa=xe("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,fa=(t,s)=>{let a=t.includes("top")?1:-1,[i,n]=Zt()?[ma,ha]:[da(a),ua(a)];return{animation:s?`${ce(i)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ce(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},pa=m.memo(({toast:t,position:s,style:a,children:i})=>{let n=t.height?fa(t.position||s||"top-center",t.visible):{opacity:0},o=m.createElement(ca,{toast:t}),l=m.createElement(xa,{...t.ariaProps},Me(t.message,t));return m.createElement(ga,{className:t.className,style:{...n,...a,...t.style}},typeof i=="function"?i({icon:o,message:l}):m.createElement(m.Fragment,null,o,l))});Ur(m.createElement);var ya=({id:t,className:s,style:a,onHeightUpdate:i,children:n})=>{let o=m.useCallback(l=>{if(l){let f=()=>{let u=l.getBoundingClientRect().height;i(t,u)};f(),new MutationObserver(f).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[t,i]);return m.createElement("div",{ref:o,className:s,style:a},n)},ba=(t,s)=>{let a=t.includes("top"),i=a?{top:0}:{bottom:0},n=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Zt()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${s*(a?1:-1)}px)`,...i,...n}},ja=ze`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,$e=16,va=({reverseOrder:t,position:s="top-center",toastOptions:a,gutter:i,children:n,toasterId:o,containerStyle:l,containerClassName:f})=>{let{toasts:u,handlers:d}=Gr(a,o);return m.createElement("div",{"data-rht-toaster":o||"",style:{position:"fixed",zIndex:9999,top:$e,left:$e,right:$e,bottom:$e,pointerEvents:"none",...l},className:f,onMouseEnter:d.startPause,onMouseLeave:d.endPause},u.map(g=>{let b=g.position||s,D=d.calculateOffset(g,{reverseOrder:t,gutter:i,defaultPosition:s}),T=ba(b,D);return m.createElement(ya,{id:g.id,key:g.id,onHeightUpdate:d.updateHeight,className:g.visible?ja:"",style:T},g.type==="custom"?Me(g.message,g):n?n(g):m.createElement(pa,{toast:g,position:b}))}))},Ga=K;const Na=ee(()=>J(()=>import("../chunks/Dashboard-D262rKzj.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])),"Dashboard"),Rt=ee(()=>J(()=>import("../chunks/Students-LHcjV5uW.js"),__vite__mapDeps([9,1,3,4,10,7,5,6])),"Students"),wa=ee(()=>J(()=>import("../chunks/Teachers-uPUiyt2Z.js"),__vite__mapDeps([15,1,4,3,10,7,5,6])),"Teachers"),at=ee(()=>J(()=>import("../chunks/TheoryLessons-CBxOFSLi.js"),__vite__mapDeps([16,1,4,3,2,12,5,6,7])),"TheoryLessons"),Ta=ee(()=>J(()=>import("../chunks/TheoryLessonDetails-B4m1NP_N.js"),__vite__mapDeps([17,1,4,3,10,7,2,5,6])),"TheoryLessonDetails"),$t=ee(()=>J(()=>import("../chunks/Orchestras-DgZF7wb6.js"),__vite__mapDeps([18,1,4,3,10,7,2,5,6])),"Orchestras"),Pt=ee(()=>J(()=>import("../chunks/Rehearsals-CBk4OzPV.js"),__vite__mapDeps([19,1,4,3,10,7,5,6])),"Rehearsals"),Ia=ee(()=>J(()=>import("../chunks/RehearsalDetails-DVvqlHsl.js"),__vite__mapDeps([20,1,5,6,3,4,7])),"RehearsalDetails"),Sa=ee(()=>J(()=>import("../chunks/Bagruts-D9x-LIrc.js"),__vite__mapDeps([21,1,4,3,10,7,2,22,5,6])),"Bagruts"),ka=ee(()=>J(()=>import("../chunks/BagrutDetails-D1gMKxlv.js"),__vite__mapDeps([23,1,4,3,10,7,2,22,5,6])),"BagrutDetails"),Ca=ee(()=>J(()=>import("../chunks/Profile-ClbUwTNi.js"),__vite__mapDeps([24,1,5,6,3,7,14])),"Profile"),Lt=ee(()=>J(()=>import("../chunks/RehearsalAttendance-CAlUJ4YT.js"),__vite__mapDeps([25,1,5,6,3,7])),"ConductorAttendance"),Da=ee(()=>J(()=>import("../chunks/OrchestraEnrollmentManager-Cx-kHUUf.js"),__vite__mapDeps([26,1,5,6,3,7])),"OrchestraEnrollmentManager"),Ea=ee(()=>J(()=>import("../chunks/StudentDetailsPageSimple-D2iurl-6.js"),__vite__mapDeps([11,1,7,5,6,3,12,13,14,4])),"StudentDetailsPage"),_a=ee(()=>J(()=>import("../chunks/TeacherDetailsPage-CXgtuhVl.js"),__vite__mapDeps([27,1,7,8,3,5,6])),"TeacherDetailsPage"),Aa=ee(()=>J(()=>import("../chunks/OrchestraDetailsPage-SBlUCd6E.js"),__vite__mapDeps([28,1,5,6,3,7])),"OrchestraDetailsPage"),re=({message:t="×˜×•×¢×Ÿ ×¢××•×“..."})=>e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:t})]})});function z({children:t,allowedRoles:s}){const{isAuthenticated:a,isLoading:i,authError:n,checkAuthStatus:o,user:l}=Ne(),[f,u]=Le.useState(0),d=2,g=()=>{if(!s||s.length===0)return!0;if(!l)return!1;const b=l.role||l.roles?.[0]||"",D=l.roles||[b],T={×× ×”×œ:"admin",××•×¨×”:"teacher",×× ×¦×—:"conductor","××“×¨×™×š ×ª×“×¨":"theory-teacher","××•×¨×” ×ª×™××•×¨×™×”":"theory-teacher"},R=D.map(k=>T[k]||k),L=T[b]||b;return s.some(k=>R.includes(k)||L===k||k==="admin"&&!b)};return Le.useEffect(()=>{if(n&&f<d){const b=setTimeout(()=>{console.log(`ğŸ”„ ProtectedRoute - Retrying authentication (${f+1}/${d})`),o(!0),u(D=>D+1)},1e3*(f+1));return()=>clearTimeout(b)}},[n,f,o]),Le.useEffect(()=>{a&&f>0&&u(0)},[a]),i?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:"××××ª ×”×¨×©××•×ª..."}),n&&f>0&&e.jsxs("div",{className:"mt-2 text-sm text-amber-600",children:["×× ×¡×” ×©×•×‘ (",f,"/",d,")..."]})]})}):a?g()?e.jsx(e.Fragment,{children:t}):e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-600 mb-4",children:[e.jsx("h3",{className:"text-lg font-bold",children:"××™×Ÿ ×”×¨×©××”"}),e.jsx("p",{className:"text-gray-600",children:"××™×Ÿ ×œ×š ×”×¨×©××” ×œ×’×©×ª ×œ×¢××•×“ ×–×”"})]}),e.jsx("button",{onClick:()=>window.history.back(),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"×—×–×•×¨"})]})}):e.jsx(Pe,{to:"/login",replace:!0})}function Oa(){return e.jsx("div",{dir:"rtl",children:e.jsxs(js,{children:[e.jsx(Y,{path:"/login",element:e.jsx(kr,{})}),e.jsx(Y,{path:"/forgot-password",element:e.jsx(Cr,{})}),e.jsx(Y,{path:"/reset-password/:token",element:e.jsx(Dr,{})}),e.jsx(Y,{path:"/dashboard",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(re,{message:"×˜×•×¢×Ÿ ×“×©×‘×•×¨×“..."}),children:e.jsx(Na,{})})})})}),e.jsx(Y,{path:"/students",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(re,{message:"×˜×•×¢×Ÿ ×¨×©×™××ª ×ª×œ××™×“×™×..."}),children:e.jsx(Rt,{})})})})}),e.jsx(Y,{path:"/students/:studentId",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(re,{message:"×˜×•×¢×Ÿ ×¤×¨×˜×™ ×ª×œ××™×“..."}),children:e.jsx(Ea,{})})})})}),e.jsx(Y,{path:"/teachers",element:e.jsx(z,{allowedRoles:["admin","teacher","conductor","theory-teacher"],children:e.jsx(W,{children:e.jsx(wa,{})})})}),e.jsx(Y,{path:"/teachers/:teacherId",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:"×˜×•×¢×Ÿ ×¤×¨×˜×™ ××•×¨×”..."})]})}),children:e.jsx(_a,{})})})})}),e.jsx(Y,{path:"/theory-lessons",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(at,{})})})}),e.jsx(Y,{path:"/theory-lessons/:theoryId",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(Ta,{})})})}),e.jsx(Y,{path:"/orchestras",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx($t,{})})})}),e.jsx(Y,{path:"/orchestras/:orchestraId",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:"×˜×•×¢×Ÿ ×¤×¨×˜×™ ×ª×–××•×¨×ª..."})]})}),children:e.jsx(Aa,{})})})})}),e.jsx(Y,{path:"/rehearsals",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(Pt,{})})})}),e.jsx(Y,{path:"/rehearsals/:rehearsalId",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(Ia,{})})})}),e.jsx(Y,{path:"/bagruts",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(Sa,{})})})}),e.jsx(Y,{path:"/bagruts/:bagrutId",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(ka,{})})})}),e.jsx(Y,{path:"/bagruts/:bagrutId/edit",element:e.jsx(z,{children:e.jsx(W,{children:e.jsxs("div",{className:"p-6",dir:"rtl",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"×¢×¨×™×›×ª ×‘×’×¨×•×ª"}),e.jsx("p",{className:"text-gray-600",children:"×¢×¨×™×›×ª ×¤×¨×˜×™ ×”×‘×’×¨×•×ª ×•×”×ª×§×“××•×ª"}),e.jsx("div",{className:"mt-8 p-4 bg-blue-50 rounded-lg",children:e.jsx("p",{className:"text-blue-700",children:"ğŸ”§ ×¢××•×“ ×¢×¨×™×›×ª ×‘×’×¨×•×ª ×‘×¤×™×ª×•×— - ×‘×™× ×ª×™×™× × ×™×ª×Ÿ ×œ×¢×¨×•×š ×“×¨×š ×¢××•×“ ×”×¤×¨×˜×™×"})})]})})})}),e.jsx(Y,{path:"/bagrut",element:e.jsx(Pe,{to:"/bagruts",replace:!0})}),e.jsx(Y,{path:"/profile",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(re,{message:"×˜×•×¢×Ÿ ×¢××•×“ ××™×©×™..."}),children:e.jsx(Ca,{})})})})}),e.jsx(Y,{path:"/conductor/attendance",element:e.jsx(z,{allowedRoles:["conductor","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(re,{message:"×˜×•×¢×Ÿ × ×•×›×—×•×ª ×—×–×¨×•×ª..."}),children:e.jsx(Lt,{})})})})}),e.jsx(Y,{path:"/conductor/attendance/:rehearsalId",element:e.jsx(z,{allowedRoles:["conductor","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(re,{message:"×˜×•×¢×Ÿ × ×•×›×—×•×ª ×—×–×¨×”..."}),children:e.jsx(Lt,{})})})})}),e.jsx(Y,{path:"/conductor/enrollment",element:e.jsx(z,{allowedRoles:["conductor","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(re,{message:"×˜×•×¢×Ÿ × ×™×”×•×œ ×¨×™×©×•××™×..."}),children:e.jsx(Da,{})})})})}),e.jsx(Y,{path:"/conductor/orchestras",element:e.jsx(z,{allowedRoles:["conductor","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(re,{message:"×˜×•×¢×Ÿ × ×™×”×•×œ ×ª×–××•×¨×•×ª..."}),children:e.jsx($t,{})})})})}),e.jsx(Y,{path:"/conductor/rehearsals",element:e.jsx(z,{allowedRoles:["conductor","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(re,{message:"×˜×•×¢×Ÿ ×—×–×¨×•×ª..."}),children:e.jsx(Pt,{})})})})}),e.jsx(Y,{path:"/conductor/musicians",element:e.jsx(z,{allowedRoles:["conductor","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(re,{message:"×˜×•×¢×Ÿ ××•×–×™×§××™×..."}),children:e.jsx(Rt,{})})})})}),e.jsx(Y,{path:"/theory-teacher/lessons",element:e.jsx(z,{allowedRoles:["theory-teacher","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(re,{message:"×˜×•×¢×Ÿ ×©×™×¢×•×¨×™ ×ª×™××•×¨×™×”..."}),children:e.jsx(at,{})})})})}),e.jsx(Y,{path:"/theory-teacher/groups",element:e.jsx(z,{allowedRoles:["theory-teacher","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(re,{message:"×˜×•×¢×Ÿ ×§×‘×•×¦×•×ª ×ª×™××•×¨×™×”..."}),children:e.jsx(at,{})})})})}),e.jsx(Y,{path:"/",element:e.jsx(Pe,{to:"/dashboard",replace:!0})}),e.jsx(Y,{path:"*",element:e.jsx(Pe,{to:"/dashboard",replace:!0})})]})})}function Ra(){return m.useEffect(()=>{Or()},[]),e.jsx(Qs,{children:e.jsx(Us,{children:e.jsx(Ms,{children:e.jsx(Gs,{children:e.jsxs(Ks,{children:[e.jsx(va,{position:"top-center",reverseOrder:!1,gutter:8,containerClassName:"",containerStyle:{},toastOptions:{duration:4e3,style:{background:"#fff",color:"#363636",padding:"16px",borderRadius:"8px",fontSize:"14px",fontFamily:"Reisinger-Yonatan, sans-serif",direction:"rtl"},success:{style:{background:"#F0FDF4",color:"#166534",border:"1px solid #86EFAC"},iconTheme:{primary:"#22C55E",secondary:"#F0FDF4"}},error:{style:{background:"#FEE2E2",color:"#991B1B",border:"1px solid #FCA5A5"},iconTheme:{primary:"#EF4444",secondary:"#FEE2E2"}}}}),e.jsx(Oa,{})]})})})})})}Is();const $a=new Bt({defaultOptions:{queries:{staleTime:1e3*60*5,retry:(t,s)=>s?.status===404||s?.status===403?!1:t<3}}}),as=document.getElementById("root");if(!as)throw new Error("Root element not found");it.createRoot(as).render(e.jsx(Le.StrictMode,{children:e.jsx(Ut,{client:$a,children:e.jsx(vs,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsx(Ra,{})})})}));export{cr as A,Zs as C,ur as D,Js as M,yr as R,nr as S,dr as T,ct as V,Xt as a,pt as b,_t as c,Qt as d,hr as e,mr as f,qa as g,za as h,Ha as i,e as j,Wa as k,K as n,Xa as s,Ne as u,Ga as z};
