const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["chunks/Dashboard-Dpn-RWbg.js","chunks/vendor-B2j9q2e_.js","chunks/StatsCard-jBCB97-B.js","chunks/utils-x1PSU_OZ.js","chunks/Card-Cj7CuoW3.js","chunks/cascade-deletion-DAN0Gkem.js","chunks/query-BI61muSV.js","chunks/ui-SByQEkWx.js","chunks/teacherDetailsApi-BGs4ypj_.js","chunks/Students-DKr86U6y.js","chunks/Table-zv34m9UG.js","chunks/StudentDetailsPageSimple-D1U1_x6r.js","chunks/TeacherNameDisplay-tCwwpP0G.js","chunks/apiCache-T5b6VToj.js","chunks/theoryEnrollmentService-Bgf_GhXN.js","chunks/Teachers-pI8i9So_.js","chunks/TheoryLessons-DvGnHz5b.js","chunks/TheoryLessonDetails-B8DTxOnv.js","chunks/Orchestras-BP6xjxmm.js","chunks/Rehearsals-D3u42LDk.js","chunks/RehearsalDetails-WAcsbBrI.js","chunks/Bagruts-BKeGkBBB.js","chunks/useBagrut-B_ilV3ep.js","chunks/BagrutDetails-ClcsC8HC.js","chunks/Profile-BJFQlJEO.js","chunks/RehearsalAttendance-YW9-mAbC.js","chunks/OrchestraEnrollmentManager-MyNr7dtD.js","chunks/TeacherDetailsPage-RNvBXzQU.js","chunks/OrchestraDetailsPage-C2uPI040.js"])))=>i.map(i=>d[i]);
var ms=Object.defineProperty;var hs=(t,s,a)=>s in t?ms(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var Ze=(t,s,a)=>hs(t,typeof s!="symbol"?s+"":s,a);import{r as m,a as gs,u as xs,b as Be,L as xe,c as fs,d as ps,e as H,N as Oe,R as Re,B as ys}from"../chunks/vendor-B2j9q2e_.js";import{a as X,t as bs,s as js,o as vs,b as Pt,_ as K,e as Ns}from"../chunks/cascade-deletion-DAN0Gkem.js";import{Q as Lt,c as Ft}from"../chunks/query-BI61muSV.js";import{X as me,A as at,a as mt,U as he,C as fe,b as ce,B as ke,M as Ue,T as nt,P as pe,c as ee,d as $e,F as Nt,e as oe,f as Se,g as le,S as ht,h as ot,i as ws,R as Ts,j as wt,k as Is,l as et,m as Ss,n as ks,H as Ce,G as Bt,o as gt,p as Me,q as Ut,r as Cs,s as Tt,t as It,u as Ds,L as Es}from"../chunks/ui-SByQEkWx.js";import"../chunks/utils-x1PSU_OZ.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=a(n);fetch(n.href,o)}})();var Mt={exports:{}},Ve={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _s=m,As=Symbol.for("react.element"),Os=Symbol.for("react.fragment"),Rs=Object.prototype.hasOwnProperty,$s=_s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ps={key:!0,ref:!0,__self:!0,__source:!0};function Vt(t,s,a){var i,n={},o=null,l=null;a!==void 0&&(o=""+a),s.key!==void 0&&(o=""+s.key),s.ref!==void 0&&(l=s.ref);for(i in s)Rs.call(s,i)&&!Ps.hasOwnProperty(i)&&(n[i]=s[i]);if(t&&t.defaultProps)for(i in s=t.defaultProps,s)n[i]===void 0&&(n[i]=s[i]);return{$$typeof:As,type:t,key:o,ref:l,props:n,_owner:$s.current}}Ve.Fragment=Os;Ve.jsx=Vt;Ve.jsxs=Vt;Mt.exports=Ve;var e=Mt.exports,lt={},St=gs;lt.createRoot=St.createRoot,lt.hydrateRoot=St.hydrateRoot;const Yt=m.createContext(null),ye=()=>{const t=m.useContext(Yt);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},Ls=({children:t})=>{const[s,a]=m.useState(!1),[i,n]=m.useState(!0),[o,l]=m.useState(null),[f,u]=m.useState(null),[d,h]=m.useState(null),b=m.useRef(!1),D=m.useRef(null),T=m.useRef(!0);m.useEffect(()=>{T.current=!0;const C=setTimeout(()=>{T.current&&R()},100);return()=>{T.current=!1,D.current&&clearTimeout(D.current),clearTimeout(C)}},[]);const R=m.useCallback(async(C=!1)=>{if(b.current&&!C){console.log("ğŸ” AUTH CONTEXT - Validation already in progress, skipping");return}const O=Date.now();if(!C&&d&&O-d<3e4){console.log("ğŸ” AUTH CONTEXT - Using cached authentication status");return}b.current=!0,u(null);try{if(X.auth.isAuthenticated()){console.log("ğŸ” AUTH CONTEXT - Token found, validating with server");const _=await X.auth.validateToken();if(!T.current)return;const F=_?.data?.user||_?.user||_?.data||_;console.log("ğŸ” AUTH CONTEXT - Token validation successful, fetching full teacher data");let S=null;if(F?._id)try{S=await X.teachers.getTeacher(F._id),console.log("ğŸ” AUTH CONTEXT - Full teacher data fetched:",{hasPersonalInfo:!!S?.personalInfo,hasRoles:!!S?.roles,fullName:S?.personalInfo?.fullName})}catch(B){console.warn("ğŸ” AUTH CONTEXT - Could not fetch full teacher data:",B),S=F}const P=S||F,A={...P,teacherId:P?.teacherId||P?._id,personalInfo:P?.personalInfo||{fullName:P?.fullName||F?.fullName||"",email:P?.email||F?.email||"",phone:P?.phone||"",address:P?.address||""},roles:P?.roles||F?.roles||[],role:P?.role||P?.roles?.[0]||F?.roles?.[0]||""};console.log("ğŸ” AUTH CONTEXT - User data normalized:",{hasUserData:!!A,userRole:A?.role||A?.roles,userId:A?.teacherId||A?._id,fullName:A?.personalInfo?.fullName}),a(!0),l(A),h(O)}else console.log("ğŸ” AUTH CONTEXT - No valid token found"),a(!1),l(null),h(O)}catch(_){if(console.error("ğŸ” AUTH CONTEXT - Auth validation failed:",_),!T.current)return;u(_.message),a(!1),l(null),h(O),_.message.includes("Authentication failed")&&X.auth.isAuthenticated()&&console.log("ğŸ” AUTH CONTEXT - Attempting token refresh")}finally{T.current&&n(!1),b.current=!1}},[d]),L=async(C,O)=>{try{n(!0),u(null);const _=await X.auth.login(C,O);if(!T.current)return;console.log("ğŸ” AUTH CONTEXT - Login successful:",{hasToken:!!_.token,hasUserData:!!(_.teacher||_.user)});const{token:F}=_,S=_.teacher||_.user||_.data?.teacher||_.data?.user||_.data;if(!F||!S)throw new Error("Invalid login response: missing token or user data");console.log("ğŸ” AUTH CONTEXT - Fetching full teacher data after login");let P=null;if(S?._id||S?.teacherId)try{const J=S._id||S.teacherId;P=await X.teachers.getTeacher(J),console.log("ğŸ” AUTH CONTEXT - Full teacher data fetched after login:",{hasPersonalInfo:!!P?.personalInfo,hasRoles:!!P?.roles,fullName:P?.personalInfo?.fullName})}catch(J){console.warn("ğŸ” AUTH CONTEXT - Could not fetch full teacher data after login:",J),P=S}const A=P||S,B={...A,teacherId:A?.teacherId||A?._id,personalInfo:A?.personalInfo||{fullName:A?.fullName||S?.personalInfo?.fullName||S?.fullName||"",email:A?.email||S?.credentials?.email||S?.personalInfo?.email||S?.email||C,phone:A?.phone||S?.personalInfo?.phone||"",address:A?.address||S?.personalInfo?.address||""},roles:A?.roles||S?.roles||[],role:A?.role||A?.roles?.[0]||S?.roles?.[0]||""};return console.log("ğŸ” AUTH CONTEXT - User data normalized after login:",{hasUserData:!!B,userRole:B?.role||B?.roles,userId:B?.teacherId||B?._id,fullName:B?.personalInfo?.fullName}),a(!0),l(B),h(Date.now()),{success:!0,user:B}}catch(_){throw console.error("ğŸ” AUTH CONTEXT - Login failed:",_),T.current&&(u(_.message),a(!1),l(null)),_}finally{T.current&&n(!1)}},k=async()=>{try{n(!0),await X.auth.logout(),console.log("ğŸ” AUTH CONTEXT - Logout successful")}catch(C){console.warn("ğŸ” AUTH CONTEXT - Logout API call failed:",C)}finally{T.current&&(a(!1),l(null),u(null),h(null),n(!1))}},M=m.useCallback(async()=>{try{return console.log("ğŸ” AUTH CONTEXT - Attempting token refresh"),await R(!0),s}catch(C){return console.error("ğŸ” AUTH CONTEXT - Token refresh failed:",C),await k(),!1}},[s]),p=m.useCallback(()=>({isAuthenticated:s,isLoading:i,user:o?{id:o.teacherId||o.id,role:o.role}:null,authError:f,lastValidation:d?new Date(d).toISOString():null,isValidating:b.current,cacheAge:d?Date.now()-d:null}),[s,i,o,f,d]),j={isAuthenticated:s,isLoading:i,user:o,authError:f,login:L,logout:k,checkAuthStatus:R,refreshToken:M,debugAuth:p};return e.jsx(Yt.Provider,{value:j,children:t})},Ht=m.createContext(null),Wt=()=>{const t=m.useContext(Ht);if(!t)throw new Error("useSchoolYear must be used within a SchoolYearProvider");return t},Fs=({children:t})=>{const{isAuthenticated:s}=ye(),[a,i]=m.useState(null),[n,o]=m.useState([]),[l,f]=m.useState(!0),[u,d]=m.useState(null);m.useEffect(()=>{s?h():(i(null),o([]),f(!1),d(null))},[s]);const h=async()=>{try{f(!0),d(null);const p=await X.schoolYears.getSchoolYears();o(p);const j=await X.schoolYears.getCurrentSchoolYear();if(j)i(j);else if(p.length>0){const C=p.sort((O,_)=>new Date(_.startDate)-new Date(O.startDate))[0];i(C)}console.log(`ğŸ“ Loaded ${p.length} school years, current: ${j?.name||"None"}`)}catch(p){console.error("Failed to load school years:",p),d(p.message||"×©×’×™××” ×‘×˜×¢×™× ×ª ×©× ×•×ª ×”×œ×™××•×“")}finally{f(!1)}},b=async p=>{try{const j=n.find(C=>C._id===p);if(j)i(j),console.log(`ğŸ¯ Switched to school year: ${j.name}`);else{const C=await X.schoolYears.getSchoolYear(p);i(C),console.log(`ğŸ¯ Switched to fetched school year: ${C.name}`)}}catch(j){console.error("Failed to set school year:",j),d(j.message||"×©×’×™××” ×‘×¢×“×›×•×Ÿ ×©× ×ª ×”×œ×™××•×“")}},D=async p=>{try{const j=await X.schoolYears.createSchoolYear(p);return o(C=>[...C,j]),p.isCurrent&&i(j),console.log(`â• Created new school year: ${j.name}`),j}catch(j){throw console.error("Failed to create school year:",j),d(j.message||"×©×’×™××” ×‘×™×¦×™×¨×ª ×©× ×ª ×”×œ×™××•×“"),j}},T=async(p,j)=>{try{const C=await X.schoolYears.updateSchoolYear(p,j);return o(O=>O.map(_=>_._id===p?C:_)),a&&a._id===p&&i(C),console.log(`âœï¸ Updated school year: ${C.name}`),C}catch(C){throw console.error("Failed to update school year:",C),d(C.message||"×©×’×™××” ×‘×¢×“×›×•×Ÿ ×©× ×ª ×”×œ×™××•×“"),C}},R=async p=>{try{if(await X.schoolYears.deleteSchoolYear(p),o(j=>j.filter(C=>C._id!==p)),a&&a._id===p){const j=n.filter(C=>C._id!==p);j.length>0?i(j[0]):i(null)}console.log(`ğŸ—‘ï¸ Deleted school year: ${p}`)}catch(j){throw console.error("Failed to delete school year:",j),d(j.message||"×©×’×™××” ×‘××—×™×§×ª ×©× ×ª ×”×œ×™××•×“"),j}},L=p=>{if(!p)return!1;const j=new Date,C=new Date(p.startDate),O=new Date(p.endDate);return j>=C&&j<=O&&p.isActive},M={currentSchoolYear:a,schoolYears:n,isLoading:l,error:u,loadSchoolYears:h,setCurrentSchoolYearById:b,createSchoolYear:D,updateSchoolYear:T,deleteSchoolYear:R,isSchoolYearActive:L,getSchoolYearDisplayName:p=>{if(!p)return"×œ× × ×‘×—×¨×” ×©× ×”";const j=p.isCurrent,C=L(p);let O=p.name;return j?O+=" (× ×•×›×—×™×ª)":C&&(O+=" (×¤×¢×™×œ×”)"),O}};return e.jsx(Ht.Provider,{value:M,children:t})},Bs={currentBagrut:null,bagruts:[],loading:!1,error:null,validation:{errors:{},warnings:{}}},Us=t=>{if(!t[3]?.detailedGrading)return 0;const s=t[3].detailedGrading;return(s.playingSkills?.points||0)+(s.musicalUnderstanding?.points||0)+(s.textKnowledge?.points||0)+(s.playingByHeart?.points||0)},Ms=(t,s)=>{const a=t/100*100,i=s/100*100;return a*.9+i*.1},Vs=t=>t>=95?"××¦×•×™×Ÿ (100-95)":t>=85?"×˜×•×‘ ×××“ (94-85)":t>=75?"×˜×•×‘ (84-75)":t>=65?"×›××¢×˜ ×˜×•×‘ (74-65)":t>=55?"××¡×¤×™×§ (64-55)":"×œ× ××¡×¤×™×§ (54-0)",Ys=t=>({presentations:[t.presentations?.[0]?.completed||!1,t.presentations?.[1]?.completed||!1,t.presentations?.[2]?.completed||!1,t.presentations?.[3]?.completed||!1],directorEvaluation:!!t.directorEvaluation?.points,recitalConfig:!!(t.recitalConfiguration?.units&&t.recitalConfiguration?.field),program:t.program?.length>0}),Ie=(t,s,a)=>t<0?`${a} ×œ× ×™×›×•×œ ×œ×”×™×•×ª ×©×œ×™×œ×™`:t>s?`${a} ×œ× ×™×›×•×œ ×œ×¢×œ×•×ª ×¢×œ ${s} × ×§×•×“×•×ª`:null,Hs=t=>t!==3&&t!==5?"×™×—×™×“×•×ª ×¨×¡×™×˜×œ ×—×™×™×‘×•×ª ×œ×”×™×•×ª 3 ××• 5":null,Ws=(t,s)=>{switch(s.type){case"SET_LOADING":return{...t,loading:s.payload};case"SET_ERROR":return{...t,error:s.payload};case"SET_CURRENT_BAGRUT":return console.log("âœ… BagrutContext: SET_CURRENT_BAGRUT reducer:",s.payload?._id),{...t,currentBagrut:s.payload};case"SET_BAGRUTS":return{...t,bagruts:s.payload};case"UPDATE_DIRECTOR_EVALUATION":{const{bagrutId:a,evaluation:i}=s.payload,n=t.currentBagrut?._id===a?{...t.currentBagrut,directorEvaluation:i}:t.currentBagrut,o=t.bagruts.map(l=>l._id===a?{...l,directorEvaluation:i}:l);return{...t,currentBagrut:n,bagruts:o}}case"UPDATE_RECITAL_CONFIG":{const{bagrutId:a,config:i}=s.payload,n={units:i.recitalUnits,field:i.recitalField},o=t.currentBagrut?._id===a?{...t.currentBagrut,recitalConfiguration:n,recitalUnits:i.recitalUnits,recitalField:i.recitalField}:t.currentBagrut,l=t.bagruts.map(f=>f._id===a?{...f,recitalConfiguration:n,recitalUnits:i.recitalUnits,recitalField:i.recitalField}:f);return{...t,currentBagrut:o,bagruts:l}}case"UPDATE_PRESENTATION":{const{bagrutId:a,index:i,data:n}=s.payload,o=(u=[])=>{const d=[...u];return d[i]={...d[i],...n},d},l=t.currentBagrut?._id===a?{...t.currentBagrut,presentations:o(t.currentBagrut.presentations)}:t.currentBagrut,f=t.bagruts.map(u=>u._id===a?{...u,presentations:o(u.presentations)}:u);return{...t,currentBagrut:l,bagruts:f}}case"CALCULATE_COMPUTED_VALUES":{const{bagrutId:a}=s.payload,i=n=>{if(n._id!==a)return n;const o=Us(n.presentations||[]),l=n.directorEvaluation?.points||0,f=Ms(o,l),u=Vs(f),d=Ys(n);return{...n,computedValues:{totalPerformancePoints:o,weightedFinalGrade:f,gradeLevel:u,completionStatus:d},finalGrade:f,finalGradeLevel:u}};return{...t,currentBagrut:t.currentBagrut?i(t.currentBagrut):null,bagruts:t.bagruts.map(i)}}case"SET_VALIDATION_ERROR":return{...t,validation:{...t.validation,errors:{...t.validation.errors,[s.payload.field]:s.payload.message}}};case"CLEAR_VALIDATION_ERRORS":return{...t,validation:{...t.validation,errors:{}}};default:return t}},zt=m.createContext(null),zs=({children:t})=>{const[s,a]=m.useReducer(Ws,Bs),i=m.useMemo(()=>({setLoading:o=>a({type:"SET_LOADING",payload:o}),setError:o=>a({type:"SET_ERROR",payload:o}),setCurrentBagrut:o=>{console.log("ğŸ’¾ BagrutContext: setCurrentBagrut action called with:",o?._id),a({type:"SET_CURRENT_BAGRUT",payload:o})},setBagruts:o=>a({type:"SET_BAGRUTS",payload:o}),updateDirectorEvaluation:(o,l)=>{const f=Ie(l.points||0,100,"×”×¢×¨×›×ª ×× ×”×œ");if(f){a({type:"SET_VALIDATION_ERROR",payload:{field:"directorEvaluation",message:f}});return}a({type:"UPDATE_DIRECTOR_EVALUATION",payload:{bagrutId:o,evaluation:l}}),a({type:"CALCULATE_COMPUTED_VALUES",payload:{bagrutId:o}})},updateRecitalConfig:(o,l)=>{const f=Hs(l.recitalUnits);if(f){a({type:"SET_VALIDATION_ERROR",payload:{field:"recitalUnits",message:f}});return}a({type:"UPDATE_RECITAL_CONFIG",payload:{bagrutId:o,config:l}}),a({type:"CALCULATE_COMPUTED_VALUES",payload:{bagrutId:o}})},updatePresentation:(o,l,f)=>{if(f.detailedGrading){const u=f.detailedGrading,d=[];if(u.playingSkills?.points!==void 0){const h=Ie(u.playingSkills.points,40,"×›×™×©×•×¨×™ × ×’×™× ×”");h&&d.push(h)}if(u.musicalUnderstanding?.points!==void 0){const h=Ie(u.musicalUnderstanding.points,30,"×”×‘× ×” ××•×–×™×§×œ×™×ª");h&&d.push(h)}if(u.textKnowledge?.points!==void 0){const h=Ie(u.textKnowledge.points,20,"×™×“×¢ ×˜×§×¡×˜");h&&d.push(h)}if(u.playingByHeart?.points!==void 0){const h=Ie(u.playingByHeart.points,10,"× ×’×™× ×” ×‘×¢×œ ×¤×”");h&&d.push(h)}if(d.length>0){a({type:"SET_VALIDATION_ERROR",payload:{field:`presentation${l}`,message:d[0]}});return}}a({type:"UPDATE_PRESENTATION",payload:{bagrutId:o,index:l,data:f}}),a({type:"CALCULATE_COMPUTED_VALUES",payload:{bagrutId:o}})},recalculateGrade:o=>{a({type:"CALCULATE_COMPUTED_VALUES",payload:{bagrutId:o}})},setValidationError:(o,l)=>{a({type:"SET_VALIDATION_ERROR",payload:{field:o,message:l}})},clearValidationErrors:()=>{a({type:"CLEAR_VALIDATION_ERRORS"})},validatePointTotal:o=>(o.playingSkills?.points||0)+(o.musicalUnderstanding?.points||0)+(o.textKnowledge?.points||0)+(o.playingByHeart?.points||0)>100?(a({type:"SET_VALIDATION_ERROR",payload:{field:"totalPoints",message:"×¡×š ×”× ×§×•×“×•×ª ×œ× ×™×›×•×œ ×œ×¢×œ×•×ª ×¢×œ 100"}}),!1):!0,validateSequentialPresentation:(o,l)=>o>0&&!l[o-1]?.completed?(a({type:"SET_VALIDATION_ERROR",payload:{field:`presentation${o}`,message:`×™×© ×œ×”×©×œ×™× ×ª×—×™×œ×” ××¦×’×ª ${o}`}}),!1):!0}),[]),n=m.useMemo(()=>({state:s,actions:i}),[s,i]);return e.jsx(zt.Provider,{value:n,children:t})},Ma=()=>{const t=m.useContext(zt);if(!t)throw new Error("useBagrutContext must be used within a BagrutProvider");return t},Va={getCurrentBagrut:t=>t.currentBagrut,getAllBagruts:t=>t.bagruts,getLoadingState:t=>t.loading,getError:t=>t.error,getValidationErrors:t=>t.validation.errors,getBagrutById:(t,s)=>t.bagruts.find(a=>a._id===s),getCompletedPresentations:(t,s)=>t.bagruts.find(i=>i._id===s)?.presentations?.filter(i=>i.completed)||[],getTotalPerformancePoints:(t,s)=>t.bagruts.find(i=>i._id===s)?.computedValues?.totalPerformancePoints||0,getWeightedFinalGrade:(t,s)=>t.bagruts.find(i=>i._id===s)?.computedValues?.weightedFinalGrade||0,getCompletionStatus:(t,s)=>t.bagruts.find(i=>i._id===s)?.computedValues?.completionStatus||{presentations:[!1,!1,!1,!1],directorEvaluation:!1,recitalConfig:!1,program:!1}},be=new Lt({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!0,refetchOnMount:!0,retry:(t,s)=>{const a=s?.response?.status;return a>=400&&a<500?!1:t<2},retryDelay:t=>Math.min(1e3*2**t,3e4),networkMode:"online"},mutations:{retry:1,networkMode:"online",onError:t=>{console.error("Mutation error:",t)}}}});be.setQueryDefaults(["students"],{staleTime:2*60*1e3,gcTime:5*60*1e3});be.setQueryDefaults(["teachers"],{staleTime:10*60*1e3,gcTime:30*60*1e3});be.setQueryDefaults(["theory-lessons"],{staleTime:2*60*1e3,gcTime:5*60*1e3});be.setQueryDefaults(["orchestras"],{staleTime:5*60*1e3,gcTime:15*60*1e3});be.setQueryDefaults(["school-years"],{staleTime:30*60*1e3,gcTime:60*60*1e3});function Xs({children:t}){return e.jsxs(Ft,{client:be,children:[t,!1]})}const Xt=m.createContext(void 0);function qs({children:t}){const[s,a]=m.useState(!0),[i,n]=m.useState(!1);return m.useEffect(()=>{const o=()=>{n(window.innerWidth<768)};return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]),e.jsx(Xt.Provider,{value:{isDesktopOpen:s,setIsDesktopOpen:a,isMobile:i},children:t})}function xt(){const t=m.useContext(Xt);if(t===void 0)throw new Error("useSidebar must be used within a SidebarProvider");return t}const Gs=({isOpen:t,onClose:s,title:a,children:i,maxWidth:n="md",showCloseButton:o=!0,closeOnBackdrop:l=!0,darkBackdrop:f=!1,className:u=""})=>{if(!t)return null;const d={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","4xl":"max-w-4xl"},h=f?"bg-opacity-75":"bg-opacity-50",b=D=>{l&&D.target===D.currentTarget&&s()};return e.jsx("div",{className:`fixed inset-0 bg-black ${h} flex items-center justify-center z-50 p-4`,onClick:b,children:e.jsxs("div",{className:`bg-white rounded-xl shadow-2xl w-full ${d[n]} max-h-[90vh] overflow-hidden transform transition-all ${u}`,children:[(a||o)&&e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a&&e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:a}),o&&e.jsx("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",type:"button",children:e.jsx(me,{className:"w-5 h-5 text-gray-500"})})]}),e.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-140px)]",children:i})]})})},Qs=({isOpen:t,title:s,message:a,confirmText:i="××™×©×•×¨",cancelText:n="×‘×™×˜×•×œ",onConfirm:o,onCancel:l,variant:f="danger"})=>{if(!t)return null;const d=(()=>{switch(f){case"danger":return{icon:"text-red-600",confirmButton:"bg-red-600 hover:bg-red-700 text-white",iconBg:"bg-red-100"};case"warning":return{icon:"text-yellow-600",confirmButton:"bg-yellow-600 hover:bg-yellow-700 text-white",iconBg:"bg-yellow-100"};case"info":return{icon:"text-blue-600",confirmButton:"bg-blue-600 hover:bg-blue-700 text-white",iconBg:"bg-blue-100"};default:return{icon:"text-red-600",confirmButton:"bg-red-600 hover:bg-red-700 text-white",iconBg:"bg-red-100"}}})();return e.jsxs(Gs,{isOpen:t,onClose:l,maxWidth:"md",showCloseButton:!1,closeOnBackdrop:!0,children:[e.jsx("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d.iconBg}`,children:e.jsx(at,{className:`w-5 h-5 ${d.icon}`})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s})]})}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-gray-700 text-sm leading-relaxed",children:a})}),e.jsxs("div",{className:"flex gap-3 p-6 pt-0",children:[e.jsx("button",{onClick:l,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:n}),e.jsx("button",{onClick:o,className:`flex-1 px-4 py-2 rounded-lg transition-colors font-medium ${d.confirmButton}`,children:i})]})]})},Ks=["×","×‘","×’","×“","×”","×•","×–","×—","×˜","×™","×™×","×™×‘","××—×¨"],Js=[1,2,3,4,5,6,7,8],Zs=["×—×œ×™×œ×™×ª","×—×œ×™×œ ×¦×“","××‘×•×‘","×‘×¡×•×Ÿ","×¡×§×¡×•×¤×•×Ÿ","×§×œ×¨×™× ×˜","×—×¦×•×¦×¨×”","×§×¨×Ÿ ×™×¢×¨","×˜×¨×•××‘×•×Ÿ","×˜×•×‘×”/×‘×¨×™×˜×•×Ÿ","×©×™×¨×”","×›×™× ×•×¨","×•×™×•×œ×”","×¦'×œ×•","×§×•× ×˜×¨×‘×¡","×¤×¡× ×ª×¨","×’×™×˜×¨×”","×’×™×˜×¨×” ×‘×¡","×ª×•×¤×™×"],er=["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™"],tr=[30,45,60],kt=["×œ× × ×‘×—×Ÿ","×¢×‘×¨/×”","×œ× ×¢×‘×¨/×”","×¢×‘×¨/×” ×‘×”×¦×˜×™×™× ×•×ª","×¢×‘×¨/×” ×‘×”×¦×˜×™×™× ×•×ª ×™×ª×¨×”"],sr=({initialData:t,onSubmit:s,onCancel:a,isEdit:i=!1})=>{const[n,o]=m.useState({personalInfo:{fullName:"",phone:"",age:null,address:"",parentName:"",parentPhone:"",parentEmail:"",studentEmail:""},academicInfo:{instrumentProgress:[{instrumentName:"",isPrimary:!0,currentStage:1,tests:{stageTest:{status:"×œ× × ×‘×—×Ÿ"},technicalTest:{status:"×œ× × ×‘×—×Ÿ"}}}],class:"×",tests:{bagrutId:null}},enrollments:{orchestraIds:[],ensembleIds:[],theoryLessonIds:[],schoolYears:[]},teacherIds:[],teacherAssignments:[],isActive:!0,...t}),[l,f]=m.useState({}),[u,d]=m.useState(!1),[h,b]=m.useState({personal:!0,academic:!0,instruments:!0,teachers:!0,enrollments:!1}),[D,T]=m.useState([]),[R,L]=m.useState([]),[k,M]=m.useState([]),[p,j]=m.useState([]),[C,O]=m.useState(""),[_,F]=m.useState(!1);m.useState([]);const[S,P]=m.useState({duration:null,selectedDays:[],startTime:"",endTime:""}),[A,B]=m.useState(!0),[J,c]=m.useState({isOpen:!1,message:"",conflictingSlot:null});m.useEffect(()=>{const r=async()=>{try{const v=await X.teachers.getTeachers();T(v)}catch(v){console.error("Error fetching teachers:",v)}},g=async()=>{try{const v=await X.orchestras.getOrchestras();console.log("Fetched orchestras:",v);const N=await Promise.all((v||[]).map(async V=>{if(V.rehearsalIds&&V.rehearsalIds.length>0)try{const Y=await X.rehearsals.getRehearsalById(V.rehearsalIds[0]);return{...V,rehearsalSchedule:Y?{day:Y.day||Y.dayOfWeek,startTime:Y.startTime,endTime:Y.endTime,location:Y.location||V.location}:null}}catch{return console.log("Could not fetch rehearsal for orchestra:",V.name),V}return V}));M(N)}catch(v){console.error("Error fetching orchestras:",v),M([])}},x=async()=>{try{const v=await X.theory.getTheoryLessons();console.log("Fetched theory lessons:",v);const N=Array.isArray(v)?v:v?.data||[];j(N)}catch(v){console.error("Error fetching theory lessons:",v),j([])}};r(),g(),x()},[]);const w=(r,g)=>{const[x,v]=r.split(":").map(Number),N=x*60+v+g,V=Math.floor(N/60),Y=N%60;return`${V.toString().padStart(2,"0")}:${Y.toString().padStart(2,"0")}`},U=(r,g,x,v)=>{const N=Ne=>{const[Ke,Je]=Ne.split(":").map(Number);return Ke*60+Je},V=N(r),Y=N(g),re=N(x),Qe=N(v);return V<Qe&&Y>re};m.useEffect(()=>{C&&(y(C),B(!0))},[C]);const y=async r=>{F(!0);try{const g=await X.teachers.getTeacherById(r);console.log("Teacher data for slots:",g);const x=await X.teachers.getTeacherStudents(r);console.log("Teacher students:",x);const v=[];x.forEach(Y=>{Y.teacherAssignments&&Array.isArray(Y.teacherAssignments)&&Y.teacherAssignments.forEach(re=>{re.teacherId===r&&v.push({day:re.day,time:re.time,duration:re.duration})})}),console.log("Occupied slots from other students:",v);const N=g.teaching?.timeBlocks?.filter(Y=>Y.isActive!==!1)||[];console.log("Time blocks found:",N);const V=[];N.forEach(Y=>{const re=Y.startTime,Qe=Y.endTime,Ne=Y.day,[Ke,Je]=re.split(":").map(Number),[rs,as]=Qe.split(":").map(Number),yt=Ke*60+Je,bt=rs*60+as,Oa=bt-yt;tr.forEach(we=>{for(let Te=yt;Te+we<=bt;Te+=15){const jt=Te+we,ns=Math.floor(Te/60),os=Te%60,ls=Math.floor(jt/60),is=jt%60,_e=`${ns.toString().padStart(2,"0")}:${os.toString().padStart(2,"0")}`,vt=`${ls.toString().padStart(2,"0")}:${is.toString().padStart(2,"0")}`,cs=v.some(se=>{if(se.day!==Ne)return!1;const us=w(se.time,se.duration);return U(_e,vt,se.time,us)}),ds=n.teacherAssignments.some(se=>se.teacherId===g._id&&se.day===Ne&&se.time===_e&&se.duration===we);if(!cs&&!ds){const se=`${Y._id}-${we}-${_e.replace(":","")}`;V.push({_id:se,day:Ne,startTime:_e,endTime:vt,duration:we,isAvailable:!0,location:Y.location,teacherName:g.personalInfo?.fullName,teacherId:g._id,instrument:g.professionalInfo?.instrument})}}})}),console.log("Generated available slots (after filtering occupied):",V),L(V)}catch(g){console.error("Error fetching teacher slots:",g),L([])}finally{F(!1)}},E=r=>{b(g=>({...g,[r]:!g[r]}))},I=(r,g,x)=>{o(v=>({...v,[r]:{...v[r],[g]:x}})),f(v=>({...v,[`${r}.${g}`]:""}))},$=(r,g,x)=>{const v=[...n.academicInfo.instrumentProgress];g==="tests"?v[r]={...v[r],tests:x}:v[r]={...v[r],[g]:x},g==="isPrimary"&&x===!0&&v.forEach((N,V)=>{V!==r&&(N.isPrimary=!1)}),o(N=>({...N,academicInfo:{...N.academicInfo,instrumentProgress:v}}))},G=()=>{const r=n.academicInfo.instrumentProgress.some(g=>g.isPrimary);o(g=>({...g,academicInfo:{...g.academicInfo,instrumentProgress:[...g.academicInfo.instrumentProgress,{instrumentName:"",isPrimary:!r,currentStage:1,tests:{stageTest:{status:"×œ× × ×‘×—×Ÿ"},technicalTest:{status:"×œ× × ×‘×—×Ÿ"}}}]}}))},q=r=>{const g=n.academicInfo.instrumentProgress.filter((x,v)=>v!==r);g.length>0&&!g.some(x=>x.isPrimary)&&(g[0].isPrimary=!0),o(x=>({...x,academicInfo:{...x.academicInfo,instrumentProgress:g}}))},je=r=>{const g=w(r.startTime,r.duration);for(const N of n.teacherAssignments)if(N.day===r.day){const V=w(N.time,N.duration);if(U(r.startTime,g,N.time,V)){const Y=D.find(re=>re._id===N.teacherId)?.personalInfo?.fullName||"××•×¨×”";return`×”×ª×–××•×Ÿ ××ª× ×’×© ×¢× ×©×™×¢×•×¨ ×§×™×™×:
${N.day} ${N.time}-${V} ×¢× ${Y}`}}const x=k.find(N=>N._id===n.enrollments.orchestraIds[0]);if(x?.rehearsalSchedule){const N=x.rehearsalSchedule;if(N.day===r.day&&U(r.startTime,g,N.startTime,N.endTime))return`×”×ª×–××•×Ÿ ××ª× ×’×© ×¢× ×—×–×¨×ª ×ª×–××•×¨×ª:
${N.day} ${N.startTime}-${N.endTime} - ${x.name}`}const v=p.find(N=>N._id===n.enrollments.theoryLessonIds[0]);if(v?.schedule){for(const N of v.schedule)if(N.day===r.day&&U(r.startTime,g,N.startTime,N.endTime))return`×”×ª×–××•×Ÿ ××ª× ×’×© ×¢× ×©×™×¢×•×¨ ×ª×™××•×¨×™×”:
${N.day} ${N.startTime}-${N.endTime} - ${v.name}`}return null},ve=r=>{const g=je(r);if(g){c({isOpen:!0,message:g,conflictingSlot:r});return}Ee(r)},Ee=r=>{const g={teacherId:r.teacherId,day:r.day,time:r.startTime,duration:r.duration,isActive:!0,isRecurring:!0,...r.location&&{location:r.location}};o(x=>({...x,teacherAssignments:[...x.teacherAssignments,g],teacherIds:x.teacherIds.includes(r.teacherId)?x.teacherIds:[...x.teacherIds,r.teacherId]})),L(x=>x.filter(v=>v._id!==r._id)),B(!1)},We=()=>{J.conflictingSlot&&Ee(J.conflictingSlot),c({isOpen:!1,message:"",conflictingSlot:null})},ze=()=>{c({isOpen:!1,message:"",conflictingSlot:null})},Xe=r=>{const g=n.teacherAssignments[r];o(x=>{const v=x.teacherAssignments.filter((V,Y)=>Y!==r),N=v.some(V=>V.teacherId===g.teacherId);return{...x,teacherAssignments:v,teacherIds:N?x.teacherIds:x.teacherIds.filter(V=>V!==g.teacherId)}}),C===g.teacherId&&setTimeout(()=>{y(g.teacherId)},100)},qe=()=>{const r={};n.personalInfo.fullName.trim()||(r["personalInfo.fullName"]="×©× ××œ× ×”×•× ×©×“×” ×—×•×‘×”"),n.personalInfo.phone&&!/^05\d{8}$/.test(n.personalInfo.phone)&&(r["personalInfo.phone"]="××¡×¤×¨ ×˜×œ×¤×•×Ÿ ×œ× ×ª×§×™×Ÿ (×“×•×’××”: 0501234567)"),n.personalInfo.parentPhone&&!/^05\d{8}$/.test(n.personalInfo.parentPhone)&&(r["personalInfo.parentPhone"]="××¡×¤×¨ ×˜×œ×¤×•×Ÿ ×”×•×¨×” ×œ× ×ª×§×™×Ÿ"),n.personalInfo.parentEmail&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.personalInfo.parentEmail)&&(r["personalInfo.parentEmail"]="××™××™×™×œ ×”×•×¨×” ×œ× ×ª×§×™×Ÿ"),n.personalInfo.studentEmail&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.personalInfo.studentEmail)&&(r["personalInfo.studentEmail"]="××™××™×™×œ ×ª×œ××™×“ ×œ× ×ª×§×™×Ÿ"),n.academicInfo.class||(r["academicInfo.class"]="×›×™×ª×” ×”×™× ×©×“×” ×—×•×‘×”"),n.academicInfo.instrumentProgress.length===0?r["academicInfo.instruments"]="×™×© ×œ×”×•×¡×™×£ ×œ×¤×—×•×ª ×›×œ×™ × ×’×™× ×” ××—×“":n.academicInfo.instrumentProgress.forEach((x,v)=>{x.instrumentName||(r[`instrument.${v}.name`]="×©× ×”×›×œ×™ ×”×•× ×©×“×” ×—×•×‘×”")});const g=n.academicInfo.instrumentProgress.some(x=>x.isPrimary);return n.academicInfo.instrumentProgress.length>0&&!g&&(r["academicInfo.primaryInstrument"]="×™×© ×œ×‘×—×•×¨ ×›×œ×™ ×¨××©×™"),f(r),Object.keys(r).length===0},Ge=async r=>{if(r.preventDefault(),!!qe()){d(!0);try{console.log("ğŸ“‹ Form data being submitted:",JSON.stringify(n,null,2)),console.log("ğŸ‘¥ Teacher assignments:",JSON.stringify(n.teacherAssignments,null,2)),console.log("ğŸ‘¨â€ğŸ« Teacher IDs:",n.teacherIds),await s(n)}catch(g){console.error("Error submitting form:",g),f({submit:"×©×’×™××” ×‘×©××™×¨×ª ×”× ×ª×•× ×™×"})}finally{d(!1)}}};return e.jsxs("form",{onSubmit:Ge,className:"space-y-6 max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:i?"×¢×¨×™×›×ª ×ª×œ××™×“":"×”×•×¡×¤×ª ×ª×œ××™×“ ×—×“×©"}),e.jsx("button",{type:"button",onClick:a,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(me,{className:"w-5 h-5"})})]}),l.submit&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-2",children:[e.jsx(mt,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"text-red-700",children:l.submit})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>E("personal"),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5 text-primary-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"×¤×¨×˜×™× ××™×©×™×™×"})]}),h.personal?e.jsx(fe,{}):e.jsx(ce,{})]}),h.personal&&e.jsx("div",{className:"p-6 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["×©× ××œ× ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n.personalInfo.fullName,onChange:r=>I("personalInfo","fullName",r.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900 ${l["personalInfo.fullName"]?"border-red-500":"border-gray-300"}`,placeholder:"×”×›× ×¡ ×©× ××©×¤×—×” ×•××– ×©× ×¤×¨×˜×™ (×œ×“×•×’××”: ×›×”×Ÿ ×™×•×¡×™)"}),l["personalInfo.fullName"]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l["personalInfo.fullName"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×˜×œ×¤×•×Ÿ ×ª×œ××™×“"}),e.jsx("input",{type:"tel",value:n.personalInfo.phone,onChange:r=>I("personalInfo","phone",r.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900 ${l["personalInfo.phone"]?"border-red-500":"border-gray-300"}`,placeholder:"0501234567"}),l["personalInfo.phone"]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l["personalInfo.phone"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×’×™×œ"}),e.jsx("input",{type:"number",value:n.personalInfo.age||"",onChange:r=>I("personalInfo","age",r.target.value?parseInt(r.target.value):null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",placeholder:"×’×™×œ ×”×ª×œ××™×“",min:"0",max:"99"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"××™××™×™×œ ×ª×œ××™×“"}),e.jsx("input",{type:"email",value:n.personalInfo.studentEmail,onChange:r=>I("personalInfo","studentEmail",r.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900 ${l["personalInfo.studentEmail"]?"border-red-500":"border-gray-300"}`,placeholder:"student@example.com"}),l["personalInfo.studentEmail"]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l["personalInfo.studentEmail"]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×›×ª×•×‘×ª"}),e.jsx("input",{type:"text",value:n.personalInfo.address,onChange:r=>I("personalInfo","address",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",placeholder:"×”×›× ×¡ ×›×ª×•×‘×ª ××œ××”"})]}),e.jsx("div",{className:"md:col-span-2 border-t pt-4 mt-2",children:e.jsx("h4",{className:"text-md font-medium text-gray-800 mb-4",children:"×¤×¨×˜×™ ×”×•×¨×”"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©× ×”×•×¨×”"}),e.jsx("input",{type:"text",value:n.personalInfo.parentName,onChange:r=>I("personalInfo","parentName",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",placeholder:"×©× ×”×”×•×¨×”"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×˜×œ×¤×•×Ÿ ×”×•×¨×”"}),e.jsx("input",{type:"tel",value:n.personalInfo.parentPhone,onChange:r=>I("personalInfo","parentPhone",r.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900 ${l["personalInfo.parentPhone"]?"border-red-500":"border-gray-300"}`,placeholder:"0501234567"}),l["personalInfo.parentPhone"]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l["personalInfo.parentPhone"]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"××™××™×™×œ ×”×•×¨×”"}),e.jsx("input",{type:"email",value:n.personalInfo.parentEmail,onChange:r=>I("personalInfo","parentEmail",r.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900 ${l["personalInfo.parentEmail"]?"border-red-500":"border-gray-300"}`,placeholder:"parent@example.com"}),l["personalInfo.parentEmail"]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l["personalInfo.parentEmail"]})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>E("academic"),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5 text-primary-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"×¤×¨×˜×™× ××§×“××™×™×"})]}),h.academic?e.jsx(fe,{}):e.jsx(ce,{})]}),h.academic&&e.jsx("div",{className:"p-6 border-t border-gray-200",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["×›×™×ª×” ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:n.academicInfo.class,onChange:r=>I("academicInfo","class",r.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900 ${l["academicInfo.class"]?"border-red-500":"border-gray-300"}`,children:Ks.map(r=>e.jsx("option",{value:r,children:r},r))}),l["academicInfo.class"]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l["academicInfo.class"]})]})})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>E("instruments"),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"w-5 h-5 text-primary-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"×›×œ×™ × ×’×™× ×”"})]}),h.instruments?e.jsx(fe,{}):e.jsx(ce,{})]}),h.instruments&&e.jsxs("div",{className:"p-6 border-t border-gray-200",children:[l["academicInfo.instruments"]&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700 text-sm",children:l["academicInfo.instruments"]})}),l["academicInfo.primaryInstrument"]&&e.jsx("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("p",{className:"text-yellow-700 text-sm",children:l["academicInfo.primaryInstrument"]})}),e.jsxs("div",{className:"space-y-4",children:[n.academicInfo.instrumentProgress.map((r,g)=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:["×›×œ×™ × ×’×™× ×” ",g+1]}),n.academicInfo.instrumentProgress.length>1&&e.jsx("button",{type:"button",onClick:()=>q(g),className:"p-1 hover:bg-red-50 rounded text-red-600",children:e.jsx(nt,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["×©× ×”×›×œ×™ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:r.instrumentName,onChange:x=>$(g,"instrumentName",x.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900 ${l[`instrument.${g}.name`]?"border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×›×œ×™"}),Zs.map(x=>e.jsx("option",{value:x,children:x},x))]}),l[`instrument.${g}.name`]&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l[`instrument.${g}.name`]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×©×œ×‘ × ×•×›×—×™"}),e.jsx("select",{value:r.currentStage,onChange:x=>$(g,"currentStage",parseInt(x.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",children:Js.map(x=>e.jsxs("option",{value:x,children:["×©×œ×‘ ",x]},x))})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.isPrimary,onChange:x=>$(g,"isPrimary",x.target.checked),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"×›×œ×™ ×¨××©×™"})]})}),e.jsxs("div",{className:"md:col-span-2 grid grid-cols-2 gap-4 mt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"××‘×—×Ÿ ×©×œ×‘"}),e.jsx("select",{value:r.tests.stageTest.status,onChange:x=>$(g,"tests",{...r.tests,stageTest:{...r.tests.stageTest,status:x.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",children:kt.map(x=>e.jsx("option",{value:x,children:x},x))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"××‘×—×Ÿ ×˜×›× ×™"}),e.jsx("select",{value:r.tests.technicalTest.status,onChange:x=>$(g,"tests",{...r.tests,technicalTest:{...r.tests.technicalTest,status:x.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",children:kt.map(x=>e.jsx("option",{value:x,children:x},x))})]})]})]})]},g)),e.jsxs("button",{type:"button",onClick:G,className:"w-full py-2 border-2 border-dashed border-gray-300 rounded-lg hover:border-primary-500 transition-colors flex items-center justify-center gap-2 text-gray-600 hover:text-primary-600",children:[e.jsx(pe,{className:"w-4 h-4"}),"×”×•×¡×£ ×›×œ×™ × ×’×™× ×”"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>E("teachers"),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5 text-primary-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"××•×¨×™× ×•×©×™×¢×•×¨×™×"}),n.teacherAssignments.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-primary-100 text-primary-700 rounded-full text-xs",children:[n.teacherAssignments.length," ×©×™×‘×•×¦×™×"]})]}),h.teachers?e.jsx(fe,{}):e.jsx(ce,{})]}),h.teachers&&e.jsxs("div",{className:"p-6 border-t border-gray-200",children:[n.teacherAssignments.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"×©×™×¢×•×¨×™× ××ª×•×›× × ×™×"}),e.jsx("div",{className:"space-y-2",children:n.teacherAssignments.map((r,g)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx($e,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:["××•×¨×” - ",D.find(x=>x._id===r.teacherId)?.professionalInfo?.instrument||"×›×œ×™"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[r.day," | ",r.time,"-",w(r.time,r.duration)," | ",r.duration," ×“×§×•×ª",r.location&&` | ${r.location}`]})]})]}),e.jsx("button",{type:"button",onClick:()=>Xe(g),className:"p-1 hover:bg-red-50 rounded text-red-600",children:e.jsx(nt,{className:"w-4 h-4"})})]},g))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×‘×—×¨ ××•×¨×”"}),e.jsxs("select",{value:C,onChange:r=>O(r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",children:[e.jsx("option",{value:"",children:"×‘×—×¨ ××•×¨×” ×œ×¨××•×ª ×–×× ×™× ×¤× ×•×™×™×"}),D.map(r=>e.jsxs("option",{value:r._id,children:[r.personalInfo?.fullName," - ",r.professionalInfo?.instrument||"×œ×œ× ×›×œ×™"]},r._id))]})]}),C&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:["×–×× ×™× ×¤× ×•×™×™× - ",D.find(r=>r._id===C)?.personalInfo?.fullName||"××•×¨×”"]}),!A&&R.length>0&&e.jsx("div",{className:"mb-4",children:e.jsxs("button",{type:"button",onClick:()=>B(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[e.jsx(pe,{className:"w-4 h-4"}),"×‘×—×¨ ×©×™×¢×•×¨ × ×•×¡×£"]})}),A&&!_&&R.length>0&&e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(Nt,{className:"w-4 h-4"}),"×¡×™× ×•×Ÿ ×–×× ×™×"]}),(S.duration||S.selectedDays.length>0||S.startTime||S.endTime)&&e.jsxs("button",{type:"button",onClick:()=>P({duration:null,selectedDays:[],startTime:"",endTime:""}),className:"text-xs text-primary-600 hover:text-primary-700 flex items-center gap-1",children:[e.jsx(me,{className:"w-3 h-3"}),"× ×§×” ×¡×™× ×•×Ÿ"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"××©×š ×©×™×¢×•×¨"}),e.jsxs("select",{value:S.duration||"",onChange:r=>P(g=>({...g,duration:r.target.value?Number(r.target.value):null})),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-primary-500 focus:border-primary-500 text-gray-900 bg-white",children:[e.jsx("option",{value:"",children:"×›×œ ×”××©×›×™×"}),e.jsx("option",{value:"30",children:"30 ×“×§×•×ª"}),e.jsx("option",{value:"45",children:"45 ×“×§×•×ª"}),e.jsx("option",{value:"60",children:"60 ×“×§×•×ª"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"×™××™×"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md bg-white text-right flex items-center justify-between text-gray-900",onClick:r=>{const g=r.currentTarget.nextElementSibling;g&&g.classList.toggle("hidden")},children:[e.jsx("span",{className:"truncate",children:S.selectedDays.length>0?`${S.selectedDays.length} ×™××™× × ×‘×—×¨×•`:"×›×œ ×”×™××™×"}),e.jsx(ce,{className:"w-4 h-4 flex-shrink-0"})]}),e.jsx("div",{className:"hidden absolute top-full mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg z-10",children:er.map(r=>e.jsxs("label",{className:"flex items-center px-3 py-2 hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S.selectedDays.includes(r),onChange:g=>{g.target.checked?P(x=>({...x,selectedDays:[...x.selectedDays,r]})):P(x=>({...x,selectedDays:x.selectedDays.filter(v=>v!==r)}))},className:"ml-2 text-primary-600 rounded"}),e.jsx("span",{className:"text-sm text-gray-900",children:r})]},r))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"××©×¢×”"}),e.jsx("input",{type:"time",value:S.startTime,onChange:r=>P(g=>({...g,startTime:r.target.value})),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-primary-500 focus:border-primary-500 text-gray-900 bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"×¢×“ ×©×¢×”"}),e.jsx("input",{type:"time",value:S.endTime,onChange:r=>P(g=>({...g,endTime:r.target.value})),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-primary-500 focus:border-primary-500 text-gray-900 bg-white"})]})]})]}),_?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"×˜×•×¢×Ÿ ×–×× ×™× ×¤× ×•×™×™×..."})]}):A&&R.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"×‘×—×¨ ×–××Ÿ ×•××©×š ×©×™×¢×•×¨ ××”××¤×©×¨×•×™×•×ª ×”×–××™× ×•×ª:"}),(()=>{const r=R.filter(x=>!(S.duration&&x.duration!==S.duration||S.selectedDays.length>0&&!S.selectedDays.includes(x.day)||S.startTime&&x.startTime<S.startTime||S.endTime&&x.endTime>S.endTime));if(r.length===0)return e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx(Nt,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"××™×Ÿ ×–×× ×™× ×”×ª×•×××™× ×œ×¡×™× ×•×Ÿ ×©×‘×—×¨×ª"}),e.jsx("button",{type:"button",onClick:()=>P({duration:null,selectedDays:[],startTime:"",endTime:""}),className:"text-xs text-primary-600 hover:text-primary-700",children:"× ×§×” ×¡×™× ×•×Ÿ ×•×ª×¨××” ××ª ×›×œ ×”×–×× ×™×"})]});const g=r.reduce((x,v)=>(x[v.day]||(x[v.day]=[]),x[v.day].push(v),x),{});return Object.entries(g).map(([x,v])=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-600 mb-2 flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4"}),x]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:v.sort((N,V)=>N.startTime.localeCompare(V.startTime)).map(N=>e.jsx("button",{type:"button",onClick:()=>ve(N),className:`p-3 border rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-colors text-right ${N.duration===30?"border-green-300 bg-green-50":N.duration===45?"border-blue-300 bg-blue-50":"border-purple-300 bg-purple-50"}`,children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(oe,{className:"w-3 h-3"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[N.startTime,"-",N.endTime]})]}),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${N.duration===30?"bg-green-100 text-green-800":N.duration===45?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:[N.duration," ×“×§×³"]})]}),N.location&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[e.jsx(Se,{className:"w-3 h-3"}),N.location]}),e.jsx("div",{className:"text-xs text-gray-600",children:N.instrument})]})},N._id))})]},x))})()]}):C&&!_&&A&&R.length===0?e.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-lg",children:[e.jsx(oe,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"××™×Ÿ ×–×× ×™× ×¤× ×•×™×™× ×œ××•×¨×” ×–×”"}),e.jsx("p",{className:"text-xs text-gray-400",children:"×™×™×ª×›×Ÿ ×©×›×œ ×”×–×× ×™× ×”×¤× ×•×™×™× ×›×‘×¨ ×ª×¤×•×¡×™× ××• ×©×”××•×¨×” ×œ× ×”×’×“×™×¨ ×–×× ×™ ×”×•×¨××”"})]}):null]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>E("enrollments"),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5 text-primary-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"×”×¨×©××•×ª"})]}),h.enrollments?e.jsx(fe,{}):e.jsx(ce,{})]}),h.enrollments&&e.jsx("div",{className:"p-6 border-t border-gray-200",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª×–××•×¨×ª"}),e.jsxs("select",{value:n.enrollments.orchestraIds[0]||"",onChange:r=>{o(g=>({...g,enrollments:{...g.enrollments,orchestraIds:r.target.value?[r.target.value]:[]}}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×ª×–××•×¨×ª"}),k.map(r=>{const g=r.rehearsalSchedule||r.schedule&&r.schedule[0]||r.rehearsals&&r.rehearsals[0]||null;let x=r.name;if(g){const v=g.day||g.dayOfWeek||"",N=g.startTime||"",V=g.endTime||"",Y=g.location||r.location||"";v&&N&&V&&(x+=` | ${v} ${N}-${V}`),Y&&(x+=` | ${Y}`)}else r.location&&(x+=` | ${r.location}`);return e.jsx("option",{value:r._id,children:x},r._id)})]}),n.enrollments.orchestraIds[0]&&e.jsx("div",{className:"mt-2 p-3 bg-purple-50 rounded-lg border border-purple-200",children:(()=>{const r=k.find(g=>g._id===n.enrollments.orchestraIds[0]);return r?e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"font-medium text-purple-900",children:r.name}),e.jsxs("div",{className:"text-sm text-purple-700 space-y-1",children:[r.rehearsalSchedule&&e.jsxs("div",{className:"p-2 bg-purple-100 rounded",children:[e.jsx("strong",{children:"×–×× ×™ ×—×–×¨×•×ª:"})," ",r.rehearsalSchedule.day," ",r.rehearsalSchedule.startTime,"-",r.rehearsalSchedule.endTime,r.rehearsalSchedule.location&&e.jsxs("span",{children:[" | ",r.rehearsalSchedule.location]})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"×¡×•×’:"})," ",r.type||"×ª×–××•×¨×ª"]}),!r.rehearsalSchedule&&r.location&&e.jsxs("div",{children:[e.jsx("strong",{children:"××™×§×•×:"})," ",r.location]}),r.memberIds&&e.jsxs("div",{children:[e.jsx("strong",{children:"××¡×¤×¨ ×—×‘×¨×™×:"})," ",r.memberIds.length]}),e.jsxs("div",{children:[e.jsx("strong",{children:"×¡×˜×˜×•×¡:"})," ",r.isActive?"×¤×¢×™×œ":"×œ× ×¤×¢×™×œ"]}),r.rehearsalIds&&r.rehearsalIds.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"××¡×¤×¨ ×—×–×¨×•×ª ×©××•×¨×•×ª:"})," ",r.rehearsalIds.length]})]})]}):null})()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©×™×¢×•×¨ ×ª×™××•×¨×™×”"}),e.jsxs("select",{value:n.enrollments.theoryLessonIds[0]||"",onChange:r=>{o(g=>({...g,enrollments:{...g.enrollments,theoryLessonIds:r.target.value?[r.target.value]:[]}}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 text-gray-900",children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×©×™×¢×•×¨ ×ª×™××•×¨×™×”"}),p.map(r=>{const g=r.schedule&&r.schedule.length>0?r.schedule[0]:null,x=g?`${g.day} ${g.startTime}-${g.endTime}${g.location?` | ${g.location}`:""}`:"";return e.jsxs("option",{value:r._id,children:[r.name||r.title||r.category," ",x?`| ${x}`:"",r.teacher?.personalInfo?.fullName&&` | ××•×¨×”: ${r.teacher.personalInfo.fullName}`]},r._id)})]}),n.enrollments.theoryLessonIds[0]&&e.jsx("div",{className:"mt-2 p-3 bg-blue-50 rounded-lg border border-blue-200",children:(()=>{const r=p.find(g=>g._id===n.enrollments.theoryLessonIds[0]);return r?e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"font-medium text-blue-900",children:r.name}),e.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"×¨××”:"})," ",r.level]}),r.teacher?.personalInfo?.fullName&&e.jsxs("div",{children:[e.jsx("strong",{children:"××•×¨×”:"})," ",r.teacher.personalInfo.fullName]}),r.description&&e.jsxs("div",{children:[e.jsx("strong",{children:"×ª×™××•×¨:"})," ",r.description]}),r.maxStudents&&e.jsxs("div",{children:[e.jsx("strong",{children:"××§×¡×™××•× ×ª×œ××™×“×™×:"})," ",r.maxStudents]}),r.currentStudents!==void 0&&e.jsxs("div",{children:[e.jsx("strong",{children:"×ª×œ××™×“×™× × ×•×›×—×™×™×:"})," ",r.currentStudents,"/",r.maxStudents||"âˆ"]}),r.schedule&&r.schedule.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"×–×× ×™ ×©×™×¢×•×¨:"}),e.jsx("div",{className:"mt-1 space-y-1",children:r.schedule.map((g,x)=>e.jsxs("div",{className:"text-xs bg-blue-100 px-2 py-1 rounded",children:[g.day," ",g.startTime,"-",g.endTime,g.location&&` | ${g.location}`]},x))})]}),r.prerequisites&&e.jsxs("div",{className:"text-xs text-blue-600 mt-2",children:[e.jsx("strong",{children:"×“×¨×™×©×•×ª ×§×“×:"})," ",r.prerequisites]})]})]}):null})()})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-6",children:[e.jsx("button",{type:"button",onClick:a,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"×‘×™×˜×•×œ"}),e.jsx("button",{type:"submit",disabled:u,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"×©×•××¨..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ht,{className:"w-4 h-4"}),i?"×¢×“×›×Ÿ ×ª×œ××™×“":"×”×•×¡×£ ×ª×œ××™×“"]})})]}),e.jsx(Qs,{isOpen:J.isOpen,title:"×”×ª× ×’×©×•×ª ×‘×œ×•×— ×–×× ×™×",message:J.message,confirmText:"×”××©×š ×‘×›×œ ×–××ª",cancelText:"×‘×™×˜×•×œ",onConfirm:We,onCancel:ze,variant:"warning"})]})},it=["××•×œ× ×¢×¨×Ÿ","×¡×˜×•×“×™×• ×§×××¨×™ 1","×¡×˜×•×“×™×• ×§×××¨×™ 2","××•×œ×¤×Ÿ ×”×§×œ×˜×•×ª","×—×“×¨ ×—×–×¨×•×ª 1","×—×“×¨ ×—×–×¨×•×ª 2","×—×“×¨ ××—×©×‘×™×","×—×“×¨ 1","×—×“×¨ 2","×—×“×¨ ×—×–×¨×•×ª","×—×“×¨ 5","×—×“×¨ 6","×—×“×¨ 7","×—×“×¨ 8","×—×“×¨ 9","×—×“×¨ 10","×—×“×¨ 11","×—×“×¨ 12","×—×“×¨ 13","×—×“×¨ 14","×—×“×¨ 15","×—×“×¨ 16","×—×“×¨ 17","×—×“×¨ 18","×—×“×¨ 19","×—×“×¨ 20","×—×“×¨ 21","×—×“×¨ 22","×—×“×¨ 23","×—×“×¨ 24","×—×“×¨ 25","×—×“×¨ 26","×—×“×¨ ×ª××•×¨×™×” ×","×—×“×¨ ×ª××•×¨×™×” ×‘"],rr=["××•×¨×”","×× ×¦×—","××“×¨×™×š ×”×¨×›×‘","×× ×”×œ","××•×¨×” ×ª××•×¨×™×”","××’××”"],ar=["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™"],nr=["×—×œ×™×œ×™×ª","×—×œ×™×œ ×¦×“","××‘×•×‘","×‘×¡×•×Ÿ","×¡×§×¡×•×¤×•×Ÿ","×§×œ×¨×™× ×˜","×—×¦×•×¦×¨×”","×§×¨×Ÿ ×™×¢×¨","×˜×¨×•××‘×•×Ÿ","×˜×•×‘×”/×‘×¨×™×˜×•×Ÿ","×©×™×¨×”","×›×™× ×•×¨","×•×™×•×œ×”","×¦'×œ×•","×§×•× ×˜×¨×‘×¡","×¤×¡× ×ª×¨","×’×™×˜×¨×”","××•×¨×’×Ÿ","×—×¨××•× ×™×§×”","×× ×“×•×œ×™× ×”","×›×™× ×•×¨ ×‘××¨×•×§","×•×™×•×œ×” ×“×” ×’××‘×”","×¤×œ×•×˜×” ×¨×§×•×¨×“×¨","××•×§×¨×™× ×”","×—×œ×™×œ ×¤××Ÿ","×“×•×œ×¦×™××¨","××•×˜×•-×”×¨×¤","×¤×¡× ×ª×¨ ××œ×§×˜×¨×•× ×™","×’×™×˜×¨×” ×‘×¡","×’×™×˜×¨×” ××§×•×¡×˜×™×ª","×’×™×˜×¨×” ×§×œ××¡×™×ª","×‘× ×’×³×•","×—×œ×™×œ ××™×¨×™","×›×™× ×•×¨ ×§×œ×˜×™","×‘×•×“×”×¨××Ÿ"],ct=(t,s)=>{if(!t||!s)return 0;const[a,i]=t.split(":").map(Number),[n,o]=s.split(":").map(Number),l=a*60+i,f=n*60+o;return f<=l?0:f-l},Ct=(t,s)=>{if(!t||!s)return null;const a=ct(t,s);return a<=0?"×©×¢×ª ×”×¡×™×•× ×—×™×™×‘×ª ×œ×”×™×•×ª ××—×¨×™ ×©×¢×ª ×”×”×ª×—×œ×”":a<30?"×™×•× ×œ×™××•×“ ×—×™×™×‘ ×œ×”×™×•×ª ×œ×¤×—×•×ª 30 ×“×§×•×ª":a>480?"×™×•× ×œ×™××•×“ ×œ× ×™×›×•×œ ×œ×”×™×•×ª ×™×•×ª×¨ ×-8 ×©×¢×•×ª":null},or=({isOpen:t,onClose:s,onTeacherAdded:a,teacherToEdit:i,mode:n="add"})=>{const{currentSchoolYear:o}=Wt(),[l,f]=m.useState("personal"),[u,d]=m.useState({personalInfo:{fullName:"",phone:"",email:"",address:""},roles:[],professionalInfo:{instrument:"",isActive:!0},teaching:{schedule:[]},conducting:{orchestraIds:[]},ensemblesIds:[]}),[h,b]=m.useState([]),[D,T]=m.useState([]),[R,L]=m.useState(!1),[k,M]=m.useState({}),[p,j]=m.useState("");m.useEffect(()=>{t&&n==="edit"&&i?O(i):t&&n==="add"&&c()},[t,n,i]),m.useEffect(()=>{t&&C()},[t]);const C=async()=>{try{const[y,E]=await Promise.all([X.orchestras.getOrchestras(),X.orchestras.getOrchestras({type:"ensemble"})]);b(y||[]),T(E||[])}catch(y){console.error("Failed to load orchestras/ensembles:",y)}},O=y=>{d({personalInfo:{fullName:y.personalInfo?.fullName||"",phone:y.personalInfo?.phone||"",email:y.personalInfo?.email||"",address:y.personalInfo?.address||""},roles:y.roles||[],professionalInfo:{instrument:y.professionalInfo?.instrument||"",isActive:y.professionalInfo?.isActive??!0},teaching:{schedule:y.teaching?.schedule||[]},conducting:{orchestraIds:y.conducting?.orchestraIds||[]},ensemblesIds:y.ensemblesIds||[]})},_=()=>{const y={};return u.personalInfo.fullName.trim()||(y["personalInfo.fullName"]="×©× ××œ× × ×“×¨×©"),u.personalInfo.phone.match(/^05\d{8}$/)||(y["personalInfo.phone"]="××¡×¤×¨ ×˜×œ×¤×•×Ÿ ×—×™×™×‘ ×œ×”×™×•×ª ×‘×¤×•×¨××˜: 05XXXXXXXX"),u.personalInfo.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)||(y["personalInfo.email"]="×›×ª×•×‘×ª ××™××™×™×œ ×œ× ×ª×§×™× ×”"),u.personalInfo.address.trim()||(y["personalInfo.address"]="×›×ª×•×‘×ª × ×“×¨×©×ª"),u.roles.length===0&&(y.roles="×™×© ×œ×‘×—×•×¨ ×œ×¤×—×•×ª ×ª×¤×§×™×“ ××—×“"),(u.roles.includes("××•×¨×”")||u.roles.includes("××’××”")||!u.roles.includes("××•×¨×” ×ª××•×¨×™×”"))&&!u.professionalInfo.instrument&&(y["professionalInfo.instrument"]="×™×© ×œ×‘×—×•×¨ ×›×œ×™ × ×’×™× ×”"),u.teaching.schedule.forEach((I,$)=>{if(I.startTime||(y[`schedule.${$}.startTime`]="×©×¢×ª ×”×ª×—×œ×” × ×“×¨×©×ª"),I.endTime||(y[`schedule.${$}.endTime`]="×©×¢×ª ×¡×™×•× × ×“×¨×©×ª"),I.location?it.includes(I.location)||(y[`schedule.${$}.location`]="××™×§×•× ×œ× ×ª×§×™×Ÿ"):y[`schedule.${$}.location`]="×™×© ×œ×‘×—×•×¨ ××™×§×•×",I.startTime&&I.endTime){const G=Ct(I.startTime,I.endTime);G&&(y[`schedule.${$}.timeRange`]=G)}}),M(y),Object.keys(y).length===0},F=(y,E,I)=>{d(G=>({...G,[y]:{...G[y],[E]:I}}));const $=`${y}.${E}`;k[$]&&M(G=>{const q={...G};return delete q[$],q})},S=(y,E)=>{const I=E?[...u.roles,y]:u.roles.filter($=>$!==y);d($=>({...$,roles:I})),k.roles&&M($=>{const G={...$};return delete G.roles,G})},P=()=>{const y={day:"×¨××©×•×Ÿ",startTime:"14:00",endTime:"15:30",location:"",notes:""};d(E=>({...E,teaching:{...E.teaching,schedule:[...E.teaching.schedule,y]}}))},A=y=>{d(E=>({...E,teaching:{...E.teaching,schedule:E.teaching.schedule.filter((I,$)=>$!==y)}}))},B=(y,E,I)=>{d($=>({...$,teaching:{...$.teaching,schedule:$.teaching.schedule.map((G,q)=>q===y?{...G,[E]:I}:G)}}))},J=async y=>{if(y.preventDefault(),!!_()){L(!0),j("");try{const E={personalInfo:u.personalInfo,roles:u.roles,professionalInfo:u.professionalInfo,teaching:{studentIds:[],schedule:u.teaching.schedule.map(I=>({day:I.day,startTime:I.startTime,endTime:I.endTime,duration:ct(I.startTime,I.endTime),location:I.location||null,notes:I.notes||null,isAvailable:!0,studentId:null,recurring:{isRecurring:!0,excludeDates:[]}}))},conducting:u.conducting,ensemblesIds:u.ensemblesIds,schoolYears:o?[{schoolYearId:o._id,isActive:!0}]:[],credentials:{email:u.personalInfo.email,password:null,isInvitationAccepted:!1},isActive:!0};if(n==="edit"&&i){console.log("ğŸ”„ Updating teacher:",E);const I=await X.teachers.updateTeacher(i._id,E);console.log("âœ… Teacher updated successfully:",I),a(I)}else{console.log("ğŸ”„ Creating teacher:",E);const I=await X.teachers.addTeacher(E);console.log("âœ… Teacher created successfully:",I),a(I)}c(),s()}catch(E){console.error(`âŒ Failed to ${n==="edit"?"update":"create"} teacher:`,E),j(E.message||`×©×’×™××” ×‘${n==="edit"?"×¢×“×›×•×Ÿ":"×™×¦×™×¨×ª"} ×”××•×¨×”. × ×¡×” ×©×•×‘.`)}finally{L(!1)}}},c=()=>{d({personalInfo:{fullName:"",phone:"",email:"",address:""},roles:[],professionalInfo:{instrument:"",isActive:!0},teaching:{schedule:[]},conducting:{orchestraIds:[]},ensemblesIds:[]}),f("personal"),M({}),j("")},w=()=>{c(),s()};if(!t)return null;const U=[{id:"personal",label:"××™×“×¢ ××™×©×™",icon:he},{id:"professional",label:"××™×“×¢ ××§×¦×•×¢×™",icon:ws},{id:"schedule",label:"×œ×•×— ×–×× ×™×",icon:ee},{id:"conducting",label:"× ×™×¦×•×—",icon:ot}];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl h-[85vh] overflow-hidden border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:n==="edit"?"×¢×¨×™×›×ª ×¤×¨×˜×™ ××•×¨×”":"×”×•×¡×¤×ª ××•×¨×” ×—×“×©"}),e.jsx("button",{onClick:w,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(me,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:U.map(({id:y,label:E,icon:I})=>e.jsxs("button",{onClick:()=>f(y),className:`flex items-center gap-2 py-4 px-2 border-b-2 font-medium text-sm ${l===y?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(I,{className:"w-4 h-4"}),E]},y))})}),e.jsxs("form",{onSubmit:J,children:[e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[l==="personal"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©× ××œ× *"}),e.jsx("input",{type:"text",value:u.personalInfo.fullName,onChange:y=>F("personalInfo","fullName",y.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 text-gray-900 placeholder-gray-500 bg-white ${k["personalInfo.fullName"]?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-primary-500"}`,placeholder:"×”×›× ×¡ ×©× ××œ×"}),k["personalInfo.fullName"]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k["personalInfo.fullName"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×˜×œ×¤×•×Ÿ *"}),e.jsx("input",{type:"tel",value:u.personalInfo.phone,onChange:y=>F("personalInfo","phone",y.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 text-gray-900 placeholder-gray-500 bg-white ${k["personalInfo.phone"]?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-primary-500"}`,placeholder:"05XXXXXXXX"}),k["personalInfo.phone"]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k["personalInfo.phone"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"××™××™×™×œ *"}),e.jsx("input",{type:"email",value:u.personalInfo.email,onChange:y=>F("personalInfo","email",y.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 text-gray-900 placeholder-gray-500 bg-white ${k["personalInfo.email"]?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-primary-500"}`,placeholder:"teacher@example.com"}),k["personalInfo.email"]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k["personalInfo.email"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×›×ª×•×‘×ª *"}),e.jsx("input",{type:"text",value:u.personalInfo.address,onChange:y=>F("personalInfo","address",y.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 text-gray-900 placeholder-gray-500 bg-white ${k["personalInfo.address"]?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-primary-500"}`,placeholder:"×¨×—×•×‘ ××¡×¤×¨, ×¢×™×¨"}),k["personalInfo.address"]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k["personalInfo.address"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"×ª×¤×§×™×“×™× *"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:rr.map(y=>e.jsxs("label",{className:"flex items-center p-2 hover:bg-gray-50 rounded-lg cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:u.roles.includes(y),onChange:E=>S(y,E.target.checked),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500 w-4 h-4"}),e.jsx("span",{className:"mr-3 text-sm text-gray-700 font-medium",children:y})]},y))}),k.roles&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k.roles})]})]}),l==="professional"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["×›×œ×™ × ×’×™× ×” ",!u.roles.includes("××•×¨×” ×ª××•×¨×™×”")&&"*"]}),e.jsxs("select",{value:u.professionalInfo.instrument,onChange:y=>F("professionalInfo","instrument",y.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 text-gray-900 bg-white ${k["professionalInfo.instrument"]?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-primary-500"}`,disabled:u.roles.includes("××•×¨×” ×ª××•×¨×™×”")&&u.roles.length===1,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×›×œ×™ × ×’×™× ×”"}),nr.map(y=>e.jsx("option",{value:y,children:y},y))]}),k["professionalInfo.instrument"]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k["professionalInfo.instrument"]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:u.professionalInfo.isActive,onChange:y=>F("professionalInfo","isActive",y.target.checked),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"××•×¨×” ×¤×¢×™×œ"})]})})]}),l==="schedule"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"×‘×œ×•×§×™ ×–××Ÿ ×œ×”×•×¨××”"}),e.jsxs("button",{type:"button",onClick:P,className:"flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(pe,{className:"w-4 h-4 ml-2"}),"×”×•×¡×£ ×‘×œ×•×§ ×–××Ÿ"]})]}),u.teaching.schedule.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ee,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"×œ× ×”×•×’×“×¨×• ×‘×œ×•×§×™ ×–××Ÿ"}),e.jsx("p",{className:"text-sm",children:"×”×•×¡×£ ×‘×œ×•×§ ×–××Ÿ ×›×“×™ ×œ×§×‘×•×¢ ××ª×™ ×”××•×¨×” ×–××™×Ÿ ×œ×”×•×¨××”"})]}):e.jsx("div",{className:"space-y-4",children:u.teaching.schedule.map((y,E)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×™×•×"}),e.jsx("select",{value:y.day,onChange:I=>B(E,"day",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900 bg-white",children:ar.map(I=>e.jsx("option",{value:I,children:I},I))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×©×¢×ª ×”×ª×—×œ×”"}),e.jsx("input",{type:"time",value:y.startTime,onChange:I=>B(E,"startTime",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900 bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×©×¢×ª ×¡×™×•×"}),e.jsx("input",{type:"time",value:y.endTime,onChange:I=>B(E,"endTime",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900 bg-white"}),y.startTime&&y.endTime&&e.jsx("div",{className:"mt-1 text-xs",children:(()=>{const I=ct(y.startTime,y.endTime),$=Ct(y.startTime,y.endTime);return $?e.jsx("span",{className:"text-red-600",children:$}):I>0?e.jsxs("span",{className:"text-gray-500",children:["××©×š: ",I," ×“×§×•×ª"]}):null})()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"××™×§×•×"}),e.jsxs("select",{value:y.location,onChange:I=>B(E,"location",I.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900 bg-white ${k[`schedule.${E}.location`]?"border-red-300 focus:ring-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ××™×§×•×..."}),it.map(I=>e.jsx("option",{value:I,children:I},I))]}),k[`schedule.${E}.location`]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k[`schedule.${E}.location`]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×”×¢×¨×•×ª"}),e.jsx("input",{type:"text",value:y.notes,onChange:I=>B(E,"notes",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900 placeholder-gray-500 bg-white",placeholder:"×”×¢×¨×•×ª × ×•×¡×¤×•×ª"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"button",onClick:()=>A(E),className:"flex items-center px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[e.jsx(nt,{className:"w-4 h-4 ml-1"}),"×”×¡×¨"]})})]},E))})]}),l==="conducting"&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl p-6 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx(ot,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-gray-900",children:"×ª×–××•×¨×•×ª ×œ× ×™×¦×•×—"}),e.jsx("p",{className:"text-sm text-gray-600",children:"×‘×—×¨ ××ª ×”×ª×–××•×¨×•×ª ×©×”××•×¨×” ×™× ×¦×—"})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3 max-h-64 overflow-y-auto",children:h.map(y=>e.jsxs("label",{className:"flex items-center p-4 bg-white border-2 border-gray-200 rounded-xl hover:border-purple-300 hover:shadow-md transition-all duration-200 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:u.conducting.orchestraIds.includes(y._id),onChange:E=>{const I=E.target.checked?[...u.conducting.orchestraIds,y._id]:u.conducting.orchestraIds.filter($=>$!==y._id);F("conducting","orchestraIds",I)},className:"rounded-lg border-gray-300 text-purple-600 focus:ring-purple-500 w-5 h-5"}),e.jsxs("div",{className:"mr-4 flex-1",children:[e.jsx("div",{className:"text-base font-semibold text-gray-900 group-hover:text-purple-700 transition-colors",children:y.name}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:y.description||"×ª×–××•×¨×ª ×œ×œ× ×ª×™××•×¨"}),y.memberCount&&e.jsxs("div",{className:"text-xs text-purple-600 mt-1",children:["ğŸ‘¥ ",y.memberCount," ×—×‘×¨×™×"]})]})]},y._id))})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-teal-50 rounded-xl p-6 border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(he,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-gray-900",children:"×× ×¡××‘×œ×™× ×œ×”×“×¨×›×”"}),e.jsx("p",{className:"text-sm text-gray-600",children:"×‘×—×¨ ××ª ×”×× ×¡××‘×œ×™× ×©×”××•×¨×” ×™×“×¨×™×š"})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3 max-h-64 overflow-y-auto",children:D.map(y=>e.jsxs("label",{className:"flex items-center p-4 bg-white border-2 border-gray-200 rounded-xl hover:border-green-300 hover:shadow-md transition-all duration-200 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:u.ensemblesIds.includes(y._id),onChange:E=>{const I=E.target.checked?[...u.ensemblesIds,y._id]:u.ensemblesIds.filter($=>$!==y._id);d($=>({...$,ensemblesIds:I}))},className:"rounded-lg border-gray-300 text-green-600 focus:ring-green-500 w-5 h-5"}),e.jsxs("div",{className:"mr-4 flex-1",children:[e.jsx("div",{className:"text-base font-semibold text-gray-900 group-hover:text-green-700 transition-colors",children:y.name}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:y.description||"×× ×¡××‘×œ ×œ×œ× ×ª×™××•×¨"}),y.memberCount&&e.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["ğŸµ ",y.memberCount," ×—×‘×¨×™×"]})]})]},y._id))})]})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200",children:[p&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-start gap-2",children:[e.jsx(mt,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm text-red-700",children:p})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:w,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",disabled:R,children:"×‘×™×˜×•×œ"}),e.jsxs("button",{type:"submit",disabled:R,className:"flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[R?e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin ml-2"}):e.jsx(ht,{className:"w-4 h-4 ml-2"}),R?"×©×•××¨...":n==="edit"?"×¢×“×›×Ÿ ××•×¨×”":"×©××•×¨ ××•×¨×”"]})]})]})]})]})})};function lr({theoryLesson:t,theoryLessons:s,teachers:a,onSubmit:i,onCancel:n,mode:o="create"}){const[l,f]=m.useState("single"),[u,d]=m.useState({category:"××’××”",teacherId:"",date:"",dayOfWeek:0,startTime:"14:00",endTime:"15:00",location:"××•×œ× ×¢×¨×Ÿ",studentIds:[],attendance:{present:[],absent:[]},notes:"",syllabus:"",homework:"",schoolYearId:""}),[h,b]=m.useState({category:"××’××”",teacherId:"",startDate:"",endDate:"",dayOfWeek:0,startTime:"14:00",endTime:"15:00",location:"××•×œ× ×¢×¨×Ÿ",studentIds:[],notes:"",syllabus:"",excludeDates:[],schoolYearId:""}),[D,T]=m.useState(a||[]),[R,L]=m.useState(!1),[k,M]=m.useState(!1),[p,j]=m.useState(""),[C,O]=m.useState(""),_=["×ª×œ××™×“×™× ×—×“×©×™× ×‘-×“","××ª×—×™×œ×™×","××ª×—×™×œ×™× ×‘","××ª×—×™×œ×™× ×“","××ª×§×“××™× ×‘","××ª×§×“××™× ×","××ª×§×“××™× ×’","×ª×œ××™×“×™× ×—×“×©×™× ×‘×•×’×¨×™× (×” - ×˜)","×ª×œ××™×“×™× ×—×“×©×™× ×¦×¢×™×¨×™×","×”×›× ×” ×œ×¨×¡×™×˜×œ ×§×œ××¡×™ ×™×","×”×›× ×” ×œ×¨×¡×™×˜×œ ×¨×•×§\\×¤×•×¤\\×’'××– ×™×","×”×›× ×” ×œ×¨×¡×™×˜×œ ×¨×•×§\\×¤×•×¤\\×’'××– ×™×‘","××’××”","×ª××•×¨×™×” ×›×œ×™"],F={0:"×¨××©×•×Ÿ",1:"×©× ×™",2:"×©×œ×™×©×™",3:"×¨×‘×™×¢×™",4:"×—××™×©×™",5:"×©×™×©×™",6:"×©×‘×ª"};m.useEffect(()=>{a||S(),P()},[a]),m.useEffect(()=>{if(o==="edit"&&t){const c=new Date(t.date);d({category:t.category||"××’××”",teacherId:t.teacherId||"",date:t.date?new Date(t.date).toISOString().split("T")[0]:"",dayOfWeek:t.dayOfWeek!==void 0?t.dayOfWeek:c.getDay(),startTime:t.startTime||"14:00",endTime:t.endTime||"15:00",location:t.location||"××•×œ× ×¢×¨×Ÿ",studentIds:t.studentIds||[],attendance:t.attendance||{present:[],absent:[]},notes:t.notes||"",syllabus:t.syllabus||"",homework:t.homework||"",schoolYearId:t.schoolYearId||""}),b(w=>({...w,category:t.category||"××’××”",teacherId:t.teacherId||"",location:t.location||"××•×œ× ×¢×¨×Ÿ",startTime:t.startTime||"14:00",endTime:t.endTime||"15:00",notes:t.notes||"",syllabus:t.syllabus||"",schoolYearId:t.schoolYearId||""}))}else if(o==="bulk-edit"&&s&&s.length>0){const c=s[0],w=s.every(q=>q.category===c.category)?c.category:"",U=s.every(q=>q.teacherId===c.teacherId)?c.teacherId:"",y=s.every(q=>q.location===c.location)?c.location:"",E=s.every(q=>q.startTime===c.startTime)?c.startTime:"",I=s.every(q=>q.endTime===c.endTime)?c.endTime:"",$=s.every(q=>q.notes===c.notes)?c.notes:"",G=s.every(q=>q.syllabus===c.syllabus)?c.syllabus:"";b({category:w||"××’××”",teacherId:U||"",startDate:"",endDate:"",dayOfWeek:0,startTime:E||"14:00",endTime:I||"15:00",location:y||"××•×œ× ×¢×¨×Ÿ",studentIds:[],notes:$||"",syllabus:G||"",excludeDates:[],schoolYearId:c.schoolYearId||""})}},[t,s,o]);const S=async()=>{try{const w=(await bs.getTeachers()).filter(U=>U.roles&&U.roles.includes("××•×¨×” ×ª××•×¨×™×”"));T(w)}catch(c){console.error("Error loading teachers:",c)}},P=async()=>{try{const c=await js.getCurrentSchoolYear();c&&(u.schoolYearId||d(w=>({...w,schoolYearId:c._id})),h.schoolYearId||b(w=>({...w,schoolYearId:c._id})))}catch(c){console.error("Error loading current school year:",c)}},A=(c,w)=>{if(o==="edit"||o==="create"&&l==="single"){if(d(U=>({...U,[c]:w})),c==="date"&&w){const y=new Date(w).getDay();d(E=>({...E,date:w,dayOfWeek:y}))}}else b(U=>({...U,[c]:w}))},B=()=>{if(l==="single"){if(!u.category.trim())return j("×™×© ×œ×‘×—×•×¨ ×§×˜×’×•×¨×™×” ×œ×©×™×¢×•×¨"),!1;if(!u.teacherId)return j("×™×© ×œ×‘×—×•×¨ ××•×¨×” ×œ×©×™×¢×•×¨"),!1;if(!u.date)return j("×™×© ×œ×‘×—×•×¨ ×ª××¨×™×š ×œ×©×™×¢×•×¨"),!1;if(!u.startTime||!u.endTime)return j("×™×© ×œ×”×–×™×Ÿ ×©×¢×•×ª ×”×ª×—×œ×” ×•×¡×™×•×"),!1;if(!u.location.trim())return j("×™×© ×œ×”×–×™×Ÿ ××™×§×•× ×œ×©×™×¢×•×¨"),!1;const c=u.startTime.split(":").map(Number),w=u.endTime.split(":").map(Number),U=c[0]*60+c[1];if(w[0]*60+w[1]<=U)return j("×©×¢×ª ×”×¡×™×•× ×—×™×™×‘×ª ×œ×”×™×•×ª ××—×¨×™ ×©×¢×ª ×”×”×ª×—×œ×”"),!1}else{if(!h.category.trim())return j("×™×© ×œ×‘×—×•×¨ ×§×˜×’×•×¨×™×” ×œ×©×™×¢×•×¨×™×"),!1;if(!h.teacherId)return j("×™×© ×œ×‘×—×•×¨ ××•×¨×” ×œ×©×™×¢×•×¨×™×"),!1;if(!h.startDate||!h.endDate)return j("×™×© ×œ×‘×—×•×¨ ×ª××¨×™×›×™ ×”×ª×—×œ×” ×•×¡×™×•×"),!1;if(!h.startTime||!h.endTime)return j("×™×© ×œ×”×–×™×Ÿ ×©×¢×•×ª ×”×ª×—×œ×” ×•×¡×™×•×"),!1;if(!h.location.trim())return j("×™×© ×œ×”×–×™×Ÿ ××™×§×•× ×œ×©×™×¢×•×¨×™×"),!1;if(h.dayOfWeek<0||h.dayOfWeek>6)return j("×™×© ×œ×‘×—×•×¨ ×™×•× ×‘×©×‘×•×¢"),!1;if(!h.schoolYearId)return j("×™×© ×œ×‘×—×•×¨ ×©× ×ª ×œ×™××•×“×™×"),!1;if(new Date(h.endDate)<=new Date(h.startDate))return j("×ª××¨×™×š ×”×¡×™×•× ×—×™×™×‘ ×œ×”×™×•×ª ××—×¨×™ ×ª××¨×™×š ×”×”×ª×—×œ×”"),!1;const c=h.startTime.split(":").map(Number),w=h.endTime.split(":").map(Number),U=c[0]*60+c[1];if(w[0]*60+w[1]<=U)return j("×©×¢×ª ×”×¡×™×•× ×—×™×™×‘×ª ×œ×”×™×•×ª ××—×¨×™ ×©×¢×ª ×”×”×ª×—×œ×”"),!1}return!0},J=async c=>{if(c.preventDefault(),j(""),O(""),!!B()){L(!0);try{if(o==="edit"){const w={...u,date:new Date(u.date+"T"+u.startTime+":00.000Z").toISOString(),mode:"edit",lessonId:t?._id};await i(w),O("×©×™×¢×•×¨ ×”×ª×™××•×¨×™×” ×¢×•×“×›×Ÿ ×‘×”×¦×œ×—×”")}else if(o==="bulk-edit"){const w={};h.category&&h.category.trim()&&(w.category=h.category),h.teacherId&&h.teacherId.trim()&&(w.teacherId=h.teacherId),h.location&&h.location.trim()&&(w.location=h.location),h.startTime&&h.startTime.trim()&&(w.startTime=h.startTime),h.endTime&&h.endTime.trim()&&(w.endTime=h.endTime),h.notes&&h.notes.trim()&&(w.notes=h.notes),h.syllabus&&h.syllabus.trim()&&(w.syllabus=h.syllabus);const U={mode:"bulk-edit",lessonIds:s?.map(y=>y._id)||[],updateData:w};await i(U),O(`${s?.length||0} ×©×™×¢×•×¨×™ ×ª×™××•×¨×™×” ×¢×•×“×›× ×• ×‘×”×¦×œ×—×”`)}else if(l==="single"){const w={...u,date:new Date(u.date+"T"+u.startTime+":00.000Z").toISOString(),mode:"create"};await i(w),O("×©×™×¢×•×¨ ×”×ª×™××•×¨×™×” × ×•×¦×¨ ×‘×”×¦×œ×—×”")}else{const w={...h,isBulk:!0,mode:"bulk-create"};console.log("ğŸš€ Bulk theory lesson creation data:",JSON.stringify(w,null,2));const y=["category","teacherId","startDate","endDate","dayOfWeek","startTime","endTime","location","schoolYearId"].filter(E=>{const I=w[E];return I==null||typeof I=="string"&&I.trim()===""});if(y.length>0){console.error("âŒ Missing required fields:",y),j(`×—×¡×¨×™× ×©×“×•×ª ×—×•×‘×”: ${y.join(", ")}`);return}await i(w),O("×¨×¦×£ ×©×™×¢×•×¨×™ ×”×ª×™××•×¨×™×” × ×•×¦×¨ ×‘×”×¦×œ×—×”")}}catch(w){console.error("Error submitting theory lesson form:",w),j(w.message||"×©×’×™××” ×‘×©××™×¨×ª ×”×©×™×¢×•×¨")}finally{L(!1)}}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:o==="edit"?"×¢×¨×™×›×ª ×©×™×¢×•×¨ ×ª×™××•×¨×™×”":o==="bulk-edit"?"×¢×¨×™×›×” ×§×‘×•×¦×ª×™×ª ×©×œ ×©×™×¢×•×¨×™ ×ª×™××•×¨×™×”":"×©×™×¢×•×¨ ×ª×™××•×¨×™×” ×—×“×©"}),e.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(me,{className:"w-5 h-5 text-gray-500"})})]}),o==="create"&&e.jsxs("div",{className:"flex space-x-4 rtl:space-x-reverse",children:[e.jsxs("button",{type:"button",onClick:()=>f("single"),className:`flex items-center px-4 py-2 rounded-lg font-medium transition-colors ${l==="single"?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(ee,{className:"w-4 h-4 ml-2"}),"×©×™×¢×•×¨ ×‘×•×“×“"]}),e.jsxs("button",{type:"button",onClick:()=>f("bulk"),className:`flex items-center px-4 py-2 rounded-lg font-medium transition-colors ${l==="bulk"?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(Ts,{className:"w-4 h-4 ml-2"}),"×¨×¦×£ ×©×™×¢×•×¨×™×"]})]}),o==="bulk-edit"&&s&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"w-5 h-5 text-blue-600 ml-2"}),e.jsxs("p",{className:"text-blue-800",children:["×¢×¨×™×›×” ×§×‘×•×¦×ª×™×ª ×©×œ ",s.length," ×©×™×¢×•×¨×™ ×ª×™××•×¨×™×”"]})]}),e.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"×©×“×•×ª ×¨×™×§×™× ×™×™×©××¨×• ×œ×œ× ×©×™× ×•×™, ×¨×§ ×©×“×•×ª ×©×™××•×œ××• ×™×¢×•×“×›× ×•"})]})]}),e.jsxs("form",{onSubmit:J,className:"p-6 space-y-6",children:[k&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 ml-2"}),e.jsx("p",{className:"text-blue-800 text-sm",children:"×˜×•×¢×Ÿ × ×ª×•× ×™ ×©×™×¢×•×¨..."})]})}),C&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsx("p",{className:"text-green-800 text-sm",children:C})}),p&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800 text-sm",children:p})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ke,{className:"w-4 h-4 inline ml-1"}),"×§×˜×’×•×¨×™×” *"]}),e.jsxs("select",{value:o==="edit"||o==="create"&&l==="single"?u.category:h.category,onChange:c=>A("category",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:o!=="bulk-edit",children:[o==="bulk-edit"&&e.jsx("option",{value:"",children:"×”×©××¨ ×œ×œ× ×©×™× ×•×™"}),_.map(c=>e.jsx("option",{value:c,children:c},c))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"××•×¨×” *"}),e.jsxs("select",{value:o==="edit"||o==="create"&&l==="single"?u.teacherId:h.teacherId,onChange:c=>A("teacherId",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:o!=="bulk-edit",children:[e.jsx("option",{value:"",children:o==="bulk-edit"?"×”×©××¨ ×œ×œ× ×©×™× ×•×™":"×‘×—×¨ ××•×¨×”"}),D.map(c=>e.jsx("option",{value:c._id,children:c.personalInfo?.fullName},c._id))]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Se,{className:"w-4 h-4 inline ml-1"}),"××™×§×•× *"]}),e.jsxs("select",{value:o==="edit"||o==="create"&&l==="single"?u.location:h.location,onChange:c=>A("location",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:o!=="bulk-edit",children:[o==="bulk-edit"&&e.jsx("option",{value:"",children:"×”×©××¨ ×œ×œ× ×©×™× ×•×™"}),it.map(c=>e.jsx("option",{value:c,children:c},c))]})]}),o==="edit"||o==="create"&&l==="single"?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª××¨×™×š *"}),e.jsx("input",{type:"date",value:u.date,onChange:c=>A("date",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×™×•× ×‘×©×‘×•×¢"}),e.jsx("input",{type:"text",value:F[u.dayOfWeek]||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-700",disabled:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(oe,{className:"w-4 h-4 inline ml-1"}),"×©×¢×ª ×”×ª×—×œ×” *"]}),e.jsx("input",{type:"time",value:u.startTime,onChange:c=>A("startTime",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©×¢×ª ×¡×™×•× *"}),e.jsx("input",{type:"time",value:u.endTime,onChange:c=>A("endTime",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0})]})]}):o==="bulk-edit"?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(oe,{className:"w-4 h-4 inline ml-1"}),"×©×¢×ª ×”×ª×—×œ×”"]}),e.jsx("input",{type:"time",value:h.startTime,onChange:c=>A("startTime",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",placeholder:"×”×©××¨ ×œ×œ× ×©×™× ×•×™"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©×¢×ª ×¡×™×•×"}),e.jsx("input",{type:"time",value:h.endTime,onChange:c=>A("endTime",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",placeholder:"×”×©××¨ ×œ×œ× ×©×™× ×•×™"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª××¨×™×š ×”×ª×—×œ×” *"}),e.jsx("input",{type:"date",value:h.startDate,onChange:c=>A("startDate",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª××¨×™×š ×¡×™×•× *"}),e.jsx("input",{type:"date",value:h.endDate,onChange:c=>A("endDate",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×™×•× ×‘×©×‘×•×¢ *"}),e.jsx("select",{value:h.dayOfWeek,onChange:c=>A("dayOfWeek",parseInt(c.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0,children:Object.entries(F).map(([c,w])=>e.jsx("option",{value:c,children:w},c))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(oe,{className:"w-4 h-4 inline ml-1"}),"×©×¢×ª ×”×ª×—×œ×” *"]}),e.jsx("input",{type:"time",value:h.startTime,onChange:c=>A("startTime",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©×¢×ª ×¡×™×•× *"}),e.jsx("input",{type:"time",value:h.endTime,onChange:c=>A("endTime",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",required:!0})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×¡×™×œ×‘×•×¡"}),e.jsx("textarea",{value:o==="edit"||o==="create"&&l==="single"?u.syllabus:h.syllabus,onChange:c=>A("syllabus",c.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",placeholder:o==="bulk-edit"?"×”×©××¨ ×œ×œ× ×©×™× ×•×™ - × ×•×©××™ ×”×©×™×¢×•×¨...":o==="edit"||l==="single"?"× ×•×©××™ ×”×©×™×¢×•×¨...":"× ×•×©××™ ×”×©×™×¢×•×¨×™×..."})]}),o==="edit"||o==="create"&&l==="single"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©×™×¢×•×¨×™ ×‘×™×ª"}),e.jsx("textarea",{value:u.homework,onChange:c=>A("homework",c.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",placeholder:"××©×™××•×ª ×œ×‘×™×ª..."})]}):null,e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×”×¢×¨×•×ª"}),e.jsx("textarea",{value:o==="edit"||o==="create"&&l==="single"?u.notes:h.notes,onChange:c=>A("notes",c.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900",placeholder:o==="bulk-edit"?"×”×©××¨ ×œ×œ× ×©×™× ×•×™ - ×”×¢×¨×•×ª ×›×œ×œ×™×•×ª...":"×”×¢×¨×•×ª ×›×œ×œ×™×•×ª..."})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",disabled:R,children:"×‘×™×˜×•×œ"}),e.jsxs("button",{type:"submit",disabled:R,className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50",children:[R?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white ml-2"}):e.jsx(ht,{className:"w-4 h-4 ml-2"}),o==="edit"?"×¢×“×›×Ÿ ×©×™×¢×•×¨":o==="bulk-edit"?"×¢×“×›×Ÿ ×©×™×¢×•×¨×™×":l==="single"?"×¦×•×¨ ×©×™×¢×•×¨":"×¦×•×¨ ×¨×¦×£ ×©×™×¢×•×¨×™×"]})]})]})]})})}const qt={0:"×¨××©×•×Ÿ",1:"×©× ×™",2:"×©×œ×™×©×™",3:"×¨×‘×™×¢×™",4:"×—××™×©×™",5:"×©×™×©×™",6:"×©×‘×ª"},ir=Object.entries(qt).map(([t,s])=>({value:parseInt(t),label:s})),ft=t=>qt[t]||"×œ× ×™×“×•×¢",cr=t=>{const s=new Date(t.date).toLocaleDateString("he-IL"),a=`${t.startTime} - ${t.endTime}`,i=ft(t.dayOfWeek),n=`${i}, ${s} ${a}`;return{date:s,time:a,dayName:i,fullDateTime:n}},Le=(t,s)=>{const a=ue(t);return ue(s)-a},ue=t=>{const[s,a]=t.split(":").map(Number);return s*60+a},Dt=t=>{const s=t.attendance?.present?.length||0,a=t.attendance?.absent?.length||0,i=t.orchestra?.memberIds?.length||s+a,n=i>0?Math.round(s/i*100):0;return{presentCount:s,absentCount:a,totalMembers:i,attendanceRate:n,hasAttendanceData:s>0||a>0}},dr=t=>{if(!t.isActive)return{status:"cancelled",text:"×‘×•×˜×œ×”",colorClass:"bg-gray-100 text-gray-800"};const s=new Date;new Date(t.date);const a=new Date(`${t.date}T${t.startTime}:00`),i=new Date(`${t.date}T${t.endTime}:00`);return s<a?{status:"upcoming",text:"×¢×ª×™×“×”",colorClass:"bg-blue-100 text-blue-800"}:s>=a&&s<=i?{status:"in_progress",text:"××ª×§×™×™××ª ×›×¢×ª",colorClass:"bg-green-100 text-green-800"}:{status:"completed",text:"×”×¡×ª×™×™××”",colorClass:"bg-orange-100 text-orange-800"}},Et=(t,s)=>{if(t.date!==s.date)return{hasConflict:!1,conflictType:"none",severity:"none",message:""};if(t.groupId===s.groupId)return{hasConflict:!1,conflictType:"none",severity:"none",message:"××•×ª×” ×ª×–××•×¨×ª"};const a=ue(t.startTime),i=ue(t.endTime),n=ue(s.startTime),o=ue(s.endTime);if(a<o&&n<i){if(t.location===s.location)return{hasConflict:!0,conflictType:"location",severity:"critical",message:`×—×¤×™×¤×” ×‘××™×§×•×: ${t.location}`};const f=t.orchestra?.conductor?._id,u=s.orchestra?.conductor?._id;if(f&&u&&f===u)return{hasConflict:!0,conflictType:"conductor",severity:"critical",message:"××•×ª×• ×× ×¦×— ×‘×©× ×™ ××§×•××•×ª"};const d=new Set(t.orchestra?.memberIds||[]),h=new Set(s.orchestra?.memberIds||[]),b=[...d].filter(D=>h.has(D));return b.length>0?{hasConflict:!0,conflictType:"members",severity:"warning",message:`${b.length} ×—×‘×¨×™× ××©×•×ª×¤×™×`}:{hasConflict:!0,conflictType:"time",severity:"warning",message:"×—×¤×™×¤×ª ×–×× ×™×"}}return{hasConflict:!1,conflictType:"none",severity:"none",message:""}},Ya=(t,s)=>t.filter(a=>{if(s.searchQuery){const i=s.searchQuery.toLowerCase();if(!(a.orchestra?.name?.toLowerCase().includes(i)||a.location?.toLowerCase().includes(i)||a.notes?.toLowerCase().includes(i)||ft(a.dayOfWeek).toLowerCase().includes(i)))return!1}if(s.orchestraId&&a.groupId!==s.orchestraId||s.type&&a.type!==s.type||s.dayOfWeek!==""&&s.dayOfWeek!==void 0&&a.dayOfWeek!==s.dayOfWeek||s.location&&a.location!==s.location)return!1;if(s.startDate){const i=new Date(a.date),n=new Date(s.startDate);if(i<n)return!1}if(s.endDate){const i=new Date(a.date),n=new Date(s.endDate);if(i>n)return!1}return!(s.status&&s.status!=="all"&&dr(a).status!==s.status||s.isActive!==void 0&&a.isActive!==s.isActive)}),Ha=(t,s="date",a="asc")=>[...t].sort((n,o)=>{let l=0;switch(s){case"date":l=new Date(n.date).getTime()-new Date(o.date).getTime();break;case"time":l=ue(n.startTime)-ue(o.startTime);break;case"orchestra":const f=n.orchestra?.name||"",u=o.orchestra?.name||"";l=f.localeCompare(u,"he");break;case"location":l=n.location.localeCompare(o.location,"he");break;case"attendance":const d=Dt(n).attendanceRate,h=Dt(o).attendanceRate;l=d-h;break;case"duration":const b=Le(n.startTime,n.endTime),D=Le(o.startTime,o.endTime);l=b-D;break;default:l=0}return a==="desc"?-l:l}),ur=t=>{const s=[],a=new Date(t.startDate),i=new Date(t.endDate),n=t.dayOfWeek,o=new Set(t.excludeDates||[]),l=new Date(a);for(;l.getDay()!==n&&l<=i;)l.setDate(l.getDate()+1);for(;l<=i;){const f=l.toISOString().split("T")[0];o.has(f)||s.push(f),l.setDate(l.getDate()+7)}return s},mr=t=>{const s={};if(t.groupId?.trim()||(s.groupId="×™×© ×œ×‘×—×•×¨ ×ª×–××•×¨×ª"),t.type||(s.type="×™×© ×œ×‘×—×•×¨ ×¡×•×’ ×”×¨×›×‘"),!t.date)s.date="×™×© ×œ×‘×—×•×¨ ×ª××¨×™×š";else{const a=new Date(t.date),i=new Date;i.setHours(0,0,0,0),a<i&&(s.date="×œ× × ×™×ª×Ÿ ×œ×§×‘×•×¢ ×—×–×¨×” ×‘×¢×‘×¨")}if(t.startTime||(s.startTime="×™×© ×œ×”×–×™×Ÿ ×©×¢×ª ×”×ª×—×œ×”"),t.endTime||(s.endTime="×™×© ×œ×”×–×™×Ÿ ×©×¢×ª ×¡×™×•×"),t.startTime&&t.endTime){const a=Le(t.startTime,t.endTime);a<=0?s.endTime="×©×¢×ª ×”×¡×™×•× ×—×™×™×‘×ª ×œ×”×™×•×ª ××—×¨×™ ×©×¢×ª ×”×”×ª×—×œ×”":a>300&&(s.endTime="××©×š ×”×—×–×¨×” ×œ× ×™×›×•×œ ×œ×”×™×•×ª ×™×•×ª×¨ ×-5 ×©×¢×•×ª")}return t.location?.trim()||(s.location="×™×© ×œ×‘×—×•×¨ ××™×§×•×"),{isValid:Object.keys(s).length===0,errors:s}},hr=t=>{const s={};if(t.orchestraId?.trim()||(s.orchestraId="×™×© ×œ×‘×—×•×¨ ×ª×–××•×¨×ª"),t.startDate||(s.startDate="×™×© ×œ×‘×—×•×¨ ×ª××¨×™×š ×”×ª×—×œ×”"),t.endDate||(s.endDate="×™×© ×œ×‘×—×•×¨ ×ª××¨×™×š ×¡×™×•×"),t.startDate&&t.endDate){const a=new Date(t.startDate),i=new Date(t.endDate);a>=i&&(s.endDate="×ª××¨×™×š ×”×¡×™×•× ×—×™×™×‘ ×œ×”×™×•×ª ××—×¨×™ ×ª××¨×™×š ×”×”×ª×—×œ×”"),(i.getTime()-a.getTime())/(1e3*60*60*24)>365&&(s.endDate="×ª×§×•×¤×” ×œ× ×™×›×•×œ×” ×œ×”×™×•×ª ×™×•×ª×¨ ××©× ×”")}return(t.dayOfWeek===void 0||t.dayOfWeek<0||t.dayOfWeek>6)&&(s.dayOfWeek="×™×© ×œ×‘×—×•×¨ ×™×•× ×‘×©×‘×•×¢"),t.startTime||(s.startTime="×™×© ×œ×”×–×™×Ÿ ×©×¢×ª ×”×ª×—×œ×”"),t.endTime||(s.endTime="×™×© ×œ×”×–×™×Ÿ ×©×¢×ª ×¡×™×•×"),t.startTime&&t.endTime&&Le(t.startTime,t.endTime)<=0&&(s.endTime="×©×¢×ª ×”×¡×™×•× ×—×™×™×‘×ª ×œ×”×™×•×ª ××—×¨×™ ×©×¢×ª ×”×”×ª×—×œ×”"),t.location?.trim()||(s.location="×™×© ×œ×‘×—×•×¨ ××™×§×•×"),{isValid:Object.keys(s).length===0,errors:s}},Wa=t=>{switch(t.orchestra?.type||t.type){case"×ª×–××•×¨×ª":return"bg-blue-500";case"×”×¨×›×‘":return"bg-pink-500";default:return"bg-gray-500"}};function gr({newRehearsal:t,bulkData:s,existingRehearsals:a,orchestras:i,onConflictsChanged:n}){const[o,l]=m.useState([]),[f,u]=m.useState(!1);m.useEffect(()=>{t||s?d():l([])},[t,s,a]),m.useEffect(()=>{n?.(o)},[o,n]);const d=async()=>{u(!0);try{let p=[];t?p=await h(t):s&&(p=await b(s)),l(p)}catch(p){console.error("Error detecting conflicts:",p)}finally{u(!1)}},h=async p=>{const j=[],C={_id:"temp",groupId:p.groupId,type:p.type,date:p.date,dayOfWeek:new Date(p.date).getDay(),startTime:p.startTime,endTime:p.endTime,location:p.location,attendance:{present:[],absent:[]},notes:p.notes||"",schoolYearId:"current",isActive:p.isActive,orchestra:i.find(O=>O._id===p.groupId)};for(const O of a){if(O.groupId===p.groupId&&O.date===p.date)continue;const _=Et(C,O);_.hasConflict&&j.push({..._,conflictingRehearsal:O,affectedDate:p.date})}return j},b=async p=>{const j=[],C=D(p),O=i.find(_=>_._id===p.orchestraId);for(const _ of C){const F={_id:"temp",groupId:p.orchestraId,type:O?.type||"×ª×–××•×¨×ª",date:_,dayOfWeek:new Date(_).getDay(),startTime:p.startTime,endTime:p.endTime,location:p.location,attendance:{present:[],absent:[]},notes:p.notes||"",schoolYearId:p.schoolYearId,isActive:!0,orchestra:O};for(const S of a){if(S.groupId===p.orchestraId&&S.date===_)continue;const P=Et(F,S);P.hasConflict&&j.push({...P,conflictingRehearsal:S,affectedDate:_})}}return j},D=p=>{const j=[],C=new Date(p.startDate),O=new Date(p.endDate),_=p.dayOfWeek,F=new Set(p.excludeDates||[]),S=new Date(C);for(;S.getDay()!==_&&S<=O;)S.setDate(S.getDate()+1);for(;S<=O;){const P=S.toISOString().split("T")[0];F.has(P)||j.push(P),S.setDate(S.getDate()+7)}return j},T=p=>{switch(p){case"critical":return e.jsx(wt,{className:"w-5 h-5 text-red-600"});case"warning":return e.jsx(at,{className:"w-5 h-5 text-yellow-600"});default:return e.jsx($e,{className:"w-5 h-5 text-green-600"})}},R=p=>{switch(p){case"location":return e.jsx(Se,{className:"w-4 h-4"});case"conductor":return e.jsx(he,{className:"w-4 h-4"});case"members":return e.jsx(le,{className:"w-4 h-4"});case"time":return e.jsx(oe,{className:"w-4 h-4"});default:return e.jsx($e,{className:"w-4 h-4"})}},L=p=>{switch(p){case"critical":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";default:return"bg-green-50 border-green-200 text-green-800"}},k=o.filter(p=>p.severity==="critical"),M=o.filter(p=>p.severity==="warning");return f?e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary-600 ml-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"×‘×•×“×§ ×”×ª× ×’×©×•×™×•×ª..."})]})}):o.length===0&&(t||s)?e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx($e,{className:"w-5 h-5 text-green-600 ml-2"}),e.jsx("span",{className:"text-sm text-green-800",children:"×œ× × ××¦××• ×”×ª× ×’×©×•×™×•×ª - × ×™×ª×Ÿ ×œ×™×¦×•×¨ ××ª ×”×—×–×¨×”"})]})}):o.length===0?null:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"×¡×™×›×•× ×”×ª× ×’×©×•×™×•×ª"}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[k.length>0&&e.jsxs("div",{className:"flex items-center text-red-600",children:[e.jsx(wt,{className:"w-4 h-4 ml-1"}),e.jsxs("span",{children:[k.length," ×§×¨×™×˜×™×•×ª"]})]}),M.length>0&&e.jsxs("div",{className:"flex items-center text-yellow-600",children:[e.jsx(at,{className:"w-4 h-4 ml-1"}),e.jsxs("span",{children:[M.length," ××–×”×¨×•×ª"]})]})]})]}),k.length>0&&e.jsx("p",{className:"text-sm text-red-800",children:"× ××¦××• ×”×ª× ×’×©×•×™×•×ª ×§×¨×™×˜×™×•×ª ×©××•× ×¢×•×ª ×™×¦×™×¨×ª ×”×—×–×¨×”. ×™×© ×œ×¤×ª×•×¨ ××•×ª×Ÿ ×œ×¤× ×™ ×”××©×š."}),M.length>0&&k.length===0&&e.jsx("p",{className:"text-sm text-yellow-800",children:"× ××¦××• ××–×”×¨×•×ª ×©×›×“××™ ×œ×‘×“×•×§. × ×™×ª×Ÿ ×œ×”××©×™×š ×‘×™×¦×™×¨×ª ×”×—×–×¨×” ××š ××•××œ×¥ ×œ×•×•×“×."})]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:o.map((p,j)=>e.jsx("div",{className:`border rounded-lg p-3 ${L(p.severity)}`,children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-start gap-2",children:[T(p.severity),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[R(p.conflictType),e.jsx("span",{className:"font-medium text-sm",children:p.message})]}),p.conflictingRehearsal&&e.jsx("div",{className:"text-xs opacity-75",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{children:p.conflictingRehearsal.orchestra?.name}),e.jsx("span",{children:cr(p.conflictingRehearsal).fullDateTime}),e.jsx("span",{children:p.conflictingRehearsal.location})]})}),p.affectedDate&&e.jsxs("div",{className:"text-xs opacity-75 mt-1",children:["×ª××¨×™×š ××ª× ×’×©: ",new Date(p.affectedDate).toLocaleDateString("he-IL")]})]})]})})},j))}),k.length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-red-900 mb-2",children:"×¤×¢×•×œ×•×ª ××•××œ×¦×•×ª ×œ×¤×ª×¨×•×Ÿ:"}),e.jsxs("ul",{className:"text-sm text-red-800 space-y-1 list-disc list-inside",children:[k.some(p=>p.conflictType==="location")&&e.jsx("li",{children:"×©× ×” ××ª ××™×§×•× ×”×—×–×¨×” ××• ×‘×—×¨ ×–××Ÿ ××—×¨"}),k.some(p=>p.conflictType==="conductor")&&e.jsx("li",{children:"×ª×× ×¢× ×”×× ×¦×— ××• ×©× ×” ××ª ×–××Ÿ ×”×—×–×¨×”"}),k.some(p=>p.conflictType==="time")&&e.jsx("li",{children:"×‘×—×¨ ×–××Ÿ ××—×¨ ××• ×ª××¨×™×š ××—×¨"})]})]})]})}function xr({orchestras:t,existingRehearsals:s=[],onSubmit:a,onCancel:i,initialData:n}){const[o,l]=m.useState("single"),[f,u]=m.useState(!1),[d,h]=m.useState({}),[b,D]=m.useState({groupId:"",type:"×ª×–××•×¨×ª",date:"",startTime:"19:00",endTime:"21:00",location:"",notes:"",isActive:!0,...n}),[T,R]=m.useState({orchestraId:"",startDate:"",endDate:"",dayOfWeek:0,startTime:"19:00",endTime:"21:00",location:"",notes:"",excludeDates:[],schoolYearId:"current"}),[L,k]=m.useState(""),[M,p]=m.useState([]),[j,C]=m.useState(!1),[O,_]=m.useState(!1);m.useEffect(()=>{if(o==="single"&&b.groupId){const c=t.find(w=>w._id===b.groupId);c&&!b.location&&D(w=>({...w,location:c.location,type:c.type}))}},[b.groupId,t,o]),m.useEffect(()=>{if(o==="bulk"&&T.orchestraId){const c=t.find(w=>w._id===T.orchestraId);c&&!T.location&&R(w=>({...w,location:c.location}))}},[T.orchestraId,t,o]),m.useEffect(()=>{if(o==="bulk"&&T.startDate&&T.endDate&&T.dayOfWeek!==void 0)try{const c=ur(T);p(c)}catch{p([])}else p([])},[o,T.startDate,T.endDate,T.dayOfWeek,T.excludeDates]);const F=(c,w)=>{D(U=>({...U,[c]:w})),d[c]&&h(U=>({...U,[c]:""}))},S=(c,w)=>{R(U=>({...U,[c]:w})),d[c]&&h(U=>({...U,[c]:""}))},P=()=>{L&&(R(c=>({...c,excludeDates:[...c.excludeDates||[],L]})),k(""))},A=c=>{R(w=>({...w,excludeDates:(w.excludeDates||[]).filter(U=>U!==c)}))},B=c=>{C(c.length>0),_(c.some(w=>w.severity==="critical"))},J=async c=>{c.preventDefault(),u(!0),h({});try{if(O){h({submit:"×™×© ×œ×¤×ª×•×¨ ×”×ª× ×’×©×•×™×•×ª ×§×¨×™×˜×™×•×ª ×œ×¤× ×™ ×™×¦×™×¨×ª ×”×—×–×¨×”"});return}if(o==="single"){const w=mr(b);if(!w.isValid){h(w.errors);return}const y=new Date(b.date).getDay(),E={...b,dayOfWeek:y};await a(E,!1)}else{const w=hr(T);if(!w.isValid){h(w.errors);return}await a(T,!0)}}catch(w){h({submit:w.message||"×©×’×™××” ×‘×©××™×¨×ª ×”×—×–×¨×”"})}finally{u(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:i,children:e.jsx("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto transform transition-all",onClick:c=>c.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("button",{onClick:i,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(me,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n?"×¢×¨×•×š ×—×–×¨×”":"×—×–×¨×” ×—×“×©×”"}),!n&&e.jsx("div",{className:"flex justify-center mt-3",children:e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{type:"button",onClick:()=>l("single"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${o==="single"?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"×—×–×¨×” ×™×—×™×“×”"}),e.jsx("button",{type:"button",onClick:()=>l("bulk"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${o==="bulk"?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"×—×–×¨×•×ª ×—×•×–×¨×•×ª"})]})})]}),e.jsx("div",{className:"w-8"})]}),e.jsxs("form",{onSubmit:J,className:"space-y-6",children:[o==="single"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(le,{className:"w-4 h-4 inline ml-1"}),"×ª×–××•×¨×ª"]}),e.jsxs("select",{value:b.groupId||"",onChange:c=>F("groupId",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.groupId?"border-red-300":"border-gray-300"}`,disabled:!!n,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×ª×–××•×¨×ª"}),t.map(c=>e.jsxs("option",{value:c._id,children:[c.name," (",c.type,")"]},c._id))]}),d.groupId&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.groupId})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ee,{className:"w-4 h-4 inline ml-1"}),"×ª××¨×™×š"]}),e.jsx("input",{type:"date",value:b.date||"",onChange:c=>F("date",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.date?"border-red-300":"border-gray-300"}`}),d.date&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.date})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(oe,{className:"w-4 h-4 inline ml-1"}),"×©×¢×ª ×”×ª×—×œ×”"]}),e.jsx("input",{type:"time",value:b.startTime||"",onChange:c=>F("startTime",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.startTime?"border-red-300":"border-gray-300"}`}),d.startTime&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.startTime})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©×¢×ª ×¡×™×•×"}),e.jsx("input",{type:"time",value:b.endTime||"",onChange:c=>F("endTime",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.endTime?"border-red-300":"border-gray-300"}`}),d.endTime&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.endTime})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Se,{className:"w-4 h-4 inline ml-1"}),"××™×§×•×"]}),e.jsx("input",{type:"text",value:b.location||"",onChange:c=>F("location",c.target.value),placeholder:"×›×’×•×Ÿ: ××•×œ× ×¢×¨×Ÿ, ×¡×˜×•×“×™×• ×§×××¨×™ 1",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.location?"border-red-300":"border-gray-300"}`}),d.location&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.location})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×”×¢×¨×•×ª"}),e.jsx("textarea",{value:b.notes||"",onChange:c=>F("notes",c.target.value),rows:3,placeholder:"×”×¢×¨×•×ª × ×•×¡×¤×•×ª ×¢×‘×•×¨ ×”×—×–×¨×”...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(le,{className:"w-4 h-4 inline ml-1"}),"×ª×–××•×¨×ª"]}),e.jsxs("select",{value:T.orchestraId||"",onChange:c=>S("orchestraId",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.orchestraId?"border-red-300":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×ª×–××•×¨×ª"}),t.map(c=>e.jsxs("option",{value:c._id,children:[c.name," (",c.type,")"]},c._id))]}),d.orchestraId&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.orchestraId})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ee,{className:"w-4 h-4 inline ml-1"}),"×ª××¨×™×š ×”×ª×—×œ×”"]}),e.jsx("input",{type:"date",value:T.startDate||"",onChange:c=>S("startDate",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.startDate?"border-red-300":"border-gray-300"}`}),d.startDate&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.startDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª××¨×™×š ×¡×™×•×"}),e.jsx("input",{type:"date",value:T.endDate||"",onChange:c=>S("endDate",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.endDate?"border-red-300":"border-gray-300"}`}),d.endDate&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.endDate})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×™×•× ×‘×©×‘×•×¢"}),e.jsx("select",{value:T.dayOfWeek||0,onChange:c=>S("dayOfWeek",parseInt(c.target.value)),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.dayOfWeek?"border-red-300":"border-gray-300"}`,children:ir.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))}),d.dayOfWeek&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.dayOfWeek})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(oe,{className:"w-4 h-4 inline ml-1"}),"×©×¢×ª ×”×ª×—×œ×”"]}),e.jsx("input",{type:"time",value:T.startTime||"",onChange:c=>S("startTime",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.startTime?"border-red-300":"border-gray-300"}`}),d.startTime&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.startTime})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©×¢×ª ×¡×™×•×"}),e.jsx("input",{type:"time",value:T.endTime||"",onChange:c=>S("endTime",c.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.endTime?"border-red-300":"border-gray-300"}`}),d.endTime&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.endTime})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Se,{className:"w-4 h-4 inline ml-1"}),"××™×§×•×"]}),e.jsx("input",{type:"text",value:T.location||"",onChange:c=>S("location",c.target.value),placeholder:"×›×’×•×Ÿ: ××•×œ× ×¢×¨×Ÿ, ×¡×˜×•×“×™×• ×§×××¨×™ 1",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 ${d.location?"border-red-300":"border-gray-300"}`}),d.location&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.location})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª××¨×™×›×™× ×œ×“×™×œ×•×’"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"date",value:L,onChange:c=>k(c.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"×‘×—×¨ ×ª××¨×™×š ×œ×“×™×œ×•×’"}),e.jsx("button",{type:"button",onClick:P,disabled:!L,className:"px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(pe,{className:"w-4 h-4"})})]}),T.excludeDates&&T.excludeDates.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:T.excludeDates.map(c=>e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg px-2 py-1",children:[e.jsx("span",{className:"text-sm text-gray-700",children:new Date(c).toLocaleDateString("he-IL")}),e.jsx("button",{type:"button",onClick:()=>A(c),className:"mr-1 text-gray-500 hover:text-red-600",children:e.jsx(Is,{className:"w-3 h-3"})})]},c))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×”×¢×¨×•×ª"}),e.jsx("textarea",{value:T.notes||"",onChange:c=>S("notes",c.target.value),rows:3,placeholder:"×”×¢×¨×•×ª × ×•×¡×¤×•×ª ×¢×‘×•×¨ ×›×œ ×”×—×–×¨×•×ª...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),M.length>0&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(mt,{className:"w-4 h-4 text-blue-600 ml-1"}),e.jsxs("span",{className:"text-sm font-medium text-blue-900",children:["×ª×™×•×•×¦×¨×• ",M.length," ×—×–×¨×•×ª"]})]}),e.jsxs("div",{className:"text-xs text-blue-700 max-h-32 overflow-y-auto",children:[M.slice(0,10).map(c=>e.jsxs("div",{children:[new Date(c).toLocaleDateString("he-IL")," - ",ft(new Date(c).getDay())]},c)),M.length>10&&e.jsxs("div",{className:"text-blue-600",children:["...×•×¢×•×“ ",M.length-10]})]})]})]}),e.jsx(gr,{newRehearsal:o==="single"?b:null,bulkData:o==="bulk"?T:null,existingRehearsals:s,orchestras:t,onConflictsChanged:B}),d.submit&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800 text-sm",children:d.submit})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"×‘×™×˜×•×œ"}),e.jsx("button",{type:"submit",disabled:f||O,className:`px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors ${f||O?"opacity-50 cursor-not-allowed":""}`,children:f?"×©×•××¨...":n?"×¢×“×›×Ÿ ×—×–×¨×”":o==="single"?"×¦×•×¨ ×—×–×¨×”":`×¦×•×¨ ${M.length} ×—×–×¨×•×ª`})]})]})]})})})}const fr=[{name:"××™×“×¢ ×›×œ×œ×™",href:"/dashboard",icon:Ce,category:"general"},{name:"×ª×œ××™×“×™×",href:"/students",icon:le,category:"management",roles:["admin"]},{name:"××•×¨×™×",href:"/teachers",icon:Bt,category:"management",roles:["admin"]},{name:"×©×™×¢×•×¨×™ ×ª×™××•×¨×™×”",href:"/theory-lessons",icon:ke,category:"management",roles:["admin"]},{name:"×ª×–××•×¨×•×ª",href:"/orchestras",icon:Ue,category:"management",roles:["admin"]},{name:"×—×–×¨×•×ª",href:"/rehearsals",icon:ee,category:"management",roles:["admin"]},{name:"×‘×’×¨×•×™×•×ª",href:"/bagruts",icon:gt,category:"management",roles:["admin"]},{name:"× ×•×›×—×•×ª",href:"/teachers",icon:Me,category:"operations",roles:["admin"]},{name:"×”×’×“×¨×•×ª",href:"/settings",icon:ot,category:"system",roles:["admin"]}],pr=[{name:"×œ×•×— ×‘×§×¨×”",href:"/dashboard",icon:Ce,category:"general"},{name:"×”×ª×œ××™×“×™× ×©×œ×™",href:"/students",icon:le,category:"personal",roles:["teacher"]},{name:"×œ×•×— ×–×× ×™× ×©×œ×™",href:"/profile",icon:ee,category:"personal",roles:["teacher"]},{name:"× ×•×›×—×•×ª",href:"/profile?tab=attendance",icon:Me,category:"operations",roles:["teacher"]},{name:"× ×™×”×•×œ ×‘×’×¨×•×™×•×ª",href:"/bagruts",icon:gt,category:"operations",roles:["teacher"]},{name:"×¤×¨×•×¤×™×œ",href:"/profile",icon:he,category:"personal"}],yr=[{name:"×œ×•×— ×‘×§×¨×”",href:"/dashboard",icon:Ce,category:"general"},{name:"×”×ª×–××•×¨×•×ª ×©×œ×™",href:"/orchestras",icon:Ue,category:"personal",roles:["conductor"]},{name:"×—×–×¨×•×ª",href:"/rehearsals",icon:ee,category:"personal",roles:["conductor"]},{name:"× ×•×›×—×•×ª",href:"/profile?tab=orchestras",icon:Me,category:"operations",roles:["conductor"]},{name:"× ×™×”×•×œ ×¨×™×©×•××™×",href:"/conductor/enrollment",icon:Ut,category:"operations",roles:["conductor"]},{name:"×¤×¨×•×¤×™×œ",href:"/profile",icon:he,category:"personal"}],br=[{name:"×œ×•×— ×‘×§×¨×”",href:"/dashboard",icon:Ce,category:"general"},{name:"×”×©×™×¢×•×¨×™× ×©×œ×™",href:"/theory-lessons",icon:ke,category:"personal",roles:["theory-teacher"]},{name:"×§×‘×•×¦×•×ª ×ª×™××•×¨×™×”",href:"/theory-lessons",icon:le,category:"personal",roles:["theory-teacher"]},{name:"× ×•×›×—×•×ª",href:"/profile?tab=lessons",icon:Me,category:"operations",roles:["theory-teacher"]},{name:"×ª×›× ×™×ª ×œ×™××•×“×™×",href:"/theory-lessons",icon:Cs,category:"personal",roles:["theory-teacher"]},{name:"×¤×¨×•×¤×™×œ",href:"/profile",icon:he,category:"personal"}],jr={admin:[{name:"×”×•×¡×£ ×ª×œ××™×“ ×—×“×©",href:"/students/new",icon:le,role:"admin"},{name:"×”×•×¡×£ ××•×¨×” ×—×“×©",href:"/teachers/new",icon:Bt,role:"admin"},{name:"×¦×•×¨ ×©×™×¢×•×¨ ×ª×™××•×¨×™×”",href:"/theory-lessons/new",icon:ke,role:"admin"},{name:"×ª×–××Ÿ ×—×–×¨×”",href:"/rehearsals/new",icon:ee,role:"admin"}],teacher:[{name:"×”×•×¡×£ ×©×™×¢×•×¨",href:"/profile?tab=students&action=addStudent",icon:pe,role:"teacher"},{name:"×¡××Ÿ × ×•×›×—×•×ª",href:"/profile?tab=attendance",icon:Tt,role:"teacher"},{name:"×¦×¤×” ×‘×œ×•×— ×–×× ×™×",href:"/profile?tab=schedule",icon:oe,role:"teacher"}],conductor:[{name:"×ª×–××Ÿ ×—×–×¨×”",href:"/rehearsals/new",icon:It,role:"conductor"},{name:"× ×”×œ ×ª×–××•×¨×ª",href:"/orchestras",icon:Ue,role:"conductor"},{name:"×¡××Ÿ × ×•×›×—×•×ª",href:"/profile?tab=orchestras",icon:Tt,role:"conductor"}],"theory-teacher":[{name:"×ª×–××Ÿ ×©×™×¢×•×¨ ×ª×™××•×¨×™×”",href:"/theory-lessons/new",icon:It,role:"theory-teacher"},{name:"× ×”×œ ×§×‘×•×¦×•×ª",href:"/theory-lessons",icon:Ut,role:"theory-teacher"},{name:"×“×¨×’ ×ª×œ××™×“×™×",href:"/theory-lessons",icon:gt,role:"theory-teacher"}]};function vr(){const t=xs(),s=Be(),{user:a,isLoading:i}=ye(),{isDesktopOpen:n,setIsDesktopOpen:o,isMobile:l}=xt(),[f,u]=m.useState(""),[d,h]=m.useState(!1),[b,D]=m.useState(new Set),[T,R]=m.useState(!1),[L,k]=m.useState(!1),[M,p]=m.useState(!1),[j,C]=m.useState(!1),[O,_]=m.useState([]),[F,S]=m.useState(!1),P=r=>t.pathname===r,B=(()=>{if(!a)return[];const r=[];return a.role&&r.push(a.role),a.roles&&Array.isArray(a.roles)&&r.push(...a.roles),a.teaching?.studentIds?.length>0&&!r.includes("teacher")&&!r.includes("××•×¨×”")&&r.push("teacher"),a.conducting?.orchestraIds?.length>0&&!r.includes("conductor")&&!r.includes("×× ×¦×—")&&r.push("conductor"),[...new Set(r.map(g=>g==="theory_teacher"?"theory-teacher":g==="×× ×”×œ"?"admin":g==="××•×¨×”"?"teacher":g==="×× ×¦×—"?"conductor":g==="××•×¨×” ×ª×™××•×¨×™×”"?"theory-teacher":g))]})(),J=B.includes("admin"),c=B.length>1,w=()=>{if(J){const x=[...fr],v=x.findIndex(N=>N.name==="× ×•×›×—×•×ª");if(v!==-1){let N="/teachers";B.includes("teacher")?N="/profile?tab=attendance":B.includes("conductor")?N="/profile?tab=orchestras":B.includes("theory-teacher")&&(N="/profile?tab=lessons"),x[v]={...x[v],href:N}}return x}const r=new Map,g=[];return B.includes("teacher")&&g.push(...pr),B.includes("conductor")&&g.push(...yr),B.includes("theory-teacher")&&g.push(...br),g.forEach(x=>{const v=x.href;if(!r.has(v))r.set(v,x);else{const N=r.get(v);x.roles&&N.roles&&(N.roles=[...new Set([...N.roles,...x.roles])])}}),Array.from(r.values())},U=()=>{const r=[],g=new Map;return B.forEach(x=>{const v=jr[x];v&&v.forEach(N=>{const V=`${N.href}-${N.name}`;g.has(V)||(g.set(V,!0),r.push(N))})}),r},y=r=>{const g={general:{label:"×›×œ×œ×™",items:[]},personal:{label:"××–×•×¨ ××™×©×™",items:[]},management:{label:"× ×™×”×•×œ ××¢×¨×›×ª",items:[]},operations:{label:"×¤×¢×•×œ×•×ª",items:[]},system:{label:"××¢×¨×›×ª",items:[]}};return r.forEach(x=>{const v=x.category||"general";g[v]&&g[v].items.push(x)}),Object.entries(g).filter(([x,v])=>v.items.length>0).map(([x,v])=>({key:x,...v}))},E=w(),I=y(E),$=U();console.log("ğŸ“‹ Sidebar Debug:",{hasUser:!!a,isLoading:i,userRoles:B,isAdmin:J,hasMultipleRoles:c,isMobile:l,isDesktopOpen:n,isOpen:d,navigationItemsCount:E?.length||0,groupedNavigationCount:I?.length||0,quickActionsCount:$?.length||0}),m.useEffect(()=>{l||h(!1)},[l]),m.useEffect(()=>{const r=g=>{if(l&&d){const x=document.getElementById("mobile-sidebar"),v=document.getElementById("hamburger-button");x&&!x.contains(g.target)&&v&&!v.contains(g.target)&&h(!1)}};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[l,d]),m.useEffect(()=>(l&&d?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[l,d]);const G=()=>{l&&h(!1)},q=r=>{const g=new Set(b);g.has(r)?g.delete(r):g.add(r),D(g)},je=r=>{switch(r){case"admin":return"×× ×”×œ";case"teacher":return"××•×¨×”";case"conductor":return"×× ×¦×—";case"theory-teacher":return"××•×¨×” ×ª×™××•×¨×™×”";default:return r}},ve=r=>{switch(r){case"admin":return"bg-red-100 text-red-700";case"teacher":return"bg-blue-100 text-blue-700";case"conductor":return"bg-green-100 text-green-700";case"theory-teacher":return"bg-yellow-100 text-yellow-700";default:return"bg-gray-100 text-gray-700"}},Ee=async(r,g)=>{G(),r==="×”×•×¡×£ ×ª×œ××™×“ ×—×“×©"?R(!0):r==="×”×•×¡×£ ××•×¨×” ×—×“×©"?k(!0):r==="×¦×•×¨ ×©×™×¢×•×¨ ×ª×™××•×¨×™×”"?p(!0):r==="×ª×–××Ÿ ×—×–×¨×”"?(await We(),C(!0)):s(g)},We=async()=>{try{S(!0);const r=await vs.getOrchestras();_(r||[])}catch(r){console.error("Failed to load orchestras:",r),_([])}finally{S(!1)}},ze=async r=>{R(!1)},Xe=async()=>{k(!1)},qe=async r=>{p(!1)},Ge=async r=>{C(!1)};return e.jsxs(e.Fragment,{children:[l&&e.jsx("button",{id:"hamburger-button",onClick:()=>h(!d),className:"fixed top-[20px] right-4 z-[60] p-2 bg-white rounded-lg shadow-lg border border-gray-200 hover:bg-gray-50 transition-colors duration-200","aria-label":"Toggle menu",children:d?e.jsx(me,{className:"w-6 h-6 text-gray-600"}):e.jsx(et,{className:"w-6 h-6 text-gray-600"})}),!l&&!n&&e.jsx("button",{onClick:()=>o(!0),className:"fixed top-[20px] right-4 z-[60] p-2 bg-white rounded-lg shadow-lg border border-gray-200 hover:bg-indigo-50 hover:border-indigo-300 transition-all duration-200","aria-label":"Open sidebar",children:e.jsx(et,{className:"w-5 h-5 text-indigo-600"})}),l&&d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[50] transition-opacity duration-300",onClick:()=>h(!1)}),e.jsxs("div",{id:"sidebar",className:`fixed top-0 right-0 w-[280px] h-screen bg-white border-l border-gray-200 shadow-[-4px_0_6px_-1px_rgba(0,0,0,0.1)] rtl z-[55] transition-transform duration-300 ease-in-out flex flex-col ${l?d?"translate-x-0":"translate-x-full":n?"translate-x-0":"translate-x-full"}`,children:[!l&&e.jsx("button",{onClick:()=>o(!n),className:"absolute top-4 left-4 p-2 bg-gray-50 rounded-lg border border-gray-200 hover:bg-indigo-50 hover:border-indigo-300 transition-all duration-200 z-10","aria-label":"Toggle sidebar",children:n?e.jsx(me,{className:"w-5 h-5 text-gray-600"}):e.jsx(et,{className:"w-5 h-5 text-indigo-600"})}),e.jsx("div",{className:"p-4 border-b border-gray-100 flex-shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ss,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"×—×™×¤×•×©...",value:f,onChange:r=>u(r.target.value),className:"w-full pr-10 pl-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm font-reisinger-yonatan text-right rtl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),c&&e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 flex-shrink-0",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:B.map(r=>e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${ve(r)}`,children:[e.jsx(ks,{className:"w-3 h-3"}),je(r)]},r))})}),e.jsx("nav",{className:"flex-1 px-3 py-4 overflow-y-auto overflow-x-hidden min-h-0 custom-scrollbar",children:i?e.jsx("div",{className:"space-y-2 px-4 py-8",children:e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded"})]})}):e.jsxs(e.Fragment,{children:[I.map((r,g)=>e.jsxs("div",{className:g>0?"mt-6":"",children:[e.jsx("div",{className:"px-4 mb-2",children:e.jsxs("button",{onClick:()=>q(r.key),className:"flex items-center justify-between w-full text-xs font-semibold text-gray-500 uppercase tracking-wider hover:text-gray-700 transition-colors",children:[e.jsx("span",{children:r.label}),e.jsx(ce,{className:`w-3 h-3 transition-transform ${b.has(r.key)?"rotate-180":""}`})]})}),!b.has(r.key)&&e.jsx("div",{className:"space-y-1",children:r.items.map(x=>{const v=x.icon,N=P(x.href);return e.jsxs(xe,{to:x.href,onClick:G,className:`flex items-center justify-between px-4 py-3 mx-3 rounded-lg text-sm font-medium transition-all duration-150 rtl font-reisinger-yonatan ${N?"bg-primary-50 text-primary-700 border border-primary-200":"text-gray-600 hover:bg-gray-50 hover:text-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-right",children:x.name}),c&&x.roles&&x.roles.length===1&&e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded-full ${ve(x.roles[0])}`,children:je(x.roles[0])})]}),e.jsx(v,{className:"w-4 h-4 flex-shrink-0"})]},`${r.key}-${x.href}-${x.name}`)})})]},r.key)),$.length>0&&e.jsxs("div",{className:"space-y-1 border-t border-gray-200 pt-6 mt-6",children:[e.jsx("h3",{className:"px-4 text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"×¤×¢×•×œ×•×ª ××”×™×¨×•×ª"}),$.map(r=>{const g=r.icon;return e.jsxs("button",{onClick:()=>Ee(r.name,r.href),className:"w-full flex items-center justify-between px-4 py-2 mx-3 rounded-lg text-sm font-medium transition-all duration-150 rtl font-reisinger-yonatan text-gray-600 hover:bg-green-50 hover:text-green-700 group",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-right",children:r.name}),c&&r.role&&e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded-full ${ve(r.role)}`,children:je(r.role)})]}),e.jsxs("div",{className:"flex items-center space-x-1 space-x-reverse",children:[e.jsx(pe,{className:"w-3 h-3 group-hover:text-green-500"}),e.jsx(g,{className:"w-3.5 h-3.5"})]})]},`${r.href}-${r.name}-${r.role}`)})]})]})})]}),T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100] p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsx(sr,{onSubmit:ze,onCancel:()=>R(!1),isEdit:!1,initialData:null})})}),L&&e.jsx(or,{isOpen:L,onClose:()=>k(!1),onSuccess:Xe}),M&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100] p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsx(lr,{onSubmit:qe,onCancel:()=>p(!1)})})}),j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100] p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:F?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"×˜×•×¢×Ÿ ×ª×–××•×¨×•×ª..."})]}):e.jsx(xr,{orchestras:O,onSubmit:Ge,onCancel:()=>C(!1)})})})]})}function Nr(){const[t,s]=m.useState(!1),a=m.useRef(null),{currentSchoolYear:i,schoolYears:n,isLoading:o,setCurrentSchoolYearById:l,getSchoolYearDisplayName:f}=Wt();m.useEffect(()=>{const d=h=>{a.current&&!a.current.contains(h.target)&&s(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const u=async d=>{await l(d),s(!1)};return o?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx(ee,{className:"w-4 h-4 text-gray-400"}),e.jsx("div",{className:"w-24 h-4 bg-gray-200 rounded animate-pulse"})]}):e.jsxs("div",{className:"relative",ref:a,children:[e.jsxs("button",{onClick:()=>s(!t),className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-gray-300 transition-all duration-150 ease-in-out min-w-[200px]",style:{direction:"rtl"},children:[e.jsx(ee,{className:"w-4 h-4 text-indigo-600 flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 font-reisinger-yonatan flex-grow text-right truncate",children:i?f(i):"×‘×—×¨ ×©× ×ª ×œ×™××•×“"}),t?e.jsx(fe,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}):e.jsx(ce,{className:"w-4 h-4 text-gray-500 flex-shrink-0"})]}),t&&e.jsxs("div",{className:"absolute right-0 mt-2 w-full min-w-[250px] bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-[1000]",children:[e.jsx("div",{className:"px-4 py-2 border-b border-gray-100",children:e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide font-reisinger-yonatan text-right",children:"×©× ×•×ª ×œ×™××•×“"})}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:n.length===0?e.jsx("div",{className:"px-4 py-3 text-sm text-gray-500 font-reisinger-yonatan text-center",children:"×œ× × ××¦××• ×©× ×•×ª ×œ×™××•×“"}):n.sort((d,h)=>new Date(h.startDate).getTime()-new Date(d.startDate).getTime()).map(d=>{const h=i?._id===d._id,b=d.isCurrent,D=d.isActive;return e.jsxs("button",{onClick:()=>u(d._id),className:`w-full px-4 py-3 text-right hover:bg-gray-50 flex items-center justify-between transition-colors duration-150 ${h?"bg-indigo-50 border-l-4 border-indigo-500":""}`,style:{direction:"rtl"},children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-medium font-reisinger-yonatan ${h?"text-indigo-700":"text-gray-700"}`,children:d.name}),b&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"× ×•×›×—×™×ª"}),!D&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"×œ× ×¤×¢×™×œ×”"})]}),e.jsxs("span",{className:"text-xs text-gray-500 font-reisinger-yonatan",children:[new Date(d.startDate).toLocaleDateString("he-IL")," - ",new Date(d.endDate).toLocaleDateString("he-IL")]})]}),h&&e.jsx(Ds,{className:"w-4 h-4 text-indigo-600 flex-shrink-0"})]},d._id)})}),e.jsx("div",{className:"px-4 py-2 border-t border-gray-100",children:e.jsx("button",{className:"text-xs text-indigo-600 hover:text-indigo-700 font-medium font-reisinger-yonatan",children:"+ ×”×•×¡×£ ×©× ×ª ×œ×™××•×“ ×—×“×©×”"})})]})]})}function wr(){const[t,s]=m.useState(!1),a=m.useRef(null),i=Be(),{user:n,logout:o}=ye(),{isDesktopOpen:l,isMobile:f}=xt(),u=n&&(n.role==="admin"||n.roles?.includes("admin")||n.role==="×× ×”×œ"||n.roles?.includes("×× ×”×œ")),d=n&&(n.role==="admin"||n.roles?.includes("admin")||n.role==="×× ×”×œ"||n.roles?.includes("×× ×”×œ")||n.role==="teacher"||n.roles?.includes("teacher")||n.role==="××•×¨×”"||n.roles?.includes("××•×¨×”")||n.role==="conductor"||n.roles?.includes("conductor")||n.role==="×× ×¦×—"||n.roles?.includes("×× ×¦×—")||n.role==="theory-teacher"||n.roles?.includes("theory-teacher")||n.role==="theory_teacher"||n.roles?.includes("theory_teacher")||n.role==="××•×¨×” ×ª×™××•×¨×™×”"||n.roles?.includes("××•×¨×” ×ª×™××•×¨×™×”")||n.teaching?.studentIds?.length>0||n.conducting?.orchestraIds?.length>0);m.useEffect(()=>{const k=M=>{a.current&&!a.current.contains(M.target)&&s(!1)};return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]);const h=()=>{i("/profile"),s(!1)},b=async()=>{try{await o(),i("/login")}catch(k){console.error("Logout error:",k)}s(!1)},D=()=>{i("/dashboard")},T=()=>{const k=n?.personalInfo?.fullName||n?.fullName||n?.name||"";if(!k)return"×";const M=k.trim().split(" ");return M.length>=2?M[0][0]+M[1][0]:M[0][0]||"×"},R=()=>n?.personalInfo?.fullName||n?.fullName||n?.name||"××©×ª××©",L=()=>{const k=n?.role||n?.roles?.[0]||"";switch(k){case"teacher":return"××•×¨×”";case"××•×¨×”":return"××•×¨×”";case"conductor":return"×× ×¦×—";case"×× ×¦×—":return"×× ×¦×—";case"theory_teacher":return"××•×¨×” ×ª×™××•×¨×™×”";case"××•×¨×” ×ª×™××•×¨×™×”":return"××•×¨×” ×ª×™××•×¨×™×”";case"admin":return"×× ×”×œ";case"×× ×”×œ":return"×× ×”×œ";default:return k||"××©×ª××©"}};return e.jsxs("header",{className:"fixed top-0 left-0 h-16 bg-white border-b border-gray-200 flex items-center justify-between z-[45] transition-all duration-300",style:{direction:"rtl",width:d&&!f&&l?"calc(100% - 280px)":"100%",paddingLeft:"1.5rem",paddingRight:d&&!f&&!l?"4rem":"1.5rem"},children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:"/logo.png",alt:"Logo",className:"h-10 w-auto object-contain"}),e.jsx(Nr,{})]}),e.jsxs("div",{className:"flex items-center gap-4",style:{direction:"ltr"},children:[!f&&e.jsx(e.Fragment,{children:!u&&e.jsx("button",{onClick:D,className:"w-10 h-10 rounded-lg bg-indigo-50 border border-indigo-200 flex items-center justify-center hover:bg-indigo-100 hover:border-indigo-300 transition-all duration-150 ease-in-out cursor-pointer",title:"×œ×•×— ×‘×§×¨×”",children:e.jsx(Ce,{className:"w-5 h-5 text-indigo-600"})})}),e.jsxs("div",{className:"relative",ref:a,children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center cursor-pointer hover:bg-indigo-700 transition-colors",onClick:()=>s(!t),children:e.jsx("span",{className:"text-sm font-semibold text-white font-reisinger-yonatan",children:T()})}),t&&e.jsxs("div",{className:"absolute left-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-[70]",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 font-reisinger-yonatan",children:R()}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:L()})]}),e.jsxs("button",{onClick:h,className:"w-full px-4 py-3 text-right hover:bg-gray-50 flex items-center justify-between transition-colors duration-150",style:{direction:"rtl"},children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 font-reisinger-yonatan",children:"×¢××•×“ ××™×©×™"}),e.jsx(he,{className:"w-4 h-4 text-gray-500"})]}),e.jsxs("button",{onClick:b,className:"w-full px-4 py-3 text-right hover:bg-gray-50 flex items-center justify-between transition-colors duration-150 text-red-600 hover:bg-red-50",style:{direction:"rtl"},children:[e.jsx("span",{className:"text-sm font-medium font-reisinger-yonatan",children:"×™×¦×™××”"}),e.jsx(Es,{className:"w-4 h-4"})]})]})]})]})]})}function W({children:t}){const{user:s}=ye(),{isDesktopOpen:a,isMobile:i}=xt(),n=s&&(s.role==="admin"||s.roles?.includes("admin")||s.role==="×× ×”×œ"||s.roles?.includes("×× ×”×œ")||s.role==="teacher"||s.roles?.includes("teacher")||s.role==="××•×¨×”"||s.roles?.includes("××•×¨×”")||s.role==="conductor"||s.roles?.includes("conductor")||s.role==="×× ×¦×—"||s.roles?.includes("×× ×¦×—")||s.role==="theory-teacher"||s.roles?.includes("theory-teacher")||s.role==="theory_teacher"||s.roles?.includes("theory_teacher")||s.role==="××•×¨×” ×ª×™××•×¨×™×”"||s.roles?.includes("××•×¨×” ×ª×™××•×¨×™×”")||s.teaching?.studentIds?.length>0||s.conducting?.orchestraIds?.length>0);return console.log("ğŸ¨ Layout Debug:",{hasUser:!!s,userRole:s?.role,userRoles:s?.roles,userObject:s,shouldShowSidebar:n,isMobile:i,isDesktopOpen:a,conditions:{hasRole:!!s?.role,hasRolesArray:!!s?.roles,isAdmin:s?.role==="admin"||s?.roles?.includes("admin"),isTeacher:s?.role==="teacher"||s?.roles?.includes("teacher"),hasConductor:s?.role==="conductor"||s?.roles?.includes("conductor"),hasTheoryTeacher:s?.role==="theory-teacher"||s?.roles?.includes("theory-teacher"),hasTeaching:s?.teaching?.studentIds?.length>0,hasConducting:s?.conducting?.orchestraIds?.length>0}}),e.jsxs("div",{className:"min-h-screen bg-gray-50",dir:"rtl",children:[n&&e.jsx(vr,{}),e.jsx(wr,{}),e.jsx("main",{className:"mt-16 ml-0 p-0 bg-gray-50 min-h-[calc(100vh-64px)] rtl transition-all duration-300",style:{marginRight:n&&!i&&a?"280px":"0"},children:e.jsx("div",{className:"p-6 bg-gray-50",children:t})})]})}function Tr(){const[t,s]=m.useState(""),[a,i]=m.useState(""),[n,o]=m.useState(""),[l,f]=m.useState(!1),u=Be(),{login:d}=ye(),h=async b=>{b.preventDefault(),o(""),f(!0),console.log("ğŸ” Login attempt started:",{email:t,password:"***"}),console.log("ğŸŒ API Base URL:","/api"),console.log("ğŸ”§ Environment check:",{VITE_API_URL:"/api",fallback:"http://localhost:3001/api",actual:"/api"});try{console.log("ğŸ“¤ Sending login request to API service...");const D=await d(t,a);console.log("âœ… Login successful:",{user:D.user?.personalInfo?.fullName||"Unknown"}),console.log("ğŸ”‘ Authentication token stored successfully"),console.log("ğŸ§­ Navigating to dashboard..."),u("/dashboard")}catch(D){console.error("âŒ Login failed:",D),console.error("ğŸ“ Error details:",{message:D.message,stack:D.stack}),o(D.message||"×©×’×™××” ×‘×”×ª×—×‘×¨×•×ª. ×× × ×‘×“×•×§ ××ª ×”×¤×¨×˜×™× ×•× ×¡×” ×©×•×‘.")}finally{f(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 relative",style:{backgroundImage:'url("/login-background.jpg")',backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},dir:"rtl",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),e.jsx("div",{className:"max-w-md w-full space-y-8 relative z-10",children:e.jsxs("div",{className:"backdrop-blur-lg bg-white/10 border border-white/20 rounded-2xl shadow-xl p-8",children:[e.jsx("div",{children:e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white drop-shadow-lg",style:{fontFamily:"'Reisinger Yonatan', 'Arial Hebrew', 'Noto Sans Hebrew', Arial, sans-serif"},children:"×›× ×™×¡×” ×œ××¢×¨×›×ª"})}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:h,children:[n&&e.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg backdrop-blur-sm",children:e.jsx("p",{className:"text-red-100 text-sm text-center font-reisinger-yonatan",children:n})}),e.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"sr-only font-reisinger-yonatan",children:'×›×ª×•×‘×ª ×“×•×"×œ'}),e.jsx("input",{id:"email",name:"email",type:"email",required:!0,disabled:l,className:"relative block w-full px-3 py-3 border border-white/30 placeholder-gray-400 text-gray-900 rounded-lg bg-white/80 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:z-10 sm:text-sm placeholder:text-right font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"×›×ª×•×‘×ª ×“×•××´×œ",value:t,onChange:b=>s(b.target.value),dir:"ltr",style:{textAlign:"left"}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only font-reisinger-yonatan",children:"×¡×™×¡××”"}),e.jsx("input",{id:"password",name:"password",type:"password",required:!0,disabled:l,className:"relative block w-full px-3 py-3 border border-white/30 placeholder-gray-400 text-gray-900 rounded-lg bg-white/80 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:z-10 sm:text-sm placeholder:text-right font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"×¡×™×¡××”",value:a,onChange:b=>i(b.target.value),dir:"ltr",style:{textAlign:"left"}})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600/90 hover:bg-blue-700/90 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 shadow-lg font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",children:l?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"××ª×—×‘×¨..."]}):"×›× ×™×¡×”"})}),e.jsx("div",{className:"text-center",children:e.jsx(xe,{to:"/forgot-password",className:"font-medium text-white/90 hover:text-white drop-shadow transition-colors duration-200 font-reisinger-yonatan underline",children:"×©×›×—×ª×™ ×¡×™×¡××"})})]})]})})]})}function Ir(){const[t,s]=m.useState(""),[a,i]=m.useState(!1),[n,o]=m.useState(!1),[l,f]=m.useState(""),u=async d=>{d.preventDefault(),f(""),i(!0);try{await Pt.forgotPassword(t),o(!0)}catch(h){f(h.message||"×©×’×™××” ×‘×©×œ×™×—×ª ×‘×§×©×ª ××™×¤×•×¡ ×¡×™×¡××”")}finally{i(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 relative",style:{backgroundImage:'url("/login-background.jpg")',backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},dir:"rtl",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),e.jsx("div",{className:"max-w-md w-full space-y-8 relative z-10",children:e.jsxs("div",{className:"backdrop-blur-lg bg-white/10 border border-white/20 rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white drop-shadow-lg",style:{fontFamily:"'Reisinger Yonatan', 'Arial Hebrew', 'Noto Sans Hebrew', Arial, sans-serif"},children:"×©×›×—×ª×™ ×¡×™×¡××"}),e.jsx("p",{className:"mt-2 text-center text-sm text-white/80 font-reisinger-yonatan",children:'×”×–×Ÿ ××ª ×›×ª×•×‘×ª ×”×“×•×"×œ ×©×œ×š ×•× ×©×œ×— ×œ×š ×§×™×©×•×¨ ×œ××™×¤×•×¡ ×¡×™×¡××”'})]}),n?e.jsxs("div",{className:"mt-8 space-y-6",children:[e.jsx("div",{className:"p-4 bg-green-500/20 border border-green-500/50 rounded-lg backdrop-blur-sm",children:e.jsx("p",{className:"text-green-100 text-sm text-center font-reisinger-yonatan",children:'×× ×§×™×™× ×—×©×‘×•×Ÿ ×¢× ×›×ª×•×‘×ª ×“×•×"×œ ×–×•, × ×©×œ×— ××œ×™×š ×§×™×©×•×¨ ×œ××™×¤×•×¡ ×¡×™×¡××”. ×× × ×‘×“×•×§ ××ª ×ª×™×‘×ª ×”×“×•××¨ ×©×œ×š.'})}),e.jsx("div",{className:"text-center",children:e.jsx(xe,{to:"/login",className:"font-medium text-white/90 hover:text-white drop-shadow transition-colors duration-200 font-reisinger-yonatan underline",children:"×—×–×•×¨ ×œ×“×£ ×”×›× ×™×¡×”"})})]}):e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:u,children:[l&&e.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg backdrop-blur-sm",children:e.jsx("p",{className:"text-red-100 text-sm text-center font-reisinger-yonatan",children:l})}),e.jsx("div",{className:"rounded-md shadow-sm",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"sr-only font-reisinger-yonatan",children:'×›×ª×•×‘×ª ×“×•×"×œ'}),e.jsx("input",{id:"email",name:"email",type:"email",required:!0,disabled:a,className:"relative block w-full px-3 py-3 border border-white/30 placeholder-gray-400 text-gray-900 rounded-lg bg-white/80 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:z-10 sm:text-sm placeholder:text-right font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"×›×ª×•×‘×ª ×“×•××´×œ",value:t,onChange:d=>s(d.target.value),dir:"ltr",style:{textAlign:"left"}})]})}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:a,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600/90 hover:bg-blue-700/90 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 shadow-lg font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",children:a?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"×©×•×œ×—..."]}):"×©×œ×— ×§×™×©×•×¨ ×œ××™×¤×•×¡ ×¡×™×¡××”"})}),e.jsx("div",{className:"text-center",children:e.jsx(xe,{to:"/login",className:"font-medium text-white/90 hover:text-white drop-shadow transition-colors duration-200 font-reisinger-yonatan underline",children:"×—×–×•×¨ ×œ×“×£ ×”×›× ×™×¡×”"})})]})]})})]})}function Sr(){const{token:t}=fs(),[s,a]=m.useState(""),[i,n]=m.useState(""),[o,l]=m.useState(!1),[f,u]=m.useState(""),[d,h]=m.useState(!1),b=Be();m.useEffect(()=>{localStorage.removeItem("authToken"),sessionStorage.removeItem("authToken"),t||u("×§×™×©×•×¨ ×œ× ×ª×§×™×Ÿ. ×× × ×‘×§×© ×§×™×©×•×¨ ×—×“×© ×œ××™×¤×•×¡ ×¡×™×¡××”.")},[t]);const D=async T=>{if(T.preventDefault(),u(""),s.length<6){u("×”×¡×™×¡××” ×—×™×™×‘×ª ×œ×”×›×™×œ ×œ×¤×—×•×ª 6 ×ª×•×•×™×");return}if(s!==i){u("×”×¡×™×¡×××•×ª ××™× ×Ÿ ×ª×•×××•×ª");return}if(!t){u("×§×™×©×•×¨ ×œ× ×ª×§×™×Ÿ");return}l(!0);try{await Pt.resetPassword(t,s),h(!0),setTimeout(()=>{b("/login")},3e3)}catch(R){const L=R.message||R.error||"×©×’×™××” ×‘××™×¤×•×¡ ×”×¡×™×¡××”";L.includes("expired")||L.includes("RESET_TOKEN_EXPIRED")?u("×ª×•×§×£ ×”×§×™×©×•×¨ ×¤×’. ×× × ×‘×§×© ×§×™×©×•×¨ ×—×“×© ×œ××™×¤×•×¡ ×¡×™×¡××”."):L.includes("invalid")||L.includes("INVALID_RESET_TOKEN")?u("×§×™×©×•×¨ ×œ× ×ª×§×™×Ÿ. ×× × ×‘×§×© ×§×™×©×•×¨ ×—×“×© ×œ××™×¤×•×¡ ×¡×™×¡××”."):L.includes("password")||L.includes("WEAK_PASSWORD")?u("×”×¡×™×¡××” ×—×™×™×‘×ª ×œ×”×›×™×œ ×œ×¤×—×•×ª 6 ×ª×•×•×™×"):u(L)}finally{l(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 relative",style:{backgroundImage:'url("/login-background.jpg")',backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},dir:"rtl",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),e.jsx("div",{className:"max-w-md w-full space-y-8 relative z-10",children:e.jsxs("div",{className:"backdrop-blur-lg bg-white/10 border border-white/20 rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white drop-shadow-lg",style:{fontFamily:"'Reisinger Yonatan', 'Arial Hebrew', 'Noto Sans Hebrew', Arial, sans-serif"},children:"××™×¤×•×¡ ×¡×™×¡××”"}),e.jsx("p",{className:"mt-2 text-center text-sm text-white/80 font-reisinger-yonatan",children:"×”×–×Ÿ ×¡×™×¡××” ×—×“×©×” ×œ×—×©×‘×•×Ÿ ×©×œ×š"})]}),d?e.jsxs("div",{className:"mt-8 space-y-6",children:[e.jsxs("div",{className:"p-4 bg-green-500/20 border border-green-500/50 rounded-lg backdrop-blur-sm",children:[e.jsx("p",{className:"text-green-100 text-center font-reisinger-yonatan",children:"×”×¡×™×¡××” ××•×¤×¡×” ×‘×”×¦×œ×—×”! ×¢×›×©×™×• ×ª×•×›×œ ×œ×”×ª×—×‘×¨ ×¢× ×”×¡×™×¡××” ×”×—×“×©×”."}),e.jsx("p",{className:"text-green-100 text-sm text-center font-reisinger-yonatan mt-2",children:"××¢×‘×™×¨ ××•×ª×š ×œ×“×£ ×”×›× ×™×¡×”..."})]}),e.jsx("div",{className:"text-center",children:e.jsx(xe,{to:"/login",className:"font-medium text-white/90 hover:text-white drop-shadow transition-colors duration-200 font-reisinger-yonatan underline",children:"×—×–×•×¨ ×œ×“×£ ×”×›× ×™×¡×” ×¢×›×©×™×•"})})]}):e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:D,children:[f&&e.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg backdrop-blur-sm",children:e.jsx("p",{className:"text-red-100 text-sm text-center font-reisinger-yonatan",children:f})}),e.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only font-reisinger-yonatan",children:"×¡×™×¡××” ×—×“×©×”"}),e.jsx("input",{id:"password",name:"password",type:"password",required:!0,disabled:o||!t,className:"relative block w-full px-3 py-3 border border-white/30 placeholder-gray-400 text-gray-900 rounded-lg bg-white/80 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:z-10 sm:text-sm placeholder:text-right font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"×¡×™×¡××” ×—×“×©×” (×œ×¤×—×•×ª 6 ×ª×•×•×™×)",value:s,onChange:T=>a(T.target.value),dir:"ltr",style:{textAlign:"left"}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"sr-only font-reisinger-yonatan",children:"××™××•×ª ×¡×™×¡××”"}),e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,disabled:o||!t,className:"relative block w-full px-3 py-3 border border-white/30 placeholder-gray-400 text-gray-900 rounded-lg bg-white/80 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:z-10 sm:text-sm placeholder:text-right font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"××™××•×ª ×¡×™×¡××”",value:i,onChange:T=>n(T.target.value),dir:"ltr",style:{textAlign:"left"}})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:o||!t,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600/90 hover:bg-blue-700/90 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 shadow-lg font-reisinger-yonatan disabled:opacity-50 disabled:cursor-not-allowed",children:o?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"×××¤×¡ ×¡×™×¡××”..."]}):"××™×¤×•×¡ ×¡×™×¡××”"})}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(xe,{to:"/forgot-password",className:"block font-medium text-white/90 hover:text-white drop-shadow transition-colors duration-200 font-reisinger-yonatan underline",children:"×‘×§×© ×§×™×©×•×¨ ×—×“×©"}),e.jsx(xe,{to:"/login",className:"block font-medium text-white/90 hover:text-white drop-shadow transition-colors duration-200 font-reisinger-yonatan underline",children:"×—×–×•×¨ ×œ×“×£ ×”×›× ×™×¡×”"})]})]})]})})]})}function Z(t,s,a=3){return m.lazy(()=>{let i=0;const n=async()=>{try{const o=await t();return console.log(`âœ… Successfully loaded ${s}`),o}catch(o){if(console.error(`âŒ Failed to load ${s}, attempt ${i+1}/${a}:`,o),i<a-1){i++;const l=Math.min(1e3*Math.pow(2,i),5e3);return await new Promise(f=>setTimeout(f,l)),n()}else throw console.error(`âŒ All retry attempts failed for ${s}`),o}};return n()})}class kr{constructor(){Ze(this,"preloadedComponents",new Set);Ze(this,"preloadPromises",new Map)}preload(s,a){if(this.preloadedComponents.has(s))return Promise.resolve();if(this.preloadPromises.has(s))return this.preloadPromises.get(s);const i=a().then(n=>(this.preloadedComponents.add(s),console.log(`âœ… Preloaded ${s}`),n)).catch(n=>{throw console.error(`âŒ Failed to preload ${s}:`,n),n}).finally(()=>{this.preloadPromises.delete(s)});return this.preloadPromises.set(s,i),i}preloadOnHover(s,a){return()=>{this.preloadedComponents.has(s)||this.preload(s,a)}}getPreloadStats(){return{preloadedComponents:Array.from(this.preloadedComponents),pendingPreloads:Array.from(this.preloadPromises.keys())}}}const tt=new kr,st={STUDENT_DETAILS:"StudentDetailsPage",THEORY_TAB:"TheoryTab",ORCHESTRA_TAB:"OrchestraTab",DASHBOARD:"Dashboard",STUDENTS_LIST:"Students"};function Cr(){setTimeout(()=>{tt.preload(st.DASHBOARD,()=>K(()=>import("../chunks/Dashboard-Dpn-RWbg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),tt.preload(st.STUDENTS_LIST,()=>K(()=>import("../chunks/Students-DKr86U6y.js"),__vite__mapDeps([9,1,3,4,10,7,5,6])))},1e3),setTimeout(()=>{tt.preload(st.STUDENT_DETAILS,()=>K(()=>import("../chunks/StudentDetailsPageSimple-D1U1_x6r.js"),__vite__mapDeps([11,1,7,5,6,3,12,13,14,4])))},3e3)}function Dr(){const t=document.head,s=document.createElement("link");s.rel="dns-prefetch",s.href="//localhost",t.appendChild(s);const a=document.createElement("link");a.rel="preconnect",a.href="http://localhost:3001",a.crossOrigin="anonymous",t.appendChild(a);const i=document.createElement("link");i.rel="prefetch",i.as="style",i.href="/src/index.css",t.appendChild(i)}function Er(){typeof window>"u"||(Dr(),Cr(),console.log("ğŸš€ Bundle optimizations initialized"))}let _r={data:""},Ar=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||_r,Or=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Rr=/\/\*[^]*?\*\/|  +/g,_t=/\n+/g,de=(t,s)=>{let a="",i="",n="";for(let o in t){let l=t[o];o[0]=="@"?o[1]=="i"?a=o+" "+l+";":i+=o[1]=="f"?de(l,o):o+"{"+de(l,o[1]=="k"?"":s)+"}":typeof l=="object"?i+=de(l,s?s.replace(/([^,])+/g,f=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,f):f?f+" "+u:u)):o):l!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=de.p?de.p(o,l):o+":"+l+";")}return a+(s&&n?s+"{"+n+"}":n)+i},ne={},Gt=t=>{if(typeof t=="object"){let s="";for(let a in t)s+=a+Gt(t[a]);return s}return t},$r=(t,s,a,i,n)=>{let o=Gt(t),l=ne[o]||(ne[o]=(u=>{let d=0,h=11;for(;d<u.length;)h=101*h+u.charCodeAt(d++)>>>0;return"go"+h})(o));if(!ne[l]){let u=o!==t?t:(d=>{let h,b,D=[{}];for(;h=Or.exec(d.replace(Rr,""));)h[4]?D.shift():h[3]?(b=h[3].replace(_t," ").trim(),D.unshift(D[0][b]=D[0][b]||{})):D[0][h[1]]=h[2].replace(_t," ").trim();return D[0]})(t);ne[l]=de(n?{["@keyframes "+l]:u}:u,a?"":"."+l)}let f=a&&ne.g?ne.g:null;return a&&(ne.g=ne[l]),((u,d,h,b)=>{b?d.data=d.data.replace(b,u):d.data.indexOf(u)===-1&&(d.data=h?u+d.data:d.data+u)})(ne[l],s,i,f),l},Pr=(t,s,a)=>t.reduce((i,n,o)=>{let l=s[o];if(l&&l.call){let f=l(a),u=f&&f.props&&f.props.className||/^go/.test(f)&&f;l=u?"."+u:f&&typeof f=="object"?f.props?"":de(f,""):f===!1?"":f}return i+n+(l??"")},"");function Ye(t){let s=this||{},a=t.call?t(s.p):t;return $r(a.unshift?a.raw?Pr(a,[].slice.call(arguments,1),s.p):a.reduce((i,n)=>Object.assign(i,n&&n.call?n(s.p):n),{}):a,Ar(s.target),s.g,s.o,s.k)}let Qt,dt,ut;Ye.bind({g:1});let ie=Ye.bind({k:1});function Lr(t,s,a,i){de.p=s,Qt=t,dt=a,ut=i}function ge(t,s){let a=this||{};return function(){let i=arguments;function n(o,l){let f=Object.assign({},o),u=f.className||n.className;a.p=Object.assign({theme:dt&&dt()},f),a.o=/ *go\d+/.test(u),f.className=Ye.apply(a,i)+(u?" "+u:"");let d=t;return t[0]&&(d=f.as||t,delete f.as),ut&&d[0]&&ut(f),Qt(d,f)}return n}}var Fr=t=>typeof t=="function",Fe=(t,s)=>Fr(t)?t(s):t,Br=(()=>{let t=0;return()=>(++t).toString()})(),Kt=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let s=matchMedia("(prefers-reduced-motion: reduce)");t=!s||s.matches}return t}})(),Ur=20,pt="default",Jt=(t,s)=>{let{toastLimit:a}=t.settings;switch(s.type){case 0:return{...t,toasts:[s.toast,...t.toasts].slice(0,a)};case 1:return{...t,toasts:t.toasts.map(l=>l.id===s.toast.id?{...l,...s.toast}:l)};case 2:let{toast:i}=s;return Jt(t,{type:t.toasts.find(l=>l.id===i.id)?1:0,toast:i});case 3:let{toastId:n}=s;return{...t,toasts:t.toasts.map(l=>l.id===n||n===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(l=>l.id!==s.toastId)};case 5:return{...t,pausedAt:s.time};case 6:let o=s.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+o}))}}},Pe=[],Zt={toasts:[],pausedAt:void 0,settings:{toastLimit:Ur}},ae={},es=(t,s=pt)=>{ae[s]=Jt(ae[s]||Zt,t),Pe.forEach(([a,i])=>{a===s&&i(ae[s])})},ts=t=>Object.keys(ae).forEach(s=>es(t,s)),Mr=t=>Object.keys(ae).find(s=>ae[s].toasts.some(a=>a.id===t)),He=(t=pt)=>s=>{es(s,t)},Vr={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Yr=(t={},s=pt)=>{let[a,i]=m.useState(ae[s]||Zt),n=m.useRef(ae[s]);m.useEffect(()=>(n.current!==ae[s]&&i(ae[s]),Pe.push([s,i]),()=>{let l=Pe.findIndex(([f])=>f===s);l>-1&&Pe.splice(l,1)}),[s]);let o=a.toasts.map(l=>{var f,u,d;return{...t,...t[l.type],...l,removeDelay:l.removeDelay||((f=t[l.type])==null?void 0:f.removeDelay)||t?.removeDelay,duration:l.duration||((u=t[l.type])==null?void 0:u.duration)||t?.duration||Vr[l.type],style:{...t.style,...(d=t[l.type])==null?void 0:d.style,...l.style}}});return{...a,toasts:o}},Hr=(t,s="blank",a)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:s,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...a,id:a?.id||Br()}),De=t=>(s,a)=>{let i=Hr(s,t,a);return He(i.toasterId||Mr(i.id))({type:2,toast:i}),i.id},Q=(t,s)=>De("blank")(t,s);Q.error=De("error");Q.success=De("success");Q.loading=De("loading");Q.custom=De("custom");Q.dismiss=(t,s)=>{let a={type:3,toastId:t};s?He(s)(a):ts(a)};Q.dismissAll=t=>Q.dismiss(void 0,t);Q.remove=(t,s)=>{let a={type:4,toastId:t};s?He(s)(a):ts(a)};Q.removeAll=t=>Q.remove(void 0,t);Q.promise=(t,s,a)=>{let i=Q.loading(s.loading,{...a,...a?.loading});return typeof t=="function"&&(t=t()),t.then(n=>{let o=s.success?Fe(s.success,n):void 0;return o?Q.success(o,{id:i,...a,...a?.success}):Q.dismiss(i),n}).catch(n=>{let o=s.error?Fe(s.error,n):void 0;o?Q.error(o,{id:i,...a,...a?.error}):Q.dismiss(i)}),t};var Wr=1e3,zr=(t,s="default")=>{let{toasts:a,pausedAt:i}=Yr(t,s),n=m.useRef(new Map).current,o=m.useCallback((b,D=Wr)=>{if(n.has(b))return;let T=setTimeout(()=>{n.delete(b),l({type:4,toastId:b})},D);n.set(b,T)},[]);m.useEffect(()=>{if(i)return;let b=Date.now(),D=a.map(T=>{if(T.duration===1/0)return;let R=(T.duration||0)+T.pauseDuration-(b-T.createdAt);if(R<0){T.visible&&Q.dismiss(T.id);return}return setTimeout(()=>Q.dismiss(T.id,s),R)});return()=>{D.forEach(T=>T&&clearTimeout(T))}},[a,i,s]);let l=m.useCallback(He(s),[s]),f=m.useCallback(()=>{l({type:5,time:Date.now()})},[l]),u=m.useCallback((b,D)=>{l({type:1,toast:{id:b,height:D}})},[l]),d=m.useCallback(()=>{i&&l({type:6,time:Date.now()})},[i,l]),h=m.useCallback((b,D)=>{let{reverseOrder:T=!1,gutter:R=8,defaultPosition:L}=D||{},k=a.filter(j=>(j.position||L)===(b.position||L)&&j.height),M=k.findIndex(j=>j.id===b.id),p=k.filter((j,C)=>C<M&&j.visible).length;return k.filter(j=>j.visible).slice(...T?[p+1]:[0,p]).reduce((j,C)=>j+(C.height||0)+R,0)},[a]);return m.useEffect(()=>{a.forEach(b=>{if(b.dismissed)o(b.id,b.removeDelay);else{let D=n.get(b.id);D&&(clearTimeout(D),n.delete(b.id))}})},[a,o]),{toasts:a,handlers:{updateHeight:u,startPause:f,endPause:d,calculateOffset:h}}},Xr=ie`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,qr=ie`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Gr=ie`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Qr=ge("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Xr} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${qr} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Gr} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Kr=ie`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Jr=ge("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${Kr} 1s linear infinite;
`,Zr=ie`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,ea=ie`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,ta=ge("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Zr} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${ea} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,sa=ge("div")`
  position: absolute;
`,ra=ge("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,aa=ie`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,na=ge("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${aa} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,oa=({toast:t})=>{let{icon:s,type:a,iconTheme:i}=t;return s!==void 0?typeof s=="string"?m.createElement(na,null,s):s:a==="blank"?null:m.createElement(ra,null,m.createElement(Jr,{...i}),a!=="loading"&&m.createElement(sa,null,a==="error"?m.createElement(Qr,{...i}):m.createElement(ta,{...i})))},la=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,ia=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,ca="0%{opacity:0;} 100%{opacity:1;}",da="0%{opacity:1;} 100%{opacity:0;}",ua=ge("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,ma=ge("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,ha=(t,s)=>{let a=t.includes("top")?1:-1,[i,n]=Kt()?[ca,da]:[la(a),ia(a)];return{animation:s?`${ie(i)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ie(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},ga=m.memo(({toast:t,position:s,style:a,children:i})=>{let n=t.height?ha(t.position||s||"top-center",t.visible):{opacity:0},o=m.createElement(oa,{toast:t}),l=m.createElement(ma,{...t.ariaProps},Fe(t.message,t));return m.createElement(ua,{className:t.className,style:{...n,...a,...t.style}},typeof i=="function"?i({icon:o,message:l}):m.createElement(m.Fragment,null,o,l))});Lr(m.createElement);var xa=({id:t,className:s,style:a,onHeightUpdate:i,children:n})=>{let o=m.useCallback(l=>{if(l){let f=()=>{let u=l.getBoundingClientRect().height;i(t,u)};f(),new MutationObserver(f).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[t,i]);return m.createElement("div",{ref:o,className:s,style:a},n)},fa=(t,s)=>{let a=t.includes("top"),i=a?{top:0}:{bottom:0},n=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Kt()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${s*(a?1:-1)}px)`,...i,...n}},pa=Ye`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ae=16,ya=({reverseOrder:t,position:s="top-center",toastOptions:a,gutter:i,children:n,toasterId:o,containerStyle:l,containerClassName:f})=>{let{toasts:u,handlers:d}=zr(a,o);return m.createElement("div",{"data-rht-toaster":o||"",style:{position:"fixed",zIndex:9999,top:Ae,left:Ae,right:Ae,bottom:Ae,pointerEvents:"none",...l},className:f,onMouseEnter:d.startPause,onMouseLeave:d.endPause},u.map(h=>{let b=h.position||s,D=d.calculateOffset(h,{reverseOrder:t,gutter:i,defaultPosition:s}),T=fa(b,D);return m.createElement(xa,{id:h.id,key:h.id,onHeightUpdate:d.updateHeight,className:h.visible?pa:"",style:T},h.type==="custom"?Fe(h.message,h):n?n(h):m.createElement(ga,{toast:h,position:b}))}))},za=Q;const ba=Z(()=>K(()=>import("../chunks/Dashboard-Dpn-RWbg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])),"Dashboard"),At=Z(()=>K(()=>import("../chunks/Students-DKr86U6y.js"),__vite__mapDeps([9,1,3,4,10,7,5,6])),"Students"),ja=Z(()=>K(()=>import("../chunks/Teachers-pI8i9So_.js"),__vite__mapDeps([15,1,4,3,10,7,5,6])),"Teachers"),rt=Z(()=>K(()=>import("../chunks/TheoryLessons-DvGnHz5b.js"),__vite__mapDeps([16,1,4,3,2,12,5,6,7])),"TheoryLessons"),va=Z(()=>K(()=>import("../chunks/TheoryLessonDetails-B8DTxOnv.js"),__vite__mapDeps([17,1,4,3,10,7,2,5,6])),"TheoryLessonDetails"),Ot=Z(()=>K(()=>import("../chunks/Orchestras-BP6xjxmm.js"),__vite__mapDeps([18,1,4,3,10,7,2,5,6])),"Orchestras"),Rt=Z(()=>K(()=>import("../chunks/Rehearsals-D3u42LDk.js"),__vite__mapDeps([19,1,4,3,10,7,5,6])),"Rehearsals"),Na=Z(()=>K(()=>import("../chunks/RehearsalDetails-WAcsbBrI.js"),__vite__mapDeps([20,1,5,6,3,4,7])),"RehearsalDetails"),wa=Z(()=>K(()=>import("../chunks/Bagruts-BKeGkBBB.js"),__vite__mapDeps([21,1,4,3,10,7,2,22,5,6])),"Bagruts"),Ta=Z(()=>K(()=>import("../chunks/BagrutDetails-ClcsC8HC.js"),__vite__mapDeps([23,1,4,3,10,7,2,22,5,6])),"BagrutDetails"),Ia=Z(()=>K(()=>import("../chunks/Profile-BJFQlJEO.js"),__vite__mapDeps([24,1,5,6,3,7,14])),"Profile"),$t=Z(()=>K(()=>import("../chunks/RehearsalAttendance-YW9-mAbC.js"),__vite__mapDeps([25,1,5,6,3,7])),"ConductorAttendance"),Sa=Z(()=>K(()=>import("../chunks/OrchestraEnrollmentManager-MyNr7dtD.js"),__vite__mapDeps([26,1,5,6,3,7])),"OrchestraEnrollmentManager"),ka=Z(()=>K(()=>import("../chunks/StudentDetailsPageSimple-D1U1_x6r.js"),__vite__mapDeps([11,1,7,5,6,3,12,13,14,4])),"StudentDetailsPage"),Ca=Z(()=>K(()=>import("../chunks/TeacherDetailsPage-RNvBXzQU.js"),__vite__mapDeps([27,1,7,8,3,5,6])),"TeacherDetailsPage"),Da=Z(()=>K(()=>import("../chunks/OrchestraDetailsPage-C2uPI040.js"),__vite__mapDeps([28,1,5,6,3,7])),"OrchestraDetailsPage"),te=({message:t="×˜×•×¢×Ÿ ×¢××•×“..."})=>e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:t})]})});function z({children:t,allowedRoles:s}){const{isAuthenticated:a,isLoading:i,authError:n,checkAuthStatus:o,user:l}=ye(),[f,u]=Re.useState(0),d=2,h=()=>{if(!s||s.length===0)return!0;if(!l)return!1;const b=l.role||l.roles?.[0]||"",D=l.roles||[b],T={×× ×”×œ:"admin",××•×¨×”:"teacher",×× ×¦×—:"conductor","××“×¨×™×š ×ª×“×¨":"theory-teacher","××•×¨×” ×ª×™××•×¨×™×”":"theory-teacher"},R=D.map(k=>T[k]||k),L=T[b]||b;return s.some(k=>R.includes(k)||L===k||k==="admin"&&!b)};return Re.useEffect(()=>{if(n&&f<d){const b=setTimeout(()=>{console.log(`ğŸ”„ ProtectedRoute - Retrying authentication (${f+1}/${d})`),o(!0),u(D=>D+1)},1e3*(f+1));return()=>clearTimeout(b)}},[n,f,o]),Re.useEffect(()=>{a&&f>0&&u(0)},[a]),i?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:"××××ª ×”×¨×©××•×ª..."}),n&&f>0&&e.jsxs("div",{className:"mt-2 text-sm text-amber-600",children:["×× ×¡×” ×©×•×‘ (",f,"/",d,")..."]})]})}):a?h()?e.jsx(e.Fragment,{children:t}):e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-600 mb-4",children:[e.jsx("h3",{className:"text-lg font-bold",children:"××™×Ÿ ×”×¨×©××”"}),e.jsx("p",{className:"text-gray-600",children:"××™×Ÿ ×œ×š ×”×¨×©××” ×œ×’×©×ª ×œ×¢××•×“ ×–×”"})]}),e.jsx("button",{onClick:()=>window.history.back(),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"×—×–×•×¨"})]})}):e.jsx(Oe,{to:"/login",replace:!0})}function Ea(){return e.jsx("div",{dir:"rtl",children:e.jsxs(ps,{children:[e.jsx(H,{path:"/login",element:e.jsx(Tr,{})}),e.jsx(H,{path:"/forgot-password",element:e.jsx(Ir,{})}),e.jsx(H,{path:"/reset-password/:token",element:e.jsx(Sr,{})}),e.jsx(H,{path:"/dashboard",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(te,{message:"×˜×•×¢×Ÿ ×“×©×‘×•×¨×“..."}),children:e.jsx(ba,{})})})})}),e.jsx(H,{path:"/students",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(te,{message:"×˜×•×¢×Ÿ ×¨×©×™××ª ×ª×œ××™×“×™×..."}),children:e.jsx(At,{})})})})}),e.jsx(H,{path:"/students/:studentId",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(te,{message:"×˜×•×¢×Ÿ ×¤×¨×˜×™ ×ª×œ××™×“..."}),children:e.jsx(ka,{})})})})}),e.jsx(H,{path:"/teachers",element:e.jsx(z,{allowedRoles:["admin","teacher","conductor","theory-teacher"],children:e.jsx(W,{children:e.jsx(ja,{})})})}),e.jsx(H,{path:"/teachers/:teacherId",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:"×˜×•×¢×Ÿ ×¤×¨×˜×™ ××•×¨×”..."})]})}),children:e.jsx(Ca,{})})})})}),e.jsx(H,{path:"/theory-lessons",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(rt,{})})})}),e.jsx(H,{path:"/theory-lessons/:theoryId",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(va,{})})})}),e.jsx(H,{path:"/orchestras",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(Ot,{})})})}),e.jsx(H,{path:"/orchestras/:orchestraId",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:"×˜×•×¢×Ÿ ×¤×¨×˜×™ ×ª×–××•×¨×ª..."})]})}),children:e.jsx(Da,{})})})})}),e.jsx(H,{path:"/rehearsals",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(Rt,{})})})}),e.jsx(H,{path:"/rehearsals/:rehearsalId",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(Na,{})})})}),e.jsx(H,{path:"/bagruts",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(wa,{})})})}),e.jsx(H,{path:"/bagruts/:bagrutId",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(Ta,{})})})}),e.jsx(H,{path:"/bagruts/:bagrutId/edit",element:e.jsx(z,{children:e.jsx(W,{children:e.jsxs("div",{className:"p-6",dir:"rtl",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"×¢×¨×™×›×ª ×‘×’×¨×•×ª"}),e.jsx("p",{className:"text-gray-600",children:"×¢×¨×™×›×ª ×¤×¨×˜×™ ×”×‘×’×¨×•×ª ×•×”×ª×§×“××•×ª"}),e.jsx("div",{className:"mt-8 p-4 bg-blue-50 rounded-lg",children:e.jsx("p",{className:"text-blue-700",children:"ğŸ”§ ×¢××•×“ ×¢×¨×™×›×ª ×‘×’×¨×•×ª ×‘×¤×™×ª×•×— - ×‘×™× ×ª×™×™× × ×™×ª×Ÿ ×œ×¢×¨×•×š ×“×¨×š ×¢××•×“ ×”×¤×¨×˜×™×"})})]})})})}),e.jsx(H,{path:"/bagrut",element:e.jsx(Oe,{to:"/bagruts",replace:!0})}),e.jsx(H,{path:"/profile",element:e.jsx(z,{children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(te,{message:"×˜×•×¢×Ÿ ×¢××•×“ ××™×©×™..."}),children:e.jsx(Ia,{})})})})}),e.jsx(H,{path:"/conductor/attendance",element:e.jsx(z,{allowedRoles:["conductor","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(te,{message:"×˜×•×¢×Ÿ × ×•×›×—×•×ª ×—×–×¨×•×ª..."}),children:e.jsx($t,{})})})})}),e.jsx(H,{path:"/conductor/attendance/:rehearsalId",element:e.jsx(z,{allowedRoles:["conductor","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(te,{message:"×˜×•×¢×Ÿ × ×•×›×—×•×ª ×—×–×¨×”..."}),children:e.jsx($t,{})})})})}),e.jsx(H,{path:"/conductor/enrollment",element:e.jsx(z,{allowedRoles:["conductor","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(te,{message:"×˜×•×¢×Ÿ × ×™×”×•×œ ×¨×™×©×•××™×..."}),children:e.jsx(Sa,{})})})})}),e.jsx(H,{path:"/conductor/orchestras",element:e.jsx(z,{allowedRoles:["conductor","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(te,{message:"×˜×•×¢×Ÿ × ×™×”×•×œ ×ª×–××•×¨×•×ª..."}),children:e.jsx(Ot,{})})})})}),e.jsx(H,{path:"/conductor/rehearsals",element:e.jsx(z,{allowedRoles:["conductor","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(te,{message:"×˜×•×¢×Ÿ ×—×–×¨×•×ª..."}),children:e.jsx(Rt,{})})})})}),e.jsx(H,{path:"/conductor/musicians",element:e.jsx(z,{allowedRoles:["conductor","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(te,{message:"×˜×•×¢×Ÿ ××•×–×™×§××™×..."}),children:e.jsx(At,{})})})})}),e.jsx(H,{path:"/theory-teacher/lessons",element:e.jsx(z,{allowedRoles:["theory-teacher","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(te,{message:"×˜×•×¢×Ÿ ×©×™×¢×•×¨×™ ×ª×™××•×¨×™×”..."}),children:e.jsx(rt,{})})})})}),e.jsx(H,{path:"/theory-teacher/groups",element:e.jsx(z,{allowedRoles:["theory-teacher","admin"],children:e.jsx(W,{children:e.jsx(m.Suspense,{fallback:e.jsx(te,{message:"×˜×•×¢×Ÿ ×§×‘×•×¦×•×ª ×ª×™××•×¨×™×”..."}),children:e.jsx(rt,{})})})})}),e.jsx(H,{path:"/",element:e.jsx(Oe,{to:"/dashboard",replace:!0})}),e.jsx(H,{path:"*",element:e.jsx(Oe,{to:"/dashboard",replace:!0})})]})})}function _a(){return m.useEffect(()=>{Er()},[]),e.jsx(Xs,{children:e.jsx(Ls,{children:e.jsx(Fs,{children:e.jsx(zs,{children:e.jsxs(qs,{children:[e.jsx(ya,{position:"top-center",reverseOrder:!1,gutter:8,containerClassName:"",containerStyle:{},toastOptions:{duration:4e3,style:{background:"#fff",color:"#363636",padding:"16px",borderRadius:"8px",fontSize:"14px",fontFamily:"Reisinger-Yonatan, sans-serif",direction:"rtl"},success:{style:{background:"#F0FDF4",color:"#166534",border:"1px solid #86EFAC"},iconTheme:{primary:"#22C55E",secondary:"#F0FDF4"}},error:{style:{background:"#FEE2E2",color:"#991B1B",border:"1px solid #FCA5A5"},iconTheme:{primary:"#EF4444",secondary:"#FEE2E2"}}}}),e.jsx(Ea,{})]})})})})})}Ns();const Aa=new Lt({defaultOptions:{queries:{staleTime:1e3*60*5,retry:(t,s)=>s?.status===404||s?.status===403?!1:t<3}}}),ss=document.getElementById("root");if(!ss)throw new Error("Root element not found");lt.createRoot(ss).render(e.jsx(Re.StrictMode,{children:e.jsx(Ft,{client:Aa,children:e.jsx(ys,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsx(_a,{})})})}));export{or as A,Qs as C,ir as D,Gs as M,xr as R,sr as S,lr as T,it as V,Wt as a,ft as b,Dt as c,qt as d,dr as e,cr as f,Wa as g,Ya as h,Ma as i,e as j,Va as k,Q as n,Ha as s,ye as u,za as z};
