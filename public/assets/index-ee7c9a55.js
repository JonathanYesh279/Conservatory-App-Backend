var me=Object.defineProperty;var ge=(t,r,n)=>r in t?me(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n;var G=(t,r,n)=>(ge(t,typeof r!="symbol"?r+"":r,n),n);import{r as c,a as fe,u as pe,L as q,b as Z,c as xe,d as v,N as H,R as F,B as ye}from"../chunks/vendor-594479e1.js";import{a as C,_,e as be}from"../chunks/cascade-deletion-5647227d.js";import{Q as ee,c as te}from"../chunks/query-5c608ab7.js";import{X as je,M as ve,S as we,P as Te,H as _e,U as re,G as se,B as ae,a as Ne,C as P,A as Ee,b as Se,c as Ae,d as Q,e as ne,f as oe,g as Re,h as K,i as Ce,L as De}from"../chunks/ui-0ea49fd5.js";import"../chunks/utils-a4d8ec6e.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerPolicy&&(s.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?s.credentials="include":l.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(l){if(l.ep)return;l.ep=!0;const s=n(l);fetch(l.href,s)}})();var le={exports:{}},$={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oe=c,Ie=Symbol.for("react.element"),Le=Symbol.for("react.fragment"),Pe=Object.prototype.hasOwnProperty,Ue=Oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ke={key:!0,ref:!0,__self:!0,__source:!0};function ie(t,r,n){var a,l={},s=null,i=null;n!==void 0&&(s=""+n),r.key!==void 0&&(s=""+r.key),r.ref!==void 0&&(i=r.ref);for(a in r)Pe.call(r,a)&&!ke.hasOwnProperty(a)&&(l[a]=r[a]);if(t&&t.defaultProps)for(a in r=t.defaultProps,r)l[a]===void 0&&(l[a]=r[a]);return{$$typeof:Ie,type:t,key:s,ref:i,props:l,_owner:Ue.current}}$.Fragment=Le;$.jsx=ie;$.jsxs=ie;le.exports=$;var e=le.exports,W={},J=fe;W.createRoot=J.createRoot,W.hydrateRoot=J.hydrateRoot;const ce=c.createContext(null),M=()=>{const t=c.useContext(ce);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},Be=({children:t})=>{const[r,n]=c.useState(!1),[a,l]=c.useState(!0),[s,i]=c.useState(null),[u,g]=c.useState(null),[o,h]=c.useState(null),b=c.useRef(!1),w=c.useRef(null),A=c.useRef(!0);c.useEffect(()=>{A.current=!0;const f=setTimeout(()=>{A.current&&I()},100);return()=>{A.current=!1,w.current&&clearTimeout(w.current),clearTimeout(f)}},[]);const I=c.useCallback(async(f=!1)=>{if(b.current&&!f){console.log("ğŸ” AUTH CONTEXT - Validation already in progress, skipping");return}const N=Date.now();if(!f&&o&&N-o<3e4){console.log("ğŸ” AUTH CONTEXT - Using cached authentication status");return}b.current=!0,g(null);try{if(C.auth.isAuthenticated()){console.log("ğŸ” AUTH CONTEXT - Token found, validating with server");const p=await C.auth.validateToken();if(!A.current)return;const D=p?.data?.user||p?.user||p?.data||p;console.log("ğŸ” AUTH CONTEXT - Token validation successful, fetching full teacher data");let x=null;if(D?._id)try{x=await C.teachers.getTeacher(D._id),console.log("ğŸ” AUTH CONTEXT - Full teacher data fetched:",{hasPersonalInfo:!!x?.personalInfo,hasRoles:!!x?.roles,fullName:x?.personalInfo?.fullName})}catch(O){console.warn("ğŸ” AUTH CONTEXT - Could not fetch full teacher data:",O),x=D}const T=x||D,j={...T,teacherId:T?.teacherId||T?._id,personalInfo:T?.personalInfo||{fullName:T?.fullName||D?.fullName||"",email:T?.email||D?.email||"",phone:T?.phone||"",address:T?.address||""},roles:T?.roles||D?.roles||[],role:T?.role||T?.roles?.[0]||D?.roles?.[0]||""};console.log("ğŸ” AUTH CONTEXT - User data normalized:",{hasUserData:!!j,userRole:j?.role||j?.roles,userId:j?.teacherId||j?._id,fullName:j?.personalInfo?.fullName}),n(!0),i(j),h(N)}else console.log("ğŸ” AUTH CONTEXT - No valid token found"),n(!1),i(null),h(N)}catch(p){if(console.error("ğŸ” AUTH CONTEXT - Auth validation failed:",p),!A.current)return;g(p.message),n(!1),i(null),h(N),p.message.includes("Authentication failed")&&C.auth.isAuthenticated()&&console.log("ğŸ” AUTH CONTEXT - Attempting token refresh")}finally{A.current&&l(!1),b.current=!1}},[o]),L=async(f,N)=>{try{l(!0),g(null);const p=await C.auth.login(f,N);if(!A.current)return;console.log("ğŸ” AUTH CONTEXT - Login successful:",{hasToken:!!p.token,hasUserData:!!(p.teacher||p.user)});const{token:D}=p,x=p.teacher||p.user||p.data?.teacher||p.data?.user||p.data;if(!D||!x)throw new Error("Invalid login response: missing token or user data");console.log("ğŸ” AUTH CONTEXT - Fetching full teacher data after login");let T=null;if(x?._id||x?.teacherId)try{const z=x._id||x.teacherId;T=await C.teachers.getTeacher(z),console.log("ğŸ” AUTH CONTEXT - Full teacher data fetched after login:",{hasPersonalInfo:!!T?.personalInfo,hasRoles:!!T?.roles,fullName:T?.personalInfo?.fullName})}catch(z){console.warn("ğŸ” AUTH CONTEXT - Could not fetch full teacher data after login:",z),T=x}const j=T||x,O={...j,teacherId:j?.teacherId||j?._id,personalInfo:j?.personalInfo||{fullName:j?.fullName||x?.personalInfo?.fullName||x?.fullName||"",email:j?.email||x?.credentials?.email||x?.personalInfo?.email||x?.email||f,phone:j?.phone||x?.personalInfo?.phone||"",address:j?.address||x?.personalInfo?.address||""},roles:j?.roles||x?.roles||[],role:j?.role||j?.roles?.[0]||x?.roles?.[0]||""};return console.log("ğŸ” AUTH CONTEXT - User data normalized after login:",{hasUserData:!!O,userRole:O?.role||O?.roles,userId:O?.teacherId||O?._id,fullName:O?.personalInfo?.fullName}),n(!0),i(O),h(Date.now()),{success:!0,user:O}}catch(p){throw console.error("ğŸ” AUTH CONTEXT - Login failed:",p),A.current&&(g(p.message),n(!1),i(null)),p}finally{A.current&&l(!1)}},k=async()=>{try{l(!0),await C.auth.logout(),console.log("ğŸ” AUTH CONTEXT - Logout successful")}catch(f){console.warn("ğŸ” AUTH CONTEXT - Logout API call failed:",f)}finally{A.current&&(n(!1),i(null),g(null),h(null),l(!1))}},y=c.useCallback(async()=>{try{return console.log("ğŸ” AUTH CONTEXT - Attempting token refresh"),await I(!0),r}catch(f){return console.error("ğŸ” AUTH CONTEXT - Token refresh failed:",f),await k(),!1}},[r]),d=c.useCallback(()=>({isAuthenticated:r,isLoading:a,user:s?{id:s.teacherId||s.id,role:s.role}:null,authError:u,lastValidation:o?new Date(o).toISOString():null,isValidating:b.current,cacheAge:o?Date.now()-o:null}),[r,a,s,u,o]),m={isAuthenticated:r,isLoading:a,user:s,authError:u,login:L,logout:k,checkAuthStatus:I,refreshToken:y,debugAuth:d};return e.jsx(ce.Provider,{value:m,children:t})},de=c.createContext(null),Ve=()=>{const t=c.useContext(de);if(!t)throw new Error("useSchoolYear must be used within a SchoolYearProvider");return t},He=({children:t})=>{const{isAuthenticated:r}=M(),[n,a]=c.useState(null),[l,s]=c.useState([]),[i,u]=c.useState(!0),[g,o]=c.useState(null);c.useEffect(()=>{r?h():(a(null),s([]),u(!1),o(null))},[r]);const h=async()=>{try{u(!0),o(null);const d=await C.schoolYears.getSchoolYears();s(d);const m=await C.schoolYears.getCurrentSchoolYear();if(m)a(m);else if(d.length>0){const f=d.sort((N,p)=>new Date(p.startDate)-new Date(N.startDate))[0];a(f)}console.log(`ğŸ“ Loaded ${d.length} school years, current: ${m?.name||"None"}`)}catch(d){console.error("Failed to load school years:",d),o(d.message||"×©×’×™××” ×‘×˜×¢×™× ×ª ×©× ×•×ª ×”×œ×™××•×“")}finally{u(!1)}},b=async d=>{try{const m=l.find(f=>f._id===d);if(m)a(m),console.log(`ğŸ¯ Switched to school year: ${m.name}`);else{const f=await C.schoolYears.getSchoolYear(d);a(f),console.log(`ğŸ¯ Switched to fetched school year: ${f.name}`)}}catch(m){console.error("Failed to set school year:",m),o(m.message||"×©×’×™××” ×‘×¢×“×›×•×Ÿ ×©× ×ª ×”×œ×™××•×“")}},w=async d=>{try{const m=await C.schoolYears.createSchoolYear(d);return s(f=>[...f,m]),d.isCurrent&&a(m),console.log(`â• Created new school year: ${m.name}`),m}catch(m){throw console.error("Failed to create school year:",m),o(m.message||"×©×’×™××” ×‘×™×¦×™×¨×ª ×©× ×ª ×”×œ×™××•×“"),m}},A=async(d,m)=>{try{const f=await C.schoolYears.updateSchoolYear(d,m);return s(N=>N.map(p=>p._id===d?f:p)),n&&n._id===d&&a(f),console.log(`âœï¸ Updated school year: ${f.name}`),f}catch(f){throw console.error("Failed to update school year:",f),o(f.message||"×©×’×™××” ×‘×¢×“×›×•×Ÿ ×©× ×ª ×”×œ×™××•×“"),f}},I=async d=>{try{if(await C.schoolYears.deleteSchoolYear(d),s(m=>m.filter(f=>f._id!==d)),n&&n._id===d){const m=l.filter(f=>f._id!==d);m.length>0?a(m[0]):a(null)}console.log(`ğŸ—‘ï¸ Deleted school year: ${d}`)}catch(m){throw console.error("Failed to delete school year:",m),o(m.message||"×©×’×™××” ×‘××—×™×§×ª ×©× ×ª ×”×œ×™××•×“"),m}},L=d=>{if(!d)return!1;const m=new Date,f=new Date(d.startDate),N=new Date(d.endDate);return m>=f&&m<=N&&d.isActive},y={currentSchoolYear:n,schoolYears:l,isLoading:i,error:g,loadSchoolYears:h,setCurrentSchoolYearById:b,createSchoolYear:w,updateSchoolYear:A,deleteSchoolYear:I,isSchoolYearActive:L,getSchoolYearDisplayName:d=>{if(!d)return"×œ× × ×‘×—×¨×” ×©× ×”";const m=d.isCurrent,f=L(d);let N=d.name;return m?N+=" (× ×•×›×—×™×ª)":f&&(N+=" (×¤×¢×™×œ×”)"),N}};return e.jsx(de.Provider,{value:y,children:t})},Fe={currentBagrut:null,bagruts:[],loading:!1,error:null,validation:{errors:{},warnings:{}}},$e=t=>{if(!t[3]?.detailedGrading)return 0;const r=t[3].detailedGrading;return(r.playingSkills?.points||0)+(r.musicalUnderstanding?.points||0)+(r.textKnowledge?.points||0)+(r.playingByHeart?.points||0)},Me=(t,r)=>{const n=t/100*100,a=r/100*100;return n*.9+a*.1},ze=t=>t>=95?"××¦×•×™×Ÿ (100-95)":t>=85?"×˜×•×‘ ×××“ (94-85)":t>=75?"×˜×•×‘ (84-75)":t>=65?"×›××¢×˜ ×˜×•×‘ (74-65)":t>=55?"××¡×¤×™×§ (64-55)":"×œ× ××¡×¤×™×§ (54-0)",Ge=t=>({presentations:[t.presentations?.[0]?.completed||!1,t.presentations?.[1]?.completed||!1,t.presentations?.[2]?.completed||!1,t.presentations?.[3]?.completed||!1],directorEvaluation:!!t.directorEvaluation?.points,recitalConfig:!!(t.recitalConfiguration?.units&&t.recitalConfiguration?.field),program:t.program?.length>0}),B=(t,r,n)=>t<0?`${n} ×œ× ×™×›×•×œ ×œ×”×™×•×ª ×©×œ×™×œ×™`:t>r?`${n} ×œ× ×™×›×•×œ ×œ×¢×œ×•×ª ×¢×œ ${r} × ×§×•×“×•×ª`:null,Ye=t=>t!==3&&t!==5?"×™×—×™×“×•×ª ×¨×¡×™×˜×œ ×—×™×™×‘×•×ª ×œ×”×™×•×ª 3 ××• 5":null,Xe=(t,r)=>{switch(r.type){case"SET_LOADING":return{...t,loading:r.payload};case"SET_ERROR":return{...t,error:r.payload};case"SET_CURRENT_BAGRUT":return console.log("âœ… BagrutContext: SET_CURRENT_BAGRUT reducer:",r.payload?._id),{...t,currentBagrut:r.payload};case"SET_BAGRUTS":return{...t,bagruts:r.payload};case"UPDATE_DIRECTOR_EVALUATION":{const{bagrutId:n,evaluation:a}=r.payload,l=t.currentBagrut?._id===n?{...t.currentBagrut,directorEvaluation:a}:t.currentBagrut,s=t.bagruts.map(i=>i._id===n?{...i,directorEvaluation:a}:i);return{...t,currentBagrut:l,bagruts:s}}case"UPDATE_RECITAL_CONFIG":{const{bagrutId:n,config:a}=r.payload,l={units:a.recitalUnits,field:a.recitalField},s=t.currentBagrut?._id===n?{...t.currentBagrut,recitalConfiguration:l,recitalUnits:a.recitalUnits,recitalField:a.recitalField}:t.currentBagrut,i=t.bagruts.map(u=>u._id===n?{...u,recitalConfiguration:l,recitalUnits:a.recitalUnits,recitalField:a.recitalField}:u);return{...t,currentBagrut:s,bagruts:i}}case"UPDATE_PRESENTATION":{const{bagrutId:n,index:a,data:l}=r.payload,s=(g=[])=>{const o=[...g];return o[a]={...o[a],...l},o},i=t.currentBagrut?._id===n?{...t.currentBagrut,presentations:s(t.currentBagrut.presentations)}:t.currentBagrut,u=t.bagruts.map(g=>g._id===n?{...g,presentations:s(g.presentations)}:g);return{...t,currentBagrut:i,bagruts:u}}case"CALCULATE_COMPUTED_VALUES":{const{bagrutId:n}=r.payload,a=l=>{if(l._id!==n)return l;const s=$e(l.presentations||[]),i=l.directorEvaluation?.points||0,u=Me(s,i),g=ze(u),o=Ge(l);return{...l,computedValues:{totalPerformancePoints:s,weightedFinalGrade:u,gradeLevel:g,completionStatus:o},finalGrade:u,finalGradeLevel:g}};return{...t,currentBagrut:t.currentBagrut?a(t.currentBagrut):null,bagruts:t.bagruts.map(a)}}case"SET_VALIDATION_ERROR":return{...t,validation:{...t.validation,errors:{...t.validation.errors,[r.payload.field]:r.payload.message}}};case"CLEAR_VALIDATION_ERRORS":return{...t,validation:{...t.validation,errors:{}}};default:return t}},ue=c.createContext(null),qe=({children:t})=>{const[r,n]=c.useReducer(Xe,Fe),a=c.useMemo(()=>({setLoading:s=>n({type:"SET_LOADING",payload:s}),setError:s=>n({type:"SET_ERROR",payload:s}),setCurrentBagrut:s=>{console.log("ğŸ’¾ BagrutContext: setCurrentBagrut action called with:",s?._id),n({type:"SET_CURRENT_BAGRUT",payload:s})},setBagruts:s=>n({type:"SET_BAGRUTS",payload:s}),updateDirectorEvaluation:(s,i)=>{const u=B(i.points||0,100,"×”×¢×¨×›×ª ×× ×”×œ");if(u){n({type:"SET_VALIDATION_ERROR",payload:{field:"directorEvaluation",message:u}});return}n({type:"UPDATE_DIRECTOR_EVALUATION",payload:{bagrutId:s,evaluation:i}}),n({type:"CALCULATE_COMPUTED_VALUES",payload:{bagrutId:s}})},updateRecitalConfig:(s,i)=>{const u=Ye(i.recitalUnits);if(u){n({type:"SET_VALIDATION_ERROR",payload:{field:"recitalUnits",message:u}});return}n({type:"UPDATE_RECITAL_CONFIG",payload:{bagrutId:s,config:i}}),n({type:"CALCULATE_COMPUTED_VALUES",payload:{bagrutId:s}})},updatePresentation:(s,i,u)=>{if(u.detailedGrading){const g=u.detailedGrading,o=[];if(g.playingSkills?.points!==void 0){const h=B(g.playingSkills.points,40,"×›×™×©×•×¨×™ × ×’×™× ×”");h&&o.push(h)}if(g.musicalUnderstanding?.points!==void 0){const h=B(g.musicalUnderstanding.points,30,"×”×‘× ×” ××•×–×™×§×œ×™×ª");h&&o.push(h)}if(g.textKnowledge?.points!==void 0){const h=B(g.textKnowledge.points,20,"×™×“×¢ ×˜×§×¡×˜");h&&o.push(h)}if(g.playingByHeart?.points!==void 0){const h=B(g.playingByHeart.points,10,"× ×’×™× ×” ×‘×¢×œ ×¤×”");h&&o.push(h)}if(o.length>0){n({type:"SET_VALIDATION_ERROR",payload:{field:`presentation${i}`,message:o[0]}});return}}n({type:"UPDATE_PRESENTATION",payload:{bagrutId:s,index:i,data:u}}),n({type:"CALCULATE_COMPUTED_VALUES",payload:{bagrutId:s}})},recalculateGrade:s=>{n({type:"CALCULATE_COMPUTED_VALUES",payload:{bagrutId:s}})},setValidationError:(s,i)=>{n({type:"SET_VALIDATION_ERROR",payload:{field:s,message:i}})},clearValidationErrors:()=>{n({type:"CLEAR_VALIDATION_ERRORS"})},validatePointTotal:s=>(s.playingSkills?.points||0)+(s.musicalUnderstanding?.points||0)+(s.textKnowledge?.points||0)+(s.playingByHeart?.points||0)>100?(n({type:"SET_VALIDATION_ERROR",payload:{field:"totalPoints",message:"×¡×š ×”× ×§×•×“×•×ª ×œ× ×™×›×•×œ ×œ×¢×œ×•×ª ×¢×œ 100"}}),!1):!0,validateSequentialPresentation:(s,i)=>s>0&&!i[s-1]?.completed?(n({type:"SET_VALIDATION_ERROR",payload:{field:`presentation${s}`,message:`×™×© ×œ×”×©×œ×™× ×ª×—×™×œ×” ××¦×’×ª ${s}`}}),!1):!0}),[]),l=c.useMemo(()=>({state:r,actions:a}),[r,a]);return e.jsx(ue.Provider,{value:l,children:t})},Rt=()=>{const t=c.useContext(ue);if(!t)throw new Error("useBagrutContext must be used within a BagrutProvider");return t},Ct={getCurrentBagrut:t=>t.currentBagrut,getAllBagruts:t=>t.bagruts,getLoadingState:t=>t.loading,getError:t=>t.error,getValidationErrors:t=>t.validation.errors,getBagrutById:(t,r)=>t.bagruts.find(n=>n._id===r),getCompletedPresentations:(t,r)=>t.bagruts.find(a=>a._id===r)?.presentations?.filter(a=>a.completed)||[],getTotalPerformancePoints:(t,r)=>t.bagruts.find(a=>a._id===r)?.computedValues?.totalPerformancePoints||0,getWeightedFinalGrade:(t,r)=>t.bagruts.find(a=>a._id===r)?.computedValues?.weightedFinalGrade||0,getCompletionStatus:(t,r)=>t.bagruts.find(a=>a._id===r)?.computedValues?.completionStatus||{presentations:[!1,!1,!1,!1],directorEvaluation:!1,recitalConfig:!1,program:!1}},U=new ee({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!0,refetchOnMount:!0,retry:(t,r)=>{const n=r?.response?.status;return n>=400&&n<500?!1:t<2},retryDelay:t=>Math.min(1e3*2**t,3e4),networkMode:"online"},mutations:{retry:1,networkMode:"online",onError:t=>{console.error("Mutation error:",t)}}}});U.setQueryDefaults(["students"],{staleTime:2*60*1e3,gcTime:5*60*1e3});U.setQueryDefaults(["teachers"],{staleTime:10*60*1e3,gcTime:30*60*1e3});U.setQueryDefaults(["theory-lessons"],{staleTime:2*60*1e3,gcTime:5*60*1e3});U.setQueryDefaults(["orchestras"],{staleTime:5*60*1e3,gcTime:15*60*1e3});U.setQueryDefaults(["school-years"],{staleTime:30*60*1e3,gcTime:60*60*1e3});function Qe({children:t}){return e.jsxs(te,{client:U,children:[t,!1]})}const We=[{name:"××™×“×¢ ×›×œ×œ×™",href:"/dashboard",icon:_e},{name:"×ª×œ××™×“×™×",href:"/students",icon:re},{name:"××•×¨×™×",href:"/teachers",icon:se},{name:"×©×™×¢×•×¨×™ ×ª×™××•×¨×™×”",href:"/theory-lessons",icon:ae},{name:"×ª×–××•×¨×•×ª",href:"/orchestras",icon:Ne},{name:"×—×–×¨×•×ª",href:"/rehearsals",icon:P},{name:"×‘×’×¨×•×™×•×ª",href:"/bagruts",icon:Ee},{name:"× ×•×›×—×•×ª",href:"/attendance",icon:Se},{name:"×“×•×—×•×ª",href:"/reports",icon:Ae},{name:"×”×’×“×¨×•×ª",href:"/settings",icon:Q}],Ke=[{name:"×”×•×¡×£ ×ª×œ××™×“ ×—×“×©",href:"/students/new",icon:re},{name:"×”×•×¡×£ ××•×¨×” ×—×“×©",href:"/teachers/new",icon:se},{name:"×¦×•×¨ ×©×™×¢×•×¨ ×ª×™××•×¨×™×”",href:"/theory-lessons/new",icon:ae},{name:"×ª×–××Ÿ ×—×–×¨×”",href:"/rehearsals/new",icon:P}];function Je(){const t=pe(),[r,n]=c.useState(""),[a,l]=c.useState(!1),[s,i]=c.useState(!1),u=o=>t.pathname===o;c.useEffect(()=>{const o=()=>{i(window.innerWidth<768),window.innerWidth>=768&&l(!1)};return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]),c.useEffect(()=>{const o=h=>{if(s&&a){const b=document.getElementById("mobile-sidebar"),w=document.getElementById("hamburger-button");b&&!b.contains(h.target)&&w&&!w.contains(h.target)&&l(!1)}};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[s,a]),c.useEffect(()=>(s&&a?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[s,a]);const g=()=>{s&&l(!1)};return e.jsxs(e.Fragment,{children:[s&&e.jsx("button",{id:"hamburger-button",onClick:()=>l(!a),className:"fixed top-4 right-4 z-[1001] p-2 bg-white rounded-lg shadow-lg border border-gray-200 hover:bg-gray-50 transition-colors duration-200","aria-label":"Toggle menu",children:a?e.jsx(je,{className:"w-6 h-6 text-gray-600"}):e.jsx(ve,{className:"w-6 h-6 text-gray-600"})}),s&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[999] transition-opacity duration-300",onClick:()=>l(!1)}),(!s||a)&&e.jsxs("div",{id:"mobile-sidebar",className:`fixed top-0 right-0 w-[280px] h-screen bg-white border-l border-gray-200 shadow-[-4px_0_6px_-1px_rgba(0,0,0,0.1)] rtl z-[1000] ${s?`transition-transform duration-300 ease-in-out ${a?"translate-x-0":"translate-x-full"}`:""}`,children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"×—×™×¤×•×©...",value:r,onChange:o=>n(o.target.value),className:"w-full pr-10 pl-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm font-reisinger-michal text-right rtl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),e.jsxs("nav",{className:"flex-1 px-3 py-4 overflow-y-auto",children:[e.jsxs("div",{className:"space-y-1 mb-6",children:[e.jsx("h3",{className:"px-4 text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"×ª×¤×¨×™×˜ ×¨××©×™"}),We.map(o=>{const h=o.icon,b=u(o.href);return e.jsxs(q,{to:o.href,onClick:g,className:`flex items-center justify-between px-4 py-3 mx-3 rounded-lg text-sm font-medium transition-all duration-150 rtl font-reisinger-michal ${b?"bg-primary-50 text-primary-700 border border-primary-200":"text-gray-600 hover:bg-gray-50 hover:text-gray-700"}`,children:[e.jsx("span",{className:"text-right",children:o.name}),e.jsx(h,{className:"w-5 h-5"})]},o.name)})]}),e.jsxs("div",{className:"space-y-1 border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"px-4 text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"×¤×¢×•×œ×•×ª ××”×™×¨×•×ª"}),Ke.map(o=>{const h=o.icon;return e.jsxs(q,{to:o.href,onClick:g,className:"flex items-center justify-between px-4 py-2 mx-3 rounded-lg text-sm font-medium transition-all duration-150 rtl font-reisinger-michal text-gray-600 hover:bg-green-50 hover:text-green-700 group",children:[e.jsx("span",{className:"text-right",children:o.name}),e.jsxs("div",{className:"flex items-center space-x-1 space-x-reverse",children:[e.jsx(Te,{className:"w-3 h-3 group-hover:text-green-500"}),e.jsx(h,{className:"w-4 h-4"})]})]},o.name)})]})]})]})]})}function Ze(){const[t,r]=c.useState(!1),n=c.useRef(null),{currentSchoolYear:a,schoolYears:l,isLoading:s,setCurrentSchoolYearById:i,getSchoolYearDisplayName:u}=Ve();c.useEffect(()=>{const o=h=>{n.current&&!n.current.contains(h.target)&&r(!1)};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[]);const g=async o=>{await i(o),r(!1)};return s?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx(P,{className:"w-4 h-4 text-gray-400"}),e.jsx("div",{className:"w-24 h-4 bg-gray-200 rounded animate-pulse"})]}):e.jsxs("div",{className:"relative",ref:n,children:[e.jsxs("button",{onClick:()=>r(!t),className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-gray-300 transition-all duration-150 ease-in-out min-w-[200px]",style:{direction:"rtl"},children:[e.jsx(P,{className:"w-4 h-4 text-indigo-600 flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 font-reisinger-michal flex-grow text-right truncate",children:a?u(a):"×‘×—×¨ ×©× ×ª ×œ×™××•×“"}),t?e.jsx(ne,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}):e.jsx(oe,{className:"w-4 h-4 text-gray-500 flex-shrink-0"})]}),t&&e.jsxs("div",{className:"absolute right-0 mt-2 w-full min-w-[250px] bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-[1000]",children:[e.jsx("div",{className:"px-4 py-2 border-b border-gray-100",children:e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide font-reisinger-michal text-right",children:"×©× ×•×ª ×œ×™××•×“"})}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:l.length===0?e.jsx("div",{className:"px-4 py-3 text-sm text-gray-500 font-reisinger-michal text-center",children:"×œ× × ××¦××• ×©× ×•×ª ×œ×™××•×“"}):l.sort((o,h)=>new Date(h.startDate).getTime()-new Date(o.startDate).getTime()).map(o=>{const h=a?._id===o._id,b=o.isCurrent,w=o.isActive;return e.jsxs("button",{onClick:()=>g(o._id),className:`w-full px-4 py-3 text-right hover:bg-gray-50 flex items-center justify-between transition-colors duration-150 ${h?"bg-indigo-50 border-l-4 border-indigo-500":""}`,style:{direction:"rtl"},children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-medium font-reisinger-michal ${h?"text-indigo-700":"text-gray-700"}`,children:o.name}),b&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"× ×•×›×—×™×ª"}),!w&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"×œ× ×¤×¢×™×œ×”"})]}),e.jsxs("span",{className:"text-xs text-gray-500 font-reisinger-michal",children:[new Date(o.startDate).toLocaleDateString("he-IL")," - ",new Date(o.endDate).toLocaleDateString("he-IL")]})]}),h&&e.jsx(Re,{className:"w-4 h-4 text-indigo-600 flex-shrink-0"})]},o._id)})}),e.jsx("div",{className:"px-4 py-2 border-t border-gray-100",children:e.jsx("button",{className:"text-xs text-indigo-600 hover:text-indigo-700 font-medium font-reisinger-michal",children:"+ ×”×•×¡×£ ×©× ×ª ×œ×™××•×“ ×—×“×©×”"})})]})]})}function et(){const[t,r]=c.useState(!1),[n,a]=c.useState(!1),[l,s]=c.useState(!1),i=c.useRef(null),u=c.useRef(null),g=Z(),{user:o,logout:h}=M();c.useEffect(()=>{const y=()=>{s(window.innerWidth<768)};return y(),window.addEventListener("resize",y),()=>window.removeEventListener("resize",y)},[]),c.useEffect(()=>{const y=d=>{i.current&&!i.current.contains(d.target)&&r(!1),u.current&&!u.current.contains(d.target)&&a(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]);const b=[{icon:K,label:"×”×ª×¨××•×ª",action:()=>console.log("Notifications")},{icon:P,label:"×œ×•×— ×©× ×”",action:()=>console.log("Calendar")},{icon:Q,label:"×”×’×“×¨×•×ª",action:()=>console.log("Settings")}],w=()=>{g("/profile"),a(!1)},A=async()=>{try{await h(),g("/login")}catch(y){console.error("Logout error:",y)}a(!1)},I=()=>{const y=o?.personalInfo?.fullName||o?.fullName||o?.name||"";if(!y)return"×";const d=y.trim().split(" ");return d.length>=2?d[0][0]+d[1][0]:d[0][0]||"×"},L=()=>o?.personalInfo?.fullName||o?.fullName||o?.name||"××©×ª××©",k=()=>{const y=o?.role||o?.roles?.[0]||"";switch(y){case"teacher":return"××•×¨×”";case"××•×¨×”":return"××•×¨×”";case"conductor":return"×× ×¦×—";case"×× ×¦×—":return"×× ×¦×—";case"theory_teacher":return"××•×¨×” ×ª×™××•×¨×™×”";case"××•×¨×” ×ª×™××•×¨×™×”":return"××•×¨×” ×ª×™××•×¨×™×”";case"admin":return"×× ×”×œ";case"×× ×”×œ":return"×× ×”×œ";default:return y||"××©×ª××©"}};return e.jsxs("header",{className:"fixed top-0 right-0 left-0 md:right-[280px] h-16 bg-white border-b border-gray-200 flex items-center justify-between px-6 pr-16 md:pr-6 z-[999]",style:{direction:"rtl"},children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:"/logo.png",alt:"Logo",className:"h-10 w-auto object-contain"}),e.jsx(Ze,{})]}),e.jsxs("div",{className:"flex items-center gap-4",style:{direction:"ltr"},children:[!l&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"w-10 h-10 rounded-lg bg-gray-50 border border-gray-200 flex items-center justify-center hover:bg-gray-100 hover:border-gray-300 transition-all duration-150 ease-in-out cursor-pointer",children:e.jsx(K,{className:"w-5 h-5 text-gray-600"})}),e.jsx("button",{className:"w-10 h-10 rounded-lg bg-gray-50 border border-gray-200 flex items-center justify-center hover:bg-gray-100 hover:border-gray-300 transition-all duration-150 ease-in-out cursor-pointer",children:e.jsx(P,{className:"w-5 h-5 text-gray-600"})}),e.jsx("button",{className:"w-10 h-10 rounded-lg bg-gray-50 border border-gray-200 flex items-center justify-center hover:bg-gray-100 hover:border-gray-300 transition-all duration-150 ease-in-out cursor-pointer",children:e.jsx(Q,{className:"w-5 h-5 text-gray-600"})})]}),l&&e.jsxs("div",{className:"relative",ref:i,children:[e.jsx("button",{onClick:()=>r(!t),className:"w-10 h-10 rounded-lg bg-gray-50 border border-gray-200 flex items-center justify-center hover:bg-gray-100 hover:border-gray-300 transition-all duration-150 ease-in-out cursor-pointer",children:t?e.jsx(ne,{className:"w-5 h-5 text-gray-600"}):e.jsx(oe,{className:"w-5 h-5 text-gray-600"})}),t&&e.jsx("div",{className:"absolute left-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-[1000]",children:b.map((y,d)=>{const m=y.icon;return e.jsxs("button",{onClick:()=>{y.action(),r(!1)},className:"w-full px-4 py-3 text-right hover:bg-gray-50 flex items-center justify-between transition-colors duration-150",style:{direction:"rtl"},children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 font-reisinger-michal",children:y.label}),e.jsx(m,{className:"w-4 h-4 text-gray-500"})]},d)})})]}),e.jsxs("div",{className:"relative",ref:u,children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center cursor-pointer hover:bg-indigo-700 transition-colors",onClick:()=>a(!n),children:e.jsx("span",{className:"text-sm font-semibold text-white font-reisinger-michal",children:I()})}),n&&e.jsxs("div",{className:"absolute left-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-[1000]",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 font-reisinger-michal",children:L()}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:k()})]}),e.jsxs("button",{onClick:w,className:"w-full px-4 py-3 text-right hover:bg-gray-50 flex items-center justify-between transition-colors duration-150",style:{direction:"rtl"},children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 font-reisinger-michal",children:"×¢××•×“ ××™×©×™"}),e.jsx(Ce,{className:"w-4 h-4 text-gray-500"})]}),e.jsxs("button",{onClick:A,className:"w-full px-4 py-3 text-right hover:bg-gray-50 flex items-center justify-between transition-colors duration-150 text-red-600 hover:bg-red-50",style:{direction:"rtl"},children:[e.jsx("span",{className:"text-sm font-medium font-reisinger-michal",children:"×™×¦×™××”"}),e.jsx(De,{className:"w-4 h-4"})]})]})]})]})]})}function E({children:t}){return e.jsxs("div",{className:"min-h-screen bg-gray-50",dir:"rtl",children:[e.jsx(Je,{}),e.jsx(et,{}),e.jsx("main",{className:"mr-0 md:mr-[280px] mt-16 ml-0 p-0 bg-gray-50 min-h-[calc(100vh-64px)] rtl",children:e.jsx("div",{className:"p-6 bg-gray-50",children:t})})]})}function tt(){const[t,r]=c.useState(""),[n,a]=c.useState(""),[l,s]=c.useState(""),[i,u]=c.useState(!1),g=Z(),{login:o}=M(),h=async b=>{b.preventDefault(),s(""),u(!0),console.log("ğŸ” Login attempt started:",{email:t,password:"***"}),console.log("ğŸŒ API Base URL:","https://conservatory-app-backend.onrender.com/api"),console.log("ğŸ”§ Environment check:",{VITE_API_URL:"https://conservatory-app-backend.onrender.com/api",fallback:"http://localhost:3001/api",actual:"https://conservatory-app-backend.onrender.com/api"});try{console.log("ğŸ“¤ Sending login request to API service...");const w=await o(t,n);console.log("âœ… Login successful:",{user:w.user?.personalInfo?.fullName||"Unknown"}),console.log("ğŸ”‘ Authentication token stored successfully"),console.log("ğŸ§­ Navigating to dashboard..."),g("/dashboard")}catch(w){console.error("âŒ Login failed:",w),console.error("ğŸ“ Error details:",{message:w.message,stack:w.stack}),s(w.message||"×©×’×™××” ×‘×”×ª×—×‘×¨×•×ª. ×× × ×‘×“×•×§ ××ª ×”×¤×¨×˜×™× ×•× ×¡×” ×©×•×‘.")}finally{u(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 relative",style:{backgroundImage:'url("/login-background.jpg")',backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},dir:"rtl",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),e.jsx("div",{className:"max-w-md w-full space-y-8 relative z-10",children:e.jsxs("div",{className:"backdrop-blur-lg bg-white/10 border border-white/20 rounded-2xl shadow-xl p-8",children:[e.jsx("div",{children:e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-yellow-400 drop-shadow-lg",style:{fontFamily:"'Reisinger Michal', 'Arial Hebrew', 'Noto Sans Hebrew', Arial, sans-serif"},children:"âœ… HEBREW WORKING! ×›× ×™×¡×” ×œ×—×©×‘×•×Ÿ ×©×œ×š"})}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:h,children:[l&&e.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg backdrop-blur-sm",children:e.jsx("p",{className:"text-red-100 text-sm text-center font-reisinger-michal",children:l})}),e.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"sr-only font-reisinger-michal",children:'×›×ª×•×‘×ª ×“×•×"×œ'}),e.jsx("input",{id:"email",name:"email",type:"email",required:!0,disabled:i,className:"relative block w-full px-3 py-3 border border-white/30 placeholder-gray-400 text-gray-900 rounded-lg bg-white/80 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:z-10 sm:text-sm placeholder:text-right font-reisinger-michal disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"×›×ª×•×‘×ª ×“×•××´×œ",value:t,onChange:b=>r(b.target.value),dir:"ltr",style:{textAlign:"left"}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only font-reisinger-michal",children:"×¡×™×¡××”"}),e.jsx("input",{id:"password",name:"password",type:"password",required:!0,disabled:i,className:"relative block w-full px-3 py-3 border border-white/30 placeholder-gray-400 text-gray-900 rounded-lg bg-white/80 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:z-10 sm:text-sm placeholder:text-right font-reisinger-michal disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"×¡×™×¡××”",value:n,onChange:b=>a(b.target.value),dir:"ltr",style:{textAlign:"left"}})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:i,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600/90 hover:bg-blue-700/90 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 shadow-lg font-reisinger-michal disabled:opacity-50 disabled:cursor-not-allowed",children:i?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"××ª×—×‘×¨..."]}):"×›× ×™×¡×”"})}),e.jsx("div",{className:"text-center",children:e.jsx(q,{to:"/dashboard",className:"font-medium text-white/90 hover:text-white drop-shadow transition-colors duration-200 font-reisinger-michal",children:"×“×œ×’ ×œ××¨×›×– ×”×‘×§×¨×” (×”×“×’××”)"})})]})]})})]})}function R(t,r,n=3){return c.lazy(()=>{let a=0;const l=async()=>{try{const s=await t();return console.log(`âœ… Successfully loaded ${r}`),s}catch(s){if(console.error(`âŒ Failed to load ${r}, attempt ${a+1}/${n}:`,s),a<n-1){a++;const i=Math.min(1e3*Math.pow(2,a),5e3);return await new Promise(u=>setTimeout(u,i)),l()}else throw console.error(`âŒ All retry attempts failed for ${r}`),s}};return l()})}class rt{constructor(){G(this,"preloadedComponents",new Set);G(this,"preloadPromises",new Map)}preload(r,n){if(this.preloadedComponents.has(r))return Promise.resolve();if(this.preloadPromises.has(r))return this.preloadPromises.get(r);const a=n().then(l=>(this.preloadedComponents.add(r),console.log(`âœ… Preloaded ${r}`),l)).catch(l=>{throw console.error(`âŒ Failed to preload ${r}:`,l),l}).finally(()=>{this.preloadPromises.delete(r)});return this.preloadPromises.set(r,a),a}preloadOnHover(r,n){return()=>{this.preloadedComponents.has(r)||this.preload(r,n)}}getPreloadStats(){return{preloadedComponents:Array.from(this.preloadedComponents),pendingPreloads:Array.from(this.preloadPromises.keys())}}}const Y=new rt,X={STUDENT_DETAILS:"StudentDetailsPage",THEORY_TAB:"TheoryTab",ORCHESTRA_TAB:"OrchestraTab",DASHBOARD:"Dashboard",STUDENTS_LIST:"Students"};function st(){setTimeout(()=>{Y.preload(X.DASHBOARD,()=>_(()=>import("../chunks/Dashboard-7e772cdb.js"),["chunks/Dashboard-7e772cdb.js","chunks/vendor-594479e1.js","chunks/StatsCard-3afa2b00.js","chunks/utils-a4d8ec6e.js","chunks/Card-c7ff3038.js","chunks/card-cba69aa1.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js","chunks/ui-0ea49fd5.js"])),Y.preload(X.STUDENTS_LIST,()=>_(()=>import("../chunks/Students-7c034971.js"),["chunks/Students-7c034971.js","chunks/vendor-594479e1.js","chunks/card-cba69aa1.js","chunks/utils-a4d8ec6e.js","chunks/Table-489a4a5c.js","chunks/ui-0ea49fd5.js","chunks/Card-c7ff3038.js","chunks/ConfirmationModal-125d9636.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js"]))},1e3),setTimeout(()=>{Y.preload(X.STUDENT_DETAILS,()=>_(()=>import("../chunks/StudentDetailsPageSimple-22231dea.js"),["chunks/StudentDetailsPageSimple-22231dea.js","chunks/vendor-594479e1.js","chunks/ui-0ea49fd5.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js","chunks/utils-a4d8ec6e.js","chunks/card-cba69aa1.js"]))},3e3)}function at(){const t=document.head,r=document.createElement("link");r.rel="dns-prefetch",r.href="//localhost",t.appendChild(r);const n=document.createElement("link");n.rel="preconnect",n.href="http://localhost:3001",n.crossOrigin="anonymous",t.appendChild(n);const a=document.createElement("link");a.rel="prefetch",a.as="style",a.href="/src/index.css",t.appendChild(a)}function nt(){typeof window>"u"||(at(),st(),console.log("ğŸš€ Bundle optimizations initialized"))}const ot=R(()=>_(()=>import("../chunks/Dashboard-7e772cdb.js"),["chunks/Dashboard-7e772cdb.js","chunks/vendor-594479e1.js","chunks/StatsCard-3afa2b00.js","chunks/utils-a4d8ec6e.js","chunks/Card-c7ff3038.js","chunks/card-cba69aa1.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js","chunks/ui-0ea49fd5.js"]),"Dashboard"),lt=R(()=>_(()=>import("../chunks/Students-7c034971.js"),["chunks/Students-7c034971.js","chunks/vendor-594479e1.js","chunks/card-cba69aa1.js","chunks/utils-a4d8ec6e.js","chunks/Table-489a4a5c.js","chunks/ui-0ea49fd5.js","chunks/Card-c7ff3038.js","chunks/ConfirmationModal-125d9636.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js"]),"Students"),it=R(()=>_(()=>import("../chunks/Teachers-1bfcb703.js"),["chunks/Teachers-1bfcb703.js","chunks/vendor-594479e1.js","chunks/card-cba69aa1.js","chunks/utils-a4d8ec6e.js","chunks/Table-489a4a5c.js","chunks/ui-0ea49fd5.js","chunks/Card-c7ff3038.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js"]),"Teachers"),ct=R(()=>_(()=>import("../chunks/TheoryLessons-53dd8f7e.js"),["chunks/TheoryLessons-53dd8f7e.js","chunks/vendor-594479e1.js","chunks/card-cba69aa1.js","chunks/utils-a4d8ec6e.js","chunks/StatsCard-3afa2b00.js","chunks/Card-c7ff3038.js","chunks/TheoryLessonForm-700f1a6e.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js","chunks/ui-0ea49fd5.js","chunks/ConfirmationModal-125d9636.js"]),"TheoryLessons"),dt=R(()=>_(()=>import("../chunks/TheoryLessonDetails-3a2ce77b.js"),["chunks/TheoryLessonDetails-3a2ce77b.js","chunks/vendor-594479e1.js","chunks/card-cba69aa1.js","chunks/utils-a4d8ec6e.js","chunks/Table-489a4a5c.js","chunks/ui-0ea49fd5.js","chunks/StatsCard-3afa2b00.js","chunks/Card-c7ff3038.js","chunks/TheoryLessonForm-700f1a6e.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js","chunks/ConfirmationModal-125d9636.js"]),"TheoryLessonDetails"),ut=R(()=>_(()=>import("../chunks/Orchestras-29770e11.js"),["chunks/Orchestras-29770e11.js","chunks/vendor-594479e1.js","chunks/card-cba69aa1.js","chunks/utils-a4d8ec6e.js","chunks/Table-489a4a5c.js","chunks/ui-0ea49fd5.js","chunks/Card-c7ff3038.js","chunks/StatsCard-3afa2b00.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js"]),"Orchestras"),ht=R(()=>_(()=>import("../chunks/Rehearsals-9e37284e.js"),["chunks/Rehearsals-9e37284e.js","chunks/vendor-594479e1.js","chunks/card-cba69aa1.js","chunks/utils-a4d8ec6e.js","chunks/Table-489a4a5c.js","chunks/ui-0ea49fd5.js","chunks/ConfirmationModal-125d9636.js","chunks/RehearsalForm-c7ad7221.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js"]),"Rehearsals"),mt=R(()=>_(()=>import("../chunks/RehearsalDetails-b0e77fea.js"),["chunks/RehearsalDetails-b0e77fea.js","chunks/vendor-594479e1.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js","chunks/utils-a4d8ec6e.js","chunks/RehearsalForm-c7ad7221.js","chunks/ui-0ea49fd5.js","chunks/card-cba69aa1.js","chunks/ConfirmationModal-125d9636.js"]),"RehearsalDetails"),gt=R(()=>_(()=>import("../chunks/Bagruts-9d30075d.js"),["chunks/Bagruts-9d30075d.js","chunks/vendor-594479e1.js","chunks/card-cba69aa1.js","chunks/utils-a4d8ec6e.js","chunks/Table-489a4a5c.js","chunks/ui-0ea49fd5.js","chunks/StatsCard-3afa2b00.js","chunks/Card-c7ff3038.js","chunks/ConfirmationModal-125d9636.js","chunks/useBagrut-8c529c91.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js"]),"Bagruts"),ft=R(()=>_(()=>import("../chunks/BagrutDetails-b51812b9.js"),["chunks/BagrutDetails-b51812b9.js","chunks/vendor-594479e1.js","chunks/card-cba69aa1.js","chunks/utils-a4d8ec6e.js","chunks/Table-489a4a5c.js","chunks/ui-0ea49fd5.js","chunks/StatsCard-3afa2b00.js","chunks/Card-c7ff3038.js","chunks/ConfirmationModal-125d9636.js","chunks/useBagrut-8c529c91.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js"]),"BagrutDetails"),pt=R(()=>_(()=>import("../chunks/Profile-bd541898.js"),["chunks/Profile-bd541898.js","chunks/vendor-594479e1.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js","chunks/utils-a4d8ec6e.js","chunks/ui-0ea49fd5.js"]),"Profile"),xt=R(()=>_(()=>import("../chunks/StudentDetailsPageSimple-22231dea.js"),["chunks/StudentDetailsPageSimple-22231dea.js","chunks/vendor-594479e1.js","chunks/ui-0ea49fd5.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js","chunks/utils-a4d8ec6e.js","chunks/card-cba69aa1.js"]),"StudentDetailsPage"),yt=R(()=>_(()=>import("../chunks/TeacherDetailsPage-7e18d149.js"),["chunks/TeacherDetailsPage-7e18d149.js","chunks/vendor-594479e1.js","chunks/ui-0ea49fd5.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js","chunks/utils-a4d8ec6e.js"]),"TeacherDetailsPage"),bt=R(()=>_(()=>import("../chunks/OrchestraDetailsPage-948cbbfe.js"),["chunks/OrchestraDetailsPage-948cbbfe.js","chunks/vendor-594479e1.js","chunks/cascade-deletion-5647227d.js","chunks/query-5c608ab7.js","chunks/utils-a4d8ec6e.js","chunks/ui-0ea49fd5.js","chunks/ConfirmationModal-125d9636.js"]),"OrchestraDetailsPage"),V=({message:t="×˜×•×¢×Ÿ ×¢××•×“..."})=>e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:t})]})});function S({children:t}){const{isAuthenticated:r,isLoading:n,authError:a,checkAuthStatus:l}=M(),[s,i]=F.useState(0),u=2;return F.useEffect(()=>{if(a&&s<u){const g=setTimeout(()=>{console.log(`ğŸ”„ ProtectedRoute - Retrying authentication (${s+1}/${u})`),l(!0),i(o=>o+1)},1e3*(s+1));return()=>clearTimeout(g)}},[a,s,l]),F.useEffect(()=>{r&&s>0&&i(0)},[r]),n?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:"××××ª ×”×¨×©××•×ª..."}),a&&s>0&&e.jsxs("div",{className:"mt-2 text-sm text-amber-600",children:["×× ×¡×” ×©×•×‘ (",s,"/",u,")..."]})]})}):r?e.jsx(e.Fragment,{children:t}):e.jsx(H,{to:"/login",replace:!0})}function jt(){return e.jsx("div",{dir:"rtl",children:e.jsxs(xe,{children:[e.jsx(v,{path:"/login",element:e.jsx(tt,{})}),e.jsx(v,{path:"/dashboard",element:e.jsx(S,{children:e.jsx(E,{children:e.jsx(c.Suspense,{fallback:e.jsx(V,{message:"×˜×•×¢×Ÿ ×“×©×‘×•×¨×“..."}),children:e.jsx(ot,{})})})})}),e.jsx(v,{path:"/students",element:e.jsx(S,{children:e.jsx(E,{children:e.jsx(c.Suspense,{fallback:e.jsx(V,{message:"×˜×•×¢×Ÿ ×¨×©×™××ª ×ª×œ××™×“×™×..."}),children:e.jsx(lt,{})})})})}),e.jsx(v,{path:"/students/:studentId",element:e.jsx(S,{children:e.jsx(E,{children:e.jsx(c.Suspense,{fallback:e.jsx(V,{message:"×˜×•×¢×Ÿ ×¤×¨×˜×™ ×ª×œ××™×“..."}),children:e.jsx(xt,{})})})})}),e.jsx(v,{path:"/teachers",element:e.jsx(S,{children:e.jsx(E,{children:e.jsx(it,{})})})}),e.jsx(v,{path:"/teachers/:teacherId",element:e.jsx(S,{children:e.jsx(E,{children:e.jsx(c.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:"×˜×•×¢×Ÿ ×¤×¨×˜×™ ××•×¨×”..."})]})}),children:e.jsx(yt,{})})})})}),e.jsx(v,{path:"/theory-lessons",element:e.jsx(S,{children:e.jsx(E,{children:e.jsx(ct,{})})})}),e.jsx(v,{path:"/theory-lessons/:theoryId",element:e.jsx(S,{children:e.jsx(E,{children:e.jsx(dt,{})})})}),e.jsx(v,{path:"/orchestras",element:e.jsx(S,{children:e.jsx(E,{children:e.jsx(ut,{})})})}),e.jsx(v,{path:"/orchestras/:orchestraId",element:e.jsx(S,{children:e.jsx(E,{children:e.jsx(c.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:"×˜×•×¢×Ÿ ×¤×¨×˜×™ ×ª×–××•×¨×ª..."})]})}),children:e.jsx(bt,{})})})})}),e.jsx(v,{path:"/rehearsals",element:e.jsx(S,{children:e.jsx(E,{children:e.jsx(ht,{})})})}),e.jsx(v,{path:"/rehearsals/:rehearsalId",element:e.jsx(S,{children:e.jsx(E,{children:e.jsx(mt,{})})})}),e.jsx(v,{path:"/bagruts",element:e.jsx(S,{children:e.jsx(E,{children:e.jsx(gt,{})})})}),e.jsx(v,{path:"/bagruts/:bagrutId",element:e.jsx(S,{children:e.jsx(E,{children:e.jsx(ft,{})})})}),e.jsx(v,{path:"/bagruts/:bagrutId/edit",element:e.jsx(S,{children:e.jsx(E,{children:e.jsxs("div",{className:"p-6",dir:"rtl",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"×¢×¨×™×›×ª ×‘×’×¨×•×ª"}),e.jsx("p",{className:"text-gray-600",children:"×¢×¨×™×›×ª ×¤×¨×˜×™ ×”×‘×’×¨×•×ª ×•×”×ª×§×“××•×ª"}),e.jsx("div",{className:"mt-8 p-4 bg-blue-50 rounded-lg",children:e.jsx("p",{className:"text-blue-700",children:"ğŸ”§ ×¢××•×“ ×¢×¨×™×›×ª ×‘×’×¨×•×ª ×‘×¤×™×ª×•×— - ×‘×™× ×ª×™×™× × ×™×ª×Ÿ ×œ×¢×¨×•×š ×“×¨×š ×¢××•×“ ×”×¤×¨×˜×™×"})})]})})})}),e.jsx(v,{path:"/bagrut",element:e.jsx(H,{to:"/bagruts",replace:!0})}),e.jsx(v,{path:"/profile",element:e.jsx(S,{children:e.jsx(E,{children:e.jsx(c.Suspense,{fallback:e.jsx(V,{message:"×˜×•×¢×Ÿ ×¢××•×“ ××™×©×™..."}),children:e.jsx(pt,{})})})})}),e.jsx(v,{path:"/",element:e.jsx(H,{to:"/dashboard",replace:!0})}),e.jsx(v,{path:"*",element:e.jsx(H,{to:"/dashboard",replace:!0})})]})})}function vt(){return c.useEffect(()=>{nt()},[]),e.jsx(Qe,{children:e.jsx(Be,{children:e.jsx(He,{children:e.jsx(qe,{children:e.jsx(jt,{})})})})})}be();const wt=new ee({defaultOptions:{queries:{staleTime:1e3*60*5,retry:(t,r)=>r?.status===404||r?.status===403?!1:t<3}}}),he=document.getElementById("root");if(!he)throw new Error("Root element not found");W.createRoot(he).render(e.jsx(F.StrictMode,{children:e.jsx(te,{client:wt,children:e.jsx(ye,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsx(vt,{})})})}));export{M as a,Rt as b,Ct as c,e as j,Ve as u};
