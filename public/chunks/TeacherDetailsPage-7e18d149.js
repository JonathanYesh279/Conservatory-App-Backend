import{j as e}from"../assets/index-ee7c9a55.js";import{r as g,e as Ce,b as De,N as ke}from"./vendor-594479e1.js";import{i as Z,U as J,C as se,a as ue,v as ee,o as Ie,X as xe,j as Ae,y as Me,n as le,A as we,P as oe,S as $e,f as Le,B as Te,T as ce,m as ie,$ as _e,a0 as Oe,k as Pe,V as de,ae as pe}from"./ui-0ea49fd5.js";import{a as R,g as H}from"./cascade-deletion-5647227d.js";import{b as me,a as re,d as Fe,e as ne,s as Re,g as We,h as He,f as G,i as Ue,j as fe,k as be,l as qe}from"./utils-a4d8ec6e.js";import"./query-5c608ab7.js";const ye={personal:{label:"××™×“×¢ ××™×©×™",icon:Z},students:{label:"× ×™×”×•×œ ×ª×œ××™×“×™×",icon:J},schedule:{label:"×œ×•×— ×–×× ×™×",icon:se},conducting:{label:"× ×™×¦×•×—",icon:ue}},Be=({activeTab:o,onTabChange:r,tabs:t=[]})=>!t||t.length===0?null:e.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 shadow-sm w-full overflow-hidden teacher-tab-navigation",children:[e.jsx("div",{className:"hidden md:flex w-full overflow-x-auto desktop-tab-nav",children:e.jsx("nav",{className:"flex gap-8 px-6 relative min-w-full","aria-label":"Tabs",children:t.map((a,n)=>{const x=ye[a.id],u=x?.icon||Z,N=o===a.id;return e.jsxs("button",{onClick:()=>r(a.id),className:`
                  group inline-flex items-center gap-3 py-4 px-2 border-b-2 font-medium text-sm transition-all duration-300 relative tab-button
                  ${N?"border-primary-500 text-primary-600 bg-primary-50/50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 hover:bg-gray-50/50"}
                `,"aria-current":N?"page":void 0,style:{minHeight:"44px"},children:[e.jsx(u,{className:`w-5 h-5 transition-all duration-300 ${N?"text-primary-500 scale-110":"text-gray-400 group-hover:text-gray-500 group-hover:scale-105"}`}),e.jsx("span",{className:"whitespace-nowrap",children:x?.label||a.label}),N&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-primary-400 to-primary-600 rounded-full animate-scale-in"})]},a.id)})})}),e.jsxs("div",{className:"md:hidden w-full overflow-hidden mobile-tab-nav",children:[e.jsx("div",{className:"overflow-x-auto scrollbar-hide w-full",children:e.jsx("nav",{className:"flex gap-3 px-4 py-3 min-w-max","aria-label":"Tabs",style:{width:"max-content"},children:t.map((a,n)=>{const x=ye[a.id],u=x?.icon||Z,N=o===a.id;return e.jsxs("button",{onClick:()=>r(a.id),className:`
                    flex flex-col items-center gap-1 px-4 py-3 rounded-xl font-medium text-xs transition-all duration-300 whitespace-nowrap transform tab-button
                    ${N?"bg-primary-100 text-primary-700 border-2 border-primary-200 scale-105 shadow-md":"text-gray-600 hover:text-gray-900 hover:bg-gray-50 hover:scale-102 border-2 border-transparent"}
                  `,"aria-current":N?"page":void 0,style:{minWidth:"80px",minHeight:"44px"},children:[e.jsx(u,{className:`w-5 h-5 transition-all duration-300 ${N?"text-primary-600":"text-gray-500"}`}),e.jsx("span",{className:"leading-tight",children:x?.label||a.label})]},a.id)})})}),e.jsx("div",{className:"flex justify-center py-1",children:e.jsx("div",{className:"w-8 h-1 bg-gray-200 rounded-full",children:e.jsx("div",{className:"h-full bg-primary-400 rounded-full transition-all duration-300",style:{width:`${t?.length>0?(t.findIndex(a=>a.id===o)+1)/t.length*100:0}%`}})})})]})]}),ze=({teacher:o,teacherId:r})=>{const[t,a]=g.useState(!1),[n,x]=g.useState({fullName:o.personalInfo?.fullName||"",phone:o.personalInfo?.phone||"",email:o.personalInfo?.email||"",address:o.personalInfo?.address||""}),u=async()=>{try{console.log("Saving teacher personal info:",n),a(!1)}catch(p){console.error("Error saving teacher personal info:",p)}},N=()=>{x({fullName:o.personalInfo?.fullName||"",phone:o.personalInfo?.phone||"",email:o.personalInfo?.email||"",address:o.personalInfo?.address||""}),a(!1)};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:t?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[e.jsx(Ie,{className:"w-4 h-4"}),"×©××•×¨"]}),e.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:[e.jsx(xe,{className:"w-4 h-4"}),"×‘×˜×œ"]})]}):e.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(ee,{className:"w-4 h-4"}),"×¢×¨×•×š"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-700 border-b pb-2",children:"×¤×¨×˜×™× ×‘×¡×™×¡×™×™×"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(Z,{className:"w-4 h-4"}),"×©× ××œ×"]}),t?e.jsx("input",{type:"text",value:n.fullName,onChange:p=>x({...n,fullName:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"×”×›× ×¡ ×©× ××œ×"}):e.jsx("p",{className:"text-gray-900",children:o.personalInfo?.fullName||"×œ× ×¦×•×™×Ÿ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(Ae,{className:"w-4 h-4"}),"×˜×œ×¤×•×Ÿ"]}),t?e.jsx("input",{type:"tel",value:n.phone,onChange:p=>x({...n,phone:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"×”×›× ×¡ ××¡×¤×¨ ×˜×œ×¤×•×Ÿ"}):e.jsx("p",{className:"text-gray-900",children:o.personalInfo?.phone||"×œ× ×¦×•×™×Ÿ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(Me,{className:"w-4 h-4"}),'×“×•×"×œ']}),t?e.jsx("input",{type:"email",value:n.email,onChange:p=>x({...n,email:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"×”×›× ×¡ ×›×ª×•×‘×ª ×“×•××´×œ"}):e.jsx("p",{className:"text-gray-900",children:o.personalInfo?.email||"×œ× ×¦×•×™×Ÿ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(le,{className:"w-4 h-4"}),"×›×ª×•×‘×ª"]}),t?e.jsx("textarea",{value:n.address,onChange:p=>x({...n,address:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"×”×›× ×¡ ×›×ª×•×‘×ª ××’×•×¨×™×",rows:2}):e.jsx("p",{className:"text-gray-900",children:o.personalInfo?.address||"×œ× ×¦×•×™×Ÿ"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-700 border-b pb-2",children:"××™×“×¢ ××§×¦×•×¢×™"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(we,{className:"w-4 h-4"}),"×›×œ×™ × ×’×™× ×”"]}),e.jsx("p",{className:"text-gray-900",children:o.professionalInfo?.instrument||"×œ× ×¦×•×™×Ÿ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"×ª×¤×§×™×“×™×"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:o.roles?.map((p,b)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:p},b))||e.jsx("span",{className:"text-gray-500",children:"××™×Ÿ ×ª×¤×§×™×“×™×"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"×¡×˜×˜×•×¡"}),e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${o.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:o.isActive?"×¤×¢×™×œ":"×œ× ×¤×¢×™×œ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(se,{className:"w-4 h-4"}),"×ª××¨×™×š ×”×¦×˜×¨×¤×•×ª"]}),e.jsx("p",{className:"text-gray-900",children:o.createdAt?new Date(o.createdAt).toLocaleDateString("he-IL"):"×œ× ×™×“×•×¢"})]}),o.credentials?.lastLogin&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"×›× ×™×¡×” ××—×¨×•× ×”"}),e.jsx("p",{className:"text-gray-900",children:new Date(o.credentials.lastLogin).toLocaleDateString("he-IL")})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3",children:"×¡×™×›×•× ×ª×œ××™×“×™×"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-600",children:o.teaching?.studentIds?.length||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"×¡×š ×”×ª×œ××™×“×™×"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:o.teaching?.timeBlocks?.length||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"×‘×œ×•×§×™ ×–××Ÿ"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Math.round((o.teaching?.timeBlocks?.reduce((p,b)=>p+(b.totalDuration||0),0)||0)/60)}),e.jsx("div",{className:"text-sm text-gray-600",children:"×©×¢×•×ª ×©×‘×•×¢×™×•×ª"})]})]})]})]})},Ve=({teacher:o,teacherId:r})=>{const[t,a]=g.useState([]),[n,x]=g.useState({}),[u,N]=g.useState([]),[p,b]=g.useState(!0),[A,T]=g.useState(!1),[M,E]=g.useState(""),[C,L]=g.useState(""),[U,k]=g.useState(!1),[I,q]=g.useState(-1),[Y,m]=g.useState(!1),[j,w]=g.useState(null),[_,V]=g.useState({day:"",startTime:"",duration:30}),X=g.useRef(null),i=g.useRef(null),d=l=>{try{return l.teacherAssignments?.some(y=>y.teacherId===r&&y.isActive===!0)||!1}catch(f){return console.error(`Error checking lessons for student ${l._id}:`,f),!1}};g.useEffect(()=>{(async()=>{try{if(b(!0),o.teaching?.studentIds?.length>0){const y=o.teaching.studentIds.map(F=>R.students.getStudentById(F)),h=await Promise.all(y);a(h);const O={};h.forEach(F=>{const Q=d(F);O[F._id]=Q}),x(O)}const f=await R.students.getStudents();N(f)}catch(f){console.error("Error fetching students:",f)}finally{b(!1)}})()},[o.teaching?.studentIds,r]);const S=l=>{E(l._id),L(l.personalInfo?.fullName||""),k(!1),q(-1)},v=l=>{L(l),E(""),k(!0),q(-1)},D=()=>{L(""),E(""),k(!1),q(-1),i.current?.focus()},s=l=>{if(!U&&(l.key==="ArrowDown"||l.key==="Enter")){k(!0);return}switch(l.key){case"ArrowDown":l.preventDefault(),q(f=>f<z.length-1?f+1:0);break;case"ArrowUp":l.preventDefault(),q(f=>f>0?f-1:z.length-1);break;case"Enter":l.preventDefault(),I>=0&&z[I]&&S(z[I]);break;case"Escape":k(!1),q(-1),i.current?.blur();break}},c=async()=>{if(M)try{await R.teachers.addStudentToTeacher(r,M);const l=await R.students.getStudentById(M);a(f=>[...f,l]),T(!1),E(""),L("")}catch(l){console.error("Error adding student:",l)}},P=async l=>{const y=t.find(O=>O._id===l)?.personalInfo?.fullName||"×”×ª×œ××™×“",h=o.personalInfo?.fullName||"×”××•×¨×”";if(confirm(`×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ×”×¡×™×¨ ××ª ${y} ××¨×©×™××ª ×”×ª×œ××™×“×™× ×©×œ ${h}?

×¤×¢×•×œ×” ×–×• ×ª× ×ª×§ ××ª ×”×§×©×¨ ×‘×™×Ÿ ×”×ª×œ××™×“ ×œ××•×¨×” ××š ×œ× ×ª××—×§ ××ª ×¤×¨×˜×™ ×”×ª×œ××™×“ ××”××¢×¨×›×ª.`))try{await R.teachers.removeStudentFromTeacher(r,l),a(O=>O.filter(F=>F._id!==l))}catch(O){console.error("Error removing student:",O)}},W=l=>{w(l),m(!0),V({day:"",startTime:"",duration:30})},B=async()=>{if(!j||!_.day||!_.startTime){alert("×× × ××œ× ××ª ×›×œ ×”×©×“×•×ª ×”× ×“×¨×©×™×");return}try{console.log("ğŸ”„ Creating lesson for student:",j.personalInfo?.fullName);const l=($,te)=>{const[ae,he]=$.split(":").map(Number),ge=ae*60+he+te,Se=Math.floor(ge/60),Ee=ge%60;return`${Se.toString().padStart(2,"0")}:${Ee.toString().padStart(2,"0")}`},f=await R.students.getStudentById(j._id);console.log("ğŸ“‹ Current student data loaded:",f.personalInfo?.fullName);const y=f.academicInfo?.instrumentProgress?.find($=>$.isPrimary)?.instrumentName||"×›×œ×™ × ×’×™× ×”",h={teacherId:r,day:_.day,time:_.startTime,duration:_.duration,location:"",isActive:!0},O=[...f.teacherAssignments||[],h];console.log("ğŸ“¤ Adding new teacher assignment:",h),console.log("ğŸ“ All assignments to be saved:",O);const F={teacherAssignments:O};console.log("ğŸ“¤ Sending update data:",F);const Q=await R.students.updateStudent(j._id,F);console.log("âœ… Student updated with new lesson assignment"),x($=>({...$,[j._id]:!0})),m(!1),w(null),V({day:"",startTime:"",duration:30})}catch(l){console.error("âŒ Failed to schedule lesson:",l);let f="×©×’×™××” ×‘×§×‘×™×¢×ª ×”×©×™×¢×•×¨. ×× × × ×¡×” ×©×•×‘.";l.message.includes("Authentication failed")?f="×¤×’ ×ª×•×§×£ ×”×¤× ×™×™×”. ×× × ×”×ª×—×‘×¨ ××—×“×©.":l.message.includes("validation")?f="×©×’×™××” ×‘× ×ª×•× ×™× ×©×”×•×–× ×•. ×× × ×‘×“×•×§ ××ª ×¤×¨×˜×™ ×”×©×™×¢×•×¨.":l.message.includes("not found")?f="×”×ª×œ××™×“ ×œ× × ××¦× ×‘××¢×¨×›×ª.":l.message.includes("Network")?f="×©×’×™××ª ×¨×©×ª. ×× × ×‘×“×•×§ ××ª ×”×—×™×‘×•×¨ ×œ××™× ×˜×¨× ×˜.":l.message.includes("×©×’×™××” ×‘×©××™×¨×ª ×”× ×ª×•× ×™×")&&(f="×©×’×™××” ×‘×©××™×¨×ª ×”× ×ª×•× ×™× ×‘××¡×“ ×”× ×ª×•× ×™×. ×× × × ×¡×” ×©×•×‘."),alert(f),console.error("Error details:",{message:l.message,stack:l.stack,studentId:j._id,teacherId:r,lessonData:_})}},z=u.filter(l=>!o.teaching?.studentIds?.includes(l._id)).filter(l=>{const f=l.personalInfo?.fullName||"",y=l.academicInfo?.class||"",h=C.toLowerCase();return f.toLowerCase().includes(h)||y.toLowerCase().includes(h)});return g.useEffect(()=>{const l=f=>{X.current&&!X.current.contains(f.target)&&(k(!1),q(-1))};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]),g.useEffect(()=>{A||(L(""),E(""),k(!1),q(-1))},[A]),p?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse w-1/3"}),e.jsx("div",{className:"space-y-3",children:[1,2,3].map(l=>e.jsx("div",{className:"h-16 bg-gray-200 rounded animate-pulse"},l))})]}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>T(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-all shadow-sm font-medium",children:[e.jsx(oe,{className:"w-4 h-4"}),"×”×•×¡×£ ×ª×œ××™×“"]})}),A&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 teacher-modal-backdrop",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-md transform transition-all teacher-modal-container",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6 text-center",children:"×”×•×¡×£ ×ª×œ××™×“ ×—×“×©"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 teacher-modal-label",children:"×—×¤×© ×•×‘×—×¨ ×ª×œ××™×“"}),e.jsx("div",{className:"text-xs text-gray-500",children:"â†‘â†“ ×œ× ×™×•×•×˜ â€¢ Enter ×œ×‘×—×™×¨×” â€¢ Esc ×œ×¡×’×™×¨×”"})]}),e.jsxs("div",{className:"relative",ref:X,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e.jsx($e,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{ref:i,type:"text",value:C,onChange:l=>v(l.target.value),onKeyDown:s,onFocus:()=>k(!0),placeholder:"×”×§×œ×“ ×©× ×ª×œ××™×“ ××• ×›×™×ª×”...",className:"w-full pr-10 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-gray-900 bg-white teacher-search-input",style:{paddingLeft:"2.5rem"}}),C?e.jsx("button",{onClick:D,className:"absolute inset-y-0 left-0 pl-3 flex items-center hover:bg-gray-50 rounded-r-lg",children:e.jsx(xe,{className:"h-4 w-4 text-gray-400 hover:text-gray-600"})}):e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Le,{className:`h-4 w-4 text-gray-400 transition-transform ${U?"rotate-180":""}`})})]}),U&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto teacher-search-dropdown teacher-dropdown-enter",children:z.length>0?e.jsx(e.Fragment,{children:z.map((l,f)=>e.jsx("button",{onClick:()=>S(l),className:`w-full text-right px-4 py-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0 teacher-search-option ${f===I?"bg-primary-50 text-primary-700 highlighted":"text-gray-900"} ${M===l._id?"bg-primary-100 text-primary-700 font-medium":""}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:l.personalInfo?.fullName}),e.jsxs("span",{className:"text-sm text-gray-500",children:["×›×™×ª×” ",l.academicInfo?.class||"×œ× ×¦×•×™×Ÿ"]})]})},l._id))}):e.jsx("div",{className:"px-4 py-3 text-gray-500 text-center",children:C?"×œ× × ××¦××• ×ª×œ××™×“×™×":"××™×Ÿ ×ª×œ××™×“×™× ×–××™× ×™×"})})]})]}),e.jsxs("div",{className:"flex gap-3 teacher-modal-buttons",children:[e.jsx("button",{onClick:c,disabled:!M,className:"flex-1 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-all disabled:bg-gray-400 disabled:cursor-not-allowed shadow-sm font-medium teacher-modal-button",children:"×”×•×¡×£"}),e.jsx("button",{onClick:()=>{T(!1),E("")},className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all shadow-sm font-medium teacher-modal-button",children:"×‘×˜×œ"})]})]})]})}),Y&&j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-md transform transition-all",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6 text-center",children:"×§×‘×™×¢×ª ×©×™×¢×•×¨ ×©×‘×•×¢×™"}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"×¤×¨×˜×™ ×”×ª×œ××™×“"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"×©×:"})," ",j.personalInfo?.fullName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"×›×™×ª×”:"})," ",j.academicInfo?.class||"×œ× ×¦×•×™×Ÿ"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"×›×œ×™ × ×’×™× ×”:"})," ",j.primaryInstrument||"×œ× ×¦×•×™×Ÿ"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×™×•× ×”×©×‘×•×¢"}),e.jsxs("select",{value:_.day,onChange:l=>V(f=>({...f,day:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×™×•×"}),e.jsx("option",{value:"×¨××©×•×Ÿ",children:"×¨××©×•×Ÿ"}),e.jsx("option",{value:"×©× ×™",children:"×©× ×™"}),e.jsx("option",{value:"×©×œ×™×©×™",children:"×©×œ×™×©×™"}),e.jsx("option",{value:"×¨×‘×™×¢×™",children:"×¨×‘×™×¢×™"}),e.jsx("option",{value:"×—××™×©×™",children:"×—××™×©×™"}),e.jsx("option",{value:"×©×™×©×™",children:"×©×™×©×™"}),e.jsx("option",{value:"×©×‘×ª",children:"×©×‘×ª"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×–××Ÿ ×”×ª×—×œ×”"}),e.jsx("input",{type:"time",value:_.startTime,onChange:l=>V(f=>({...f,startTime:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"××©×š (×“×§×•×ª)"}),e.jsxs("select",{value:_.duration,onChange:l=>V(f=>({...f,duration:Number(l.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:30,children:"30 ×“×§×•×ª"}),e.jsx("option",{value:45,children:"45 ×“×§×•×ª"}),e.jsx("option",{value:60,children:"60 ×“×§×•×ª"}),e.jsx("option",{value:90,children:"90 ×“×§×•×ª"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[e.jsx("button",{onClick:B,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:"×§×‘×¢ ×©×™×¢×•×¨"}),e.jsx("button",{onClick:()=>{m(!1),w(null),V({day:"",startTime:"",duration:30})},className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"×‘×™×˜×•×œ"})]})]})]})}),t.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(J,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"××™×Ÿ ×ª×œ××™×“×™× ××©×•×™×›×™×"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"×¢×“×™×™×Ÿ ×œ× ×©×•×™×›×• ×ª×œ××™×“×™× ×œ××•×¨×” ×–×”"}),e.jsx("button",{onClick:()=>T(!0),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-all shadow-sm font-medium",children:"×”×•×¡×£ ×ª×œ××™×“ ×¨××©×•×Ÿ"})]}):e.jsx("div",{className:"grid gap-4",children:t.map(l=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Z,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:l.personalInfo?.fullName||"×œ×œ× ×©×"}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["×›×™×ª×” ",l.academicInfo?.class||"×œ× ×¦×•×™×Ÿ"]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:l.primaryInstrument||"×œ×œ× ×›×œ×™"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!n[l._id]&&e.jsxs("button",{onClick:()=>W(l),className:"px-3 py-1 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 focus:ring-2 focus:ring-green-500 focus:ring-offset-1 transition-all shadow-sm font-medium flex items-center gap-1",children:[e.jsx(Te,{className:"w-4 h-4"}),"×§×‘×¢ ×©×™×¢×•×¨"]}),e.jsx("button",{onClick:()=>window.location.href=`/students/${l._id}`,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 transition-all shadow-sm font-medium",children:"×¦×¤×” ×‘×¤×¨×˜×™×"}),e.jsxs("button",{onClick:()=>P(l._id),className:"px-3 py-1 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 focus:ring-2 focus:ring-red-500 focus:ring-offset-1 transition-all shadow-sm font-medium flex items-center gap-1",children:[e.jsx(ce,{className:"w-4 h-4"}),"×”×¡×¨"]})]})]})},l._id))}),t.length>0&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"×¡×§×™×¨×ª ×œ×•×— ×–×× ×™×"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.timeBlocks?.map((l,f)=>e.jsxs("div",{className:"bg-white rounded-lg p-4 border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:l.day}),e.jsxs("span",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.jsx(ie,{className:"w-4 h-4"}),Math.round(l.totalDuration/60)," ×©×¢×•×ª"]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[l.startTime," - ",l.endTime]}),l.location&&e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["ğŸ“ ",l.location]}),e.jsxs("div",{className:"text-xs text-blue-600 mt-2",children:[l.assignedLessons?.length||0," ×©×™×¢×•×¨×™× ××ª×•×›× × ×™×"]})]},l._id||f))}),(!o.timeBlocks||o.timeBlocks.length===0)&&e.jsx("div",{className:"text-center text-gray-500 py-4",children:"××™×Ÿ ×‘×œ×•×§×™ ×–××Ÿ ××•×’×“×¨×™× ×¢×“×™×™×Ÿ"})]})]})};var Ye={lessThanXSeconds:{one:"×¤×—×•×ª ××©× ×™×™×”",two:"×¤×—×•×ª ××©×ª×™ ×©× ×™×•×ª",other:"×¤×—×•×ª ×Ö¾{{count}} ×©× ×™×•×ª"},xSeconds:{one:"×©× ×™×™×”",two:"×©×ª×™ ×©× ×™×•×ª",other:"{{count}} ×©× ×™×•×ª"},halfAMinute:"×—×¦×™ ×“×§×”",lessThanXMinutes:{one:"×¤×—×•×ª ××“×§×”",two:"×¤×—×•×ª ××©×ª×™ ×“×§×•×ª",other:"×¤×—×•×ª ×Ö¾{{count}} ×“×§×•×ª"},xMinutes:{one:"×“×§×”",two:"×©×ª×™ ×“×§×•×ª",other:"{{count}} ×“×§×•×ª"},aboutXHours:{one:"×›×©×¢×”",two:"×›×©×¢×ª×™×™×",other:"×›Ö¾{{count}} ×©×¢×•×ª"},xHours:{one:"×©×¢×”",two:"×©×¢×ª×™×™×",other:"{{count}} ×©×¢×•×ª"},xDays:{one:"×™×•×",two:"×™×•××™×™×",other:"{{count}} ×™××™×"},aboutXWeeks:{one:"×›×©×‘×•×¢",two:"×›×©×‘×•×¢×™×™×",other:"×›Ö¾{{count}} ×©×‘×•×¢×•×ª"},xWeeks:{one:"×©×‘×•×¢",two:"×©×‘×•×¢×™×™×",other:"{{count}} ×©×‘×•×¢×•×ª"},aboutXMonths:{one:"×›×—×•×“×©",two:"×›×—×•×“×©×™×™×",other:"×›Ö¾{{count}} ×—×•×“×©×™×"},xMonths:{one:"×—×•×“×©",two:"×—×•×“×©×™×™×",other:"{{count}} ×—×•×“×©×™×"},aboutXYears:{one:"×›×©× ×”",two:"×›×©× ×ª×™×™×",other:"×›Ö¾{{count}} ×©× ×™×"},xYears:{one:"×©× ×”",two:"×©× ×ª×™×™×",other:"{{count}} ×©× ×™×"},overXYears:{one:"×™×•×ª×¨ ××©× ×”",two:"×™×•×ª×¨ ××©× ×ª×™×™×",other:"×™×•×ª×¨ ×Ö¾{{count}} ×©× ×™×"},almostXYears:{one:"×›××¢×˜ ×©× ×”",two:"×›××¢×˜ ×©× ×ª×™×™×",other:"×›××¢×˜ {{count}} ×©× ×™×"}},Xe=function(r,t,a){if(r==="xDays"&&a!==null&&a!==void 0&&a.addSuffix&&t<=2)return a.comparison&&a.comparison>0?t===1?"××—×¨":"××—×¨×ª×™×™×":t===1?"××ª××•×œ":"×©×œ×©×•×";var n,x=Ye[r];return typeof x=="string"?n=x:t===1?n=x.one:t===2?n=x.two:n=x.other.replace("{{count}}",String(t)),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"×‘×¢×•×“ "+n:"×œ×¤× ×™ "+n:n};const Ke=Xe;var Qe={full:"EEEE, d ×‘MMMM y",long:"d ×‘MMMM y",medium:"d ×‘MMM y",short:"d.M.y"},Ge={full:"H:mm:ss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},Je={full:"{{date}} '×‘×©×¢×”' {{time}}",long:"{{date}} '×‘×©×¢×”' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ze={date:me({formats:Qe,defaultWidth:"full"}),time:me({formats:Ge,defaultWidth:"full"}),dateTime:me({formats:Je,defaultWidth:"full"})};const es=Ze;var ss={lastWeek:"eeee '×©×¢×‘×¨ ×‘×©×¢×”' p",yesterday:"'××ª××•×œ ×‘×©×¢×”' p",today:"'×”×™×•× ×‘×©×¢×”' p",tomorrow:"'××—×¨ ×‘×©×¢×”' p",nextWeek:"eeee '×‘×©×¢×”' p",other:"P"},ts=function(r,t,a,n){return ss[r]};const as=ts;var rs={narrow:["×œ×¤× ×”×´×¡","×œ×¡×¤×™×¨×”"],abbreviated:["×œ×¤× ×”×´×¡","×œ×¡×¤×™×¨×”"],wide:["×œ×¤× ×™ ×”×¡×¤×™×¨×”","×œ×¡×¤×™×¨×”"]},ns={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["×¨×‘×¢×•×Ÿ 1","×¨×‘×¢×•×Ÿ 2","×¨×‘×¢×•×Ÿ 3","×¨×‘×¢×•×Ÿ 4"]},ls={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["×™× ×•×³","×¤×‘×¨×³","××¨×¥","××¤×¨×³","×××™","×™×•× ×™","×™×•×œ×™","××•×’×³","×¡×¤×˜×³","××•×§×³","× ×•×‘×³","×“×¦××³"],wide:["×™× ×•××¨","×¤×‘×¨×•××¨","××¨×¥","××¤×¨×™×œ","×××™","×™×•× ×™","×™×•×œ×™","××•×’×•×¡×˜","×¡×¤×˜××‘×¨","××•×§×˜×•×‘×¨","× ×•×‘××‘×¨","×“×¦××‘×¨"]},is={narrow:["××³","×‘×³","×’×³","×“×³","×”×³","×•×³","×©×³"],short:["××³","×‘×³","×’×³","×“×³","×”×³","×•×³","×©×³"],abbreviated:["×™×•× ××³","×™×•× ×‘×³","×™×•× ×’×³","×™×•× ×“×³","×™×•× ×”×³","×™×•× ×•×³","×©×‘×ª"],wide:["×™×•× ×¨××©×•×Ÿ","×™×•× ×©× ×™","×™×•× ×©×œ×™×©×™","×™×•× ×¨×‘×™×¢×™","×™×•× ×—××™×©×™","×™×•× ×©×™×©×™","×™×•× ×©×‘×ª"]},os={narrow:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×•×§×¨",afternoon:"××—×¨ ×”×¦×”×¨×™×™×",evening:"×¢×¨×‘",night:"×œ×™×œ×”"},abbreviated:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×•×§×¨",afternoon:"××—×¨ ×”×¦×”×¨×™×™×",evening:"×¢×¨×‘",night:"×œ×™×œ×”"},wide:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×•×§×¨",afternoon:"××—×¨ ×”×¦×”×¨×™×™×",evening:"×¢×¨×‘",night:"×œ×™×œ×”"}},cs={narrow:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×‘×•×§×¨",afternoon:"×‘×¦×”×¨×™×™×",evening:"×‘×¢×¨×‘",night:"×‘×œ×™×œ×”"},abbreviated:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×‘×•×§×¨",afternoon:"××—×¨ ×”×¦×”×¨×™×™×",evening:"×‘×¢×¨×‘",night:"×‘×œ×™×œ×”"},wide:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×‘×•×§×¨",afternoon:"××—×¨ ×”×¦×”×¨×™×™×",evening:"×‘×¢×¨×‘",night:"×‘×œ×™×œ×”"}},ds=function(r,t){var a=Number(r);if(a<=0||a>10)return String(a);var n=String(t?.unit),x=["year","hour","minute","second"].indexOf(n)>=0,u=["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™","×©×‘×™×¢×™","×©××™× ×™","×ª×©×™×¢×™","×¢×©×™×¨×™"],N=["×¨××©×•× ×”","×©× ×™×™×”","×©×œ×™×©×™×ª","×¨×‘×™×¢×™×ª","×—××™×©×™×ª","×©×™×©×™×ª","×©×‘×™×¢×™×ª","×©××™× ×™×ª","×ª×©×™×¢×™×ª","×¢×©×™×¨×™×ª"],p=a-1;return x?N[p]:u[p]},ms={ordinalNumber:ds,era:re({values:rs,defaultWidth:"wide"}),quarter:re({values:ns,defaultWidth:"wide",argumentCallback:function(r){return r-1}}),month:re({values:ls,defaultWidth:"wide"}),day:re({values:is,defaultWidth:"wide"}),dayPeriod:re({values:os,defaultWidth:"wide",formattingValues:cs,defaultFormattingWidth:"wide"})};const us=ms;var xs=/^(\d+|(×¨××©×•×Ÿ|×©× ×™|×©×œ×™×©×™|×¨×‘×™×¢×™|×—××™×©×™|×©×™×©×™|×©×‘×™×¢×™|×©××™× ×™|×ª×©×™×¢×™|×¢×©×™×¨×™|×¨××©×•× ×”|×©× ×™×™×”|×©×œ×™×©×™×ª|×¨×‘×™×¢×™×ª|×—××™×©×™×ª|×©×™×©×™×ª|×©×‘×™×¢×™×ª|×©××™× ×™×ª|×ª×©×™×¢×™×ª|×¢×©×™×¨×™×ª))/i,hs=/^(\d+|×¨×|×©× |×©×œ|×¨×‘|×—|×©×™|×©×‘|×©×|×ª|×¢)/i,gs={narrow:/^×œ(×¡×¤×™×¨×”|×¤× ×”×´×¡)/i,abbreviated:/^×œ(×¡×¤×™×¨×”|×¤× ×”×´×¡)/i,wide:/^×œ(×¤× ×™ ×”)?×¡×¤×™×¨×”/i},ps={any:[/^×œ×¤/i,/^×œ×¡/i]},fs={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^×¨×‘×¢×•×Ÿ [1234]/i},bs={any:[/1/i,/2/i,/3/i,/4/i]},ys={narrow:/^\d+/i,abbreviated:/^(×™× ×•|×¤×‘×¨|××¨×¥|××¤×¨|×××™|×™×•× ×™|×™×•×œ×™|××•×’|×¡×¤×˜|××•×§|× ×•×‘|×“×¦×)×³?/i,wide:/^(×™× ×•××¨|×¤×‘×¨×•××¨|××¨×¥|××¤×¨×™×œ|×××™|×™×•× ×™|×™×•×œ×™|××•×’×•×¡×˜|×¡×¤×˜××‘×¨|××•×§×˜×•×‘×¨|× ×•×‘××‘×¨|×“×¦××‘×¨)/i},js={narrow:[/^1$/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^7/i,/^8/i,/^9/i,/^10/i,/^11/i,/^12/i],any:[/^×™× /i,/^×¤/i,/^××¨/i,/^××¤/i,/^××/i,/^×™×•× /i,/^×™×•×œ/i,/^××•×’/i,/^×¡/i,/^××•×§/i,/^× /i,/^×“/i]},Ns={narrow:/^[××‘×’×“×”×•×©]×³/i,short:/^[××‘×’×“×”×•×©]×³/i,abbreviated:/^(×©×‘×ª|×™×•× (×|×‘|×’|×“|×”|×•)×³)/i,wide:/^×™×•× (×¨××©×•×Ÿ|×©× ×™|×©×œ×™×©×™|×¨×‘×™×¢×™|×—××™×©×™|×©×™×©×™|×©×‘×ª)/i},vs={abbreviated:[/××³$/i,/×‘×³$/i,/×’×³$/i,/×“×³$/i,/×”×³$/i,/×•×³$/i,/^×©/i],wide:[/×Ÿ$/i,/× ×™$/i,/×œ×™×©×™$/i,/×¢×™$/i,/××™×©×™$/i,/×©×™×©×™$/i,/×ª$/i],any:[/^×/i,/^×‘/i,/^×’/i,/^×“/i,/^×”/i,/^×•/i,/^×©/i]},ws={any:/^(××—×¨ ×”|×‘)?(×—×¦×•×ª|×¦×”×¨×™×™×|×‘×•×§×¨|×¢×¨×‘|×œ×™×œ×”|××—×”×´×¦|×œ×¤× ×”×´×¦)/i},Ts={any:{am:/^×œ×¤/i,pm:/^××—×”/i,midnight:/^×—/i,noon:/^×¦/i,morning:/×‘×•×§×¨/i,afternoon:/×‘×¦|××—×¨/i,evening:/×¢×¨×‘/i,night:/×œ×™×œ×”/i}},Ss=["×¨×","×©× ","×©×œ","×¨×‘","×—","×©×™","×©×‘","×©×","×ª","×¢"],Es={ordinalNumber:Fe({matchPattern:xs,parsePattern:hs,valueCallback:function(r){var t=parseInt(r,10);return isNaN(t)?Ss.indexOf(r)+1:t}}),era:ne({matchPatterns:gs,defaultMatchWidth:"wide",parsePatterns:ps,defaultParseWidth:"any"}),quarter:ne({matchPatterns:fs,defaultMatchWidth:"wide",parsePatterns:bs,defaultParseWidth:"any",valueCallback:function(r){return r+1}}),month:ne({matchPatterns:ys,defaultMatchWidth:"wide",parsePatterns:js,defaultParseWidth:"any"}),day:ne({matchPatterns:Ns,defaultMatchWidth:"wide",parsePatterns:vs,defaultParseWidth:"any"}),dayPeriod:ne({matchPatterns:ws,defaultMatchWidth:"any",parsePatterns:Ts,defaultParseWidth:"any"})};const Cs=Es;var Ds={code:"he",formatDistance:Ke,formatLong:es,formatRelative:as,localize:us,match:Cs,options:{weekStartsOn:0,firstWeekContainsDate:1}};const je=Ds,ks={×¨××©×•×Ÿ:0,×©× ×™:1,×©×œ×™×©×™:2,×¨×‘×™×¢×™:3,×—××™×©×™:4,×©×™×©×™:5,×©×‘×ª:6},Ne=["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™","×©×‘×ª"],Is=({teacher:o,timeBlocks:r=[],lessons:t=[],orchestraActivities:a=[],className:n="",showNavigation:x=!0,onLessonUpdate:u})=>{const[N,p]=g.useState(new Date),[b,A]=g.useState(null),[T,M]=g.useState(!1),E=g.useMemo(()=>Re(N,{weekStartsOn:0}),[N]),C=g.useMemo(()=>We(N,{weekStartsOn:0}),[N]),L=g.useMemo(()=>He({start:E,end:C}),[E,C]),U=i=>{const d=ks[i];return d===void 0?null:be(E,d)},k=g.useMemo(()=>{const i=[];return t.forEach((d,S)=>{const v=U(d.day);if(!v)return;const D=d.startTime||d.time||d.scheduleInfo?.startTime,s=d.duration||d.scheduleInfo?.duration||45,c=d.endTime||d.scheduleInfo?.endTime||X(D,s);if(!D){console.warn("Lesson missing time data:",d);return}i.push({id:`lesson-${d._id||S}`,date:v,startTime:D,endTime:c,title:d.lessonType==="group"?"×©×™×¢×•×¨ ×§×‘×•×¦×ª×™":"×©×™×¢×•×¨ ×¤×¨×˜×™",subtitle:d.studentName||"×ª×œ××™×“",studentName:d.studentName,instrumentName:d.instrumentName||d.instrument?.instrumentName,type:"lesson",location:d.location||d.scheduleInfo?.location,color:d.lessonType==="group"?"bg-green-100 border-green-300 text-green-800":"bg-blue-100 border-blue-300 text-blue-800",details:d})}),a.forEach(d=>{const S=U(d.day);if(S){if(!d.startTime||!d.endTime){console.warn("Orchestra activity missing time data:",d);return}i.push({id:`orchestra-${d._id}`,date:S,startTime:d.startTime,endTime:d.endTime,title:d.name,subtitle:d.type==="orchestra"?"×ª×–××•×¨×ª":"×× ×¡××‘×œ",type:d.type,location:d.location,participants:[`${d.participants||0} × ×’× ×™×`],color:d.type==="orchestra"?"bg-purple-100 border-purple-300 text-purple-800":"bg-green-100 border-green-300 text-green-800",details:d})}}),i.sort((d,S)=>{const v=d.date.getTime()-S.date.getTime();if(v!==0)return v;const D=d.startTime||"00:00",s=S.startTime||"00:00";return D.localeCompare(s)})},[r,t,a,o,E]),I=g.useMemo(()=>{const i={};return L.forEach(d=>{const S=G(d,"yyyy-MM-dd");i[S]=k.filter(v=>Ue(v.date,d))}),i},[k,L]),q=()=>p(i=>qe(i,7)),Y=()=>p(i=>be(i,7)),m=()=>p(new Date),j=i=>{switch(i){case"lesson":return e.jsx(Z,{className:"w-4 h-4"});case"orchestra":return e.jsx(ue,{className:"w-4 h-4"});case"ensemble":return e.jsx(J,{className:"w-4 h-4"});default:return e.jsx(Te,{className:"w-4 h-4"})}},w=i=>{i.type==="lesson"&&i.details&&(console.log("ğŸ¯ Opening lesson for editing:",i.details),console.log("ğŸ†” Activity ID:",i.id),console.log("ğŸ“‹ Full activity object:",i),A(i.details))},_=async i=>{if(b){M(!0);try{u&&await u({...b,...i}),A(null)}catch(d){console.error("Error updating lesson:",d),alert("×©×’×™××” ×‘×¢×“×›×•×Ÿ ×”×©×™×¢×•×¨. ×× × × ×¡×” ×©×•×‘.")}finally{M(!1)}}},V=(i,d)=>{const[S,v]=i.split(":").map(Number),[D,s]=d.split(":").map(Number),c=S*60+v;return D*60+s-c},X=(i,d)=>{if(!i||!d)return i||"00:00";const[S,v]=i.split(":").map(Number),D=S*60+v+d,s=Math.floor(D/60),c=D%60;return`${s.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`};return e.jsxs("div",{className:`bg-white rounded-lg shadow-sm border border-gray-200 ${n}`,children:[x&&e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:q,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(_e,{className:"w-5 h-5"})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["×œ×•×— ×–×× ×™× - ",G(E,"dd/MM",{locale:je})," - ",G(C,"dd/MM/yyyy",{locale:je})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[k.length," ×¤×¢×™×œ×•×™×•×ª ×”×©×‘×•×¢"]})]}),e.jsx("button",{onClick:Y,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Oe,{className:"w-5 h-5"})})]}),e.jsx("button",{onClick:m,className:"px-3 py-1 text-sm bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"×”×©×‘×•×¢ ×”× ×•×›×—×™"})]})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx("div",{className:"grid grid-cols-7 gap-3",children:L.map((i,d)=>{const S=G(i,"yyyy-MM-dd"),v=I[S]||[],D=fe(i);return e.jsxs("div",{className:`border rounded-lg ${D?"border-primary-400 bg-primary-50/30":"border-gray-200 bg-white"}`,children:[e.jsxs("div",{className:`p-3 text-center border-b ${D?"bg-primary-100 text-primary-800 border-primary-200":v.length>0?"bg-blue-50 text-blue-700 border-blue-100":"bg-gray-50 text-gray-600 border-gray-200"}`,children:[e.jsx("div",{className:"font-semibold",children:Ne[d]}),e.jsx("div",{className:"text-sm mt-1",children:G(i,"dd/MM")}),v.length>0&&e.jsxs("div",{className:"text-xs mt-1 opacity-75",children:[v.length," ×¤×¢×™×œ×•×™×•×ª"]})]}),e.jsx("div",{className:"p-2 space-y-2 min-h-[400px]",children:v.length===0?e.jsx("div",{className:"text-center text-sm text-gray-400 mt-8",children:"××™×Ÿ ×¤×¢×™×œ×•×™×•×ª"}):v.map(s=>e.jsxs("div",{className:`p-3 rounded-lg border-l-4 ${s.color} shadow-sm hover:shadow-md transition-shadow ${s.type==="lesson"?"cursor-pointer":"cursor-default"}`,onClick:()=>s.type==="lesson"&&w(s),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[j(s.type),e.jsx("span",{className:"font-semibold text-sm",children:s.title})]}),s.type==="lesson"&&e.jsx(ee,{className:"w-4 h-4 text-gray-400 hover:text-blue-600 transition-colors"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs mb-1",children:[e.jsx(ie,{className:"w-3 h-3"}),e.jsxs("span",{className:"font-medium",children:[s.startTime," - ",s.endTime]})]}),s.subtitle&&e.jsxs("div",{className:"text-xs opacity-90 mb-1",children:[s.type==="lesson"&&s.studentName&&e.jsxs("div",{className:"font-medium",children:["×ª×œ××™×“: ",s.studentName]}),s.type!=="lesson"&&e.jsx("div",{children:s.subtitle})]}),s.type==="lesson"&&s.instrumentName&&e.jsxs("div",{className:"text-xs opacity-75 mb-1",children:["×›×œ×™: ",s.instrumentName]}),s.location&&e.jsxs("div",{className:"flex items-center gap-1 text-xs opacity-75",children:[e.jsx(le,{className:"w-3 h-3"}),e.jsx("span",{children:s.location})]}),s.participants&&e.jsxs("div",{className:"flex items-center gap-1 text-xs opacity-75 mt-1",children:[e.jsx(J,{className:"w-3 h-3"}),e.jsx("span",{children:s.participants.join(", ")})]})]},s.id))})]},S)})})}),e.jsx("div",{className:"lg:hidden",children:e.jsx("div",{className:"space-y-4 pb-safe",children:L.map((i,d)=>{const S=G(i,"yyyy-MM-dd"),v=I[S]||[],D=fe(i);return e.jsxs("div",{className:`border rounded-lg overflow-hidden ${D?"border-primary-400":"border-gray-200"}`,children:[e.jsx("div",{className:`p-3 font-semibold ${D?"bg-primary-100 text-primary-800":v.length>0?"bg-blue-50 text-blue-700":"bg-gray-50 text-gray-700"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{children:[Ne[d]," - ",G(i,"dd/MM")]}),v.length>0&&e.jsxs("span",{className:"text-sm opacity-75",children:[v.length," ×¤×¢×™×œ×•×™×•×ª"]})]})}),e.jsx("div",{className:"p-3",children:v.length===0?e.jsx("div",{className:"text-center text-sm text-gray-400 py-4",children:"××™×Ÿ ×¤×¢×™×œ×•×™×•×ª"}):e.jsx("div",{className:"space-y-2",children:v.map(s=>e.jsxs("div",{className:`p-3 rounded-lg border-l-4 ${s.color} ${s.type==="lesson"?"cursor-pointer active:bg-opacity-80 touch-manipulation select-none":"cursor-default"} transition-all duration-200`,onClick:()=>s.type==="lesson"&&w(s),onTouchStart:c=>{s.type==="lesson"&&(c.currentTarget.style.transform="scale(0.98)")},onTouchEnd:c=>{s.type==="lesson"&&(c.currentTarget.style.transform="scale(1)")},children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[j(s.type),e.jsx("h4",{className:"font-semibold text-sm",children:s.title})]}),s.type==="lesson"&&e.jsx(ee,{className:"w-4 h-4 text-gray-400 hover:text-blue-600 transition-colors"})]}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"w-3 h-3"}),e.jsxs("span",{className:"font-medium",children:[s.startTime," - ",s.endTime]})]}),s.type==="lesson"&&s.studentName&&e.jsxs("div",{className:"font-medium",children:["×ª×œ××™×“: ",s.studentName]}),s.instrumentName&&e.jsxs("div",{className:"opacity-75",children:["×›×œ×™: ",s.instrumentName]}),s.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"w-3 h-3"}),e.jsx("span",{children:s.location})]}),s.participants&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"w-3 h-3"}),e.jsx("span",{children:s.participants.join(", ")})]})]})]},s.id))})})]},S)})})}),k.length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"×¡×™×›×•× ×”×©×‘×•×¢"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:k.filter(i=>i.type==="lesson").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"×©×™×¢×•×¨×™×"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:k.filter(i=>i.type==="orchestra").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"×ª×–××•×¨×•×ª"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:k.filter(i=>i.type==="ensemble").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"×× ×¡××‘×œ×™×"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:L.filter(i=>{const d=G(i,"yyyy-MM-dd");return(I[d]||[]).length>0}).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"×™××™× ×¤×¢×™×œ×™×"})]})]})]}),r.length>0&&e.jsxs("div",{className:"mt-6 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(se,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"×™××™ ×œ×™××•×“ - ×–××™× ×•×ª ×œ××¢×¨×›×ª"}),e.jsxs("span",{className:"text-sm text-gray-600 bg-white px-2 py-1 rounded-full",children:[r.length," ×‘×œ×•×§×™ ×–××Ÿ"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(i=>e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200 shadow-sm hover:shadow-md transition-all duration-200",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-bold text-gray-900 text-lg",children:i.day}),i.isActive&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full font-medium",children:"×¤×¢×™×œ"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 mb-2",children:[e.jsx(ie,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"font-medium",children:[i.startTime," - ",i.endTime]})]}),i.location&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-2",children:[e.jsx(le,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:i.location})]}),i.notes&&e.jsx("div",{className:"text-xs text-gray-500 bg-gray-50 p-2 rounded-md mt-2",children:i.notes})]}),e.jsxs("div",{className:"text-center ml-3",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Math.floor(i.totalDuration/60)}),e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"×©×¢×•×ª"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:i.totalDuration%60!==0&&`+${i.totalDuration%60}×“'`})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:[i.assignedLessons?.length||0," ×©×™×¢×•×¨×™× ××ª×•×›× × ×™×"]}),e.jsx("span",{className:"text-blue-600 font-medium",children:"×–××™×Ÿ ×œ××¢×¨×›×ª"})]})})]},i._id))}),e.jsx("div",{className:"mt-4 p-3 bg-blue-100 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"×”×¡×‘×¨:"})," ×™××™ ×”×œ×™××•×“ ××¦×™×’×™× ××ª ×”×–×× ×™× ×‘×”× ×”××•×¨×” ×–××™×Ÿ ×œ×œ××“. ×¨×§ ×©×™×¢×•×¨×™× ×‘×¤×•×¢×œ ×¢× ×ª×œ××™×“×™× ×•×¤×¢×™×œ×•×™×•×ª ×”× ×™×¦×•×— ××•×¦×’×™× ×‘×œ×•×— ×”×–×× ×™× ×œ××¢×œ×”."]})})]})]}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"×¢×¨×™×›×ª ×©×™×¢×•×¨ ×¤×¨×˜×™"}),e.jsx("button",{onClick:()=>A(null),className:"text-gray-400 hover:text-gray-600 p-1",children:e.jsx(xe,{className:"w-6 h-6"})})]}),e.jsxs("form",{className:"space-y-4",onSubmit:async i=>{i.preventDefault();const d=i.target,S=new FormData(d),v=S.get("day"),D=S.get("startTime"),s=S.get("endTime");if(!v||!D||!s){alert("×× × ××œ× ××ª ×›×œ ×”×©×“×•×ª ×”× ×“×¨×©×™×");return}const c=V(D,s);if(c<=0){alert("×–××Ÿ ×”×¡×™×•× ×—×™×™×‘ ×œ×”×™×•×ª ×œ××—×¨ ×–××Ÿ ×”×”×ª×—×œ×”");return}await _({day:v,startTime:D,endTime:s,duration:c})},children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×™×•× ×”×©×‘×•×¢"}),e.jsxs("select",{name:"day",defaultValue:b.day,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×™×•×"}),e.jsx("option",{value:"×¨××©×•×Ÿ",children:"×¨××©×•×Ÿ"}),e.jsx("option",{value:"×©× ×™",children:"×©× ×™"}),e.jsx("option",{value:"×©×œ×™×©×™",children:"×©×œ×™×©×™"}),e.jsx("option",{value:"×¨×‘×™×¢×™",children:"×¨×‘×™×¢×™"}),e.jsx("option",{value:"×—××™×©×™",children:"×—××™×©×™"}),e.jsx("option",{value:"×©×™×©×™",children:"×©×™×©×™"}),e.jsx("option",{value:"×©×‘×ª",children:"×©×‘×ª"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×–××Ÿ ×”×ª×—×œ×”"}),e.jsx("input",{type:"time",name:"startTime",defaultValue:b.startTime||b.time,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×–××Ÿ ×¡×™×•×"}),e.jsx("input",{type:"time",name:"endTime",defaultValue:b.endTime||X(b.startTime||b.time||"00:00",b.duration||45),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"×¤×¨×˜×™ ×”×©×™×¢×•×¨"}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"×ª×œ××™×“:"})," ",b.studentName||"×œ× ×¦×•×™×Ÿ"]}),b.instrumentName&&e.jsxs("div",{children:[e.jsx("strong",{children:"×›×œ×™ × ×’×™× ×”:"})," ",b.instrumentName]}),b.location&&e.jsxs("div",{children:[e.jsx("strong",{children:"××™×§×•×:"})," ",b.location]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[e.jsx("button",{type:"submit",disabled:T,className:"flex-1 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-medium disabled:opacity-50",children:T?"×©×•××¨...":"×©××•×¨ ×©×™× ×•×™×™×"}),e.jsx("button",{type:"button",onClick:()=>A(null),className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"×‘×™×˜×•×œ"})]})]})]})})]})};class As{async getCurrentOrchestraEnrollments(r){if(!r||r.length===0)return[];try{const t=r.map(async n=>{try{return await H.getOrchestra(n)}catch(x){return console.warn(`Failed to fetch orchestra ${n}:`,x),null}});return(await Promise.allSettled(t)).filter(n=>n.status==="fulfilled"&&n.value!==null).map(n=>n.value)}catch(t){throw console.error("Error fetching orchestra enrollments:",t),{code:"FETCH_ORCHESTRAS_FAILED",message:"×©×’×™××” ×‘×˜×¢×™× ×ª × ×ª×•× ×™ ×”×ª×–××•×¨×•×ª",details:t}}}async getCurrentEnsembleEnrollments(r){if(!r||r.length===0)return[];try{const t=r.map(async n=>{try{return await H.request(`/ensemble/${n}`)}catch(x){return console.warn(`Failed to fetch ensemble ${n}:`,x),null}});return(await Promise.allSettled(t)).filter(n=>n.status==="fulfilled"&&n.value!==null).map(n=>n.value)}catch(t){throw console.error("Error fetching ensemble enrollments:",t),{code:"FETCH_ENSEMBLES_FAILED",message:"×©×’×™××” ×‘×˜×¢×™× ×ª × ×ª×•× ×™ ×”×”×¨×›×‘×™×",details:t}}}async getAllAvailableOrchestras(){try{return(await H.request("/orchestra")).filter(t=>t.isActive)}catch(r){throw console.error("Error fetching available orchestras:",r),{code:"FETCH_ALL_ORCHESTRAS_FAILED",message:"×©×’×™××” ×‘×˜×¢×™× ×ª ×¨×©×™××ª ×”×ª×–××•×¨×•×ª ×”×–××™× ×•×ª",details:r}}}async getAllAvailableEnsembles(){try{return(await H.request("/ensemble")).filter(t=>t.isActive)}catch(r){throw console.error("Error fetching available ensembles:",r),{code:"FETCH_ALL_ENSEMBLES_FAILED",message:"×©×’×™××” ×‘×˜×¢×™× ×ª ×¨×©×™××ª ×”×”×¨×›×‘×™× ×”×–××™× ×™×",details:r}}}async checkOrchestraEligibility(r,t,a){try{const n=await H.getOrchestra(t),x=a||await H.getStudentDetails(r),u={canEnroll:!0,reasons:[],conflicts:[],instrumentCompatible:!1,hasSpace:!1,meetsRequirements:!1},N=x.instrumentProgress?.map(b=>b.instrumentName)||[];u.instrumentCompatible=n.instruments.some(b=>N.includes(b)),u.instrumentCompatible||(u.canEnroll=!1,u.reasons.push(`×”×›×œ×™ ×©×œ×š (${N.join(", ")}) ×œ× ××ª××™× ×œ×ª×–××•×¨×ª ×–×•`)),n.maxMembers&&n.currentMembers?(u.hasSpace=n.currentMembers<n.maxMembers,u.hasSpace||(u.canEnroll=!1,u.reasons.push("×”×ª×–××•×¨×ª ××œ××” - ××™×Ÿ ××§×•××•×ª ×–××™× ×™×"))):u.hasSpace=!0;const p=await this.detectScheduleConflicts(x,n.rehearsalTimes);return u.conflicts=p,p.length>0&&p.some(A=>A.severity==="overlap")&&(u.canEnroll=!1,u.reasons.push("×™×© ×”×ª× ×’×©×•×ª ×¢× ×”×©×™×¢×•×¨×™× ×”×§×™×™××™× ×©×œ×š")),u.meetsRequirements=!0,u.estimatedCost=n.yearlyFee||0,u}catch(n){throw console.error("Error checking orchestra eligibility:",n),{code:"ELIGIBILITY_CHECK_FAILED",message:"×©×’×™××” ×‘×‘×“×™×§×ª ×–×›××•×ª ×œ×ª×–××•×¨×ª",details:n}}}async checkEnsembleEligibility(r,t,a){try{const n=await H.request(`/ensemble/${t}`),x=a||await H.getStudentDetails(r),u={canEnroll:!0,reasons:[],conflicts:[],instrumentCompatible:!1,hasSpace:!1,meetsRequirements:!1},N=x.instrumentProgress?.map(b=>b.instrumentName)||[];u.instrumentCompatible=n.instruments.some(b=>N.includes(b)),u.instrumentCompatible||(u.canEnroll=!1,u.reasons.push(`×”×›×œ×™ ×©×œ×š (${N.join(", ")}) ×œ× ××ª××™× ×œ×”×¨×›×‘ ×–×”`)),n.maxMembers&&n.currentMembers?(u.hasSpace=n.currentMembers<n.maxMembers,u.hasSpace||(u.canEnroll=!1,u.reasons.push("×”×”×¨×›×‘ ××œ× - ××™×Ÿ ××§×•××•×ª ×–××™× ×™×"))):u.hasSpace=!0;const p=await this.detectScheduleConflicts(x,n.rehearsalTimes);return u.conflicts=p,p.length>0&&p.some(A=>A.severity==="overlap")&&(u.canEnroll=!1,u.reasons.push("×™×© ×”×ª× ×’×©×•×ª ×¢× ×”×©×™×¢×•×¨×™× ×”×§×™×™××™× ×©×œ×š")),u.meetsRequirements=!0,u.estimatedCost=n.yearlyFee||0,u}catch(n){throw console.error("Error checking ensemble eligibility:",n),{code:"ELIGIBILITY_CHECK_FAILED",message:"×©×’×™××” ×‘×‘×“×™×§×ª ×–×›××•×ª ×œ×”×¨×›×‘",details:n}}}async detectScheduleConflicts(r,t){const a=[];try{const n=r.teacherAssignments||[],x={×¨××©×•×Ÿ:0,×©× ×™:1,×©×œ×™×©×™:2,×¨×‘×™×¢×™:3,×—××™×©×™:4,×©×™×©×™:5,×©×‘×ª:6};for(const u of t){const N=x[u.day];for(const p of n){const b=x[p.day];if(N===b){const A=this.timeToMinutes(u.startTime),T=this.timeToMinutes(u.endTime),M=this.timeToMinutes(p.startTime),E=M+(p.duration||45);A<E&&M<T?a.push({type:"lesson",conflictWith:`×©×™×¢×•×¨ ${p.instrumentName||"×›×œ×™ × ×’×™× ×”"} ×¢× ${p.teacherName||"×”××•×¨×”"}`,day:p.day,startTime:p.startTime,endTime:this.minutesToTime(E),severity:"overlap"}):(Math.abs(A-E)<30||Math.abs(M-T)<30)&&a.push({type:"lesson",conflictWith:`×©×™×¢×•×¨ ${p.instrumentName||"×›×œ×™ × ×’×™× ×”"} ×¢× ${p.teacherName||"×”××•×¨×”"}`,day:p.day,startTime:p.startTime,endTime:this.minutesToTime(E),severity:"adjacent"})}}}}catch(n){console.error("Error detecting conflicts:",n)}return a}async addOrchestraEnrollment(r,t){try{const a=await this.checkOrchestraEligibility(r,t);if(!a.canEnroll)throw{code:"ENROLLMENT_NOT_ELIGIBLE",message:`×œ× × ×™×ª×Ÿ ×œ×”×¨×©×: ${a.reasons.join(", ")}`,details:{eligibility:a}};const n=await H.getStudentDetails(r);if(n.orchestraIds?.includes(t))throw{code:"ALREADY_ENROLLED",message:"×”×ª×œ××™×“ ×›×‘×¨ ×¨×©×•× ×œ×ª×–××•×¨×ª ×–×•",details:{orchestraId:t}};const x=[...n.orchestraIds||[],t];await H.request(`/student/${r}`,{method:"PUT",body:JSON.stringify({orchestraIds:x})})}catch(a){throw a.code?a:(console.error("Error adding orchestra enrollment:",a),{code:"ENROLLMENT_FAILED",message:"×©×’×™××” ×‘×¨×™×©×•× ×œ×ª×–××•×¨×ª",details:a})}}async removeOrchestraEnrollment(r,t){try{const a=await H.getStudentDetails(r);if(!a.orchestraIds?.includes(t))throw{code:"NOT_ENROLLED",message:"×”×ª×œ××™×“ ××™× ×• ×¨×©×•× ×œ×ª×–××•×¨×ª ×–×•",details:{orchestraId:t}};const n=a.orchestraIds.filter(x=>x!==t);await H.request(`/student/${r}`,{method:"PUT",body:JSON.stringify({orchestraIds:n})})}catch(a){throw a.code?a:(console.error("Error removing orchestra enrollment:",a),{code:"UNENROLLMENT_FAILED",message:"×©×’×™××” ×‘×‘×™×˜×•×œ ×¨×™×©×•× ××”×ª×–××•×¨×ª",details:a})}}async addEnsembleEnrollment(r,t){try{const a=await this.checkEnsembleEligibility(r,t);if(!a.canEnroll)throw{code:"ENROLLMENT_NOT_ELIGIBLE",message:`×œ× × ×™×ª×Ÿ ×œ×”×¨×©×: ${a.reasons.join(", ")}`,details:{eligibility:a}};const n=await H.getStudentDetails(r);if(n.ensembleIds?.includes(t))throw{code:"ALREADY_ENROLLED",message:"×”×ª×œ××™×“ ×›×‘×¨ ×¨×©×•× ×œ×”×¨×›×‘ ×–×”",details:{ensembleId:t}};const x=[...n.ensembleIds||[],t];await H.request(`/student/${r}`,{method:"PUT",body:JSON.stringify({ensembleIds:x})})}catch(a){throw a.code?a:(console.error("Error adding ensemble enrollment:",a),{code:"ENROLLMENT_FAILED",message:"×©×’×™××” ×‘×¨×™×©×•× ×œ×”×¨×›×‘",details:a})}}async removeEnsembleEnrollment(r,t){try{const a=await H.getStudentDetails(r);if(!a.ensembleIds?.includes(t))throw{code:"NOT_ENROLLED",message:"×”×ª×œ××™×“ ××™× ×• ×¨×©×•× ×œ×”×¨×›×‘ ×–×”",details:{ensembleId:t}};const n=a.ensembleIds.filter(x=>x!==t);await H.request(`/student/${r}`,{method:"PUT",body:JSON.stringify({ensembleIds:n})})}catch(a){throw a.code?a:(console.error("Error removing ensemble enrollment:",a),{code:"UNENROLLMENT_FAILED",message:"×©×’×™××” ×‘×‘×™×˜×•×œ ×¨×™×©×•× ××”×”×¨×›×‘",details:a})}}timeToMinutes(r){const[t,a]=r.split(":").map(Number);return t*60+a}minutesToTime(r){const t=Math.floor(r/60),a=r%60;return`${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}}const ve=new As,Ms=({teacher:o,teacherId:r})=>{const[t,a]=g.useState(null),[n,x]=g.useState(!1),[u,N]=g.useState([]),[p,b]=g.useState([]),[A,T]=g.useState([]),[M,E]=g.useState(!1),[C,L]=g.useState(!1),[U,k]=g.useState(!1),[I,q]=g.useState(o),[Y,m]=g.useState(null);g.useEffect(()=>{(async()=>{if(o.conducting){E(!0);try{const c=(o.conducting.orchestraIds||[]).map(async y=>{try{const h=await ve.getCurrentOrchestraEnrollments([y]);return h[0]?{_id:h[0]._id,name:h[0].name,type:"orchestra",rehearsalTimes:h[0].rehearsalTimes||[],location:"××•×œ× ×”×ª×–××•×¨×ª",participants:h[0].currentMembers||0}:null}catch(h){return console.warn(`Failed to load orchestra ${y}:`,h),null}}),P=(o.conducting.ensemblesIds||[]).map(async y=>{try{const h=await ve.getCurrentEnsembleEnrollments([y]);return h[0]?{_id:h[0]._id,name:h[0].name,type:"ensemble",rehearsalTimes:h[0].rehearsalTimes||[],location:"×—×“×¨ ×”×× ×¡××‘×œ",participants:h[0].currentMembers||0}:null}catch(h){return console.warn(`Failed to load ensemble ${y}:`,h),null}}),[W,B]=await Promise.all([Promise.allSettled(c),Promise.allSettled(P)]),K=W.filter(y=>y.status==="fulfilled"&&y.value!==null).map(y=>y.value),z=B.filter(y=>y.status==="fulfilled"&&y.value!==null).map(y=>y.value),l=K.flatMap(y=>y.rehearsalTimes.map(h=>({_id:`${y._id}-${h.day}-${h.startTime}`,name:y.name,day:h.day,startTime:h.startTime,endTime:h.endTime,location:h.location||y.location,participants:y.participants,type:"orchestra"}))),f=z.flatMap(y=>y.rehearsalTimes.map(h=>({_id:`${y._id}-${h.day}-${h.startTime}`,name:y.name,day:h.day,startTime:h.startTime,endTime:h.endTime,location:h.location||y.location,participants:y.participants,type:"ensemble"})));N(l),b(f)}catch(c){console.error("Failed to load conducting activities:",c)}finally{E(!1)}}})()},[o.conducting]),g.useEffect(()=>{(async()=>{if(r)try{console.log("ğŸ”„ Loading teacher lessons for ID:",r);const c=await R.teachers.getTeacherLessons(r);console.log("âœ… Teacher lessons loaded:",c);const P=c?.lessons||c?.data?.lessons||[];T(P),console.log(`ğŸ“š Set ${P.length} lessons for teacher`)}catch(c){console.error("âŒ Failed to load teacher lessons:",c),T([])}})()},[r]);const j=["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™","×©×‘×ª"],w=async()=>{try{const s=await R.teachers.getTeacher(r);q(s)}catch(s){console.error("Failed to refresh teacher data:",s)}},_=g.useMemo(()=>{const s=[];return I.teaching?.timeBlocks&&s.push(...I.teaching.timeBlocks),I.teaching?.schedule&&I.teaching.schedule.forEach(c=>{c.studentId||s.push({_id:c._id,day:c.day,startTime:c.startTime,endTime:c.endTime,totalDuration:c.duration||0,location:c.location,notes:c.notes,isActive:c.isAvailable!==!1,assignedLessons:[],isFromSchedule:!0})}),s},[I.teaching?.timeBlocks,I.teaching?.schedule]);j.reduce((s,c)=>(s[c]=_.filter(P=>P.day===c)||[],s),{});const V=()=>_.reduce((s,c)=>s+(c.totalDuration||0),0)/60||0,X=()=>{const s=new Set;return I.teaching?.schedule?.forEach(c=>{c.studentId&&s.add(c.studentId)}),s.size},i=async s=>{try{if(console.log("ğŸ”„ Updating lesson via student record:",s),console.log("ğŸ†” Student ID:",s.studentId),console.log("ğŸ‘¨â€ğŸ« Teacher ID:",s.teacherId||r),console.log("ğŸ“ Update data:",{day:s.day,startTime:s.startTime,endTime:s.endTime,duration:s.duration}),!s.studentId)throw new Error("Student ID is missing");const c=await R.students.getStudentById(s.studentId);if(console.log("ğŸ“‹ Current student data loaded:",c.personalInfo?.fullName),!c.teacherAssignments||c.teacherAssignments.length===0)throw new Error("No teacher assignments found for this student");const P=s.teacherId||r,W=c.teacherAssignments.findIndex(h=>h.teacherId===P&&h.isActive);if(W===-1)throw new Error(`No active assignment found for teacher ${P}`);console.log(`ğŸ¯ Found teacher assignment at index ${W}`);const B=[...c.teacherAssignments],K=B[W],z=(h,O)=>{const[F,Q]=h.split(":").map(Number),$=F*60+Q+O,te=Math.floor($/60),ae=$%60;return`${te.toString().padStart(2,"0")}:${ae.toString().padStart(2,"0")}`};B[W]={...K,day:s.day,time:s.startTime,duration:s.duration,scheduleInfo:{...K.scheduleInfo,day:s.day,startTime:s.startTime,endTime:z(s.startTime,s.duration),duration:s.duration,updatedAt:new Date().toISOString()},updatedAt:new Date().toISOString()},console.log("ğŸ“¤ Updating student record with new assignment:",B[W]);const l=await R.students.updateStudent(s.studentId,{teacherAssignments:B});console.log("âœ… Student updated successfully:",l.personalInfo?.fullName);const f=await R.teachers.getTeacherLessons(r),y=f?.lessons||f?.data?.lessons||[];T(y),console.log("âœ… Teacher lessons refreshed - new count:",y.length)}catch(c){throw console.error("âŒ Failed to update lesson:",c),console.error("âŒ Error details:",c.message),c}},d=u.length+p.length,S=V(),v=_.length||0,D=X();return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-end items-start",children:[M&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600 mr-4",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),"×˜×•×¢×Ÿ ×¤×¢×™×œ×•×™×•×ª ×”× ×™×¦×•×—..."]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-600",children:Math.round(S)}),e.jsx("div",{className:"text-gray-600",children:"×©×¢×•×ª ×©×‘×•×¢×™×•×ª"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:v}),e.jsx("div",{className:"text-gray-600",children:"×™××™ ×œ×™××•×“"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:D}),e.jsx("div",{className:"text-gray-600",children:"×ª×œ××™×“×™×"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:d}),e.jsx("div",{className:"text-gray-600",children:"×”×¨×›×‘×™×"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>L(!1),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${C?"bg-white text-gray-600 hover:bg-gray-100":"bg-primary-500 text-white"}`,children:"×œ×•×— ×–×× ×™× ×©×‘×•×¢×™"}),e.jsx("button",{onClick:()=>L(!0),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${C?"bg-primary-500 text-white":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"× ×™×”×•×œ ×™××™ ×œ×™××•×“"})]}),d>0&&e.jsxs("div",{className:"text-sm text-gray-600",children:["×× ×¦×— ×¢×œ ",d," ×”×¨×›×‘×™×"]})]}),C?e.jsxs("div",{className:"space-y-6",children:[_.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:_.map((s,c)=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:s.day})]}),s.isActive&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full font-medium",children:"×¤×¢×™×œ"})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(ie,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"font-medium",children:[s.startTime," - ",s.endTime]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx("span",{className:"text-sm",children:"××©×š:"}),e.jsxs("span",{className:"font-medium text-blue-600",children:[Math.floor(s.totalDuration/60)," ×©×¢×•×ª",s.totalDuration%60!==0&&` ×•-${s.totalDuration%60} ×“×§×•×ª`]})]}),s.location&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(le,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:s.location})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(J,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-sm",children:[s.assignedLessons?.length||0," ×©×™×¢×•×¨×™× ××ª×•×›× × ×™×"]})]})]}),s.notes&&e.jsx("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-600",children:s.notes})}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-100",children:[e.jsxs("button",{onClick:()=>a(s),className:"flex-1 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors font-medium",children:[e.jsx(ee,{className:"w-4 h-4 inline-block ml-1"}),"×¢×¨×•×š"]}),e.jsxs("button",{onClick:()=>m({timeBlock:s}),disabled:U,className:"flex-1 px-3 py-2 text-sm bg-red-50 text-red-700 rounded-lg hover:bg-red-100 transition-colors font-medium disabled:opacity-50",children:[e.jsx(ce,{className:"w-4 h-4 inline-block ml-1"}),U?"××•×—×§...":"××—×§"]})]})]},s._id||c))}):e.jsxs("div",{className:"bg-white rounded-xl border-2 border-dashed border-gray-200 p-12 text-center",children:[e.jsx(se,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"××™×Ÿ ×™××™ ×œ×™××•×“ ××•×’×“×¨×™×"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"×˜×¨× ×”×•×’×“×¨×• ×™××™ ×œ×™××•×“ ×¢×‘×•×¨ ××•×¨×” ×–×”. ×”×’×“×¨ ×™××™ ×œ×™××•×“ ×›×“×™ ×œ××¤×©×¨ ×ª×–××•×Ÿ ×©×™×¢×•×¨×™×."}),e.jsx("button",{onClick:()=>x(!0),className:"px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-medium",children:"×”×•×¡×£ ×™×•× ×œ×™××•×“ ×¨××©×•×Ÿ"})]}),_.length>0&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-medium shadow-sm",children:[e.jsx(oe,{className:"w-5 h-5"}),"×”×•×¡×£ ×™×•× ×œ×™××•×“ ×—×“×©"]})})]}):e.jsx(Is,{teacher:I,timeBlocks:_,lessons:A,orchestraActivities:u,className:"",showNavigation:!0,onLessonUpdate:i}),t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["×¢×¨×•×š ×™×•× ×œ×™××•×“ - ",t.day]}),e.jsx("button",{onClick:()=>a(null),className:"text-gray-400 hover:text-gray-600 p-1",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×–××Ÿ ×”×ª×—×œ×”"}),e.jsx("input",{type:"time",defaultValue:t.startTime,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×–××Ÿ ×¡×™×•×"}),e.jsx("input",{type:"time",defaultValue:t.endTime,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"××™×§×•×"}),e.jsx("input",{type:"text",defaultValue:t.location,placeholder:"×—×“×¨, ××•×œ×, ××• ××™×§×•× ××—×¨",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×”×¢×¨×•×ª"}),e.jsx("textarea",{defaultValue:t.notes,placeholder:"×”×¢×¨×•×ª × ×•×¡×¤×•×ª ×¢×œ ×™×•× ×”×œ×™××•×“...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"isActive",defaultChecked:t.isActive,className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsx("label",{htmlFor:"isActive",className:"text-sm font-medium text-gray-700",children:"×™×•× ×œ×™××•×“ ×¤×¢×™×œ (×–××™×Ÿ ×œ×§×‘×™×¢×ª ×©×™×¢×•×¨×™×)"})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-medium disabled:opacity-50",disabled:U,onClick:async s=>{s.preventDefault();const c=s.target.closest("form");new FormData(c);const P=c.querySelectorAll('input[type="time"]'),W=P[0].value,B=P[1].value,K=c.querySelector('input[type="text"]').value,z=c.querySelector("textarea").value,l=c.querySelector('input[type="checkbox"]').checked,y=((h,O)=>{const[F,Q]=h.split(":").map(Number),[$,te]=O.split(":").map(Number),ae=F*60+Q;return $*60+te-ae})(W,B);try{if(k(!0),t.isFromSchedule){const h=I.teaching.schedule.map($=>$._id===t._id?{_id:$._id,day:$.day,startTime:W,endTime:B,duration:y,location:K,notes:z||null,isAvailable:l,studentId:$.studentId,recurring:$.recurring}:$);console.log("ğŸ”„ Simplified update approach"),console.log("ğŸ”„ Updated schedule entry:",h.find($=>$._id===t._id));const O=localStorage.getItem("authToken")||sessionStorage.getItem("authToken");if(!O)throw new Error("No authentication token found");console.log("ğŸ”‘ Using token:",O?"Token exists":"No token found"),console.log("ğŸ“Š Duration calculated:",y,"minutes"),console.log("ğŸ“ Time range:",W,"-",B);const F=await fetch(`http://localhost:3001/api/teacher/${r}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${O}`},body:JSON.stringify({teaching:{...I.teaching,schedule:h}})});if(!F.ok){const $=await F.text();throw console.error("âŒ Server response:",$),new Error(`HTTP ${F.status}: ${$}`)}const Q=await F.json();console.log("âœ… Update successful:",Q)}else await R.teachers.updateTimeBlock(r,t._id,{startTime:W,endTime:B,totalDuration:y,location:K,notes:z,isActive:l});await w(),a(null),console.log("âœ… Successfully updated teaching day")}catch(h){console.error("âŒ Failed to update teaching day:",h),console.error("Error details:",h.response?.data||h.message),alert("×©×’×™××” ×‘×¢×“×›×•×Ÿ ×™×•× ×”×œ×™××•×“. ×× × × ×¡×” ×©×•×‘.")}finally{k(!1)}},children:U?"×©×•××¨...":"×©××•×¨ ×©×™× ×•×™×™×"}),e.jsx("button",{type:"button",onClick:()=>a(null),className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"×‘×™×˜×•×œ"})]})]})]})}),!C&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"××§×¨×"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-100 border border-blue-300 rounded"}),e.jsx("span",{className:"text-gray-700",children:"×©×™×¢×•×¨×™× ×¤×¨×˜×™×™×"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-purple-100 border border-purple-300 rounded"}),e.jsx("span",{className:"text-gray-700",children:"×ª×–××•×¨×•×ª"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-100 border border-green-300 rounded"}),e.jsx("span",{className:"text-gray-700",children:"×× ×¡××‘×œ×™×"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-100 border border-gray-300 rounded"}),e.jsx("span",{className:"text-gray-700",children:"×–××Ÿ ×¤× ×•×™"})]})]})]}),Y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 p-6",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 rounded-full",children:e.jsx(Pe,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 text-center mb-2",children:"××—×™×§×ª ×™×•× ×œ×™××•×“"}),e.jsxs("p",{className:"text-gray-600 text-center mb-6",children:["×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×™×•× ×”×œ×™××•×“ ×‘×™×•× ",Y.timeBlock.day,"?"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>m(null),className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"×‘×™×˜×•×œ"}),e.jsx("button",{onClick:async()=>{const s=Y.timeBlock;m(null);try{if(k(!0),s.isFromSchedule){const c=I.teaching.schedule.filter(W=>W._id!==s._id),P={teaching:{...I.teaching,schedule:c}};console.log("ğŸ—‘ï¸ Deleting teaching day with data:",P),await R.teachers.updateTeacher(r,P)}else await R.teachers.deleteTimeBlock(r,s._id);await w(),console.log("âœ… Successfully deleted teaching day:",s.day)}catch(c){console.error("âŒ Failed to delete teaching day:",c),console.error("Error details:",c.response?.data||c.message),alert("×©×’×™××” ×‘××—×™×§×ª ×™×•× ×”×œ×™××•×“. ×× × × ×¡×” ×©×•×‘.")}finally{k(!1)}},disabled:U,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium disabled:opacity-50",children:U?"××•×—×§...":"××—×§"})]})]})})]})},$s=({teacher:o,teacherId:r})=>{const[t,a]=g.useState([]),[n,x]=g.useState([]),[u,N]=g.useState(!0),[p,b]=g.useState(!1),[A,T]=g.useState(!1),[M,E]=g.useState({name:"",description:""}),[C,L]=g.useState({name:"",description:"",type:""});g.useEffect(()=>{(async()=>{try{if(N(!0),o.conducting?.orchestraIds?.length>0){const j=o.conducting.orchestraIds.map(w=>R.orchestras?.getOrchestraById(w));if(j.length>0)try{const w=await Promise.all(j);a(w.filter(Boolean))}catch(w){console.warn("Error fetching orchestras:",w),a([])}}if(o.conducting?.ensemblesIds?.length>0){const j=o.conducting.ensemblesIds.map(w=>R.ensembles?.getEnsembleById(w));if(j.length>0)try{const w=await Promise.all(j);x(w.filter(Boolean))}catch(w){console.warn("Error fetching ensembles:",w),x([])}}}catch(j){console.error("Error fetching conducting data:",j)}finally{N(!1)}})()},[o.conducting]);const U=async()=>{if(M.name.trim())try{const m={...M,conductorId:r,memberIds:[],isActive:!0,createdAt:new Date};console.log("Creating orchestra:",m);const j={_id:`temp-${Date.now()}`,...m};a(w=>[...w,j]),E({name:"",description:""}),b(!1)}catch(m){console.error("Error creating orchestra:",m)}},k=async()=>{if(C.name.trim())try{const m={...C,conductorId:r,memberIds:[],isActive:!0,createdAt:new Date};console.log("Creating ensemble:",m);const j={_id:`temp-${Date.now()}`,...m};x(w=>[...w,j]),L({name:"",description:"",type:""}),T(!1)}catch(m){console.error("Error creating ensemble:",m)}},I=async m=>{if(confirm("×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×”×ª×–××•×¨×ª?"))try{console.log("Deleting orchestra:",m),a(j=>j.filter(w=>w._id!==m))}catch(j){console.error("Error deleting orchestra:",j)}},q=async m=>{if(confirm("×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×”×× ×¡××‘×œ?"))try{console.log("Deleting ensemble:",m),x(j=>j.filter(w=>w._id!==m))}catch(j){console.error("Error deleting ensemble:",j)}};if(u)return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse w-1/3"}),e.jsx("div",{className:"space-y-3",children:[1,2].map(m=>e.jsx("div",{className:"h-24 bg-gray-200 rounded animate-pulse"},m))})]});const Y=t.reduce((m,j)=>m+(j.memberIds?.length||0),0)+n.reduce((m,j)=>m+(j.memberIds?.length||0),0);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.length}),e.jsx("div",{className:"text-gray-600",children:"×ª×–××•×¨×•×ª"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.length}),e.jsx("div",{className:"text-gray-600",children:"×× ×¡××‘×œ×™×"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:Y}),e.jsx("div",{className:"text-gray-600",children:"×¡×š ×—×‘×¨×™×"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"×ª×–××•×¨×•×ª"}),e.jsxs("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:[e.jsx(oe,{className:"w-4 h-4"}),"×¦×•×¨ ×ª×–××•×¨×ª"]})]}),t.length===0?e.jsxs("div",{className:"text-center py-8 bg-purple-50 rounded-lg",children:[e.jsx(ue,{className:"w-12 h-12 text-purple-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"××™×Ÿ ×ª×–××•×¨×•×ª"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"×¢×“×™×™×Ÿ ×œ× × ×•×¦×¨×• ×ª×–××•×¨×•×ª ×ª×—×ª × ×™×¦×•×—×• ×©×œ ×”××•×¨×”"}),e.jsx("button",{onClick:()=>b(!0),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:"×¦×•×¨ ×ª×–××•×¨×ª ×¨××©×•× ×”"})]}):e.jsx("div",{className:"grid gap-4",children:t.map(m=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:m.name}),m.description&&e.jsx("p",{className:"text-gray-600 mb-3",children:m.description}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"w-4 h-4"}),m.memberIds?.length||0," ×—×‘×¨×™×"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"w-4 h-4"}),m.rehearsalSchedule?.length||0," ×—×–×¨×•×ª"]}),e.jsx("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${m.isActive!==!1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:m.isActive!==!1?"×¤×¢×™×œ":"×œ× ×¤×¢×™×œ"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-2 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>I(m._id),className:"px-3 py-2 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:e.jsx(ce,{className:"w-4 h-4"})})]})]})},m._id))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"×× ×¡××‘×œ×™×"}),e.jsxs("button",{onClick:()=>T(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[e.jsx(oe,{className:"w-4 h-4"}),"×¦×•×¨ ×× ×¡××‘×œ"]})]}),n.length===0?e.jsxs("div",{className:"text-center py-8 bg-blue-50 rounded-lg",children:[e.jsx(we,{className:"w-12 h-12 text-blue-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"××™×Ÿ ×× ×¡××‘×œ×™×"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"×¢×“×™×™×Ÿ ×œ× × ×•×¦×¨×• ×× ×¡××‘×œ×™× ×ª×—×ª × ×™×¦×•×—×• ×©×œ ×”××•×¨×”"}),e.jsx("button",{onClick:()=>T(!0),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"×¦×•×¨ ×× ×¡××‘×œ ×¨××©×•×Ÿ"})]}):e.jsx("div",{className:"grid gap-4",children:n.map(m=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:m.name}),m.description&&e.jsx("p",{className:"text-gray-600 mb-3",children:m.description}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"w-4 h-4"}),m.memberIds?.length||0," ×—×‘×¨×™×"]}),m.type&&e.jsx("div",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs",children:m.type}),e.jsx("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${m.isActive!==!1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:m.isActive!==!1?"×¤×¢×™×œ":"×œ× ×¤×¢×™×œ"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-2 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>q(m._id),className:"px-3 py-2 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:e.jsx(ce,{className:"w-4 h-4"})})]})]})},m._id))})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"×¦×•×¨ ×ª×–××•×¨×ª ×—×“×©×”"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©× ×”×ª×–××•×¨×ª"}),e.jsx("input",{type:"text",value:M.name,onChange:m=>E({...M,name:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"×”×›× ×¡ ×©× ×ª×–××•×¨×ª..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª×™××•×¨"}),e.jsx("textarea",{value:M.description,onChange:m=>E({...M,description:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"×ª×™××•×¨ ×”×ª×–××•×¨×ª...",rows:3})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:U,disabled:!M.name.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors disabled:bg-gray-300",children:"×¦×•×¨ ×ª×–××•×¨×ª"}),e.jsx("button",{onClick:()=>{b(!1),E({name:"",description:""})},className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"×‘×˜×œ"})]})]})]})}),A&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"×¦×•×¨ ×× ×¡××‘×œ ×—×“×©"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©× ×”×× ×¡××‘×œ"}),e.jsx("input",{type:"text",value:C.name,onChange:m=>L({...C,name:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"×”×›× ×¡ ×©× ×× ×¡××‘×œ..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×¡×•×’ ×”×× ×¡××‘×œ"}),e.jsxs("select",{value:C.type,onChange:m=>L({...C,type:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×¡×•×’..."}),e.jsx("option",{value:"×§×œ××¡×™",children:"×§×œ××¡×™"}),e.jsx("option",{value:"×’'××–",children:"×’'××–"}),e.jsx("option",{value:"×›×œ×™ × ×©×™×¤×”",children:"×›×œ×™ × ×©×™×¤×”"}),e.jsx("option",{value:"×›×œ×™ ××™×ª×¨",children:"×›×œ×™ ××™×ª×¨"}),e.jsx("option",{value:"××¢×•×¨×‘",children:"××¢×•×¨×‘"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª×™××•×¨"}),e.jsx("textarea",{value:C.description,onChange:m=>L({...C,description:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"×ª×™××•×¨ ×”×× ×¡××‘×œ...",rows:3})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:k,disabled:!C.name.trim(),className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-300",children:"×¦×•×¨ ×× ×¡××‘×œ"}),e.jsx("button",{onClick:()=>{T(!1),L({name:"",description:"",type:""})},className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"×‘×˜×œ"})]})]})]})})]})},Ls=({activeTab:o,teacherId:r,teacher:t,isLoading:a})=>{if(a||!t)return e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse w-1/3"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-2/3"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-1/2"})]})]});switch(o){case"personal":return e.jsx(ze,{teacher:t,teacherId:r});case"students":return e.jsx(Ve,{teacher:t,teacherId:r});case"schedule":return e.jsx(Ms,{teacher:t,teacherId:r});case"conducting":return e.jsx($s,{teacher:t,teacherId:r});default:return e.jsx("div",{className:"p-6 text-center text-gray-500",children:e.jsx("p",{children:"×ª×•×›×Ÿ ×”×›×¨×˜×™×¡×™×™×” ×œ× × ××¦×"})})}},Hs=()=>{const{teacherId:o}=Ce(),r=De(),[t,a]=g.useState("personal"),[n,x]=g.useState(null),[u,N]=g.useState(!0),[p,b]=g.useState(null);if(!o||o.trim()==="")return e.jsx(ke,{to:"/teachers",replace:!0});const A=g.useCallback(async()=>{if(o)try{N(!0),b(null),console.log("ğŸ”„ Fetching teacher data for ID:",o);const T=await R.teachers.getTeacherById(o);console.log("âœ… Teacher data loaded:",T?.personalInfo?.fullName),x(T)}catch(T){console.error("âŒ Error fetching teacher:",T),b({code:T.status===404?"NOT_FOUND":T.status===401?"UNAUTHORIZED":T.status===403?"FORBIDDEN":"SERVER_ERROR",message:T.message||"×©×’×™××” ×‘×˜×¢×™× ×ª × ×ª×•× ×™ ×”××•×¨×”"})}finally{N(!1)}},[o]);return g.useEffect(()=>{A()},[A]),p?.code==="NOT_FOUND"?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-96 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ğŸ”"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"××•×¨×” ×œ× × ××¦×"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"×”××•×¨×” ×©×‘×™×§×©×ª ×œ× × ××¦× ×‘××¢×¨×›×ª ××• ×©××™×Ÿ ×œ×š ×”×¨×©××” ×œ×¦×¤×•×ª ×‘×•"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>r("/teachers"),className:"flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(de,{className:"w-4 h-4 ml-2"}),"×—×–×•×¨ ×œ×¨×©×™××ª ××•×¨×™×"]}),e.jsxs("button",{onClick:()=>window.location.reload(),className:"flex items-center px-4 py-2 border border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(pe,{className:"w-4 h-4 ml-2"}),"× ×¡×” ×©×•×‘"]})]})]}):p?.code==="UNAUTHORIZED"||p?.code==="FORBIDDEN"?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-96 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ğŸ”’"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"××™×Ÿ ×”×¨×©××”"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"××™×Ÿ ×œ×š ×”×¨×©××” ×œ×¦×¤×•×ª ×‘×¤×¨×˜×™ ××•×¨×” ×–×”"}),e.jsxs("button",{onClick:()=>r("/teachers"),className:"flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(de,{className:"w-4 h-4 ml-2"}),"×—×–×•×¨ ×œ×¨×©×™××ª ××•×¨×™×"]})]}):p&&!["NOT_FOUND","UNAUTHORIZED","FORBIDDEN"].includes(p.code)?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-96 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"âš ï¸"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"×©×’×™××” ×‘×˜×¢×™× ×ª ×”× ×ª×•× ×™×"}),e.jsx("p",{className:"text-gray-600 mb-6",children:p.message}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>window.location.reload(),className:"flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(pe,{className:"w-4 h-4 ml-2"}),"× ×¡×” ×©×•×‘"]}),e.jsxs("button",{onClick:()=>r("/teachers"),className:"flex items-center px-4 py-2 border border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(de,{className:"w-4 h-4 ml-2"}),"×—×–×•×¨ ×œ×¨×©×™××ª ××•×¨×™×"]})]})]}):u?e.jsx("div",{className:"space-y-6 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:"×˜×•×¢×Ÿ ×¤×¨×˜×™ ××•×¨×”..."})]})}):e.jsxs("div",{className:"space-y-6 bg-white min-h-screen teacher-details-container teacher-content-area",children:[e.jsxs("nav",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("button",{onClick:()=>r("/teachers"),className:"hover:text-primary-600 transition-colors",children:"××•×¨×™×"}),e.jsx("span",{children:">"}),e.jsx("span",{className:"text-gray-900",children:n?.personalInfo?.fullName||"×¤×¨×˜×™ ××•×¨×”"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xl text-primary-600",children:"ğŸ‘¨â€ğŸ«"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n?.personalInfo?.fullName||"×˜×•×¢×Ÿ..."}),e.jsxs("p",{className:"text-gray-600",children:[n?.professionalInfo?.instrument||"×œ×œ× ×›×œ×™"," | ",n?.roles?.join(", ")||"××•×¨×”"]})]}),n?.conducting?.orchestraIds?.length>0&&e.jsx("div",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:"×× ×¦×—"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 w-full overflow-hidden",children:[e.jsx(Be,{activeTab:t,onTabChange:a,tabs:[{id:"personal",label:"××™×“×¢ ××™×©×™",component:()=>null},{id:"students",label:"× ×™×”×•×œ ×ª×œ××™×“×™×",component:()=>null},{id:"schedule",label:"×œ×•×— ×–×× ×™×",component:()=>null},...n?.conducting?.orchestraIds?.length>0||n?.conducting?.ensemblesIds?.length>0||n?.roles?.includes("×× ×¦×—")?[{id:"conducting",label:"× ×™×¦×•×—",component:()=>null}]:[]]}),e.jsx(Ls,{activeTab:t,teacherId:o,teacher:n,isLoading:u})]})]})};export{Hs as default};
