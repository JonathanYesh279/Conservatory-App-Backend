import{j as e,V as Te,z as pe}from"../assets/index-C1bRj8tq.js";import{r as x,c as Ae,b as Me,N as Le}from"./vendor-B2j9q2e_.js";import{U as ae,g as Z,c as se,M as ge,d as _e,a as Se,O as re,S as Ee,X as me,Z as $e,a3 as Oe,f as te,o as Ce,P as ce,m as Pe,b as Fe,B as De,T as de,e as ee,D as Re,ac as We,a9 as xe,ap as fe}from"./ui-SByQEkWx.js";import{t as He}from"./teacherDetailsApi-BGs4ypj_.js";import{a as F,h as V}from"./cascade-deletion-DAN0Gkem.js";import{b as he,a as ie,d as Ue,e as oe,s as qe,g as ze,h as Be,f as J,i as Ve,j as be,k as ye,l as Ye}from"./utils-x1PSU_OZ.js";import"./query-BI61muSV.js";const je={personal:{label:"××™×“×¢ ××™×©×™",icon:ae},students:{label:"× ×™×”×•×œ ×ª×œ××™×“×™×",icon:Z},schedule:{label:"×œ×•×— ×–×× ×™×",icon:se},conducting:{label:"× ×™×¦×•×—",icon:ge}},Xe=({activeTab:i,onTabChange:s,tabs:a=[]})=>!a||a.length===0?null:e.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 shadow-sm w-full overflow-hidden teacher-tab-navigation",children:[e.jsx("div",{className:"hidden md:flex w-full overflow-x-auto desktop-tab-nav",children:e.jsx("nav",{className:"flex gap-8 px-6 relative min-w-full","aria-label":"Tabs",children:a.map((r,t)=>{const g=je[r.id],u=g?.icon||ae,T=i===r.id;return e.jsxs("button",{onClick:()=>s(r.id),className:`
                  group inline-flex items-center gap-3 py-4 px-2 border-b-2 font-medium text-sm transition-all duration-300 relative tab-button
                  ${T?"border-primary-500 text-primary-600 bg-primary-50/50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 hover:bg-gray-50/50"}
                `,"aria-current":T?"page":void 0,style:{minHeight:"44px"},children:[e.jsx(u,{className:`w-5 h-5 transition-all duration-300 ${T?"text-primary-500 scale-110":"text-gray-400 group-hover:text-gray-500 group-hover:scale-105"}`}),e.jsx("span",{className:"whitespace-nowrap",children:g?.label||r.label}),T&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-primary-400 to-primary-600 rounded-full animate-scale-in"})]},r.id)})})}),e.jsxs("div",{className:"md:hidden w-full overflow-hidden mobile-tab-nav",children:[e.jsx("div",{className:"overflow-x-auto scrollbar-hide w-full",children:e.jsx("nav",{className:"flex gap-3 px-4 py-3 min-w-max","aria-label":"Tabs",style:{width:"max-content"},children:a.map((r,t)=>{const g=je[r.id],u=g?.icon||ae,T=i===r.id;return e.jsxs("button",{onClick:()=>s(r.id),className:`
                    flex flex-col items-center gap-1 px-4 py-3 rounded-xl font-medium text-xs transition-all duration-300 whitespace-nowrap transform tab-button
                    ${T?"bg-primary-100 text-primary-700 border-2 border-primary-200 scale-105 shadow-md":"text-gray-600 hover:text-gray-900 hover:bg-gray-50 hover:scale-102 border-2 border-transparent"}
                  `,"aria-current":T?"page":void 0,style:{minWidth:"80px",minHeight:"44px"},children:[e.jsx(u,{className:`w-5 h-5 transition-all duration-300 ${T?"text-primary-600":"text-gray-500"}`}),e.jsx("span",{className:"leading-tight",children:g?.label||r.label})]},r.id)})})}),e.jsx("div",{className:"flex justify-center py-1",children:e.jsx("div",{className:"w-8 h-1 bg-gray-200 rounded-full",children:e.jsx("div",{className:"h-full bg-primary-400 rounded-full transition-all duration-300",style:{width:`${a?.length>0?(a.findIndex(r=>r.id===i)+1)/a.length*100:0}%`}})})})]})]}),Ke=({teacher:i,teacherId:s})=>{const[a,r]=x.useState(!1),[t,g]=x.useState(!1),[u,T]=x.useState(null),[N,f]=x.useState(!1),[S,E]=x.useState({fullName:i.personalInfo?.fullName||"",phone:i.personalInfo?.phone||"",email:i.personalInfo?.email||"",address:i.personalInfo?.address||""}),_=async()=>{try{g(!0),T(null),f(!1),await He.updateTeacherPersonalInfo(s,S),i.personalInfo.fullName=S.fullName,i.personalInfo.phone=S.phone,i.personalInfo.email=S.email,i.personalInfo.address=S.address,f(!0),r(!1),setTimeout(()=>f(!1),3e3)}catch(w){console.error("Error saving teacher personal info:",w),T(w.message||"×©×’×™××” ×‘×©××™×¨×ª ×”× ×ª×•× ×™×")}finally{g(!1)}},D=()=>{E({fullName:i.personalInfo?.fullName||"",phone:i.personalInfo?.phone||"",email:i.personalInfo?.email||"",address:i.personalInfo?.address||""}),T(null),r(!1)};return e.jsxs("div",{className:"p-6 space-y-6",children:[N&&e.jsxs("div",{className:"flex items-center gap-2 p-4 bg-green-50 border border-green-200 rounded-lg text-green-800",children:[e.jsx(_e,{className:"w-5 h-5"}),e.jsx("span",{children:"×”× ×ª×•× ×™× × ×©××¨×• ×‘×”×¦×œ×—×”!"})]}),u&&e.jsxs("div",{className:"flex items-center gap-2 p-4 bg-red-50 border border-red-200 rounded-lg text-red-800",children:[e.jsx(Se,{className:"w-5 h-5"}),e.jsx("span",{children:u})]}),e.jsx("div",{className:"flex justify-end",children:a?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:_,disabled:t,className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"×©×•××¨..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"w-4 h-4"}),"×©××•×¨"]})}),e.jsxs("button",{onClick:D,disabled:t,className:"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(me,{className:"w-4 h-4"}),"×‘×˜×œ"]})]}):e.jsxs("button",{onClick:()=>r(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(re,{className:"w-4 h-4"}),"×¢×¨×•×š"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-700 border-b pb-2",children:"×¤×¨×˜×™× ×‘×¡×™×¡×™×™×"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(ae,{className:"w-4 h-4"}),"×©× ××œ×"]}),a?e.jsx("input",{type:"text",value:S.fullName,onChange:w=>E({...S,fullName:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"×”×›× ×¡ ×©× ××œ×"}):e.jsx("p",{className:"text-gray-900",children:i.personalInfo?.fullName||"×œ× ×¦×•×™×Ÿ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx($e,{className:"w-4 h-4"}),"×˜×œ×¤×•×Ÿ"]}),a?e.jsx("input",{type:"tel",value:S.phone,onChange:w=>E({...S,phone:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"×”×›× ×¡ ××¡×¤×¨ ×˜×œ×¤×•×Ÿ"}):e.jsx("p",{className:"text-gray-900",children:i.personalInfo?.phone||"×œ× ×¦×•×™×Ÿ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(Oe,{className:"w-4 h-4"}),'×“×•×"×œ']}),a?e.jsx("input",{type:"email",value:S.email,onChange:w=>E({...S,email:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"×”×›× ×¡ ×›×ª×•×‘×ª ×“×•××´×œ"}):e.jsx("p",{className:"text-gray-900",children:i.personalInfo?.email||"×œ× ×¦×•×™×Ÿ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(te,{className:"w-4 h-4"}),"×›×ª×•×‘×ª"]}),a?e.jsx("textarea",{value:S.address,onChange:w=>E({...S,address:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"×”×›× ×¡ ×›×ª×•×‘×ª ××’×•×¨×™×",rows:2}):e.jsx("p",{className:"text-gray-900",children:i.personalInfo?.address||"×œ× ×¦×•×™×Ÿ"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-700 border-b pb-2",children:"××™×“×¢ ××§×¦×•×¢×™"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(Ce,{className:"w-4 h-4"}),"×›×œ×™ × ×’×™× ×”"]}),e.jsx("p",{className:"text-gray-900",children:i.professionalInfo?.instrument||"×œ× ×¦×•×™×Ÿ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"×ª×¤×§×™×“×™×"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:i.roles?.map((w,$)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:w},$))||e.jsx("span",{className:"text-gray-500",children:"××™×Ÿ ×ª×¤×§×™×“×™×"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"×¡×˜×˜×•×¡"}),e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${i.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:i.isActive?"×¤×¢×™×œ":"×œ× ×¤×¢×™×œ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(se,{className:"w-4 h-4"}),"×ª××¨×™×š ×”×¦×˜×¨×¤×•×ª"]}),e.jsx("p",{className:"text-gray-900",children:i.createdAt?new Date(i.createdAt).toLocaleDateString("he-IL"):"×œ× ×™×“×•×¢"})]}),i.credentials?.lastLogin&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"×›× ×™×¡×” ××—×¨×•× ×”"}),e.jsx("p",{className:"text-gray-900",children:new Date(i.credentials.lastLogin).toLocaleDateString("he-IL")})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3",children:"×¡×™×›×•× ×ª×œ××™×“×™×"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-600",children:i.teaching?.studentIds?.length||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"×¡×š ×”×ª×œ××™×“×™×"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.teaching?.timeBlocks?.length||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"×‘×œ×•×§×™ ×–××Ÿ"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Math.round((i.teaching?.timeBlocks?.reduce((w,$)=>w+($.totalDuration||0),0)||0)/60)}),e.jsx("div",{className:"text-sm text-gray-600",children:"×©×¢×•×ª ×©×‘×•×¢×™×•×ª"})]})]})]})]})},Qe=({teacher:i,teacherId:s})=>{const[a,r]=x.useState([]),[t,g]=x.useState({}),[u,T]=x.useState([]),[N,f]=x.useState(!0),[S,E]=x.useState(!1),[_,D]=x.useState(""),[w,$]=x.useState(""),[R,h]=x.useState(!1),[k,O]=x.useState(-1),[X,c]=x.useState(!1),[v,I]=x.useState(null),[z,B]=x.useState({day:"",startTime:"",duration:30}),G=x.useRef(null),o=x.useRef(null),d=n=>{try{return n.teacherAssignments?.some(Y=>Y.teacherId===s&&Y.isActive===!0)||!1}catch(y){return console.error(`Error checking lessons for student ${n._id}:`,y),!1}};x.useEffect(()=>{(async()=>{try{if(f(!0),i.teaching?.studentIds?.length>0){const Y=i.teaching.studentIds.map(q=>F.students.getStudentById(q)),j=await Promise.all(Y);r(j);const p={};j.forEach(q=>{const K=d(q);p[q._id]=K}),g(p)}const y=await F.students.getStudents();T(y)}catch(y){console.error("Error fetching students:",y)}finally{f(!1)}})()},[i.teaching?.studentIds,s]);const A=n=>{D(n._id),$(n.personalInfo?.fullName||""),h(!1),O(-1)},M=n=>{$(n),D(""),h(!0),O(-1)},P=()=>{$(""),D(""),h(!1),O(-1),o.current?.focus()},m=n=>{if(!R&&(n.key==="ArrowDown"||n.key==="Enter")){h(!0);return}switch(n.key){case"ArrowDown":n.preventDefault(),O(y=>y<W.length-1?y+1:0);break;case"ArrowUp":n.preventDefault(),O(y=>y>0?y-1:W.length-1);break;case"Enter":n.preventDefault(),k>=0&&W[k]&&A(W[k]);break;case"Escape":h(!1),O(-1),o.current?.blur();break}},l=async()=>{if(_)try{await F.teachers.addStudentToTeacher(s,_);const n=await F.students.getStudentById(_);r(y=>[...y,n]),E(!1),D(""),$("")}catch(n){console.error("Error adding student:",n)}},b=async n=>{const Y=a.find(p=>p._id===n)?.personalInfo?.fullName||"×”×ª×œ××™×“",j=i.personalInfo?.fullName||"×”××•×¨×”";if(confirm(`×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ×”×¡×™×¨ ××ª ${Y} ××¨×©×™××ª ×”×ª×œ××™×“×™× ×©×œ ${j}?

×¤×¢×•×œ×” ×–×• ×ª× ×ª×§ ××ª ×”×§×©×¨ ×‘×™×Ÿ ×”×ª×œ××™×“ ×œ××•×¨×” ××š ×œ× ×ª××—×§ ××ª ×¤×¨×˜×™ ×”×ª×œ××™×“ ××”××¢×¨×›×ª.`))try{await F.teachers.removeStudentFromTeacher(s,n),r(p=>p.filter(q=>q._id!==n))}catch(p){console.error("Error removing student:",p)}},C=n=>{I(n),c(!0),B({day:"",startTime:"",duration:30})},L=async()=>{if(!v||!z.day||!z.startTime){alert("×× × ××œ× ××ª ×›×œ ×”×©×“×•×ª ×”× ×“×¨×©×™×");return}try{console.log("ğŸ”„ Creating lesson for student:",v.personalInfo?.fullName);const n=(Q,H)=>{const[ne,le]=Q.split(":").map(Number),ue=ne*60+le+H,ke=Math.floor(ue/60),Ie=ue%60;return`${ke.toString().padStart(2,"0")}:${Ie.toString().padStart(2,"0")}`},y=await F.students.getStudentById(v._id);console.log("ğŸ“‹ Current student data loaded:",y.personalInfo?.fullName);const Y=y.academicInfo?.instrumentProgress?.find(Q=>Q.isPrimary)?.instrumentName||"×›×œ×™ × ×’×™× ×”",j={teacherId:s,day:z.day,time:z.startTime,duration:z.duration,location:"",isActive:!0},p=[...y.teacherAssignments||[],j];console.log("ğŸ“¤ Adding new teacher assignment:",j),console.log("ğŸ“ All assignments to be saved:",p);const q={teacherAssignments:p};console.log("ğŸ“¤ Sending update data:",q);const K=await F.students.updateStudent(v._id,q);console.log("âœ… Student updated with new lesson assignment"),g(Q=>({...Q,[v._id]:!0})),c(!1),I(null),B({day:"",startTime:"",duration:30})}catch(n){console.error("âŒ Failed to schedule lesson:",n);let y="×©×’×™××” ×‘×§×‘×™×¢×ª ×”×©×™×¢×•×¨. ×× × × ×¡×” ×©×•×‘.";n.message.includes("Authentication failed")?y="×¤×’ ×ª×•×§×£ ×”×¤× ×™×™×”. ×× × ×”×ª×—×‘×¨ ××—×“×©.":n.message.includes("validation")?y="×©×’×™××” ×‘× ×ª×•× ×™× ×©×”×•×–× ×•. ×× × ×‘×“×•×§ ××ª ×¤×¨×˜×™ ×”×©×™×¢×•×¨.":n.message.includes("not found")?y="×”×ª×œ××™×“ ×œ× × ××¦× ×‘××¢×¨×›×ª.":n.message.includes("Network")?y="×©×’×™××ª ×¨×©×ª. ×× × ×‘×“×•×§ ××ª ×”×—×™×‘×•×¨ ×œ××™× ×˜×¨× ×˜.":n.message.includes("×©×’×™××” ×‘×©××™×¨×ª ×”× ×ª×•× ×™×")&&(y="×©×’×™××” ×‘×©××™×¨×ª ×”× ×ª×•× ×™× ×‘××¡×“ ×”× ×ª×•× ×™×. ×× × × ×¡×” ×©×•×‘."),alert(y),console.error("Error details:",{message:n.message,stack:n.stack,studentId:v._id,teacherId:s,lessonData:z})}},W=u.filter(n=>!i.teaching?.studentIds?.includes(n._id)).filter(n=>{const y=n.personalInfo?.fullName||"",Y=n.academicInfo?.class||"",j=w.toLowerCase();return y.toLowerCase().includes(j)||Y.toLowerCase().includes(j)});return x.useEffect(()=>{const n=y=>{G.current&&!G.current.contains(y.target)&&(h(!1),O(-1))};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),x.useEffect(()=>{S||($(""),D(""),h(!1),O(-1))},[S]),N?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse w-1/3"}),e.jsx("div",{className:"space-y-3",children:[1,2,3].map(n=>e.jsx("div",{className:"h-16 bg-gray-200 rounded animate-pulse"},n))})]}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>E(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-all shadow-sm font-medium",children:[e.jsx(ce,{className:"w-4 h-4"}),"×”×•×¡×£ ×ª×œ××™×“"]})}),S&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 teacher-modal-backdrop",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-md transform transition-all teacher-modal-container",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6 text-center",children:"×”×•×¡×£ ×ª×œ××™×“ ×—×“×©"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 teacher-modal-label",children:"×—×¤×© ×•×‘×—×¨ ×ª×œ××™×“"}),e.jsx("div",{className:"text-xs text-gray-500",children:"â†‘â†“ ×œ× ×™×•×•×˜ â€¢ Enter ×œ×‘×—×™×¨×” â€¢ Esc ×œ×¡×’×™×¨×”"})]}),e.jsxs("div",{className:"relative",ref:G,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e.jsx(Pe,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{ref:o,type:"text",value:w,onChange:n=>M(n.target.value),onKeyDown:m,onFocus:()=>h(!0),placeholder:"×”×§×œ×“ ×©× ×ª×œ××™×“ ××• ×›×™×ª×”...",className:"w-full pr-10 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-gray-900 bg-white teacher-search-input",style:{paddingLeft:"2.5rem"}}),w?e.jsx("button",{onClick:P,className:"absolute inset-y-0 left-0 pl-3 flex items-center hover:bg-gray-50 rounded-r-lg",children:e.jsx(me,{className:"h-4 w-4 text-gray-400 hover:text-gray-600"})}):e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Fe,{className:`h-4 w-4 text-gray-400 transition-transform ${R?"rotate-180":""}`})})]}),R&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto teacher-search-dropdown teacher-dropdown-enter",children:W.length>0?e.jsx(e.Fragment,{children:W.map((n,y)=>e.jsx("button",{onClick:()=>A(n),className:`w-full text-right px-4 py-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0 teacher-search-option ${y===k?"bg-primary-50 text-primary-700 highlighted":"text-gray-900"} ${_===n._id?"bg-primary-100 text-primary-700 font-medium":""}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:n.personalInfo?.fullName}),e.jsxs("span",{className:"text-sm text-gray-500",children:["×›×™×ª×” ",n.academicInfo?.class||"×œ× ×¦×•×™×Ÿ"]})]})},n._id))}):e.jsx("div",{className:"px-4 py-3 text-gray-500 text-center",children:w?"×œ× × ××¦××• ×ª×œ××™×“×™×":"××™×Ÿ ×ª×œ××™×“×™× ×–××™× ×™×"})})]})]}),e.jsxs("div",{className:"flex gap-3 teacher-modal-buttons",children:[e.jsx("button",{onClick:l,disabled:!_,className:"flex-1 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-all disabled:bg-gray-400 disabled:cursor-not-allowed shadow-sm font-medium teacher-modal-button",children:"×”×•×¡×£"}),e.jsx("button",{onClick:()=>{E(!1),D("")},className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all shadow-sm font-medium teacher-modal-button",children:"×‘×˜×œ"})]})]})]})}),X&&v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-md transform transition-all",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6 text-center",children:"×§×‘×™×¢×ª ×©×™×¢×•×¨ ×©×‘×•×¢×™"}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"×¤×¨×˜×™ ×”×ª×œ××™×“"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"×©×:"})," ",v.personalInfo?.fullName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"×›×™×ª×”:"})," ",v.academicInfo?.class||"×œ× ×¦×•×™×Ÿ"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"×›×œ×™ × ×’×™× ×”:"})," ",v.primaryInstrument||"×œ× ×¦×•×™×Ÿ"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×™×•× ×”×©×‘×•×¢"}),e.jsxs("select",{value:z.day,onChange:n=>B(y=>({...y,day:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×™×•×"}),e.jsx("option",{value:"×¨××©×•×Ÿ",children:"×¨××©×•×Ÿ"}),e.jsx("option",{value:"×©× ×™",children:"×©× ×™"}),e.jsx("option",{value:"×©×œ×™×©×™",children:"×©×œ×™×©×™"}),e.jsx("option",{value:"×¨×‘×™×¢×™",children:"×¨×‘×™×¢×™"}),e.jsx("option",{value:"×—××™×©×™",children:"×—××™×©×™"}),e.jsx("option",{value:"×©×™×©×™",children:"×©×™×©×™"}),e.jsx("option",{value:"×©×‘×ª",children:"×©×‘×ª"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×–××Ÿ ×”×ª×—×œ×”"}),e.jsx("input",{type:"time",value:z.startTime,onChange:n=>B(y=>({...y,startTime:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"××©×š (×“×§×•×ª)"}),e.jsxs("select",{value:z.duration,onChange:n=>B(y=>({...y,duration:Number(n.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:30,children:"30 ×“×§×•×ª"}),e.jsx("option",{value:45,children:"45 ×“×§×•×ª"}),e.jsx("option",{value:60,children:"60 ×“×§×•×ª"}),e.jsx("option",{value:90,children:"90 ×“×§×•×ª"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[e.jsx("button",{onClick:L,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:"×§×‘×¢ ×©×™×¢×•×¨"}),e.jsx("button",{onClick:()=>{c(!1),I(null),B({day:"",startTime:"",duration:30})},className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"×‘×™×˜×•×œ"})]})]})]})}),a.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"××™×Ÿ ×ª×œ××™×“×™× ××©×•×™×›×™×"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"×¢×“×™×™×Ÿ ×œ× ×©×•×™×›×• ×ª×œ××™×“×™× ×œ××•×¨×” ×–×”"}),e.jsx("button",{onClick:()=>E(!0),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-all shadow-sm font-medium",children:"×”×•×¡×£ ×ª×œ××™×“ ×¨××©×•×Ÿ"})]}):e.jsx("div",{className:"grid gap-4",children:a.map(n=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(ae,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:n.personalInfo?.fullName||"×œ×œ× ×©×"}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["×›×™×ª×” ",n.academicInfo?.class||"×œ× ×¦×•×™×Ÿ"]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:n.primaryInstrument||"×œ×œ× ×›×œ×™"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!t[n._id]&&e.jsxs("button",{onClick:()=>C(n),className:"px-3 py-1 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 focus:ring-2 focus:ring-green-500 focus:ring-offset-1 transition-all shadow-sm font-medium flex items-center gap-1",children:[e.jsx(De,{className:"w-4 h-4"}),"×§×‘×¢ ×©×™×¢×•×¨"]}),e.jsx("button",{onClick:()=>window.location.href=`/students/${n._id}`,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 transition-all shadow-sm font-medium",children:"×¦×¤×” ×‘×¤×¨×˜×™×"}),e.jsxs("button",{onClick:()=>b(n._id),className:"px-3 py-1 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 focus:ring-2 focus:ring-red-500 focus:ring-offset-1 transition-all shadow-sm font-medium flex items-center gap-1",children:[e.jsx(de,{className:"w-4 h-4"}),"×”×¡×¨"]})]})]})},n._id))}),a.length>0&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"×¡×§×™×¨×ª ×œ×•×— ×–×× ×™×"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.timeBlocks?.map((n,y)=>e.jsxs("div",{className:"bg-white rounded-lg p-4 border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:n.day}),e.jsxs("span",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.jsx(ee,{className:"w-4 h-4"}),Math.round(n.totalDuration/60)," ×©×¢×•×ª"]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[n.startTime," - ",n.endTime]}),n.location&&e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["ğŸ“ ",n.location]}),e.jsxs("div",{className:"text-xs text-blue-600 mt-2",children:[n.assignedLessons?.length||0," ×©×™×¢×•×¨×™× ××ª×•×›× × ×™×"]})]},n._id||y))}),(!i.timeBlocks||i.timeBlocks.length===0)&&e.jsx("div",{className:"text-center text-gray-500 py-4",children:"××™×Ÿ ×‘×œ×•×§×™ ×–××Ÿ ××•×’×“×¨×™× ×¢×“×™×™×Ÿ"})]})]})};var Ge={lessThanXSeconds:{one:"×¤×—×•×ª ××©× ×™×™×”",two:"×¤×—×•×ª ××©×ª×™ ×©× ×™×•×ª",other:"×¤×—×•×ª ×Ö¾{{count}} ×©× ×™×•×ª"},xSeconds:{one:"×©× ×™×™×”",two:"×©×ª×™ ×©× ×™×•×ª",other:"{{count}} ×©× ×™×•×ª"},halfAMinute:"×—×¦×™ ×“×§×”",lessThanXMinutes:{one:"×¤×—×•×ª ××“×§×”",two:"×¤×—×•×ª ××©×ª×™ ×“×§×•×ª",other:"×¤×—×•×ª ×Ö¾{{count}} ×“×§×•×ª"},xMinutes:{one:"×“×§×”",two:"×©×ª×™ ×“×§×•×ª",other:"{{count}} ×“×§×•×ª"},aboutXHours:{one:"×›×©×¢×”",two:"×›×©×¢×ª×™×™×",other:"×›Ö¾{{count}} ×©×¢×•×ª"},xHours:{one:"×©×¢×”",two:"×©×¢×ª×™×™×",other:"{{count}} ×©×¢×•×ª"},xDays:{one:"×™×•×",two:"×™×•××™×™×",other:"{{count}} ×™××™×"},aboutXWeeks:{one:"×›×©×‘×•×¢",two:"×›×©×‘×•×¢×™×™×",other:"×›Ö¾{{count}} ×©×‘×•×¢×•×ª"},xWeeks:{one:"×©×‘×•×¢",two:"×©×‘×•×¢×™×™×",other:"{{count}} ×©×‘×•×¢×•×ª"},aboutXMonths:{one:"×›×—×•×“×©",two:"×›×—×•×“×©×™×™×",other:"×›Ö¾{{count}} ×—×•×“×©×™×"},xMonths:{one:"×—×•×“×©",two:"×—×•×“×©×™×™×",other:"{{count}} ×—×•×“×©×™×"},aboutXYears:{one:"×›×©× ×”",two:"×›×©× ×ª×™×™×",other:"×›Ö¾{{count}} ×©× ×™×"},xYears:{one:"×©× ×”",two:"×©× ×ª×™×™×",other:"{{count}} ×©× ×™×"},overXYears:{one:"×™×•×ª×¨ ××©× ×”",two:"×™×•×ª×¨ ××©× ×ª×™×™×",other:"×™×•×ª×¨ ×Ö¾{{count}} ×©× ×™×"},almostXYears:{one:"×›××¢×˜ ×©× ×”",two:"×›××¢×˜ ×©× ×ª×™×™×",other:"×›××¢×˜ {{count}} ×©× ×™×"}},Je=function(s,a,r){if(s==="xDays"&&r!==null&&r!==void 0&&r.addSuffix&&a<=2)return r.comparison&&r.comparison>0?a===1?"××—×¨":"××—×¨×ª×™×™×":a===1?"××ª××•×œ":"×©×œ×©×•×";var t,g=Ge[s];return typeof g=="string"?t=g:a===1?t=g.one:a===2?t=g.two:t=g.other.replace("{{count}}",String(a)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"×‘×¢×•×“ "+t:"×œ×¤× ×™ "+t:t},Ze={full:"EEEE, d ×‘MMMM y",long:"d ×‘MMMM y",medium:"d ×‘MMM y",short:"d.M.y"},es={full:"H:mm:ss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},ss={full:"{{date}} '×‘×©×¢×”' {{time}}",long:"{{date}} '×‘×©×¢×”' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ts={date:he({formats:Ze,defaultWidth:"full"}),time:he({formats:es,defaultWidth:"full"}),dateTime:he({formats:ss,defaultWidth:"full"})},as={lastWeek:"eeee '×©×¢×‘×¨ ×‘×©×¢×”' p",yesterday:"'××ª××•×œ ×‘×©×¢×”' p",today:"'×”×™×•× ×‘×©×¢×”' p",tomorrow:"'××—×¨ ×‘×©×¢×”' p",nextWeek:"eeee '×‘×©×¢×”' p",other:"P"},rs=function(s,a,r,t){return as[s]},ns={narrow:["×œ×¤× ×”×´×¡","×œ×¡×¤×™×¨×”"],abbreviated:["×œ×¤× ×”×´×¡","×œ×¡×¤×™×¨×”"],wide:["×œ×¤× ×™ ×”×¡×¤×™×¨×”","×œ×¡×¤×™×¨×”"]},ls={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["×¨×‘×¢×•×Ÿ 1","×¨×‘×¢×•×Ÿ 2","×¨×‘×¢×•×Ÿ 3","×¨×‘×¢×•×Ÿ 4"]},is={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["×™× ×•×³","×¤×‘×¨×³","××¨×¥","××¤×¨×³","×××™","×™×•× ×™","×™×•×œ×™","××•×’×³","×¡×¤×˜×³","××•×§×³","× ×•×‘×³","×“×¦××³"],wide:["×™× ×•××¨","×¤×‘×¨×•××¨","××¨×¥","××¤×¨×™×œ","×××™","×™×•× ×™","×™×•×œ×™","××•×’×•×¡×˜","×¡×¤×˜××‘×¨","××•×§×˜×•×‘×¨","× ×•×‘××‘×¨","×“×¦××‘×¨"]},os={narrow:["××³","×‘×³","×’×³","×“×³","×”×³","×•×³","×©×³"],short:["××³","×‘×³","×’×³","×“×³","×”×³","×•×³","×©×³"],abbreviated:["×™×•× ××³","×™×•× ×‘×³","×™×•× ×’×³","×™×•× ×“×³","×™×•× ×”×³","×™×•× ×•×³","×©×‘×ª"],wide:["×™×•× ×¨××©×•×Ÿ","×™×•× ×©× ×™","×™×•× ×©×œ×™×©×™","×™×•× ×¨×‘×™×¢×™","×™×•× ×—××™×©×™","×™×•× ×©×™×©×™","×™×•× ×©×‘×ª"]},cs={narrow:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×•×§×¨",afternoon:"××—×¨ ×”×¦×”×¨×™×™×",evening:"×¢×¨×‘",night:"×œ×™×œ×”"},abbreviated:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×•×§×¨",afternoon:"××—×¨ ×”×¦×”×¨×™×™×",evening:"×¢×¨×‘",night:"×œ×™×œ×”"},wide:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×•×§×¨",afternoon:"××—×¨ ×”×¦×”×¨×™×™×",evening:"×¢×¨×‘",night:"×œ×™×œ×”"}},ds={narrow:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×‘×•×§×¨",afternoon:"×‘×¦×”×¨×™×™×",evening:"×‘×¢×¨×‘",night:"×‘×œ×™×œ×”"},abbreviated:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×‘×•×§×¨",afternoon:"××—×¨ ×”×¦×”×¨×™×™×",evening:"×‘×¢×¨×‘",night:"×‘×œ×™×œ×”"},wide:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×‘×•×§×¨",afternoon:"××—×¨ ×”×¦×”×¨×™×™×",evening:"×‘×¢×¨×‘",night:"×‘×œ×™×œ×”"}},ms=function(s,a){var r=Number(s);if(r<=0||r>10)return String(r);var t=String(a?.unit),g=["year","hour","minute","second"].indexOf(t)>=0,u=["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™","×©×‘×™×¢×™","×©××™× ×™","×ª×©×™×¢×™","×¢×©×™×¨×™"],T=["×¨××©×•× ×”","×©× ×™×™×”","×©×œ×™×©×™×ª","×¨×‘×™×¢×™×ª","×—××™×©×™×ª","×©×™×©×™×ª","×©×‘×™×¢×™×ª","×©××™× ×™×ª","×ª×©×™×¢×™×ª","×¢×©×™×¨×™×ª"],N=r-1;return g?T[N]:u[N]},us={ordinalNumber:ms,era:ie({values:ns,defaultWidth:"wide"}),quarter:ie({values:ls,defaultWidth:"wide",argumentCallback:function(s){return s-1}}),month:ie({values:is,defaultWidth:"wide"}),day:ie({values:os,defaultWidth:"wide"}),dayPeriod:ie({values:cs,defaultWidth:"wide",formattingValues:ds,defaultFormattingWidth:"wide"})},xs=/^(\d+|(×¨××©×•×Ÿ|×©× ×™|×©×œ×™×©×™|×¨×‘×™×¢×™|×—××™×©×™|×©×™×©×™|×©×‘×™×¢×™|×©××™× ×™|×ª×©×™×¢×™|×¢×©×™×¨×™|×¨××©×•× ×”|×©× ×™×™×”|×©×œ×™×©×™×ª|×¨×‘×™×¢×™×ª|×—××™×©×™×ª|×©×™×©×™×ª|×©×‘×™×¢×™×ª|×©××™× ×™×ª|×ª×©×™×¢×™×ª|×¢×©×™×¨×™×ª))/i,hs=/^(\d+|×¨×|×©× |×©×œ|×¨×‘|×—|×©×™|×©×‘|×©×|×ª|×¢)/i,gs={narrow:/^×œ(×¡×¤×™×¨×”|×¤× ×”×´×¡)/i,abbreviated:/^×œ(×¡×¤×™×¨×”|×¤× ×”×´×¡)/i,wide:/^×œ(×¤× ×™ ×”)?×¡×¤×™×¨×”/i},ps={any:[/^×œ×¤/i,/^×œ×¡/i]},fs={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^×¨×‘×¢×•×Ÿ [1234]/i},bs={any:[/1/i,/2/i,/3/i,/4/i]},ys={narrow:/^\d+/i,abbreviated:/^(×™× ×•|×¤×‘×¨|××¨×¥|××¤×¨|×××™|×™×•× ×™|×™×•×œ×™|××•×’|×¡×¤×˜|××•×§|× ×•×‘|×“×¦×)×³?/i,wide:/^(×™× ×•××¨|×¤×‘×¨×•××¨|××¨×¥|××¤×¨×™×œ|×××™|×™×•× ×™|×™×•×œ×™|××•×’×•×¡×˜|×¡×¤×˜××‘×¨|××•×§×˜×•×‘×¨|× ×•×‘××‘×¨|×“×¦××‘×¨)/i},js={narrow:[/^1$/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^7/i,/^8/i,/^9/i,/^10/i,/^11/i,/^12/i],any:[/^×™× /i,/^×¤/i,/^××¨/i,/^××¤/i,/^××/i,/^×™×•× /i,/^×™×•×œ/i,/^××•×’/i,/^×¡/i,/^××•×§/i,/^× /i,/^×“/i]},Ns={narrow:/^[××‘×’×“×”×•×©]×³/i,short:/^[××‘×’×“×”×•×©]×³/i,abbreviated:/^(×©×‘×ª|×™×•× (×|×‘|×’|×“|×”|×•)×³)/i,wide:/^×™×•× (×¨××©×•×Ÿ|×©× ×™|×©×œ×™×©×™|×¨×‘×™×¢×™|×—××™×©×™|×©×™×©×™|×©×‘×ª)/i},vs={abbreviated:[/××³$/i,/×‘×³$/i,/×’×³$/i,/×“×³$/i,/×”×³$/i,/×•×³$/i,/^×©/i],wide:[/×Ÿ$/i,/× ×™$/i,/×œ×™×©×™$/i,/×¢×™$/i,/××™×©×™$/i,/×©×™×©×™$/i,/×ª$/i],any:[/^×/i,/^×‘/i,/^×’/i,/^×“/i,/^×”/i,/^×•/i,/^×©/i]},ws={any:/^(××—×¨ ×”|×‘)?(×—×¦×•×ª|×¦×”×¨×™×™×|×‘×•×§×¨|×¢×¨×‘|×œ×™×œ×”|××—×”×´×¦|×œ×¤× ×”×´×¦)/i},Ts={any:{am:/^×œ×¤/i,pm:/^××—×”/i,midnight:/^×—/i,noon:/^×¦/i,morning:/×‘×•×§×¨/i,afternoon:/×‘×¦|××—×¨/i,evening:/×¢×¨×‘/i,night:/×œ×™×œ×”/i}},Ss=["×¨×","×©× ","×©×œ","×¨×‘","×—","×©×™","×©×‘","×©×","×ª","×¢"],Es={ordinalNumber:Ue({matchPattern:xs,parsePattern:hs,valueCallback:function(s){var a=parseInt(s,10);return isNaN(a)?Ss.indexOf(s)+1:a}}),era:oe({matchPatterns:gs,defaultMatchWidth:"wide",parsePatterns:ps,defaultParseWidth:"any"}),quarter:oe({matchPatterns:fs,defaultMatchWidth:"wide",parsePatterns:bs,defaultParseWidth:"any",valueCallback:function(s){return s+1}}),month:oe({matchPatterns:ys,defaultMatchWidth:"wide",parsePatterns:js,defaultParseWidth:"any"}),day:oe({matchPatterns:Ns,defaultMatchWidth:"wide",parsePatterns:vs,defaultParseWidth:"any"}),dayPeriod:oe({matchPatterns:ws,defaultMatchWidth:"any",parsePatterns:Ts,defaultParseWidth:"any"})},Ne={code:"he",formatDistance:Je,formatLong:ts,formatRelative:rs,localize:us,match:Es,options:{weekStartsOn:0,firstWeekContainsDate:1}};const Cs={×¨××©×•×Ÿ:0,×©× ×™:1,×©×œ×™×©×™:2,×¨×‘×™×¢×™:3,×—××™×©×™:4,×©×™×©×™:5,×©×‘×ª:6},ve=["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™","×©×‘×ª"],Ds=({teacher:i,timeBlocks:s=[],lessons:a=[],orchestraActivities:r=[],className:t="",showNavigation:g=!0,onLessonUpdate:u})=>{const[T,N]=x.useState(new Date),[f,S]=x.useState(null),[E,_]=x.useState(!1),D=x.useMemo(()=>qe(T,{weekStartsOn:0}),[T]),w=x.useMemo(()=>ze(T,{weekStartsOn:0}),[T]),$=x.useMemo(()=>Be({start:D,end:w}),[D,w]),R=o=>{const d=Cs[o];return d===void 0?null:ye(D,d)},h=x.useMemo(()=>{const o=[];return a.forEach((d,A)=>{const M=R(d.day);if(!M)return;const P=d.startTime||d.time||d.scheduleInfo?.startTime,m=d.duration||d.scheduleInfo?.duration||45,l=d.endTime||d.scheduleInfo?.endTime||G(P,m);if(!P){console.warn("Lesson missing time data:",d);return}o.push({id:`lesson-${d._id||A}`,date:M,startTime:P,endTime:l,title:d.lessonType==="group"?"×©×™×¢×•×¨ ×§×‘×•×¦×ª×™":"×©×™×¢×•×¨ ×¤×¨×˜×™",subtitle:d.studentName||"×ª×œ××™×“",studentName:d.studentName,instrumentName:d.instrumentName||d.instrument?.instrumentName,type:"lesson",location:d.location||d.scheduleInfo?.location,color:d.lessonType==="group"?"bg-green-100 border-green-300 text-green-800":"bg-blue-100 border-blue-300 text-blue-800",details:d})}),r.forEach(d=>{const A=R(d.day);if(A){if(!d.startTime||!d.endTime){console.warn("Orchestra activity missing time data:",d);return}o.push({id:`orchestra-${d._id}`,date:A,startTime:d.startTime,endTime:d.endTime,title:d.name,subtitle:d.type==="orchestra"?"×ª×–××•×¨×ª":"×× ×¡××‘×œ",type:d.type,location:d.location,participants:[`${d.participants||0} × ×’× ×™×`],color:d.type==="orchestra"?"bg-purple-100 border-purple-300 text-purple-800":"bg-green-100 border-green-300 text-green-800",details:d})}}),o.sort((d,A)=>{const M=d.date.getTime()-A.date.getTime();if(M!==0)return M;const P=d.startTime||"00:00",m=A.startTime||"00:00";return P.localeCompare(m)})},[s,a,r,i,D]),k=x.useMemo(()=>{const o={};return $.forEach(d=>{const A=J(d,"yyyy-MM-dd");o[A]=h.filter(M=>Ve(M.date,d))}),o},[h,$]),O=()=>N(o=>Ye(o,7)),X=()=>N(o=>ye(o,7)),c=()=>N(new Date),v=o=>{switch(o){case"lesson":return e.jsx(ae,{className:"w-4 h-4"});case"orchestra":return e.jsx(ge,{className:"w-4 h-4"});case"ensemble":return e.jsx(Z,{className:"w-4 h-4"});default:return e.jsx(De,{className:"w-4 h-4"})}},I=o=>{o.type==="lesson"&&o.details&&(console.log("ğŸ¯ Opening lesson for editing:",o.details),console.log("ğŸ†” Activity ID:",o.id),console.log("ğŸ“‹ Full activity object:",o),S(o.details))},z=async o=>{if(f){_(!0);try{u&&await u({...f,...o}),S(null)}catch(d){console.error("Error updating lesson:",d),alert("×©×’×™××” ×‘×¢×“×›×•×Ÿ ×”×©×™×¢×•×¨. ×× × × ×¡×” ×©×•×‘.")}finally{_(!1)}}},B=(o,d)=>{const[A,M]=o.split(":").map(Number),[P,m]=d.split(":").map(Number),l=A*60+M;return P*60+m-l},G=(o,d)=>{if(!o||!d)return o||"00:00";const[A,M]=o.split(":").map(Number),P=A*60+M+d,m=Math.floor(P/60),l=P%60;return`${m.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`};return e.jsxs("div",{className:`bg-white rounded-lg shadow-sm border border-gray-200 ${t}`,children:[g&&e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:O,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Re,{className:"w-5 h-5"})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["×œ×•×— ×–×× ×™× - ",J(D,"dd/MM",{locale:Ne})," - ",J(w,"dd/MM/yyyy",{locale:Ne})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[h.length," ×¤×¢×™×œ×•×™×•×ª ×”×©×‘×•×¢"]})]}),e.jsx("button",{onClick:X,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(We,{className:"w-5 h-5"})})]}),e.jsx("button",{onClick:c,className:"px-3 py-1 text-sm bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"×”×©×‘×•×¢ ×”× ×•×›×—×™"})]})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx("div",{className:"grid grid-cols-7 gap-3",children:$.map((o,d)=>{const A=J(o,"yyyy-MM-dd"),M=k[A]||[],P=be(o);return e.jsxs("div",{className:`border rounded-lg ${P?"border-primary-400 bg-primary-50/30":"border-gray-200 bg-white"}`,children:[e.jsxs("div",{className:`p-3 text-center border-b ${P?"bg-primary-100 text-primary-800 border-primary-200":M.length>0?"bg-blue-50 text-blue-700 border-blue-100":"bg-gray-50 text-gray-600 border-gray-200"}`,children:[e.jsx("div",{className:"font-semibold",children:ve[d]}),e.jsx("div",{className:"text-sm mt-1",children:J(o,"dd/MM")}),M.length>0&&e.jsxs("div",{className:"text-xs mt-1 opacity-75",children:[M.length," ×¤×¢×™×œ×•×™×•×ª"]})]}),e.jsx("div",{className:"p-2 space-y-2 min-h-[400px]",children:M.length===0?e.jsx("div",{className:"text-center text-sm text-gray-400 mt-8",children:"××™×Ÿ ×¤×¢×™×œ×•×™×•×ª"}):M.map(m=>e.jsxs("div",{className:`p-3 rounded-lg border-l-4 ${m.color} shadow-sm hover:shadow-md transition-shadow ${m.type==="lesson"?"cursor-pointer":"cursor-default"}`,onClick:()=>m.type==="lesson"&&I(m),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[v(m.type),e.jsx("span",{className:"font-semibold text-sm",children:m.title})]}),m.type==="lesson"&&e.jsx(re,{className:"w-4 h-4 text-gray-400 hover:text-blue-600 transition-colors"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs mb-1",children:[e.jsx(ee,{className:"w-3 h-3"}),e.jsxs("span",{className:"font-medium",children:[m.startTime," - ",m.endTime]})]}),m.subtitle&&e.jsxs("div",{className:"text-xs opacity-90 mb-1",children:[m.type==="lesson"&&m.studentName&&e.jsxs("div",{className:"font-medium",children:["×ª×œ××™×“: ",m.studentName]}),m.type!=="lesson"&&e.jsx("div",{children:m.subtitle})]}),m.type==="lesson"&&m.instrumentName&&e.jsxs("div",{className:"text-xs opacity-75 mb-1",children:["×›×œ×™: ",m.instrumentName]}),m.location&&e.jsxs("div",{className:"flex items-center gap-1 text-xs opacity-75",children:[e.jsx(te,{className:"w-3 h-3"}),e.jsx("span",{children:m.location})]}),m.participants&&e.jsxs("div",{className:"flex items-center gap-1 text-xs opacity-75 mt-1",children:[e.jsx(Z,{className:"w-3 h-3"}),e.jsx("span",{children:m.participants.join(", ")})]})]},m.id))})]},A)})})}),e.jsx("div",{className:"lg:hidden",children:e.jsx("div",{className:"space-y-4 pb-safe",children:$.map((o,d)=>{const A=J(o,"yyyy-MM-dd"),M=k[A]||[],P=be(o);return e.jsxs("div",{className:`border rounded-lg overflow-hidden ${P?"border-primary-400":"border-gray-200"}`,children:[e.jsx("div",{className:`p-3 font-semibold ${P?"bg-primary-100 text-primary-800":M.length>0?"bg-blue-50 text-blue-700":"bg-gray-50 text-gray-700"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{children:[ve[d]," - ",J(o,"dd/MM")]}),M.length>0&&e.jsxs("span",{className:"text-sm opacity-75",children:[M.length," ×¤×¢×™×œ×•×™×•×ª"]})]})}),e.jsx("div",{className:"p-3",children:M.length===0?e.jsx("div",{className:"text-center text-sm text-gray-400 py-4",children:"××™×Ÿ ×¤×¢×™×œ×•×™×•×ª"}):e.jsx("div",{className:"space-y-2",children:M.map(m=>e.jsxs("div",{className:`p-3 rounded-lg border-l-4 ${m.color} ${m.type==="lesson"?"cursor-pointer active:bg-opacity-80 touch-manipulation select-none":"cursor-default"} transition-all duration-200`,onClick:()=>m.type==="lesson"&&I(m),onTouchStart:l=>{m.type==="lesson"&&(l.currentTarget.style.transform="scale(0.98)")},onTouchEnd:l=>{m.type==="lesson"&&(l.currentTarget.style.transform="scale(1)")},children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[v(m.type),e.jsx("h4",{className:"font-semibold text-sm",children:m.title})]}),m.type==="lesson"&&e.jsx(re,{className:"w-4 h-4 text-gray-400 hover:text-blue-600 transition-colors"})]}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"w-3 h-3"}),e.jsxs("span",{className:"font-medium",children:[m.startTime," - ",m.endTime]})]}),m.type==="lesson"&&m.studentName&&e.jsxs("div",{className:"font-medium",children:["×ª×œ××™×“: ",m.studentName]}),m.instrumentName&&e.jsxs("div",{className:"opacity-75",children:["×›×œ×™: ",m.instrumentName]}),m.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(te,{className:"w-3 h-3"}),e.jsx("span",{children:m.location})]}),m.participants&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-3 h-3"}),e.jsx("span",{children:m.participants.join(", ")})]})]})]},m.id))})})]},A)})})}),h.length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"×¡×™×›×•× ×”×©×‘×•×¢"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:h.filter(o=>o.type==="lesson").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"×©×™×¢×•×¨×™×"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:h.filter(o=>o.type==="orchestra").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"×ª×–××•×¨×•×ª"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:h.filter(o=>o.type==="ensemble").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"×× ×¡××‘×œ×™×"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:$.filter(o=>{const d=J(o,"yyyy-MM-dd");return(k[d]||[]).length>0}).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"×™××™× ×¤×¢×™×œ×™×"})]})]})]}),s.length>0&&e.jsxs("div",{className:"mt-6 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(se,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"×™××™ ×œ×™××•×“ - ×–××™× ×•×ª ×œ××¢×¨×›×ª"}),e.jsxs("span",{className:"text-sm text-gray-600 bg-white px-2 py-1 rounded-full",children:[s.length," ×‘×œ×•×§×™ ×–××Ÿ"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(o=>e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200 shadow-sm hover:shadow-md transition-all duration-200",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-bold text-gray-900 text-lg",children:o.day}),o.isActive&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full font-medium",children:"×¤×¢×™×œ"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 mb-2",children:[e.jsx(ee,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"font-medium",children:[o.startTime," - ",o.endTime]})]}),o.location&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-2",children:[e.jsx(te,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:o.location})]}),o.notes&&e.jsx("div",{className:"text-xs text-gray-500 bg-gray-50 p-2 rounded-md mt-2",children:o.notes})]}),e.jsxs("div",{className:"text-center ml-3",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Math.floor(o.totalDuration/60)}),e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"×©×¢×•×ª"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:o.totalDuration%60!==0&&`+${o.totalDuration%60}×“'`})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:[o.assignedLessons?.length||0," ×©×™×¢×•×¨×™× ××ª×•×›× × ×™×"]}),e.jsx("span",{className:"text-blue-600 font-medium",children:"×–××™×Ÿ ×œ××¢×¨×›×ª"})]})})]},o._id))}),e.jsx("div",{className:"mt-4 p-3 bg-blue-100 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"×”×¡×‘×¨:"})," ×™××™ ×”×œ×™××•×“ ××¦×™×’×™× ××ª ×”×–×× ×™× ×‘×”× ×”××•×¨×” ×–××™×Ÿ ×œ×œ××“. ×¨×§ ×©×™×¢×•×¨×™× ×‘×¤×•×¢×œ ×¢× ×ª×œ××™×“×™× ×•×¤×¢×™×œ×•×™×•×ª ×”× ×™×¦×•×— ××•×¦×’×™× ×‘×œ×•×— ×”×–×× ×™× ×œ××¢×œ×”."]})})]})]}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"×¢×¨×™×›×ª ×©×™×¢×•×¨ ×¤×¨×˜×™"}),e.jsx("button",{onClick:()=>S(null),className:"text-gray-400 hover:text-gray-600 p-1",children:e.jsx(me,{className:"w-6 h-6"})})]}),e.jsxs("form",{className:"space-y-4",onSubmit:async o=>{o.preventDefault();const d=o.target,A=new FormData(d),M=A.get("day"),P=A.get("startTime"),m=A.get("endTime");if(!M||!P||!m){alert("×× × ××œ× ××ª ×›×œ ×”×©×“×•×ª ×”× ×“×¨×©×™×");return}const l=B(P,m);if(l<=0){alert("×–××Ÿ ×”×¡×™×•× ×—×™×™×‘ ×œ×”×™×•×ª ×œ××—×¨ ×–××Ÿ ×”×”×ª×—×œ×”");return}await z({day:M,startTime:P,endTime:m,duration:l})},children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×™×•× ×”×©×‘×•×¢"}),e.jsxs("select",{name:"day",defaultValue:f.day,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×™×•×"}),e.jsx("option",{value:"×¨××©×•×Ÿ",children:"×¨××©×•×Ÿ"}),e.jsx("option",{value:"×©× ×™",children:"×©× ×™"}),e.jsx("option",{value:"×©×œ×™×©×™",children:"×©×œ×™×©×™"}),e.jsx("option",{value:"×¨×‘×™×¢×™",children:"×¨×‘×™×¢×™"}),e.jsx("option",{value:"×—××™×©×™",children:"×—××™×©×™"}),e.jsx("option",{value:"×©×™×©×™",children:"×©×™×©×™"}),e.jsx("option",{value:"×©×‘×ª",children:"×©×‘×ª"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×–××Ÿ ×”×ª×—×œ×”"}),e.jsx("input",{type:"time",name:"startTime",defaultValue:f.startTime||f.time,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×–××Ÿ ×¡×™×•×"}),e.jsx("input",{type:"time",name:"endTime",defaultValue:f.endTime||G(f.startTime||f.time||"00:00",f.duration||45),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"×¤×¨×˜×™ ×”×©×™×¢×•×¨"}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"×ª×œ××™×“:"})," ",f.studentName||"×œ× ×¦×•×™×Ÿ"]}),f.instrumentName&&e.jsxs("div",{children:[e.jsx("strong",{children:"×›×œ×™ × ×’×™× ×”:"})," ",f.instrumentName]}),f.location&&e.jsxs("div",{children:[e.jsx("strong",{children:"××™×§×•×:"})," ",f.location]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[e.jsx("button",{type:"submit",disabled:E,className:"flex-1 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-medium disabled:opacity-50",children:E?"×©×•××¨...":"×©××•×¨ ×©×™× ×•×™×™×"}),e.jsx("button",{type:"button",onClick:()=>S(null),className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"×‘×™×˜×•×œ"})]})]})]})})]})};class ks{async getCurrentOrchestraEnrollments(s){if(!s||s.length===0)return[];try{const a=s.map(async t=>{try{return await V.getOrchestra(t)}catch(g){return console.warn(`Failed to fetch orchestra ${t}:`,g),null}});return(await Promise.allSettled(a)).filter(t=>t.status==="fulfilled"&&t.value!==null).map(t=>t.value)}catch(a){throw console.error("Error fetching orchestra enrollments:",a),{code:"FETCH_ORCHESTRAS_FAILED",message:"×©×’×™××” ×‘×˜×¢×™× ×ª × ×ª×•× ×™ ×”×ª×–××•×¨×•×ª",details:a}}}async getCurrentEnsembleEnrollments(s){if(!s||s.length===0)return[];try{const a=s.map(async t=>{try{return await V.request(`/ensemble/${t}`)}catch(g){return console.warn(`Failed to fetch ensemble ${t}:`,g),null}});return(await Promise.allSettled(a)).filter(t=>t.status==="fulfilled"&&t.value!==null).map(t=>t.value)}catch(a){throw console.error("Error fetching ensemble enrollments:",a),{code:"FETCH_ENSEMBLES_FAILED",message:"×©×’×™××” ×‘×˜×¢×™× ×ª × ×ª×•× ×™ ×”×”×¨×›×‘×™×",details:a}}}async getAllAvailableOrchestras(){try{return(await V.request("/orchestra")).filter(a=>a.isActive)}catch(s){throw console.error("Error fetching available orchestras:",s),{code:"FETCH_ALL_ORCHESTRAS_FAILED",message:"×©×’×™××” ×‘×˜×¢×™× ×ª ×¨×©×™××ª ×”×ª×–××•×¨×•×ª ×”×–××™× ×•×ª",details:s}}}async getAllAvailableEnsembles(){try{return(await V.request("/ensemble")).filter(a=>a.isActive)}catch(s){throw console.error("Error fetching available ensembles:",s),{code:"FETCH_ALL_ENSEMBLES_FAILED",message:"×©×’×™××” ×‘×˜×¢×™× ×ª ×¨×©×™××ª ×”×”×¨×›×‘×™× ×”×–××™× ×™×",details:s}}}async checkOrchestraEligibility(s,a,r){try{const t=await V.getOrchestra(a),g=r||await V.getStudentDetails(s),u={canEnroll:!0,reasons:[],conflicts:[],instrumentCompatible:!1,hasSpace:!1,meetsRequirements:!1},T=g.instrumentProgress?.map(f=>f.instrumentName)||[];u.instrumentCompatible=t.instruments.some(f=>T.includes(f)),u.instrumentCompatible||(u.canEnroll=!1,u.reasons.push(`×”×›×œ×™ ×©×œ×š (${T.join(", ")}) ×œ× ××ª××™× ×œ×ª×–××•×¨×ª ×–×•`)),t.maxMembers&&t.currentMembers?(u.hasSpace=t.currentMembers<t.maxMembers,u.hasSpace||(u.canEnroll=!1,u.reasons.push("×”×ª×–××•×¨×ª ××œ××” - ××™×Ÿ ××§×•××•×ª ×–××™× ×™×"))):u.hasSpace=!0;const N=await this.detectScheduleConflicts(g,t.rehearsalTimes);return u.conflicts=N,N.length>0&&N.some(S=>S.severity==="overlap")&&(u.canEnroll=!1,u.reasons.push("×™×© ×”×ª× ×’×©×•×ª ×¢× ×”×©×™×¢×•×¨×™× ×”×§×™×™××™× ×©×œ×š")),u.meetsRequirements=!0,u.estimatedCost=t.yearlyFee||0,u}catch(t){throw console.error("Error checking orchestra eligibility:",t),{code:"ELIGIBILITY_CHECK_FAILED",message:"×©×’×™××” ×‘×‘×“×™×§×ª ×–×›××•×ª ×œ×ª×–××•×¨×ª",details:t}}}async checkEnsembleEligibility(s,a,r){try{const t=await V.request(`/ensemble/${a}`),g=r||await V.getStudentDetails(s),u={canEnroll:!0,reasons:[],conflicts:[],instrumentCompatible:!1,hasSpace:!1,meetsRequirements:!1},T=g.instrumentProgress?.map(f=>f.instrumentName)||[];u.instrumentCompatible=t.instruments.some(f=>T.includes(f)),u.instrumentCompatible||(u.canEnroll=!1,u.reasons.push(`×”×›×œ×™ ×©×œ×š (${T.join(", ")}) ×œ× ××ª××™× ×œ×”×¨×›×‘ ×–×”`)),t.maxMembers&&t.currentMembers?(u.hasSpace=t.currentMembers<t.maxMembers,u.hasSpace||(u.canEnroll=!1,u.reasons.push("×”×”×¨×›×‘ ××œ× - ××™×Ÿ ××§×•××•×ª ×–××™× ×™×"))):u.hasSpace=!0;const N=await this.detectScheduleConflicts(g,t.rehearsalTimes);return u.conflicts=N,N.length>0&&N.some(S=>S.severity==="overlap")&&(u.canEnroll=!1,u.reasons.push("×™×© ×”×ª× ×’×©×•×ª ×¢× ×”×©×™×¢×•×¨×™× ×”×§×™×™××™× ×©×œ×š")),u.meetsRequirements=!0,u.estimatedCost=t.yearlyFee||0,u}catch(t){throw console.error("Error checking ensemble eligibility:",t),{code:"ELIGIBILITY_CHECK_FAILED",message:"×©×’×™××” ×‘×‘×“×™×§×ª ×–×›××•×ª ×œ×”×¨×›×‘",details:t}}}async detectScheduleConflicts(s,a){const r=[];try{const t=s.teacherAssignments||[],g={×¨××©×•×Ÿ:0,×©× ×™:1,×©×œ×™×©×™:2,×¨×‘×™×¢×™:3,×—××™×©×™:4,×©×™×©×™:5,×©×‘×ª:6};for(const u of a){const T=g[u.day];for(const N of t){const f=g[N.day];if(T===f){const S=this.timeToMinutes(u.startTime),E=this.timeToMinutes(u.endTime),_=this.timeToMinutes(N.startTime),D=_+(N.duration||45);S<D&&_<E?r.push({type:"lesson",conflictWith:`×©×™×¢×•×¨ ${N.instrumentName||"×›×œ×™ × ×’×™× ×”"} ×¢× ${N.teacherName||"×”××•×¨×”"}`,day:N.day,startTime:N.startTime,endTime:this.minutesToTime(D),severity:"overlap"}):(Math.abs(S-D)<30||Math.abs(_-E)<30)&&r.push({type:"lesson",conflictWith:`×©×™×¢×•×¨ ${N.instrumentName||"×›×œ×™ × ×’×™× ×”"} ×¢× ${N.teacherName||"×”××•×¨×”"}`,day:N.day,startTime:N.startTime,endTime:this.minutesToTime(D),severity:"adjacent"})}}}}catch(t){console.error("Error detecting conflicts:",t)}return r}async addOrchestraEnrollment(s,a){try{const r=await this.checkOrchestraEligibility(s,a);if(!r.canEnroll)throw{code:"ENROLLMENT_NOT_ELIGIBLE",message:`×œ× × ×™×ª×Ÿ ×œ×”×¨×©×: ${r.reasons.join(", ")}`,details:{eligibility:r}};const t=await V.getStudentDetails(s);if(t.orchestraIds?.includes(a))throw{code:"ALREADY_ENROLLED",message:"×”×ª×œ××™×“ ×›×‘×¨ ×¨×©×•× ×œ×ª×–××•×¨×ª ×–×•",details:{orchestraId:a}};const g=[...t.orchestraIds||[],a];await V.request(`/student/${s}`,{method:"PUT",body:JSON.stringify({orchestraIds:g})})}catch(r){throw r.code?r:(console.error("Error adding orchestra enrollment:",r),{code:"ENROLLMENT_FAILED",message:"×©×’×™××” ×‘×¨×™×©×•× ×œ×ª×–××•×¨×ª",details:r})}}async removeOrchestraEnrollment(s,a){try{const r=await V.getStudentDetails(s);if(!r.orchestraIds?.includes(a))throw{code:"NOT_ENROLLED",message:"×”×ª×œ××™×“ ××™× ×• ×¨×©×•× ×œ×ª×–××•×¨×ª ×–×•",details:{orchestraId:a}};const t=r.orchestraIds.filter(g=>g!==a);await V.request(`/student/${s}`,{method:"PUT",body:JSON.stringify({orchestraIds:t})})}catch(r){throw r.code?r:(console.error("Error removing orchestra enrollment:",r),{code:"UNENROLLMENT_FAILED",message:"×©×’×™××” ×‘×‘×™×˜×•×œ ×¨×™×©×•× ××”×ª×–××•×¨×ª",details:r})}}async addEnsembleEnrollment(s,a){try{const r=await this.checkEnsembleEligibility(s,a);if(!r.canEnroll)throw{code:"ENROLLMENT_NOT_ELIGIBLE",message:`×œ× × ×™×ª×Ÿ ×œ×”×¨×©×: ${r.reasons.join(", ")}`,details:{eligibility:r}};const t=await V.getStudentDetails(s);if(t.ensembleIds?.includes(a))throw{code:"ALREADY_ENROLLED",message:"×”×ª×œ××™×“ ×›×‘×¨ ×¨×©×•× ×œ×”×¨×›×‘ ×–×”",details:{ensembleId:a}};const g=[...t.ensembleIds||[],a];await V.request(`/student/${s}`,{method:"PUT",body:JSON.stringify({ensembleIds:g})})}catch(r){throw r.code?r:(console.error("Error adding ensemble enrollment:",r),{code:"ENROLLMENT_FAILED",message:"×©×’×™××” ×‘×¨×™×©×•× ×œ×”×¨×›×‘",details:r})}}async removeEnsembleEnrollment(s,a){try{const r=await V.getStudentDetails(s);if(!r.ensembleIds?.includes(a))throw{code:"NOT_ENROLLED",message:"×”×ª×œ××™×“ ××™× ×• ×¨×©×•× ×œ×”×¨×›×‘ ×–×”",details:{ensembleId:a}};const t=r.ensembleIds.filter(g=>g!==a);await V.request(`/student/${s}`,{method:"PUT",body:JSON.stringify({ensembleIds:t})})}catch(r){throw r.code?r:(console.error("Error removing ensemble enrollment:",r),{code:"UNENROLLMENT_FAILED",message:"×©×’×™××” ×‘×‘×™×˜×•×œ ×¨×™×©×•× ××”×”×¨×›×‘",details:r})}}timeToMinutes(s){const[a,r]=s.split(":").map(Number);return a*60+r}minutesToTime(s){const a=Math.floor(s/60),r=s%60;return`${a.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}}const we=new ks,Is=({teacherId:i,timeBlock:s,onSave:a,onCancel:r})=>{const[t,g]=x.useState(()=>s?{day:s.day,startTime:s.startTime,endTime:s.endTime,location:s.location,notes:s.notes||"",isActive:s.isActive,isRecurring:s.recurring?.isRecurring||!0}:{day:"×¨××©×•×Ÿ",startTime:"14:00",endTime:"18:00",location:"×—×“×¨ 25",notes:"",isActive:!0,isRecurring:!0}),[u,T]=x.useState(!1),[N,f]=x.useState(null),S=["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™","×©×‘×ª"],E=(h,k)=>{const[O,X]=h.split(":").map(Number),[c,v]=k.split(":").map(Number),I=O*60+X;return c*60+v-I},_=h=>{const k=Math.floor(h/60),O=h%60;return O>0?`${k} ×©×¢×•×ª ×•-${O} ×“×§×•×ª`:`${k} ×©×¢×•×ª`},D=(h,k)=>{g(O=>({...O,[h]:k})),f(null)},w=()=>{const h=E(t.startTime,t.endTime);return h<=0?(f("×©×¢×ª ×¡×™×•× ×—×™×™×‘×ª ×œ×”×™×•×ª ××—×¨×™ ×©×¢×ª ×”×ª×—×œ×”"),!1):h<30?(f("×–××™× ×•×ª ×—×™×™×‘×ª ×œ×”×™×•×ª ×œ×¤×—×•×ª 30 ×“×§×•×ª"),!1):t.location.trim()?!0:(f("×™×© ×œ×‘×—×•×¨ ××™×§×•×"),!1)},$=async h=>{if(h.preventDefault(),!!w()){T(!0),f(null);try{const k=E(t.startTime,t.endTime),O={day:t.day,startTime:t.startTime,endTime:t.endTime,totalDuration:k,location:t.location,notes:t.notes.trim()||null,isActive:t.isActive,recurring:{isRecurring:t.isRecurring,excludeDates:s?.recurring?.excludeDates||[]}};s?._id?await F.teacherSchedule.updateTimeBlock(i,s._id,O):await F.teacherSchedule.createTimeBlock(i,O),a()}catch(k){console.error("Error saving time block:",k),f("×©×’×™××” ×‘×©××™×¨×ª ×”×–××™× ×•×ª: "+(k.message||"×©×’×™××” ×œ× ×™×“×•×¢×”"))}finally{T(!1)}}},R=E(t.startTime,t.endTime);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:s?"×¢×¨×™×›×ª ×–××™× ×•×ª":"×”×•×¡×¤×ª ×–××™× ×•×ª ×—×“×©×”"}),e.jsx("button",{type:"button",onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(me,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:$,className:"p-6 space-y-6",children:[N&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700 text-sm",children:N})}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"×™×•× ×‘×©×‘×•×¢ *"]}),e.jsx("select",{value:t.day,onChange:h=>D("day",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900",required:!0,children:S.map(h=>e.jsx("option",{value:h,children:h},h))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"×©×¢×ª ×”×ª×—×œ×” *"]}),e.jsx("input",{type:"time",value:t.startTime,onChange:h=>D("startTime",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"×©×¢×ª ×¡×™×•× *"}),e.jsx("input",{type:"time",value:t.endTime,onChange:h=>D("endTime",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900",required:!0})]})]}),R>0&&e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center text-blue-700",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{className:"font-medium",children:["××©×š ×–××Ÿ: ",_(R)]})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"××™×§×•× *"]}),e.jsx("select",{value:t.location,onChange:h=>D("location",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900",required:!0,children:Te.map(h=>e.jsx("option",{value:h,children:h},h))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"×”×¢×¨×•×ª"}),e.jsx("textarea",{value:t.notes,onChange:h=>D("notes",h.target.value),placeholder:"×”×¢×¨×•×ª ××•×¤×¦×™×•× ×œ×™×•×ª...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 resize-none"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.isRecurring,onChange:h=>D("isRecurring",h.target.checked),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-gray-700 mr-3",children:"×—×•×–×¨ ×©×‘×•×¢×™×ª"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.isActive,onChange:h=>D("isActive",h.target.checked),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-gray-700 mr-3",children:"×¤×¢×™×œ"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"submit",disabled:u,className:"flex-1 flex items-center justify-center px-4 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"×©×•××¨..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"w-4 h-4 mr-2"}),s?"×¢×“×›×Ÿ":"×¦×•×¨"," ×–××™× ×•×ª"]})}),e.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 font-medium",children:"×‘×™×˜×•×œ"})]})]})]})})},As=({teacher:i,teacherId:s})=>{const[a,r]=x.useState(null),[t,g]=x.useState(!1),[u,T]=x.useState([]),[N,f]=x.useState([]),[S,E]=x.useState([]),[_,D]=x.useState(!1),[w,$]=x.useState(!1),[R,h]=x.useState(!1),[k,O]=x.useState(i),[X,c]=x.useState(null),v=(l,b)=>{if(!l||!b)return 0;const[C,L]=l.split(":").map(Number),[U,W]=b.split(":").map(Number),n=C*60+L;return U*60+W-n};x.useEffect(()=>{(async()=>{if(i.conducting){D(!0);try{const b=(i.conducting.orchestraIds||[]).map(async j=>{try{const p=await we.getCurrentOrchestraEnrollments([j]);return p[0]?{_id:p[0]._id,name:p[0].name,type:"orchestra",rehearsalTimes:p[0].rehearsalTimes||[],location:"××•×œ× ×”×ª×–××•×¨×ª",participants:p[0].currentMembers||0}:null}catch(p){return console.warn(`Failed to load orchestra ${j}:`,p),null}}),C=(i.conducting.ensemblesIds||[]).map(async j=>{try{const p=await we.getCurrentEnsembleEnrollments([j]);return p[0]?{_id:p[0]._id,name:p[0].name,type:"ensemble",rehearsalTimes:p[0].rehearsalTimes||[],location:"×—×“×¨ ×”×× ×¡××‘×œ",participants:p[0].currentMembers||0}:null}catch(p){return console.warn(`Failed to load ensemble ${j}:`,p),null}}),[L,U]=await Promise.all([Promise.allSettled(b),Promise.allSettled(C)]),W=L.filter(j=>j.status==="fulfilled"&&j.value!==null).map(j=>j.value),n=U.filter(j=>j.status==="fulfilled"&&j.value!==null).map(j=>j.value),y=W.flatMap(j=>j.rehearsalTimes.map(p=>({_id:`${j._id}-${p.day}-${p.startTime}`,name:j.name,day:p.day,startTime:p.startTime,endTime:p.endTime,location:p.location||j.location,participants:j.participants,type:"orchestra"}))),Y=n.flatMap(j=>j.rehearsalTimes.map(p=>({_id:`${j._id}-${p.day}-${p.startTime}`,name:j.name,day:p.day,startTime:p.startTime,endTime:p.endTime,location:p.location||j.location,participants:j.participants,type:"ensemble"})));T(y),f(Y)}catch(b){console.error("Failed to load conducting activities:",b)}finally{D(!1)}}})()},[i.conducting]),x.useEffect(()=>{(async()=>{if(s)try{console.log("ğŸ”„ Loading teacher lessons for ID:",s);const b=await F.teachers.getTeacherLessons(s);console.log("âœ… Teacher lessons loaded:",b);const C=b?.lessons||b?.data?.lessons||[];E(C),console.log(`ğŸ“š Set ${C.length} lessons for teacher`)}catch(b){console.error("âŒ Failed to load teacher lessons:",b),E([])}})()},[s]);const I=["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™","×©×‘×ª"],z=async()=>{try{const l=await F.teachers.getTeacher(s);O(l)}catch(l){console.error("Failed to refresh teacher data:",l)}},B=x.useMemo(()=>{const l=[];if(k.teaching?.timeBlocks){const C=k.teaching.timeBlocks.map(L=>({...L,totalDuration:v(L.startTime,L.endTime)}));l.push(...C)}k.teaching?.schedule&&k.teaching.schedule.forEach(C=>{C.studentId||l.push({_id:C._id,day:C.day,startTime:C.startTime,endTime:C.endTime,totalDuration:v(C.startTime,C.endTime),location:C.location,notes:C.notes,isActive:C.isAvailable!==!1,assignedLessons:[],isFromSchedule:!0})});const b=C=>{const L=I.indexOf(C);return L===-1?999:L};return l.sort((C,L)=>{const U=b(C.day)-b(L.day);if(U!==0)return U;const W=C.startTime||"00:00",n=L.startTime||"00:00";return W.localeCompare(n)})},[k.teaching?.timeBlocks,k.teaching?.schedule]);I.reduce((l,b)=>(l[b]=B.filter(C=>C.day===b)||[],l),{});const G=()=>B.reduce((l,b)=>l+(b.totalDuration||0),0)/60||0,o=()=>{const l=new Set;return k.teaching?.schedule?.forEach(b=>{b.studentId&&l.add(b.studentId)}),l.size},d=async l=>{try{if(console.log("ğŸ”„ Updating lesson via student record:",l),console.log("ğŸ†” Student ID:",l.studentId),console.log("ğŸ‘¨â€ğŸ« Teacher ID:",l.teacherId||s),console.log("ğŸ“ Update data:",{day:l.day,startTime:l.startTime,endTime:l.endTime,duration:l.duration}),!l.studentId)throw new Error("Student ID is missing");const b=await F.students.getStudentById(l.studentId);if(console.log("ğŸ“‹ Current student data loaded:",b.personalInfo?.fullName),!b.teacherAssignments||b.teacherAssignments.length===0)throw new Error("No teacher assignments found for this student");const C=l.teacherId||s,L=b.teacherAssignments.findIndex(p=>p.teacherId===C&&p.isActive);if(L===-1)throw new Error(`No active assignment found for teacher ${C}`);console.log(`ğŸ¯ Found teacher assignment at index ${L}`);const U=[...b.teacherAssignments],W=U[L],n=(p,q)=>{const[K,Q]=p.split(":").map(Number),H=K*60+Q+q,ne=Math.floor(H/60),le=H%60;return`${ne.toString().padStart(2,"0")}:${le.toString().padStart(2,"0")}`};U[L]={...W,day:l.day,time:l.startTime,duration:l.duration,scheduleInfo:{...W.scheduleInfo,day:l.day,startTime:l.startTime,endTime:n(l.startTime,l.duration),duration:l.duration,updatedAt:new Date().toISOString()},updatedAt:new Date().toISOString()},console.log("ğŸ“¤ Updating student record with new assignment:",U[L]);const y=await F.students.updateStudent(l.studentId,{teacherAssignments:U});console.log("âœ… Student updated successfully:",y.personalInfo?.fullName);const Y=await F.teachers.getTeacherLessons(s),j=Y?.lessons||Y?.data?.lessons||[];E(j),console.log("âœ… Teacher lessons refreshed - new count:",j.length)}catch(b){throw console.error("âŒ Failed to update lesson:",b),console.error("âŒ Error details:",b.message),b}},A=u.length+N.length,M=G(),P=B.length||0,m=o();return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-end items-start",children:[_&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600 mr-4",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),"×˜×•×¢×Ÿ ×¤×¢×™×œ×•×™×•×ª ×”× ×™×¦×•×—..."]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-600",children:Math.round(M)}),e.jsx("div",{className:"text-gray-600",children:"×©×¢×•×ª ×©×‘×•×¢×™×•×ª"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:P}),e.jsx("div",{className:"text-gray-600",children:"×™××™ ×œ×™××•×“"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:m}),e.jsx("div",{className:"text-gray-600",children:"×ª×œ××™×“×™×"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:A}),e.jsx("div",{className:"text-gray-600",children:"×”×¨×›×‘×™×"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>$(!1),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${w?"bg-white text-gray-600 hover:bg-gray-100":"bg-primary-500 text-white"}`,children:"×œ×•×— ×–×× ×™× ×©×‘×•×¢×™"}),e.jsx("button",{onClick:()=>$(!0),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${w?"bg-primary-500 text-white":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"× ×™×”×•×œ ×™××™ ×œ×™××•×“"})]}),A>0&&e.jsxs("div",{className:"text-sm text-gray-600",children:["×× ×¦×— ×¢×œ ",A," ×”×¨×›×‘×™×"]})]}),w?e.jsxs("div",{className:"space-y-6",children:[B.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:B.map((l,b)=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:l.day})]}),l.isActive&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full font-medium",children:"×¤×¢×™×œ"})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(ee,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"font-medium",children:[l.startTime," - ",l.endTime]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx("span",{className:"text-sm",children:"××©×š:"}),e.jsxs("span",{className:"font-medium text-blue-600",children:[Math.floor(l.totalDuration/60)," ×©×¢×•×ª",l.totalDuration%60!==0&&` ×•-${l.totalDuration%60} ×“×§×•×ª`]})]}),l.location&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(te,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:l.location})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Z,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-sm",children:[l.assignedLessons?.length||0," ×©×™×¢×•×¨×™× ××ª×•×›× × ×™×"]})]})]}),l.notes&&e.jsx("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-600",children:l.notes})}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-100",children:[e.jsxs("button",{onClick:()=>r(l),className:"flex-1 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors font-medium",children:[e.jsx(re,{className:"w-4 h-4 inline-block ml-1"}),"×¢×¨×•×š"]}),e.jsxs("button",{onClick:()=>c({timeBlock:l}),disabled:R,className:"flex-1 px-3 py-2 text-sm bg-red-50 text-red-700 rounded-lg hover:bg-red-100 transition-colors font-medium disabled:opacity-50",children:[e.jsx(de,{className:"w-4 h-4 inline-block ml-1"}),R?"××•×—×§...":"××—×§"]})]})]},l._id||b))}):e.jsxs("div",{className:"bg-white rounded-xl border-2 border-dashed border-gray-200 p-12 text-center",children:[e.jsx(se,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"××™×Ÿ ×™××™ ×œ×™××•×“ ××•×’×“×¨×™×"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"×˜×¨× ×”×•×’×“×¨×• ×™××™ ×œ×™××•×“ ×¢×‘×•×¨ ××•×¨×” ×–×”. ×”×’×“×¨ ×™××™ ×œ×™××•×“ ×›×“×™ ×œ××¤×©×¨ ×ª×–××•×Ÿ ×©×™×¢×•×¨×™×."}),e.jsx("button",{onClick:()=>g(!0),className:"px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-medium",children:"×”×•×¡×£ ×™×•× ×œ×™××•×“ ×¨××©×•×Ÿ"})]}),B.length>0&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-medium shadow-sm",children:[e.jsx(ce,{className:"w-5 h-5"}),"×”×•×¡×£ ×™×•× ×œ×™××•×“ ×—×“×©"]})})]}):e.jsx(Ds,{teacher:k,timeBlocks:B,lessons:S,orchestraActivities:u,className:"",showNavigation:!0,onLessonUpdate:d}),a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["×¢×¨×•×š ×™×•× ×œ×™××•×“ - ",a.day]}),e.jsx("button",{onClick:()=>r(null),className:"text-gray-400 hover:text-gray-600 p-1",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×–××Ÿ ×”×ª×—×œ×”"}),e.jsx("input",{type:"time",defaultValue:a.startTime,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×–××Ÿ ×¡×™×•×"}),e.jsx("input",{type:"time",defaultValue:a.endTime,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"××™×§×•×"}),e.jsxs("select",{defaultValue:a.location||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white",children:[e.jsx("option",{value:"",children:"×‘×—×¨ ××™×§×•×..."}),Te.map(l=>e.jsx("option",{value:l,children:l},l))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×”×¢×¨×•×ª"}),e.jsx("textarea",{defaultValue:a.notes,placeholder:"×”×¢×¨×•×ª × ×•×¡×¤×•×ª ×¢×œ ×™×•× ×”×œ×™××•×“...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"isActive",defaultChecked:a.isActive,className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsx("label",{htmlFor:"isActive",className:"text-sm font-medium text-gray-700",children:"×™×•× ×œ×™××•×“ ×¤×¢×™×œ (×–××™×Ÿ ×œ×§×‘×™×¢×ª ×©×™×¢×•×¨×™×)"})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-medium disabled:opacity-50",disabled:R,onClick:async l=>{l.preventDefault();const b=l.target.closest("form");new FormData(b);const C=b.querySelectorAll('input[type="time"]'),L=C[0].value,U=C[1].value,W=b.querySelector("select").value,n=b.querySelector("textarea").value,y=b.querySelector('input[type="checkbox"]').checked,j=((p,q)=>{const[K,Q]=p.split(":").map(Number),[H,ne]=q.split(":").map(Number),le=K*60+Q;return H*60+ne-le})(L,U);try{if(h(!0),a.isFromSchedule){const p=k.teaching.schedule.map(H=>H._id===a._id?{_id:H._id,day:H.day,startTime:L,endTime:U,duration:j,location:W,notes:n||null,isAvailable:y,studentId:H.studentId,recurring:H.recurring}:H);console.log("ğŸ”„ Simplified update approach"),console.log("ğŸ”„ Updated schedule entry:",p.find(H=>H._id===a._id));const q=localStorage.getItem("authToken")||sessionStorage.getItem("authToken");if(!q)throw new Error("No authentication token found");console.log("ğŸ”‘ Using token:",q?"Token exists":"No token found"),console.log("ğŸ“Š Duration calculated:",j,"minutes"),console.log("ğŸ“ Time range:",L,"-",U);const K=await fetch(`http://localhost:3001/api/teacher/${s}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${q}`},body:JSON.stringify({teaching:{...k.teaching,schedule:p}})});if(!K.ok){const H=await K.text();throw console.error("âŒ Server response:",H),new Error(`HTTP ${K.status}: ${H}`)}const Q=await K.json();console.log("âœ… Update successful:",Q)}else await F.teacherSchedule.updateTimeBlock(s,a._id,{startTime:L,endTime:U,totalDuration:j,location:W,notes:n,isActive:y});await z(),r(null),console.log("âœ… Successfully updated teaching day")}catch(p){console.error("âŒ Failed to update teaching day:",p),console.error("Error details:",p.response?.data||p.message),pe.error("×©×’×™××” ×‘×¢×“×›×•×Ÿ ×™×•× ×”×œ×™××•×“. ×× × × ×¡×” ×©×•×‘.",{duration:4e3,position:"top-center",style:{background:"#FEE2E2",color:"#991B1B",border:"1px solid #FCA5A5",padding:"16px",fontSize:"14px",fontFamily:"Reisinger-Yonatan, sans-serif"}})}finally{h(!1)}},children:R?"×©×•××¨...":"×©××•×¨ ×©×™× ×•×™×™×"}),e.jsx("button",{type:"button",onClick:()=>r(null),className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"×‘×™×˜×•×œ"})]})]})]})}),!w&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"××§×¨×"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-100 border border-blue-300 rounded"}),e.jsx("span",{className:"text-gray-700",children:"×©×™×¢×•×¨×™× ×¤×¨×˜×™×™×"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-purple-100 border border-purple-300 rounded"}),e.jsx("span",{className:"text-gray-700",children:"×ª×–××•×¨×•×ª"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-100 border border-green-300 rounded"}),e.jsx("span",{className:"text-gray-700",children:"×× ×¡××‘×œ×™×"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-100 border border-gray-300 rounded"}),e.jsx("span",{className:"text-gray-700",children:"×–××Ÿ ×¤× ×•×™"})]})]})]}),X&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 p-6",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 rounded-full",children:e.jsx(Se,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 text-center mb-2",children:"××—×™×§×ª ×™×•× ×œ×™××•×“"}),e.jsxs("p",{className:"text-gray-600 text-center mb-6",children:["×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×™×•× ×”×œ×™××•×“ ×‘×™×•× ",X.timeBlock.day,"?"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>c(null),className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"×‘×™×˜×•×œ"}),e.jsx("button",{onClick:async()=>{const l=X.timeBlock;c(null);try{if(h(!0),l.isFromSchedule){const b=k.teaching.schedule.filter(L=>L._id!==l._id),C={teaching:{...k.teaching,schedule:b}};console.log("ğŸ—‘ï¸ Deleting teaching day with data:",C),await F.teachers.updateTeacher(s,C)}else await F.teacherSchedule.deleteTimeBlock(s,l._id);await z(),console.log("âœ… Successfully deleted teaching day:",l.day)}catch(b){console.error("âŒ Failed to delete teaching day:",b),console.error("Error details:",b.response?.data||b.message),pe.error("×©×’×™××” ×‘××—×™×§×ª ×™×•× ×”×œ×™××•×“. ×× × × ×¡×” ×©×•×‘.",{duration:4e3,position:"top-center",style:{background:"#FEE2E2",color:"#991B1B",border:"1px solid #FCA5A5",padding:"16px",fontSize:"14px",fontFamily:"Reisinger-Yonatan, sans-serif"}})}finally{h(!1)}},disabled:R,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium disabled:opacity-50",children:R?"××•×—×§...":"××—×§"})]})]})}),t&&e.jsx(Is,{teacherId:s,timeBlock:null,onSave:async()=>{await z(),g(!1)},onCancel:()=>g(!1)})]})},Ms=({teacher:i,teacherId:s})=>{const[a,r]=x.useState([]),[t,g]=x.useState([]),[u,T]=x.useState(!0),[N,f]=x.useState(!1),[S,E]=x.useState(!1),[_,D]=x.useState({name:"",description:""}),[w,$]=x.useState({name:"",description:"",type:""});x.useEffect(()=>{(async()=>{try{if(T(!0),i.conducting?.orchestraIds?.length>0){const v=i.conducting.orchestraIds.map(I=>F.orchestras?.getOrchestraById(I));if(v.length>0)try{const I=await Promise.all(v);r(I.filter(Boolean))}catch(I){console.warn("Error fetching orchestras:",I),r([])}}if(i.conducting?.ensemblesIds?.length>0){const v=i.conducting.ensemblesIds.map(I=>F.ensembles?.getEnsembleById(I));if(v.length>0)try{const I=await Promise.all(v);g(I.filter(Boolean))}catch(I){console.warn("Error fetching ensembles:",I),g([])}}}catch(v){console.error("Error fetching conducting data:",v)}finally{T(!1)}})()},[i.conducting]);const R=async()=>{if(_.name.trim())try{const c={..._,conductorId:s,memberIds:[],isActive:!0,createdAt:new Date};console.log("Creating orchestra:",c);const v={_id:`temp-${Date.now()}`,...c};r(I=>[...I,v]),D({name:"",description:""}),f(!1)}catch(c){console.error("Error creating orchestra:",c)}},h=async()=>{if(w.name.trim())try{const c={...w,conductorId:s,memberIds:[],isActive:!0,createdAt:new Date};console.log("Creating ensemble:",c);const v={_id:`temp-${Date.now()}`,...c};g(I=>[...I,v]),$({name:"",description:"",type:""}),E(!1)}catch(c){console.error("Error creating ensemble:",c)}},k=async c=>{if(confirm("×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×”×ª×–××•×¨×ª?"))try{console.log("Deleting orchestra:",c),r(v=>v.filter(I=>I._id!==c))}catch(v){console.error("Error deleting orchestra:",v)}},O=async c=>{if(confirm("×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×”×× ×¡××‘×œ?"))try{console.log("Deleting ensemble:",c),g(v=>v.filter(I=>I._id!==c))}catch(v){console.error("Error deleting ensemble:",v)}};if(u)return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse w-1/3"}),e.jsx("div",{className:"space-y-3",children:[1,2].map(c=>e.jsx("div",{className:"h-24 bg-gray-200 rounded animate-pulse"},c))})]});const X=a.reduce((c,v)=>c+(v.memberIds?.length||0),0)+t.reduce((c,v)=>c+(v.memberIds?.length||0),0);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:a.length}),e.jsx("div",{className:"text-gray-600",children:"×ª×–××•×¨×•×ª"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.length}),e.jsx("div",{className:"text-gray-600",children:"×× ×¡××‘×œ×™×"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:X}),e.jsx("div",{className:"text-gray-600",children:"×¡×š ×—×‘×¨×™×"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"×ª×–××•×¨×•×ª"}),e.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:[e.jsx(ce,{className:"w-4 h-4"}),"×¦×•×¨ ×ª×–××•×¨×ª"]})]}),a.length===0?e.jsxs("div",{className:"text-center py-8 bg-purple-50 rounded-lg",children:[e.jsx(ge,{className:"w-12 h-12 text-purple-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"××™×Ÿ ×ª×–××•×¨×•×ª"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"×¢×“×™×™×Ÿ ×œ× × ×•×¦×¨×• ×ª×–××•×¨×•×ª ×ª×—×ª × ×™×¦×•×—×• ×©×œ ×”××•×¨×”"}),e.jsx("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:"×¦×•×¨ ×ª×–××•×¨×ª ×¨××©×•× ×”"})]}):e.jsx("div",{className:"grid gap-4",children:a.map(c=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:c.name}),c.description&&e.jsx("p",{className:"text-gray-600 mb-3",children:c.description}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-4 h-4"}),c.memberIds?.length||0," ×—×‘×¨×™×"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"w-4 h-4"}),c.rehearsalSchedule?.length||0," ×—×–×¨×•×ª"]}),e.jsx("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${c.isActive!==!1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:c.isActive!==!1?"×¤×¢×™×œ":"×œ× ×¤×¢×™×œ"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-2 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:e.jsx(re,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>k(c._id),className:"px-3 py-2 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:e.jsx(de,{className:"w-4 h-4"})})]})]})},c._id))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"×× ×¡××‘×œ×™×"}),e.jsxs("button",{onClick:()=>E(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[e.jsx(ce,{className:"w-4 h-4"}),"×¦×•×¨ ×× ×¡××‘×œ"]})]}),t.length===0?e.jsxs("div",{className:"text-center py-8 bg-blue-50 rounded-lg",children:[e.jsx(Ce,{className:"w-12 h-12 text-blue-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"××™×Ÿ ×× ×¡××‘×œ×™×"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"×¢×“×™×™×Ÿ ×œ× × ×•×¦×¨×• ×× ×¡××‘×œ×™× ×ª×—×ª × ×™×¦×•×—×• ×©×œ ×”××•×¨×”"}),e.jsx("button",{onClick:()=>E(!0),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"×¦×•×¨ ×× ×¡××‘×œ ×¨××©×•×Ÿ"})]}):e.jsx("div",{className:"grid gap-4",children:t.map(c=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:c.name}),c.description&&e.jsx("p",{className:"text-gray-600 mb-3",children:c.description}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-4 h-4"}),c.memberIds?.length||0," ×—×‘×¨×™×"]}),c.type&&e.jsx("div",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs",children:c.type}),e.jsx("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${c.isActive!==!1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:c.isActive!==!1?"×¤×¢×™×œ":"×œ× ×¤×¢×™×œ"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-2 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:e.jsx(re,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>O(c._id),className:"px-3 py-2 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:e.jsx(de,{className:"w-4 h-4"})})]})]})},c._id))})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"×¦×•×¨ ×ª×–××•×¨×ª ×—×“×©×”"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©× ×”×ª×–××•×¨×ª"}),e.jsx("input",{type:"text",value:_.name,onChange:c=>D({..._,name:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"×”×›× ×¡ ×©× ×ª×–××•×¨×ª..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª×™××•×¨"}),e.jsx("textarea",{value:_.description,onChange:c=>D({..._,description:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"×ª×™××•×¨ ×”×ª×–××•×¨×ª...",rows:3})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:R,disabled:!_.name.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors disabled:bg-gray-300",children:"×¦×•×¨ ×ª×–××•×¨×ª"}),e.jsx("button",{onClick:()=>{f(!1),D({name:"",description:""})},className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"×‘×˜×œ"})]})]})]})}),S&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"×¦×•×¨ ×× ×¡××‘×œ ×—×“×©"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©× ×”×× ×¡××‘×œ"}),e.jsx("input",{type:"text",value:w.name,onChange:c=>$({...w,name:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"×”×›× ×¡ ×©× ×× ×¡××‘×œ..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×¡×•×’ ×”×× ×¡××‘×œ"}),e.jsxs("select",{value:w.type,onChange:c=>$({...w,type:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×¡×•×’..."}),e.jsx("option",{value:"×§×œ××¡×™",children:"×§×œ××¡×™"}),e.jsx("option",{value:"×’'××–",children:"×’'××–"}),e.jsx("option",{value:"×›×œ×™ × ×©×™×¤×”",children:"×›×œ×™ × ×©×™×¤×”"}),e.jsx("option",{value:"×›×œ×™ ××™×ª×¨",children:"×›×œ×™ ××™×ª×¨"}),e.jsx("option",{value:"××¢×•×¨×‘",children:"××¢×•×¨×‘"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª×™××•×¨"}),e.jsx("textarea",{value:w.description,onChange:c=>$({...w,description:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"×ª×™××•×¨ ×”×× ×¡××‘×œ...",rows:3})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:h,disabled:!w.name.trim(),className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-300",children:"×¦×•×¨ ×× ×¡××‘×œ"}),e.jsx("button",{onClick:()=>{E(!1),$({name:"",description:"",type:""})},className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"×‘×˜×œ"})]})]})]})})]})},Ls=({activeTab:i,teacherId:s,teacher:a,isLoading:r})=>{if(r||!a)return e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse w-1/3"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-2/3"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-1/2"})]})]});switch(i){case"personal":return e.jsx(Ke,{teacher:a,teacherId:s});case"students":return e.jsx(Qe,{teacher:a,teacherId:s});case"schedule":return e.jsx(As,{teacher:a,teacherId:s});case"conducting":return e.jsx(Ms,{teacher:a,teacherId:s});default:return e.jsx("div",{className:"p-6 text-center text-gray-500",children:e.jsx("p",{children:"×ª×•×›×Ÿ ×”×›×¨×˜×™×¡×™×™×” ×œ× × ××¦×"})})}},Hs=()=>{const{teacherId:i}=Ae(),s=Me(),[a,r]=x.useState("personal"),[t,g]=x.useState(null),[u,T]=x.useState(!0),[N,f]=x.useState(null);if(!i||i.trim()==="")return e.jsx(Le,{to:"/teachers",replace:!0});const S=x.useCallback(async()=>{if(i)try{T(!0),f(null),console.log("ğŸ”„ Fetching teacher data for ID:",i);const E=await F.teachers.getTeacherById(i);console.log("âœ… Teacher data loaded:",E?.personalInfo?.fullName),g(E)}catch(E){console.error("âŒ Error fetching teacher:",E),f({code:E.status===404?"NOT_FOUND":E.status===401?"UNAUTHORIZED":E.status===403?"FORBIDDEN":"SERVER_ERROR",message:E.message||"×©×’×™××” ×‘×˜×¢×™× ×ª × ×ª×•× ×™ ×”××•×¨×”"})}finally{T(!1)}},[i]);return x.useEffect(()=>{S()},[S]),N?.code==="NOT_FOUND"?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-96 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ğŸ”"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"××•×¨×” ×œ× × ××¦×"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"×”××•×¨×” ×©×‘×™×§×©×ª ×œ× × ××¦× ×‘××¢×¨×›×ª ××• ×©××™×Ÿ ×œ×š ×”×¨×©××” ×œ×¦×¤×•×ª ×‘×•"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>s("/teachers"),className:"flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(xe,{className:"w-4 h-4 ml-2"}),"×—×–×•×¨ ×œ×¨×©×™××ª ××•×¨×™×"]}),e.jsxs("button",{onClick:()=>window.location.reload(),className:"flex items-center px-4 py-2 border border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(fe,{className:"w-4 h-4 ml-2"}),"× ×¡×” ×©×•×‘"]})]})]}):N?.code==="UNAUTHORIZED"||N?.code==="FORBIDDEN"?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-96 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ğŸ”’"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"××™×Ÿ ×”×¨×©××”"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"××™×Ÿ ×œ×š ×”×¨×©××” ×œ×¦×¤×•×ª ×‘×¤×¨×˜×™ ××•×¨×” ×–×”"}),e.jsxs("button",{onClick:()=>s("/teachers"),className:"flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(xe,{className:"w-4 h-4 ml-2"}),"×—×–×•×¨ ×œ×¨×©×™××ª ××•×¨×™×"]})]}):N&&!["NOT_FOUND","UNAUTHORIZED","FORBIDDEN"].includes(N.code)?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-96 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"âš ï¸"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"×©×’×™××” ×‘×˜×¢×™× ×ª ×”× ×ª×•× ×™×"}),e.jsx("p",{className:"text-gray-600 mb-6",children:N.message}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>window.location.reload(),className:"flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(fe,{className:"w-4 h-4 ml-2"}),"× ×¡×” ×©×•×‘"]}),e.jsxs("button",{onClick:()=>s("/teachers"),className:"flex items-center px-4 py-2 border border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(xe,{className:"w-4 h-4 ml-2"}),"×—×–×•×¨ ×œ×¨×©×™××ª ××•×¨×™×"]})]})]}):u?e.jsx("div",{className:"space-y-6 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:"×˜×•×¢×Ÿ ×¤×¨×˜×™ ××•×¨×”..."})]})}):e.jsxs("div",{className:"space-y-6 bg-white min-h-screen teacher-details-container teacher-content-area",children:[e.jsxs("nav",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("button",{onClick:()=>s("/teachers"),className:"hover:text-primary-600 transition-colors",children:"××•×¨×™×"}),e.jsx("span",{children:">"}),e.jsx("span",{className:"text-gray-900",children:t?.personalInfo?.fullName||"×¤×¨×˜×™ ××•×¨×”"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xl text-primary-600",children:"ğŸ‘¨â€ğŸ«"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t?.personalInfo?.fullName||"×˜×•×¢×Ÿ..."}),e.jsxs("p",{className:"text-gray-600",children:[t?.professionalInfo?.instrument||"×œ×œ× ×›×œ×™"," | ",t?.roles?.join(", ")||"××•×¨×”"]})]}),t?.conducting?.orchestraIds?.length>0&&e.jsx("div",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:"×× ×¦×—"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 w-full overflow-hidden",children:[e.jsx(Xe,{activeTab:a,onTabChange:r,tabs:[{id:"personal",label:"××™×“×¢ ××™×©×™",component:()=>null},{id:"students",label:"× ×™×”×•×œ ×ª×œ××™×“×™×",component:()=>null},{id:"schedule",label:"×œ×•×— ×–×× ×™×",component:()=>null},...t?.conducting?.orchestraIds?.length>0||t?.conducting?.ensemblesIds?.length>0||t?.roles?.includes("×× ×¦×—")?[{id:"conducting",label:"× ×™×¦×•×—",component:()=>null}]:[]]}),e.jsx(Ls,{activeTab:a,teacherId:i,teacher:t,isLoading:u})]})]})};export{Hs as default};
