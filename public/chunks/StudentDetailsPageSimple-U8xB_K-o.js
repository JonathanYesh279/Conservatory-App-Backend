import{j as e}from"../assets/index-BAwpfw4Y.js";import{r as u,a as Rt,R as Ne,f as fr,h as Gn,e as zn,b as qn,N as Xn}from"./vendor-E-WBaSU9.js";import{i as Ue,G as hr,C as Ot,l as fe,a as Z,B as ke,A as bt,u as fs,v as hs,o as gs,X as yt,j as Ls,y as Is,n as Ke,m as he,a6 as st,s as Qn,ae as rt,T as ps,P as we,U as Oe,k as tt,I as Zn,f as gr,e as Jn,g as ea,af as ta,ag as sa,aa as ra,b as na,ah as aa,a5 as la,ai as Ds,q as pr,p as ia,c as oa,aj as Ms,ak as ca,r as da,V as _s}from"./ui-BeR0qYie.js";import{a as B}from"./cascade-deletion-C-2LBfWA.js";import{a as vr,u as ua,b as Fs}from"./query-CMzvnXZ6.js";import{c as X,C as ee}from"./Card-Cf_Ok3Ft.js";import{c as ma}from"./utils-x1PSU_OZ.js";const Nt={STATIC_DATA_STALE_TIME:10*60*1e3,STATIC_DATA_CACHE_TIME:30*60*1e3,DYNAMIC_DATA_STALE_TIME:2*60*1e3,DYNAMIC_DATA_CACHE_TIME:5*60*1e3,REALTIME_DATA_STALE_TIME:30*1e3,REALTIME_DATA_CACHE_TIME:60*1e3},V={STUDENTS:["students"],STUDENT:t=>["student",t],STUDENT_THEORY_LESSONS:t=>["student",t,"theory-lessons"],STUDENT_ORCHESTRAS:t=>["student",t,"orchestras"],STUDENT_SCHEDULE:t=>["student",t,"schedule"],STUDENT_ATTENDANCE:t=>["student",t,"attendance"],STUDENT_DOCUMENTS:t=>["student",t,"documents"],TEACHERS:["teachers"],TEACHER:t=>["teacher",t],TEACHER_SCHEDULE:t=>["teacher",t,"schedule"],THEORY_LESSONS:["theory-lessons"],THEORY_LESSON:t=>["theory-lesson",t],ORCHESTRAS:["orchestras"],ORCHESTRA:t=>["orchestra",t],SCHOOL_YEARS:["school-years"],HOLIDAYS:["holidays"],INSTRUMENTS:["instruments"]},ct=new Map;function ne(t,s){if(ct.has(t))return ct.get(t);const r=s().finally(()=>{ct.delete(t)});return ct.set(t,r),r}const jt={students:{getAll:()=>ne("students-all",()=>B.students.getAllStudents()),getById:t=>ne(`student-${t}`,()=>B.students.getStudentById(t)),update:(t,s)=>B.students.updateStudent(t,s)},teachers:{getAll:()=>ne("teachers-all",()=>B.teachers.getAllTeachers()),getById:t=>ne(`teacher-${t}`,()=>B.teachers.getTeacherById(t))},theoryLessons:{getAll:()=>ne("theory-lessons-all",()=>B.theoryLessons.getTheoryLessons()),getById:t=>ne(`theory-lesson-${t}`,()=>B.theoryLessons.getTheoryLessonById(t)),addStudent:(t,s)=>B.theoryLessons.addStudentToTheory(t,s),removeStudent:(t,s)=>B.theoryLessons.removeStudentFromTheory(t,s)},orchestras:{getAll:()=>ne("orchestras-all",()=>B.orchestras.getAllOrchestras()),getById:t=>ne(`orchestra-${t}`,()=>B.orchestras.getOrchestraById(t))},schoolData:{getSchoolYears:()=>ne("school-years",()=>B.schoolData?.getSchoolYears?.()||Promise.resolve([])),getHolidays:()=>ne("holidays",()=>B.schoolData?.getHolidays?.()||Promise.resolve([])),getInstruments:()=>ne("instruments",()=>B.schoolData?.getInstruments?.()||Promise.resolve([]))}};function vs(t){return vr({queryKey:V.STUDENT(t||""),queryFn:()=>jt.students.getById(t),enabled:!!t,staleTime:Nt.DYNAMIC_DATA_STALE_TIME,gcTime:Nt.DYNAMIC_DATA_CACHE_TIME,refetchOnWindowFocus:!1})}function bs(){return vr({queryKey:V.THEORY_LESSONS,queryFn:jt.theoryLessons.getAll,staleTime:Nt.DYNAMIC_DATA_STALE_TIME,gcTime:Nt.DYNAMIC_DATA_CACHE_TIME,refetchOnWindowFocus:!1})}function xa(t){const{data:s=[]}=bs(),{data:r}=vs(t);return u.useMemo(()=>!t||!s.length?[]:s.filter(n=>n.studentIds?.includes(t)||r?.theoryLessonIds?.includes(n._id)),[s,t,r?.theoryLessonIds])}function fa(t,s,r){const{data:n=[]}=bs(),{data:a}=vs(t);return u.useMemo(()=>!t||!n.length?[]:n.filter(i=>{if(i.studentIds?.includes(t)||a?.theoryLessonIds?.includes(i._id)||i.maxStudents&&i.studentIds?.length>=i.maxStudents)return!1;const d=!i.targetGrades||i.targetGrades.length===0||i.targetGrades.includes(s),m=!i.level||i.level===r||i.level==="all";return d&&m}).map(i=>({...i,isCompatible:!0,gradeCompatible:!0,levelCompatible:!0,isFull:!1,isEnrolled:!1})),[n,t,a?.theoryLessonIds,s,r])}function ha(t){const s=ua(),r=Fs({mutationFn:({lessonId:a})=>jt.theoryLessons.addStudent(a,t),onMutate:async({lessonId:a})=>{await s.cancelQueries({queryKey:V.THEORY_LESSONS}),await s.cancelQueries({queryKey:V.STUDENT(t)});const i=s.getQueryData(V.THEORY_LESSONS),o=s.getQueryData(V.STUDENT(t));return s.setQueryData(V.THEORY_LESSONS,l=>l?.map(d=>d._id===a?{...d,studentIds:[...d.studentIds||[],t]}:d)||[]),s.setQueryData(V.STUDENT(t),l=>l&&{...l,theoryLessonIds:[...l.theoryLessonIds||[],a]}),{previousTheoryLessons:i,previousStudent:o}},onError:(a,i,o)=>{o?.previousTheoryLessons&&s.setQueryData(V.THEORY_LESSONS,o.previousTheoryLessons),o?.previousStudent&&s.setQueryData(V.STUDENT(t),o.previousStudent)},onSettled:()=>{s.invalidateQueries({queryKey:V.THEORY_LESSONS}),s.invalidateQueries({queryKey:V.STUDENT(t)})}}),n=Fs({mutationFn:({lessonId:a})=>jt.theoryLessons.removeStudent(a,t),onMutate:async({lessonId:a})=>{await s.cancelQueries({queryKey:V.THEORY_LESSONS}),await s.cancelQueries({queryKey:V.STUDENT(t)});const i=s.getQueryData(V.THEORY_LESSONS),o=s.getQueryData(V.STUDENT(t));return s.setQueryData(V.THEORY_LESSONS,l=>l?.map(d=>d._id===a?{...d,studentIds:d.studentIds?.filter(m=>m!==t)||[]}:d)||[]),s.setQueryData(V.STUDENT(t),l=>l&&{...l,theoryLessonIds:l.theoryLessonIds?.filter(d=>d!==a)||[]}),{previousTheoryLessons:i,previousStudent:o}},onError:(a,i,o)=>{o?.previousTheoryLessons&&s.setQueryData(V.THEORY_LESSONS,o.previousTheoryLessons),o?.previousStudent&&s.setQueryData(V.STUDENT(t),o.previousStudent)},onSettled:()=>{s.invalidateQueries({queryKey:V.THEORY_LESSONS}),s.invalidateQueries({queryKey:V.STUDENT(t)})}});return{enroll:r.mutate,unenroll:n.mutate,isEnrolling:r.isPending,isUnenrolling:n.isPending,error:r.error||n.error}}const $s={personal:{label:"פרטים אישיים",icon:Ue},academic:{label:"מידע אקדמי",icon:hr},schedule:{label:"לוח זמנים",icon:Ot},attendance:{label:"נוכחות",icon:fe},orchestra:{label:"תזמורות",icon:Z},theory:{label:"תאוריה",icon:ke},bagrut:{label:"בגרות",icon:bt},documents:{label:"מסמכים",icon:fs}},ga=({activeTab:t,onTabChange:s,tabs:r=[]})=>!r||r.length===0?null:e.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 shadow-sm w-full overflow-hidden student-tab-navigation",children:[e.jsx("div",{className:"hidden md:flex w-full overflow-x-auto desktop-tab-nav",children:e.jsx("nav",{className:"flex gap-8 px-6 relative min-w-full","aria-label":"Tabs",children:r.map((n,a)=>{const i=$s[n.id],o=i?.icon||Ue,l=t===n.id;return e.jsxs("button",{onClick:()=>s(n.id),className:`
                  group inline-flex items-center gap-3 py-4 px-2 border-b-2 font-medium text-sm transition-all duration-300 relative tab-button
                  ${l?"border-primary-500 text-primary-600 bg-primary-50/50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 hover:bg-gray-50/50"}
                `,"aria-current":l?"page":void 0,style:{minHeight:"44px"},children:[e.jsx(o,{className:`w-5 h-5 transition-all duration-300 ${l?"text-primary-500 scale-110":"text-gray-400 group-hover:text-gray-500 group-hover:scale-105"}`}),e.jsx("span",{className:"whitespace-nowrap",children:i?.label||n.label}),l&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-primary-400 to-primary-600 rounded-full animate-scale-in"})]},n.id)})})}),e.jsxs("div",{className:"md:hidden w-full overflow-hidden mobile-tab-nav",children:[e.jsx("div",{className:"overflow-x-auto scrollbar-hide w-full",children:e.jsx("nav",{className:"flex gap-3 px-4 py-3 min-w-max","aria-label":"Tabs",style:{width:"max-content"},children:r.map((n,a)=>{const i=$s[n.id],o=i?.icon||Ue,l=t===n.id;return e.jsxs("button",{onClick:()=>s(n.id),className:`
                    flex flex-col items-center gap-1 px-4 py-3 rounded-xl font-medium text-xs transition-all duration-300 whitespace-nowrap transform tab-button
                    ${l?"bg-primary-100 text-primary-700 border-2 border-primary-200 scale-105 shadow-md":"text-gray-600 hover:text-gray-900 hover:bg-gray-50 hover:scale-102 border-2 border-transparent"}
                  `,"aria-current":l?"page":void 0,style:{minWidth:"80px",minHeight:"44px"},children:[e.jsx(o,{className:`w-5 h-5 transition-all duration-300 ${l?"text-primary-600":"text-gray-500"}`}),e.jsx("span",{className:"leading-tight",children:i?.label||n.label})]},n.id)})})}),e.jsx("div",{className:"flex justify-center py-1",children:e.jsx("div",{className:"w-8 h-1 bg-gray-200 rounded-full",children:e.jsx("div",{className:"h-full bg-primary-400 rounded-full transition-all duration-300",style:{width:`${r?.length>0?(r.findIndex(n=>n.id===t)+1)/r.length*100:0}%`}})})})]})]});function br({isLoading:t,children:s,skeleton:r,minHeight:n="200px"}){const[a,i]=u.useState(!1);return u.useEffect(()=>{let o;return t?o=setTimeout(()=>i(!0),150):i(!1),()=>clearTimeout(o)},[t]),t&&a?e.jsx("div",{style:{minHeight:n},children:r||e.jsx(pa,{})}):t?e.jsx("div",{style:{minHeight:n},className:"flex items-center justify-center",children:e.jsx("div",{className:"animate-pulse text-gray-400",children:"טוען..."})}):e.jsx(e.Fragment,{children:s})}function pa(){return e.jsx("div",{className:"space-y-4 p-4",children:[1,2,3].map(t=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]},t))})}const ht={StudentHeader:()=>e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-start gap-6 animate-pulse",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-full flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx("div",{className:"h-7 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-16"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-20"})]})]})]})}),TabContent:()=>e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 space-y-6 animate-pulse",children:[1,2,3,4].map(t=>e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-10 bg-gray-200 rounded"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-20"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-24"})]})]},t))}),TheoryLessons:()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between animate-pulse",children:[e.jsxs("div",{children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-48 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-64"})]}),e.jsx("div",{className:"h-10 bg-gray-200 rounded w-40"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[1,2,3,4].map(t=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 animate-pulse",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"})]}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-2"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded w-16"}),e.jsx("div",{className:"h-5 bg-gray-200 rounded w-20"})]})]}),e.jsx("div",{className:"h-10 bg-gray-200 rounded w-20"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-32"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-40"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"})]})]})]},t))})]}),OrchestraList:()=>e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(t=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-2/3"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3"})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"})})]},t))}),DocumentsList:()=>e.jsx("div",{className:"space-y-4 p-4 animate-pulse",children:[1,2,3].map(t=>e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-white border rounded-lg",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded"}),e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded"})]})]},t))}),Schedule:()=>e.jsxs("div",{className:"p-4 space-y-4 animate-pulse",children:[e.jsxs("div",{className:"grid grid-cols-8 gap-2 mb-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded"}),Array.from({length:7}).map((t,s)=>e.jsx("div",{className:"h-6 bg-gray-200 rounded"},s))]}),Array.from({length:10}).map((t,s)=>e.jsxs("div",{className:"grid grid-cols-8 gap-2",children:[e.jsx("div",{className:"h-12 bg-gray-200 rounded"}),Array.from({length:7}).map((r,n)=>e.jsx("div",{className:"h-12 bg-gray-200 rounded opacity-50"},n))]},s))]}),AttendanceChart:()=>e.jsxs("div",{className:"bg-white p-6 rounded-lg border space-y-6 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded"}),e.jsx("div",{className:"flex justify-center gap-6",children:[1,2,3].map(t=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-200 rounded-full"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-16"})]},t))})]}),PersonalInfo:()=>e.jsxs("div",{className:"space-y-6 animate-pulse",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-32 mb-4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Array.from({length:6}).map((t,s)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"}),e.jsx("div",{className:"h-10 bg-gray-200 rounded"})]},s))})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-28 mb-4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Array.from({length:4}).map((t,s)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20"}),e.jsx("div",{className:"h-10 bg-gray-200 rounded"})]},s))})]})]})},va=({student:t,studentId:s,isLoading:r,onStudentUpdate:n})=>{const a=t?.personalInfo||{},[i,o]=u.useState(!1),[l,d]=u.useState(!1),[m,x]=u.useState({fullName:a.fullName||"",phone:a.phone||"",age:a.age||"",address:a.address||"",parentName:a.parentName||"",parentPhone:a.parentPhone||"",parentEmail:a.parentEmail||"",studentEmail:a.studentEmail||""});u.useEffect(()=>{x({fullName:a.fullName||"",phone:a.phone||"",age:a.age||"",address:a.address||"",parentName:a.parentName||"",parentPhone:a.parentPhone||"",parentEmail:a.parentEmail||"",studentEmail:a.studentEmail||""})},[a]);const f=async()=>{try{d(!0);const h=await B.students.updateStudent(s,{personalInfo:m});n&&n(h),o(!1)}catch(h){console.error("Error saving student personal info:",h);let b="שגיאה בשמירת הנתונים";h.message.includes("Authentication failed")?b="פג תוקף הפנייה. אנא התחבר מחדש.":h.message.includes("validation")?b="שגיאה בנתונים שהוזנו. אנא בדוק את הפרטים האישיים.":h.message.includes("not found")?b="התלמיד לא נמצא במערכת.":h.message.includes("Network")&&(b="שגיאת רשת. אנא בדוק את החיבור לאינטרנט."),alert(b)}finally{d(!1)}},v=()=>{x({fullName:a.fullName||"",phone:a.phone||"",age:a.age||"",address:a.address||"",parentName:a.parentName||"",parentPhone:a.parentPhone||"",parentEmail:a.parentEmail||"",studentEmail:a.studentEmail||""}),o(!1)};return r?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-6",children:[1,2,3,4,5,6,7,8].map(h=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-32"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse w-full"})]},h))})}):e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsx("div",{className:"flex justify-end",children:i?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:f,disabled:l,className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50",children:[e.jsx(gs,{className:"w-4 h-4"}),l?"שומר...":"שמור"]}),e.jsxs("button",{onClick:v,disabled:l,className:"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors disabled:opacity-50",children:[e.jsx(yt,{className:"w-4 h-4"}),"בטל"]})]}):e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(hs,{className:"w-4 h-4"}),"ערוך"]})}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-4",children:"פרטי תלמיד"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"שם מלא"}),i?e.jsx("input",{type:"text",value:m.fullName,onChange:h=>x({...m,fullName:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"הכנס שם מלא"}):e.jsx("div",{className:"text-gray-900 text-lg font-medium",children:a.fullName||"לא צוין"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"טלפון"}),i?e.jsx("input",{type:"tel",value:m.phone,onChange:h=>x({...m,phone:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"הכנס מספר טלפון"}):e.jsxs("div",{className:"text-gray-900 flex items-center gap-2",children:[e.jsx(Ls,{className:"w-4 h-4 text-gray-500"}),a.phone||"לא צוין"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"גיל"}),i?e.jsx("input",{type:"number",value:m.age,onChange:h=>x({...m,age:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"הכנס גיל",min:"1",max:"99"}):e.jsx("div",{className:"text-gray-900",children:a.age||"לא צוין"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"אימייל תלמיד"}),i?e.jsx("input",{type:"email",value:m.studentEmail,onChange:h=>x({...m,studentEmail:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"הכנס כתובת דוא״ל תלמיד"}):e.jsxs("div",{className:"text-gray-900 flex items-center gap-2",children:[e.jsx(Is,{className:"w-4 h-4 text-gray-500"}),a.studentEmail||"לא צוין"]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"כתובת"}),i?e.jsx("textarea",{value:m.address,onChange:h=>x({...m,address:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"הכנס כתובת מגורים",rows:2}):e.jsxs("div",{className:"text-gray-900 flex items-center gap-2",children:[e.jsx(Ke,{className:"w-4 h-4 text-gray-500"}),a.address||"לא צוין"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-4",children:"פרטי הורה"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"שם הורה"}),i?e.jsx("input",{type:"text",value:m.parentName,onChange:h=>x({...m,parentName:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"הכנס שם הורה"}):e.jsx("div",{className:"text-gray-900",children:a.parentName||"לא צוין"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"טלפון הורה"}),i?e.jsx("input",{type:"tel",value:m.parentPhone,onChange:h=>x({...m,parentPhone:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"הכנס מספר טלפון הורה"}):e.jsxs("div",{className:"text-gray-900 flex items-center gap-2",children:[e.jsx(Ls,{className:"w-4 h-4 text-gray-500"}),a.parentPhone||"לא צוין"]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"אימייל הורה"}),i?e.jsx("input",{type:"email",value:m.parentEmail,onChange:h=>x({...m,parentEmail:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"הכנס כתובת דוא״ל הורה"}):e.jsxs("div",{className:"text-gray-900 flex items-center gap-2",children:[e.jsx(Is,{className:"w-4 h-4 text-gray-500"}),a.parentEmail||"לא צוין"]})]})]})]})]})},ba=({student:t,studentId:s,isLoading:r,onStudentUpdate:n})=>{const a=t?.academicInfo||{},[i,o]=u.useState(!1),[l,d]=u.useState(!1),[m,x]=u.useState({class:a.class||"",stage:a.stage||a.level||"",startDate:a.startDate||""});u.useEffect(()=>{x({class:a.class||"",stage:a.stage||a.level||"",startDate:a.startDate||""})},[a]);const f=async()=>{try{d(!0);const c=await B.students.updateStudent(s,{academicInfo:{...a,...m}});n&&n(c),o(!1)}catch(c){console.error("Error saving student academic info:",c);let p="שגיאה בשמירת הנתונים האקדמיים";c.message.includes("Authentication failed")?p="פג תוקף הפנייה. אנא התחבר מחדש.":c.message.includes("validation")?p="שגיאה בנתונים שהוזנו. אנא בדוק את הפרטים האקדמיים.":c.message.includes("not found")?p="התלמיד לא נמצא במערכת.":c.message.includes("Network")&&(p="שגיאת רשת. אנא בדוק את החיבור לאינטרנט."),alert(p)}finally{d(!1)}},v=()=>{x({class:a.class||"",stage:a.stage||a.level||"",startDate:a.startDate||""}),o(!1)};if(r)return e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-6",children:[1,2,3,4].map(c=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-32"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded animate-pulse w-full"})]},c))})});const h=c=>{switch(c){case"עבר/ה":return e.jsx(fe,{className:"w-4 h-4 text-green-500"});case"לא עבר/ה":return e.jsx(Qn,{className:"w-4 h-4 text-red-500"});case"עבר/ה בהצטיינות":return e.jsx(st,{className:"w-4 h-4 text-blue-500"});case"עבר/ה בהצטיינות יתרה":return e.jsx(st,{className:"w-4 h-4 text-purple-500"});default:return e.jsx(he,{className:"w-4 h-4 text-gray-500"})}},b=c=>{switch(c){case"עבר/ה":return"bg-green-100 text-green-800";case"לא עבר/ה":return"bg-red-100 text-red-800";case"עבר/ה בהצטיינות":return"bg-blue-100 text-blue-800";case"עבר/ה בהצטיינות יתרה":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"flex justify-end mb-4",children:i?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:f,disabled:l,className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50",children:[e.jsx(gs,{className:"w-4 h-4"}),l?"שומר...":"שמור"]}),e.jsxs("button",{onClick:v,disabled:l,className:"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors disabled:opacity-50",children:[e.jsx(yt,{className:"w-4 h-4"}),"בטל"]})]}):e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(hs,{className:"w-4 h-4"}),"ערוך"]})}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(ke,{className:"w-4 h-4 text-primary-600"}),"מידע אקדמי"]}),e.jsx("div",{className:"mb-4 pb-4 border-b border-gray-100",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-black font-semibold",style:{color:"#000000"},children:"כיתה:"}),i?e.jsx("input",{type:"text",value:m.class,onChange:c=>x({...m,class:c.target.value}),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"הכנס כיתה"}):e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.class||"לא צוין"})]}),(!a.instrumentProgress||a.instrumentProgress.length===0)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-black font-semibold",style:{color:"#000000"},children:"שלב:"}),i?e.jsx("input",{type:"text",value:m.stage,onChange:c=>x({...m,stage:c.target.value}),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"הכנס שלב"}):e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.stage||a.level||"לא צוין"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-black font-semibold",style:{color:"#000000"},children:"תאריך התחלה:"}),i?e.jsx("input",{type:"date",value:m.startDate?new Date(m.startDate).toISOString().split("T")[0]:"",onChange:c=>x({...m,startDate:c.target.value}),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary-500"}):e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.startDate?new Date(a.startDate).toLocaleDateString("he-IL"):"לא צוין"})]})]})}),a.instrumentProgress&&a.instrumentProgress.length>0&&e.jsxs("div",{className:"mb-4 pb-4 border-b border-gray-100",children:[e.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-2 flex items-center gap-1",children:[e.jsx(Z,{className:"w-3 h-3"}),"כלי נגינה"]}),e.jsx("div",{className:"space-y-3",children:a.instrumentProgress.map((c,p)=>e.jsxs("div",{className:"border border-gray-100 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:c.instrumentName}),c.isPrimary&&e.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-primary-100 text-primary-800 rounded",children:"ראשי"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-600",children:[e.jsxs("span",{children:["שלב: ",c.currentStage||c.stage||c.level||"לא צוין"]}),c.startDate&&e.jsx("span",{children:new Date(c.startDate).toLocaleDateString("he-IL")})]}),c.tests&&e.jsxs("div",{className:"mt-2 space-y-1",children:[c.tests.stageTest&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-black font-semibold",style:{color:"#000000"},children:"מבחן שלב:"}),e.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs ${b(c.tests.stageTest.status||"לא נבחן")}`,children:[h(c.tests.stageTest.status||"לא נבחן"),c.tests.stageTest.status||"לא נבחן"]}),c.tests.stageTest.notes&&e.jsxs("span",{className:"text-xs text-gray-500",children:["(",c.tests.stageTest.notes,")"]})]}),c.tests.technicalTest&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-black font-semibold",style:{color:"#000000"},children:"מבחן טכני:"}),e.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs ${b(c.tests.technicalTest.status||"לא נבחן")}`,children:[h(c.tests.technicalTest.status||"לא נבחן"),c.tests.technicalTest.status||"לא נבחן"]}),c.tests.technicalTest.notes&&e.jsxs("span",{className:"text-xs text-gray-500",children:["(",c.tests.technicalTest.notes,")"]})]})]})]},p))})]}),a.notes&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[e.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-2 flex items-center gap-1",children:[e.jsx(fs,{className:"w-3 h-3"}),"הערות"]}),e.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded",children:a.notes})]})]})]})},Jt=u.memo(({lesson:t,isEnrolled:s=!1,onEnroll:r,onUnenroll:n,isEnrolling:a=!1,isUnenrolling:i=!1,studentGrade:o,canEnroll:l=!0})=>{const d=u.useMemo(()=>{switch(t.level?.toLowerCase()){case"beginner":case"מתחילים":return"bg-green-100 text-green-800";case"intermediate":case"בינוני":return"bg-yellow-100 text-yellow-800";case"advanced":case"מתקדמים":return"bg-red-100 text-red-800";default:return"bg-blue-100 text-blue-800"}},[t.level]),m=u.useMemo(()=>{switch(t.category?.toLowerCase()){case"harmony":case"הרמוניה":return e.jsx(Z,{className:"w-4 h-4"});case"theory":case"תיאוריה":return e.jsx(ke,{className:"w-4 h-4"});case"composition":case"קומפוזיציה":return e.jsx(hr,{className:"w-4 h-4"});default:return e.jsx(ke,{className:"w-4 h-4"})}},[t.category]),x=h=>{if(!h)return"";const[b,c]=h.split(":");return`${b}:${c}`},f=u.useMemo(()=>t.teacherName||(typeof t.teacherId=="string"?t.teacherId:t.teacherId?.personalInfo?.name)||"לא ידוע",[t.teacherName,t.teacherId]),v=u.useMemo(()=>{if(!t.maxStudents)return null;const h=t.studentIds?.length||0,b=h/t.maxStudents*100;return{current:h,total:t.maxStudents,percentage:b}},[t.maxStudents,t.studentIds]);return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[m,e.jsx("h4",{className:"text-xl font-semibold text-gray-900",children:t.title||t.name||"שיעור תיאוריה"})]}),t.category&&e.jsxs("span",{className:"text-sm text-gray-600",children:["קטגוריה: ",t.category]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[t.level&&e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${d}`,children:t.level}),!s&&t.gradeCompatible&&o&&e.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:["מתאים לכיתה ",o]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:s?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"inline-flex items-center px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"רשום"]}),e.jsx("button",{onClick:n,disabled:i,className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"בטל הרשמה",children:i?e.jsx(rt,{className:"w-4 h-4 animate-spin"}):e.jsx(ps,{className:"w-4 h-4"})})]}):e.jsx("button",{onClick:r,disabled:!l||a,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${l?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:a?e.jsxs(e.Fragment,{children:[e.jsx(rt,{className:"w-4 h-4 animate-spin"}),"נרשם..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-4 h-4"}),"הרשם"]})})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-3",children:[e.jsx(Ue,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:["מורה: ",f]})]}),(t.date||t.startTime)&&e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(he,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:[t.date&&new Date(t.date).toLocaleDateString("he-IL"),t.startTime&&t.endTime&&e.jsxs(e.Fragment,{children:[t.date?" • ":"",x(t.startTime)," - ",x(t.endTime)]})]})]})}),t.location&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-3",children:[e.jsx(Ke,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:t.location})]}),v&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-2",children:[e.jsx(Oe,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:[v.current," / ",v.total," תלמידים"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${v.percentage}%`}})})]}),!s&&e.jsxs(e.Fragment,{children:[t.isFull&&e.jsx("div",{className:"mb-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2 text-yellow-800",children:[e.jsx(tt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"השיעור מלא"})]})}),!t.gradeCompatible&&e.jsx("div",{className:"mb-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[e.jsx(tt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"לא מתאים לכיתה"})]})}),!t.levelCompatible&&e.jsx("div",{className:"mb-3 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2 text-orange-800",children:[e.jsx(tt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"רמה לא מתאימה"})]})})]}),t.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-3 pt-3 border-t",children:t.description}),t.targetGrades&&t.targetGrades.length>0&&e.jsx("div",{className:"mt-3 pt-3 border-t",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Zn,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["מיועד לכיתות: ",t.targetGrades.join(", ")]})]})})]})});Jt.displayName="LessonCard";const es=u.memo(({icon:t,title:s,description:r,actionLabel:n,onAction:a})=>e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:t}),e.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:s}),e.jsx("p",{className:"text-gray-500 mb-6",children:r}),n&&a&&e.jsx("button",{onClick:a,className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:n})]}));es.displayName="EmptyState";const ya=({student:t,studentId:s})=>{const[r,n]=u.useState("current"),[a,i]=u.useState(null),{data:o,isLoading:l,error:d}=vs(s),{data:m,isLoading:x}=bs(),f=u.useMemo(()=>t?.academicInfo?.class||o?.academicInfo?.class||"ז",[t,o]),v=u.useMemo(()=>t?.theoryLevel||o?.theoryLevel||"beginner",[t,o]),h=xa(s),b=fa(s,f,v),{enroll:c,unenroll:p,isEnrolling:N,isUnenrolling:y,error:w}=ha(s),T=u.useMemo(()=>C=>{c({lessonId:C})},[c]),P=u.useMemo(()=>C=>{p({lessonId:C}),i(null)},[p]),j=l||x,g=d||w;if(j)return e.jsx(br,{isLoading:!0,skeleton:e.jsx(ht.TabContent,{}),minHeight:"400px",children:e.jsx("div",{})});if(g)return e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"text-red-600 text-lg mb-2",children:"⚠️ שגיאה בטעינת הנתונים"}),e.jsx("div",{className:"text-gray-600 mb-4 text-sm",children:d?.message||w?.message||"אירעה שגיאה לא צפויה"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors text-sm",children:"נסה שוב"})]});const S=()=>h.length===0?e.jsx(es,{icon:e.jsx(ke,{className:"w-8 h-8 text-gray-300"}),title:"אין שיעורי תיאוריה רשומים",description:"התלמיד אינו רשום כרגע לשיעורי תיאוריה",actionLabel:"צפה בשיעורים זמינים",onAction:()=>n("manage")}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5 text-purple-600"}),"שיעורי תיאוריה רשומים (",h.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:h.map(C=>e.jsx(Jt,{lesson:C,isEnrolled:!0,onUnenroll:()=>i(C._id),isUnenrolling:y,studentGrade:f},C._id))})]}),A=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(we,{className:"w-5 h-5 text-green-600"}),"שיעורי תיאוריה זמינים להרשמה"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["כיתה: ",f," • רמה: ",v]})]}),b.length===0?e.jsx(es,{icon:e.jsx(ke,{className:"w-8 h-8 text-gray-300"}),title:"אין שיעורים זמינים",description:"כל השיעורים המתאימים מלאים או שכבר נרשמת אליהם"}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:b.map(C=>e.jsx(Jt,{lesson:C,isEnrolled:!1,onEnroll:()=>T(C._id),isEnrolling:N,studentGrade:f,canEnroll:C.isCompatible},C._id))})]});return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"שיעורי תיאוריה"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["ניהול הרשמות לשיעורי תיאוריה • כיתה: ",f," • רמה: ",v]})]}),e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>n("current"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${r==="current"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-4 h-4"}),"שיעורים רשומים (",h.length,")"]})}),e.jsx("button",{onClick:()=>n("manage"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${r==="manage"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"}),"הרשמה חדשה (",b.length,")"]})})]})]}),r==="current"?S():A(),a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"בטל הרשמה לשיעור תיאוריה"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"האם אתה בטוח שברצונך לבטל את ההרשמה לשיעור זה? פעולה זו לא ניתנת לביטול."}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>i(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"ביטול"}),e.jsx("button",{onClick:()=>P(a),disabled:y,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors flex items-center gap-2",children:y?e.jsxs(e.Fragment,{children:[e.jsx(rt,{className:"w-4 h-4 animate-spin"}),"מבטל..."]}):"בטל הרשמה"})]})]})})]})},Na=u.memo(ya),ja=({lessons:t,className:s=""})=>{const r=["ראשון","שני","שלישי","רביעי","חמישי","שישי"],n=t.reduce((l,d)=>(d.dayOfWeek>=0&&d.dayOfWeek<=5&&(l[d.dayOfWeek]||(l[d.dayOfWeek]=[]),l[d.dayOfWeek].push(d)),l),{});Object.keys(n).forEach(l=>{n[parseInt(l)].sort((d,m)=>{const x=d.startTime.split(":").map(Number),f=m.startTime.split(":").map(Number),v=x[0]*60+x[1],h=f[0]*60+f[1];return v-h})});const a=l=>{switch(l){case"individual":return"bg-gradient-to-r from-blue-500 to-blue-600 text-white border-blue-600";case"group":return"bg-gradient-to-r from-green-500 to-green-600 text-white border-green-600";case"orchestra":return"bg-gradient-to-r from-purple-500 to-purple-600 text-white border-purple-600";case"theory":return"bg-gradient-to-r from-orange-500 to-orange-600 text-white border-orange-600";default:return"bg-gradient-to-r from-gray-500 to-gray-600 text-white border-gray-600"}},i=l=>{switch(l){case"individual":return"שיעור אישי";case"group":return"שיעור קבוצתי";case"orchestra":return"תזמורת";case"theory":return"תיאוריה";default:return"שיעור"}},o=(l,d)=>{const[m,x]=l.split(":").map(Number),[f,v]=d.split(":").map(Number),h=m*60+x;return f*60+v-h};return e.jsxs("div",{className:`simple-weekly-grid ${s}`,children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"לוח זמנים שבועי"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.length===0?"אין שיעורים השבוע":t.length===1?"שיעור אחד השבוע":`${t.length} שיעורים השבוע`})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:r.map((l,d)=>{const m=n[d]||[];return e.jsxs("div",{className:"day-column",children:[e.jsxs("div",{className:"day-header bg-gray-50 rounded-t-lg px-4 py-3 border-b",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-center",children:l}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-1",children:m.length===0?"אין שיעורים":m.length===1?"שיעור אחד":`${m.length} שיעורים`})]}),e.jsx("div",{className:"day-content bg-white rounded-b-lg border border-t-0 border-gray-200 min-h-32",children:m.length===0?e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"text-gray-300 mb-2",children:e.jsx(Z,{className:"w-8 h-8 mx-auto"})}),e.jsx("p",{className:"text-gray-400 text-sm",children:"אין שיעורים"})]}):e.jsx("div",{className:"p-3 space-y-3",children:m.map(x=>e.jsxs("div",{className:`lesson-card rounded-lg p-4 border-2 shadow-sm hover:shadow-md transition-all duration-200 ${a(x.lessonType)}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h5",{className:"font-bold text-lg",children:x.instrumentName}),e.jsx("span",{className:"text-xs bg-white bg-opacity-20 px-2 py-1 rounded-full",children:i(x.lessonType)})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(he,{className:"w-4 h-4"}),e.jsxs("span",{className:"font-medium",children:[x.startTime," - ",x.endTime]}),e.jsxs("span",{className:"text-xs bg-white bg-opacity-20 px-2 py-1 rounded",children:[o(x.startTime,x.endTime),"ד'"]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:["מורה: ",x.teacherName]})]}),(x.roomNumber||x.location)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:x.roomNumber?`חדר ${x.roomNumber}`:x.location})]})]},x.id))})})]},d)})}),e.jsxs("div",{className:"legend bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"מקרא"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-blue-500 to-blue-600 rounded border"}),e.jsx("span",{className:"text-sm text-gray-700",children:"שיעורים אישיים"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-green-500 to-green-600 rounded border"}),e.jsx("span",{className:"text-sm text-gray-700",children:"שיעורים קבוצתיים"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-purple-500 to-purple-600 rounded border"}),e.jsx("span",{className:"text-sm text-gray-700",children:"תזמורות"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-orange-500 to-orange-600 rounded border"}),e.jsx("span",{className:"text-sm text-gray-700",children:"תיאוריה"})]})]})]})]})},wa=({student:t,studentId:s,isLoading:r})=>{const[n,a]=u.useState({});u.useEffect(()=>{(async()=>{if(t?.teacherAssignments&&t.teacherAssignments.length>0){const d=[...new Set(t.teacherAssignments.map(x=>x.teacherId).filter(Boolean))],m={};for(const x of d)try{const f=await B.teachers.getTeacherById(x);m[x]=f,console.log(`Fetched teacher ${x}:`,f.personalInfo?.fullName)}catch(f){console.error(`Failed to fetch teacher ${x}:`,f)}a(m)}})()},[t?.teacherAssignments]);const i=u.useMemo(()=>{const l=[];return console.log("Processing student data:",t),t?.teacherAssignments&&t.teacherAssignments.length>0&&t.teacherAssignments.forEach((d,m)=>{console.log(`Processing assignment ${m}:`,d);const f={ראשון:0,שני:1,שלישי:2,רביעי:3,חמישי:4,שישי:5,שבת:6}[d.day]??0,v=d.time||d.startTime||"14:30",h=(y,w)=>{const[T,P]=y.split(":").map(Number),j=T*60+P+w,g=Math.floor(j/60),S=j%60;return`${g.toString().padStart(2,"0")}:${S.toString().padStart(2,"0")}`},b=d.scheduleInfo?.endTime||h(v,d.duration||45),c=n[d.teacherId],p=c?.personalInfo?.fullName||d.scheduleInfo?.teacherName||d.teacherName||"מורה",N=c?.professionalInfo?.instrument||d.instrument||t?.academicInfo?.instrumentProgress?.[0]?.instrumentName||"כלי נגינה";l.push({id:d._id||d.teacherId||`lesson-${m}`,instrumentName:N,teacherName:p,teacherId:d.teacherId,startTime:v,endTime:b,dayOfWeek:f,location:d.location||d.scheduleInfo?.location,roomNumber:d.roomNumber||d.room,lessonType:d.lessonType||"individual"})}),t?.lessons&&t.lessons.length>0&&t.lessons.forEach((d,m)=>{console.log(`Processing lesson ${m}:`,d);const f=(d.teacherId?n[d.teacherId]:null)?.personalInfo?.fullName||d.teacherName||d.teacher?.personalInfo?.fullName||"מורה";l.push({id:d._id||`lesson-direct-${m}`,instrumentName:d.instrument||d.instrumentName||"כלי נגינה",teacherName:f,startTime:d.startTime||"14:30",endTime:d.endTime||"15:15",dayOfWeek:d.dayOfWeek??2,location:d.location,roomNumber:d.roomNumber||d.room,lessonType:d.lessonType||"individual"})}),l.length===0&&console.log("No lessons found, showing empty state"),console.log("Final lessons array:",l),l},[t?.teacherAssignments,t?.lessons,n]),o=u.useMemo(()=>t?.orchestraEnrollments?t.orchestraEnrollments.map(l=>({id:l._id||l.orchestraId,name:l.orchestraName||"תזמורת",status:l.status||"רשום"})):[],[t?.orchestraEnrollments]);return r?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse w-48"}),e.jsx("div",{className:"h-96 bg-gray-200 rounded animate-pulse"})]})}):e.jsxs("div",{className:"p-6 space-y-6 bg-white min-h-screen w-full max-w-full overflow-hidden student-content-area",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"לוח זמנים שבועי"}),e.jsx("p",{className:"text-gray-600 mt-1",children:i.length===0?"אין שיעורים מתוכננים":i.length===1?"שיעור אחד בשבוע":`${i.length} שיעורים בשבוע`})]}),i.length>0?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 w-full max-w-full overflow-hidden",children:e.jsx(ja,{lessons:i})}):e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center",children:[e.jsx(Ot,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"אין שיעורים מתוכננים"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"התלמיד עדיין לא שוייך למורים או שלא הוגדרו לו שיעורים קבועים"}),e.jsx("div",{className:"text-sm text-gray-500",children:"ניתן לשייך מורים ולהגדיר שיעורים דרך המערכת"})]}),i.length>0&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5 text-primary-600"}),"שיעורים השבוע"]}),e.jsx("div",{className:"space-y-3",children:i.map(l=>{const d=["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת"];return e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"w-4 h-4 text-primary-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:l.instrumentName})]}),e.jsx("span",{className:"text-sm text-gray-600 font-medium",children:d[l.dayOfWeek]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(he,{className:"w-3 h-3"}),e.jsxs("span",{children:[l.startTime," - ",l.endTime]})]}),(l.roomNumber||l.location)&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ke,{className:"w-3 h-3"}),e.jsx("span",{children:l.roomNumber?`חדר ${l.roomNumber}`:l.location})]})]}),e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:["מורה: ",l.teacherName]})]},l.id)})})]}),o.length>0&&e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Oe,{className:"w-5 h-5 text-purple-600"}),"תזמורות ופעילויות"]}),e.jsx("div",{className:"space-y-3",children:o.map(l=>e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Oe,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:l.name})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${l.status==="רשום"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:l.status})]}),e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:"לוח זמנים יפורסם בהמשך"})]},l.id))})]}),o.length===0&&e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Oe,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"אין תזמורות"}),e.jsx("p",{className:"text-gray-600",children:"לא נרשמת עדיין לתזמורות או פעילויות קבוצתיות"})]})})]}),i.length===0&&o.length>0&&e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Oe,{className:"w-5 h-5 text-purple-600"}),"תזמורות ופעילויות"]}),e.jsx("div",{className:"space-y-3",children:o.map(l=>e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Oe,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:l.name})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${l.status==="רשום"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:l.status})]}),e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:"לוח זמנים יפורסם בהמשך"})]},l.id))})]})]})},Sa=({student:t,studentId:s,isLoading:r})=>{const[n,a]=u.useState("current"),[i,o]=u.useState([]),[l,d]=u.useState([]),[m,x]=u.useState(!1),[f,v]=u.useState(null),[h,b]=u.useState(null),c=t?.teacherAssignments?.[0]?.instrument||"חצוצרה",p=t?.academicInfo?.class||"ז";u.useEffect(()=>{(async()=>{try{x(!0);const S=(await B.orchestras.getOrchestras()).filter(O=>O.memberIds?.includes(s)),A=t?.enrollments?.orchestraIds||[],C=new Set([...A,...S.map(O=>O._id)]);if(C.size===0){o([]);return}const E=Array.from(C).map(async O=>{try{return{...await B.orchestras.getOrchestra(O),enrollmentStatus:"enrolled"}}catch(D){console.warn(`Failed to fetch orchestra ${O}:`,D);const _=S.find(I=>I._id===O);return _?{..._,enrollmentStatus:"enrolled"}:{_id:O,name:"תזמורת לא זמינה",error:!0,enrollmentStatus:"enrolled"}}}),L=await Promise.all(E);o(L),console.log(`Found ${L.length} enrolled orchestras for student ${s}`)}catch(g){console.error("Error fetching enrolled orchestras:",g)}finally{x(!1)}})()},[t?.enrollments?.orchestraIds,s]),u.useEffect(()=>{(async()=>{if(n==="manage")try{x(!0);const g=await B.orchestras.getOrchestras(),A=g.map(C=>{const E=t?.enrollments?.orchestraIds?.includes(C._id)||C.memberIds?.includes(s);let L=!0;C.requiredInstruments&&C.requiredInstruments.length>0&&(L=C.requiredInstruments.includes(c));let O=!0;return C.gradeRequirements&&C.gradeRequirements.length>0&&(O=C.gradeRequirements.includes(p)),{...C,isEnrolled:E,instrumentCompatible:L,gradeCompatible:O,isCompatible:L&&O}}).filter(C=>!C.isEnrolled);console.log("All orchestras:",g.length,"Available:",A.length),d(A)}catch(g){console.error("Error fetching available orchestras:",g),d([])}finally{x(!1)}})()},[n,t?.enrollments?.orchestraIds,c,p,s]);const N=j=>{if(!j||!t?.teacherAssignments)return!1;const g=2,S="14:30",A="15:15";return j.some(C=>{if(C.dayOfWeek!==g)return!1;const E=C.startTime,L=C.endTime;return E<A&&L>S})},y=async j=>{try{v(j);const g=[...t.enrollments?.orchestraIds||[],j];await B.students.updateStudent(s,{enrollments:{...t.enrollments,orchestraIds:g}});try{await B.orchestras.addMember(j,s),console.log(`Added student ${s} to orchestra ${j} memberIds`)}catch(A){console.error(`Failed to update orchestra ${j} memberIds:`,A)}const S=l.find(A=>A._id===j);S&&(o(A=>[...A,{...S,enrollmentStatus:"enrolled"}]),d(A=>A.filter(C=>C._id!==j))),console.log(`Successfully enrolled in orchestra ${j}`)}catch(g){console.error("Error enrolling in orchestra:",g)}finally{v(null)}},w=async j=>{try{v(j);const g=(t.enrollments?.orchestraIds||[]).filter(A=>A!==j);await B.students.updateStudent(s,{enrollments:{...t.enrollments,orchestraIds:g}});try{await B.orchestras.removeMember(j,s),console.log(`Removed student ${s} from orchestra ${j} memberIds`)}catch(A){console.error(`Failed to update orchestra ${j} memberIds:`,A)}const S=i.find(A=>A._id===j);S&&!S.error&&d(A=>[...A,S]),o(A=>A.filter(C=>C._id!==j)),console.log(`Successfully unenrolled from orchestra ${j}`)}catch(g){console.error("Error unenrolling from orchestra:",g)}finally{v(null),b(null)}};if(r)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse w-48"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-24 bg-gray-200 rounded animate-pulse"})]})});const T=()=>m?e.jsx("div",{className:"space-y-4",children:[1,2].map(j=>e.jsx("div",{className:"bg-gray-200 rounded-lg h-48 animate-pulse"},j))}):i.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Z,{className:"w-8 h-8 text-gray-300"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"אין הרשמות קיימות"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"התלמיד אינו רשום כרגע לתזמורות"}),e.jsx("button",{onClick:()=>a("manage"),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:"צפה בתזמורות זמינות"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5 text-purple-600"}),"תזמורות רשומות (",i.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:i.map(j=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-xl font-semibold text-gray-900",children:j.name}),j.conductor&&e.jsxs("p",{className:"text-gray-600 mt-1",children:["מנצח: ",typeof j.conductor=="string"?j.conductor:j.conductor.personalInfo?.name||"לא ידוע"]}),j.error&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:"שגיאה בטעינת פרטי התזמורת"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"inline-flex items-center px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"רשום"]}),e.jsx("button",{onClick:()=>b(j._id),disabled:f===j._id,className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"בטל הרשמה",children:e.jsx(ps,{className:"w-4 h-4"})})]})]}),j.description&&e.jsx("p",{className:"text-gray-600 mb-4",children:j.description}),j.rehearsalSchedule&&j.rehearsalSchedule.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h5",{className:"font-medium text-gray-700 mb-2 flex items-center gap-1",children:[e.jsx(he,{className:"w-4 h-4"}),"זמני חזרות"]}),e.jsx("div",{className:"space-y-1",children:j.rehearsalSchedule.map((g,S)=>e.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded flex items-center gap-2",children:[e.jsx("span",{children:g.day||`יום ${S+1}`}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[g.startTime," - ",g.endTime]}),g.location&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx(Ke,{className:"w-3 h-3"}),e.jsx("span",{children:g.location})]})]},S))})]}),j.capacity&&e.jsxs("div",{className:"text-sm text-gray-600",children:["קיבולת: ",j.currentMembers||0," / ",j.capacity," חברים"]})]},j._id))})]}),P=()=>m?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(j=>e.jsx("div",{className:"bg-gray-200 rounded-lg h-32 animate-pulse"},j))}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(we,{className:"w-5 h-5 text-green-600"}),"תזמורות זמינות להרשמה"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["מציג תזמורות התואמות לכלי: ",c]})]}),l.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Z,{className:"w-8 h-8 text-gray-300"})}),e.jsx("h4",{className:"text-lg font-medium text-gray-600 mb-2",children:"אין תזמורות זמינות"}),e.jsx("p",{className:"text-gray-500",children:"כל התזמורות התואמות לכלי שלך מלאות או שכבר נרשמת אליהן"})]}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:l.map(j=>{const g=N(j.rehearsalSchedule),S=j.capacity&&j.currentMembers>=j.capacity,A=!g&&!S&&j.isCompatible;return e.jsxs("div",{className:`bg-white rounded-xl border p-6 hover:shadow-md transition-shadow ${A?"border-gray-200":"border-gray-200 opacity-75"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-xl font-semibold text-gray-900",children:j.name}),j.conductor&&e.jsxs("p",{className:"text-gray-600 mt-1",children:["מנצח: ",typeof j.conductor=="string"?j.conductor:j.conductor.personalInfo?.name||"לא ידוע"]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[j.level&&e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${j.level==="beginner"?"bg-green-100 text-green-800":j.level==="intermediate"?"bg-yellow-100 text-yellow-800":j.level==="advanced"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:j.level==="beginner"?"מתחילים":j.level==="intermediate"?"בינוני":j.level==="advanced"?"מתקדמים":"מעורב"}),j.gradeRequirements&&j.gradeRequirements.includes(p)&&e.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:["מתאים לכיתה ",p]})]})]}),e.jsx("button",{onClick:()=>y(j._id),disabled:!A||f===j._id,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${A?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:f===j._id?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"נרשם..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-4 h-4"}),"הרשם"]})})]}),j.description&&e.jsx("p",{className:"text-gray-600 mb-4",children:j.description}),g&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[e.jsx(tt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"התנגשות בלוח זמנים"})]}),e.jsx("p",{className:"text-red-700 text-sm mt-1",children:"זמני החזרות מתנגשים עם השיעור שלך בימי שלישי 14:30-15:15"})]}),S&&e.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-800",children:[e.jsx(tt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"התזמורת מלאה"})]}),e.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"כל המקומות בתזמורת תפוסים"})]}),j.rehearsalSchedule&&j.rehearsalSchedule.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h5",{className:"font-medium text-gray-700 mb-2 flex items-center gap-1",children:[e.jsx(he,{className:"w-4 h-4"}),"זמני חזרות"]}),e.jsx("div",{className:"space-y-1",children:j.rehearsalSchedule.map((C,E)=>e.jsxs("div",{className:`text-sm p-2 rounded flex items-center gap-2 ${g?"bg-red-50 text-red-700":"bg-gray-50 text-gray-600"}`,children:[e.jsx("span",{children:C.day||`יום ${E+1}`}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[C.startTime," - ",C.endTime]}),C.location&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx(Ke,{className:"w-3 h-3"}),e.jsx("span",{children:C.location})]})]},E))})]}),j.requiredInstruments&&j.requiredInstruments.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"font-medium text-gray-700 mb-2",children:"כלים נדרשים"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:j.requiredInstruments.map((C,E)=>e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${C===c?"bg-green-100 text-green-800 ring-1 ring-green-300":"bg-gray-100 text-gray-700"}`,children:C},E))})]}),j.capacity&&e.jsxs("div",{className:"text-sm text-gray-600",children:["קיבולת: ",j.currentMembers||0," / ",j.capacity," חברים"]})]},j._id)})})]});return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"תזמורות והרכבים"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["ניהול הרשמות לתזמורות במוסיקה • כלי: ",c," • כיתה: ",p]})]}),e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>a("current"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${n==="current"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-4 h-4"}),"הרשמות קיימות"]})}),e.jsx("button",{onClick:()=>a("manage"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${n==="manage"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"}),"הרשמה חדשה"]})})]})]}),n==="current"?T():P(),h&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"בטל הרשמה לתזמורת"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"האם אתה בטוח שברצונך לבטל את ההרשמה לתזמורת זו? פעולה זו לא ניתנת לביטול."}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>b(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"ביטול"}),e.jsx("button",{onClick:()=>w(h),disabled:f===h,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors flex items-center gap-2",children:f===h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"מבטל..."]}):"בטל הרשמה"})]})]})})]})};function Bs(t,s){if(typeof t=="function")return t(s);t!=null&&(t.current=s)}function yr(...t){return s=>{let r=!1;const n=t.map(a=>{const i=Bs(a,s);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():Bs(t[a],null)}}}}function q(...t){return u.useCallback(yr(...t),t)}function nt(t){const s=Ea(t),r=u.forwardRef((n,a)=>{const{children:i,...o}=n,l=u.Children.toArray(i),d=l.find(Aa);if(d){const m=d.props.children,x=l.map(f=>f===d?u.Children.count(m)>1?u.Children.only(null):u.isValidElement(m)?m.props.children:null:f);return e.jsx(s,{...o,ref:a,children:u.isValidElement(m)?u.cloneElement(m,void 0,x):null})}return e.jsx(s,{...o,ref:a,children:i})});return r.displayName=`${t}.Slot`,r}var Ca=nt("Slot");function Ea(t){const s=u.forwardRef((r,n)=>{const{children:a,...i}=r;if(u.isValidElement(a)){const o=Ra(a),l=Pa(i,a.props);return a.type!==u.Fragment&&(l.ref=n?yr(n,o):o),u.cloneElement(a,l)}return u.Children.count(a)>1?u.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var Ta=Symbol("radix.slottable");function Aa(t){return u.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Ta}function Pa(t,s){const r={...s};for(const n in s){const a=t[n],i=s[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{const d=i(...l);return a(...l),d}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...t,...r}}function Ra(t){let s=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}const Hs=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Ws=ma,kt=(t,s)=>r=>{var n;if(s?.variants==null)return Ws(t,r?.class,r?.className);const{variants:a,defaultVariants:i}=s,o=Object.keys(a).map(m=>{const x=r?.[m],f=i?.[m];if(x===null)return null;const v=Hs(x)||Hs(f);return a[m][v]}),l=r&&Object.entries(r).reduce((m,x)=>{let[f,v]=x;return v===void 0||(m[f]=v),m},{}),d=s==null||(n=s.compoundVariants)===null||n===void 0?void 0:n.reduce((m,x)=>{let{class:f,className:v,...h}=x;return Object.entries(h).every(b=>{let[c,p]=b;return Array.isArray(p)?p.includes({...i,...l}[c]):{...i,...l}[c]===p})?[...m,f,v]:m},[]);return Ws(t,o,d,r?.class,r?.className)},Oa=kt("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ys=u.forwardRef(({className:t,variant:s,size:r,asChild:n=!1,...a},i)=>{const o=n?Ca:"button";return e.jsx(o,{className:X(Oa({variant:s,size:r,className:t})),ref:i,...a})});ys.displayName="Button";const U=u.forwardRef(({className:t,type:s,...r},n)=>e.jsx("input",{type:s,className:X("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...r}));U.displayName="Input";var ka=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],K=ka.reduce((t,s)=>{const r=nt(`Primitive.${s}`),n=u.forwardRef((a,i)=>{const{asChild:o,...l}=a,d=o?r:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...l,ref:i})});return n.displayName=`Primitive.${s}`,{...t,[s]:n}},{});function La(t,s){t&&Rt.flushSync(()=>t.dispatchEvent(s))}var Ia="Label",Nr=u.forwardRef((t,s)=>e.jsx(K.label,{...t,ref:s,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(t.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));Nr.displayName=Ia;var jr=Nr;const Da=kt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),z=u.forwardRef(({className:t,...s},r)=>e.jsx(jr,{ref:r,className:X(Da(),t),...s}));z.displayName=jr.displayName;function Vs(t,[s,r]){return Math.min(r,Math.max(s,t))}function G(t,s,{checkForDefaultPrevented:r=!0}={}){return function(a){if(t?.(a),r===!1||!a.defaultPrevented)return s?.(a)}}function Ns(t,s=[]){let r=[];function n(i,o){const l=u.createContext(o),d=r.length;r=[...r,o];const m=f=>{const{scope:v,children:h,...b}=f,c=v?.[t]?.[d]||l,p=u.useMemo(()=>b,Object.values(b));return e.jsx(c.Provider,{value:p,children:h})};m.displayName=i+"Provider";function x(f,v){const h=v?.[t]?.[d]||l,b=u.useContext(h);if(b)return b;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[m,x]}const a=()=>{const i=r.map(o=>u.createContext(o));return function(l){const d=l?.[t]||i;return u.useMemo(()=>({[`__scope${t}`]:{...l,[t]:d}}),[l,d])}};return a.scopeName=t,[n,Ma(a,...s)]}function Ma(...t){const s=t[0];if(t.length===1)return s;const r=()=>{const n=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((l,{useScope:d,scopeName:m})=>{const f=d(i)[`__scope${m}`];return{...l,...f}},{});return u.useMemo(()=>({[`__scope${s.scopeName}`]:o}),[o])}};return r.scopeName=s.scopeName,r}function _a(t){const s=t+"CollectionProvider",[r,n]=Ns(s),[a,i]=r(s,{collectionRef:{current:null},itemMap:new Map}),o=c=>{const{scope:p,children:N}=c,y=Ne.useRef(null),w=Ne.useRef(new Map).current;return e.jsx(a,{scope:p,itemMap:w,collectionRef:y,children:N})};o.displayName=s;const l=t+"CollectionSlot",d=nt(l),m=Ne.forwardRef((c,p)=>{const{scope:N,children:y}=c,w=i(l,N),T=q(p,w.collectionRef);return e.jsx(d,{ref:T,children:y})});m.displayName=l;const x=t+"CollectionItemSlot",f="data-radix-collection-item",v=nt(x),h=Ne.forwardRef((c,p)=>{const{scope:N,children:y,...w}=c,T=Ne.useRef(null),P=q(p,T),j=i(x,N);return Ne.useEffect(()=>(j.itemMap.set(T,{ref:T,...w}),()=>void j.itemMap.delete(T))),e.jsx(v,{[f]:"",ref:P,children:y})});h.displayName=x;function b(c){const p=i(t+"CollectionConsumer",c);return Ne.useCallback(()=>{const y=p.collectionRef.current;if(!y)return[];const w=Array.from(y.querySelectorAll(`[${f}]`));return Array.from(p.itemMap.values()).sort((j,g)=>w.indexOf(j.ref.current)-w.indexOf(g.ref.current))},[p.collectionRef,p.itemMap])}return[{Provider:o,Slot:m,ItemSlot:h},b,n]}var Fa=u.createContext(void 0);function $a(t){const s=u.useContext(Fa);return t||s||"ltr"}function Le(t){const s=u.useRef(t);return u.useEffect(()=>{s.current=t}),u.useMemo(()=>(...r)=>s.current?.(...r),[])}function Ba(t,s=globalThis?.document){const r=Le(t);u.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return s.addEventListener("keydown",n,{capture:!0}),()=>s.removeEventListener("keydown",n,{capture:!0})},[r,s])}var Ha="DismissableLayer",ts="dismissableLayer.update",Wa="dismissableLayer.pointerDownOutside",Va="dismissableLayer.focusOutside",Us,wr=u.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Sr=u.forwardRef((t,s)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...d}=t,m=u.useContext(wr),[x,f]=u.useState(null),v=x?.ownerDocument??globalThis?.document,[,h]=u.useState({}),b=q(s,g=>f(g)),c=Array.from(m.layers),[p]=[...m.layersWithOutsidePointerEventsDisabled].slice(-1),N=c.indexOf(p),y=x?c.indexOf(x):-1,w=m.layersWithOutsidePointerEventsDisabled.size>0,T=y>=N,P=Ya(g=>{const S=g.target,A=[...m.branches].some(C=>C.contains(S));!T||A||(a?.(g),o?.(g),g.defaultPrevented||l?.())},v),j=Ga(g=>{const S=g.target;[...m.branches].some(C=>C.contains(S))||(i?.(g),o?.(g),g.defaultPrevented||l?.())},v);return Ba(g=>{y===m.layers.size-1&&(n?.(g),!g.defaultPrevented&&l&&(g.preventDefault(),l()))},v),u.useEffect(()=>{if(x)return r&&(m.layersWithOutsidePointerEventsDisabled.size===0&&(Us=v.body.style.pointerEvents,v.body.style.pointerEvents="none"),m.layersWithOutsidePointerEventsDisabled.add(x)),m.layers.add(x),Ks(),()=>{r&&m.layersWithOutsidePointerEventsDisabled.size===1&&(v.body.style.pointerEvents=Us)}},[x,v,r,m]),u.useEffect(()=>()=>{x&&(m.layers.delete(x),m.layersWithOutsidePointerEventsDisabled.delete(x),Ks())},[x,m]),u.useEffect(()=>{const g=()=>h({});return document.addEventListener(ts,g),()=>document.removeEventListener(ts,g)},[]),e.jsx(K.div,{...d,ref:b,style:{pointerEvents:w?T?"auto":"none":void 0,...t.style},onFocusCapture:G(t.onFocusCapture,j.onFocusCapture),onBlurCapture:G(t.onBlurCapture,j.onBlurCapture),onPointerDownCapture:G(t.onPointerDownCapture,P.onPointerDownCapture)})});Sr.displayName=Ha;var Ua="DismissableLayerBranch",Ka=u.forwardRef((t,s)=>{const r=u.useContext(wr),n=u.useRef(null),a=q(s,n);return u.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),e.jsx(K.div,{...t,ref:a})});Ka.displayName=Ua;function Ya(t,s=globalThis?.document){const r=Le(t),n=u.useRef(!1),a=u.useRef(()=>{});return u.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let d=function(){Cr(Wa,r,m,{discrete:!0})};const m={originalEvent:l};l.pointerType==="touch"?(s.removeEventListener("click",a.current),a.current=d,s.addEventListener("click",a.current,{once:!0})):d()}else s.removeEventListener("click",a.current);n.current=!1},o=window.setTimeout(()=>{s.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),s.removeEventListener("pointerdown",i),s.removeEventListener("click",a.current)}},[s,r]),{onPointerDownCapture:()=>n.current=!0}}function Ga(t,s=globalThis?.document){const r=Le(t),n=u.useRef(!1);return u.useEffect(()=>{const a=i=>{i.target&&!n.current&&Cr(Va,r,{originalEvent:i},{discrete:!1})};return s.addEventListener("focusin",a),()=>s.removeEventListener("focusin",a)},[s,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Ks(){const t=new CustomEvent(ts);document.dispatchEvent(t)}function Cr(t,s,r,{discrete:n}){const a=r.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});s&&a.addEventListener(t,s,{once:!0}),n?La(a,i):a.dispatchEvent(i)}var Ut=0;function za(){u.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Ys()),document.body.insertAdjacentElement("beforeend",t[1]??Ys()),Ut++,()=>{Ut===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(s=>s.remove()),Ut--}},[])}function Ys(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Kt="focusScope.autoFocusOnMount",Yt="focusScope.autoFocusOnUnmount",Gs={bubbles:!1,cancelable:!0},qa="FocusScope",Er=u.forwardRef((t,s)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...o}=t,[l,d]=u.useState(null),m=Le(a),x=Le(i),f=u.useRef(null),v=q(s,c=>d(c)),h=u.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;u.useEffect(()=>{if(n){let c=function(w){if(h.paused||!l)return;const T=w.target;l.contains(T)?f.current=T:je(f.current,{select:!0})},p=function(w){if(h.paused||!l)return;const T=w.relatedTarget;T!==null&&(l.contains(T)||je(f.current,{select:!0}))},N=function(w){if(document.activeElement===document.body)for(const P of w)P.removedNodes.length>0&&je(l)};document.addEventListener("focusin",c),document.addEventListener("focusout",p);const y=new MutationObserver(N);return l&&y.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",c),document.removeEventListener("focusout",p),y.disconnect()}}},[n,l,h.paused]),u.useEffect(()=>{if(l){qs.add(h);const c=document.activeElement;if(!l.contains(c)){const N=new CustomEvent(Kt,Gs);l.addEventListener(Kt,m),l.dispatchEvent(N),N.defaultPrevented||(Xa(tl(Tr(l)),{select:!0}),document.activeElement===c&&je(l))}return()=>{l.removeEventListener(Kt,m),setTimeout(()=>{const N=new CustomEvent(Yt,Gs);l.addEventListener(Yt,x),l.dispatchEvent(N),N.defaultPrevented||je(c??document.body,{select:!0}),l.removeEventListener(Yt,x),qs.remove(h)},0)}}},[l,m,x,h]);const b=u.useCallback(c=>{if(!r&&!n||h.paused)return;const p=c.key==="Tab"&&!c.altKey&&!c.ctrlKey&&!c.metaKey,N=document.activeElement;if(p&&N){const y=c.currentTarget,[w,T]=Qa(y);w&&T?!c.shiftKey&&N===T?(c.preventDefault(),r&&je(w,{select:!0})):c.shiftKey&&N===w&&(c.preventDefault(),r&&je(T,{select:!0})):N===y&&c.preventDefault()}},[r,n,h.paused]);return e.jsx(K.div,{tabIndex:-1,...o,ref:v,onKeyDown:b})});Er.displayName=qa;function Xa(t,{select:s=!1}={}){const r=document.activeElement;for(const n of t)if(je(n,{select:s}),document.activeElement!==r)return}function Qa(t){const s=Tr(t),r=zs(s,t),n=zs(s.reverse(),t);return[r,n]}function Tr(t){const s=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)s.push(r.currentNode);return s}function zs(t,s){for(const r of t)if(!Za(r,{upTo:s}))return r}function Za(t,{upTo:s}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(s!==void 0&&t===s)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Ja(t){return t instanceof HTMLInputElement&&"select"in t}function je(t,{select:s=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&Ja(t)&&s&&t.select()}}var qs=el();function el(){let t=[];return{add(s){const r=t[0];s!==r&&r?.pause(),t=Xs(t,s),t.unshift(s)},remove(s){t=Xs(t,s),t[0]?.resume()}}}function Xs(t,s){const r=[...t],n=r.indexOf(s);return n!==-1&&r.splice(n,1),r}function tl(t){return t.filter(s=>s.tagName!=="A")}var te=globalThis?.document?u.useLayoutEffect:()=>{},sl=fr[" useId ".trim().toString()]||(()=>{}),rl=0;function js(t){const[s,r]=u.useState(sl());return te(()=>{r(n=>n??String(rl++))},[t]),s?`radix-${s}`:""}const nl=["top","right","bottom","left"],at=Math.min,Re=Math.max,al={left:"right",right:"left",bottom:"top",top:"bottom"},ll={start:"end",end:"start"};function ss(t,s,r){return Re(t,at(s,r))}function ge(t,s){return typeof t=="function"?t(s):t}function pe(t){return t.split("-")[0]}function Ge(t){return t.split("-")[1]}function ws(t){return t==="x"?"y":"x"}function Ss(t){return t==="y"?"height":"width"}const il=new Set(["top","bottom"]);function ce(t){return il.has(pe(t))?"y":"x"}function Cs(t){return ws(ce(t))}function ol(t,s,r){r===void 0&&(r=!1);const n=Ge(t),a=Cs(t),i=Ss(a);let o=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return s.reference[i]>s.floating[i]&&(o=wt(o)),[o,wt(o)]}function cl(t){const s=wt(t);return[rs(t),s,rs(s)]}function rs(t){return t.replace(/start|end/g,s=>ll[s])}const Qs=["left","right"],Zs=["right","left"],dl=["top","bottom"],ul=["bottom","top"];function ml(t,s,r){switch(t){case"top":case"bottom":return r?s?Zs:Qs:s?Qs:Zs;case"left":case"right":return s?dl:ul;default:return[]}}function xl(t,s,r,n){const a=Ge(t);let i=ml(pe(t),r==="start",n);return a&&(i=i.map(o=>o+"-"+a),s&&(i=i.concat(i.map(rs)))),i}function wt(t){return t.replace(/left|right|bottom|top/g,s=>al[s])}function fl(t){return{top:0,right:0,bottom:0,left:0,...t}}function Ar(t){return typeof t!="number"?fl(t):{top:t,right:t,bottom:t,left:t}}function St(t){const{x:s,y:r,width:n,height:a}=t;return{width:n,height:a,top:r,left:s,right:s+n,bottom:r+a,x:s,y:r}}function Js(t,s,r){let{reference:n,floating:a}=t;const i=ce(s),o=Cs(s),l=Ss(o),d=pe(s),m=i==="y",x=n.x+n.width/2-a.width/2,f=n.y+n.height/2-a.height/2,v=n[l]/2-a[l]/2;let h;switch(d){case"top":h={x,y:n.y-a.height};break;case"bottom":h={x,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:f};break;case"left":h={x:n.x-a.width,y:f};break;default:h={x:n.x,y:n.y}}switch(Ge(s)){case"start":h[o]-=v*(r&&m?-1:1);break;case"end":h[o]+=v*(r&&m?-1:1);break}return h}const hl=async(t,s,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:i=[],platform:o}=r,l=i.filter(Boolean),d=await(o.isRTL==null?void 0:o.isRTL(s));let m=await o.getElementRects({reference:t,floating:s,strategy:a}),{x,y:f}=Js(m,n,d),v=n,h={},b=0;for(let c=0;c<l.length;c++){const{name:p,fn:N}=l[c],{x:y,y:w,data:T,reset:P}=await N({x,y:f,initialPlacement:n,placement:v,strategy:a,middlewareData:h,rects:m,platform:o,elements:{reference:t,floating:s}});x=y??x,f=w??f,h={...h,[p]:{...h[p],...T}},P&&b<=50&&(b++,typeof P=="object"&&(P.placement&&(v=P.placement),P.rects&&(m=P.rects===!0?await o.getElementRects({reference:t,floating:s,strategy:a}):P.rects),{x,y:f}=Js(m,v,d)),c=-1)}return{x,y:f,placement:v,strategy:a,middlewareData:h}};async function lt(t,s){var r;s===void 0&&(s={});const{x:n,y:a,platform:i,rects:o,elements:l,strategy:d}=t,{boundary:m="clippingAncestors",rootBoundary:x="viewport",elementContext:f="floating",altBoundary:v=!1,padding:h=0}=ge(s,t),b=Ar(h),p=l[v?f==="floating"?"reference":"floating":f],N=St(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(p)))==null||r?p:p.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:m,rootBoundary:x,strategy:d})),y=f==="floating"?{x:n,y:a,width:o.floating.width,height:o.floating.height}:o.reference,w=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),T=await(i.isElement==null?void 0:i.isElement(w))?await(i.getScale==null?void 0:i.getScale(w))||{x:1,y:1}:{x:1,y:1},P=St(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:y,offsetParent:w,strategy:d}):y);return{top:(N.top-P.top+b.top)/T.y,bottom:(P.bottom-N.bottom+b.bottom)/T.y,left:(N.left-P.left+b.left)/T.x,right:(P.right-N.right+b.right)/T.x}}const gl=t=>({name:"arrow",options:t,async fn(s){const{x:r,y:n,placement:a,rects:i,platform:o,elements:l,middlewareData:d}=s,{element:m,padding:x=0}=ge(t,s)||{};if(m==null)return{};const f=Ar(x),v={x:r,y:n},h=Cs(a),b=Ss(h),c=await o.getDimensions(m),p=h==="y",N=p?"top":"left",y=p?"bottom":"right",w=p?"clientHeight":"clientWidth",T=i.reference[b]+i.reference[h]-v[h]-i.floating[b],P=v[h]-i.reference[h],j=await(o.getOffsetParent==null?void 0:o.getOffsetParent(m));let g=j?j[w]:0;(!g||!await(o.isElement==null?void 0:o.isElement(j)))&&(g=l.floating[w]||i.floating[b]);const S=T/2-P/2,A=g/2-c[b]/2-1,C=at(f[N],A),E=at(f[y],A),L=C,O=g-c[b]-E,D=g/2-c[b]/2+S,_=ss(L,D,O),I=!d.arrow&&Ge(a)!=null&&D!==_&&i.reference[b]/2-(D<L?C:E)-c[b]/2<0,M=I?D<L?D-L:D-O:0;return{[h]:v[h]+M,data:{[h]:_,centerOffset:D-_-M,...I&&{alignmentOffset:M}},reset:I}}}),pl=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(s){var r,n;const{placement:a,middlewareData:i,rects:o,initialPlacement:l,platform:d,elements:m}=s,{mainAxis:x=!0,crossAxis:f=!0,fallbackPlacements:v,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:c=!0,...p}=ge(t,s);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const N=pe(a),y=ce(l),w=pe(l)===l,T=await(d.isRTL==null?void 0:d.isRTL(m.floating)),P=v||(w||!c?[wt(l)]:cl(l)),j=b!=="none";!v&&j&&P.push(...xl(l,c,b,T));const g=[l,...P],S=await lt(s,p),A=[];let C=((n=i.flip)==null?void 0:n.overflows)||[];if(x&&A.push(S[N]),f){const D=ol(a,o,T);A.push(S[D[0]],S[D[1]])}if(C=[...C,{placement:a,overflows:A}],!A.every(D=>D<=0)){var E,L;const D=(((E=i.flip)==null?void 0:E.index)||0)+1,_=g[D];if(_&&(!(f==="alignment"?y!==ce(_):!1)||C.every(k=>ce(k.placement)===y?k.overflows[0]>0:!0)))return{data:{index:D,overflows:C},reset:{placement:_}};let I=(L=C.filter(M=>M.overflows[0]<=0).sort((M,k)=>M.overflows[1]-k.overflows[1])[0])==null?void 0:L.placement;if(!I)switch(h){case"bestFit":{var O;const M=(O=C.filter(k=>{if(j){const F=ce(k.placement);return F===y||F==="y"}return!0}).map(k=>[k.placement,k.overflows.filter(F=>F>0).reduce((F,J)=>F+J,0)]).sort((k,F)=>k[1]-F[1])[0])==null?void 0:O[0];M&&(I=M);break}case"initialPlacement":I=l;break}if(a!==I)return{reset:{placement:I}}}return{}}}};function er(t,s){return{top:t.top-s.height,right:t.right-s.width,bottom:t.bottom-s.height,left:t.left-s.width}}function tr(t){return nl.some(s=>t[s]>=0)}const vl=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(s){const{rects:r}=s,{strategy:n="referenceHidden",...a}=ge(t,s);switch(n){case"referenceHidden":{const i=await lt(s,{...a,elementContext:"reference"}),o=er(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:tr(o)}}}case"escaped":{const i=await lt(s,{...a,altBoundary:!0}),o=er(i,r.floating);return{data:{escapedOffsets:o,escaped:tr(o)}}}default:return{}}}}},Pr=new Set(["left","top"]);async function bl(t,s){const{placement:r,platform:n,elements:a}=t,i=await(n.isRTL==null?void 0:n.isRTL(a.floating)),o=pe(r),l=Ge(r),d=ce(r)==="y",m=Pr.has(o)?-1:1,x=i&&d?-1:1,f=ge(s,t);let{mainAxis:v,crossAxis:h,alignmentAxis:b}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return l&&typeof b=="number"&&(h=l==="end"?b*-1:b),d?{x:h*x,y:v*m}:{x:v*m,y:h*x}}const yl=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(s){var r,n;const{x:a,y:i,placement:o,middlewareData:l}=s,d=await bl(s,t);return o===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:a+d.x,y:i+d.y,data:{...d,placement:o}}}}},Nl=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(s){const{x:r,y:n,placement:a}=s,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:p=>{let{x:N,y}=p;return{x:N,y}}},...d}=ge(t,s),m={x:r,y:n},x=await lt(s,d),f=ce(pe(a)),v=ws(f);let h=m[v],b=m[f];if(i){const p=v==="y"?"top":"left",N=v==="y"?"bottom":"right",y=h+x[p],w=h-x[N];h=ss(y,h,w)}if(o){const p=f==="y"?"top":"left",N=f==="y"?"bottom":"right",y=b+x[p],w=b-x[N];b=ss(y,b,w)}const c=l.fn({...s,[v]:h,[f]:b});return{...c,data:{x:c.x-r,y:c.y-n,enabled:{[v]:i,[f]:o}}}}}},jl=function(t){return t===void 0&&(t={}),{options:t,fn(s){const{x:r,y:n,placement:a,rects:i,middlewareData:o}=s,{offset:l=0,mainAxis:d=!0,crossAxis:m=!0}=ge(t,s),x={x:r,y:n},f=ce(a),v=ws(f);let h=x[v],b=x[f];const c=ge(l,s),p=typeof c=="number"?{mainAxis:c,crossAxis:0}:{mainAxis:0,crossAxis:0,...c};if(d){const w=v==="y"?"height":"width",T=i.reference[v]-i.floating[w]+p.mainAxis,P=i.reference[v]+i.reference[w]-p.mainAxis;h<T?h=T:h>P&&(h=P)}if(m){var N,y;const w=v==="y"?"width":"height",T=Pr.has(pe(a)),P=i.reference[f]-i.floating[w]+(T&&((N=o.offset)==null?void 0:N[f])||0)+(T?0:p.crossAxis),j=i.reference[f]+i.reference[w]+(T?0:((y=o.offset)==null?void 0:y[f])||0)-(T?p.crossAxis:0);b<P?b=P:b>j&&(b=j)}return{[v]:h,[f]:b}}}},wl=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(s){var r,n;const{placement:a,rects:i,platform:o,elements:l}=s,{apply:d=()=>{},...m}=ge(t,s),x=await lt(s,m),f=pe(a),v=Ge(a),h=ce(a)==="y",{width:b,height:c}=i.floating;let p,N;f==="top"||f==="bottom"?(p=f,N=v===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(N=f,p=v==="end"?"top":"bottom");const y=c-x.top-x.bottom,w=b-x.left-x.right,T=at(c-x[p],y),P=at(b-x[N],w),j=!s.middlewareData.shift;let g=T,S=P;if((r=s.middlewareData.shift)!=null&&r.enabled.x&&(S=w),(n=s.middlewareData.shift)!=null&&n.enabled.y&&(g=y),j&&!v){const C=Re(x.left,0),E=Re(x.right,0),L=Re(x.top,0),O=Re(x.bottom,0);h?S=b-2*(C!==0||E!==0?C+E:Re(x.left,x.right)):g=c-2*(L!==0||O!==0?L+O:Re(x.top,x.bottom))}await d({...s,availableWidth:S,availableHeight:g});const A=await o.getDimensions(l.floating);return b!==A.width||c!==A.height?{reset:{rects:!0}}:{}}}},ns=Math.min,He=Math.max,Ct=Math.round,dt=Math.floor,de=t=>({x:t,y:t});function Lt(){return typeof window<"u"}function ze(t){return Rr(t)?(t.nodeName||"").toLowerCase():"#document"}function se(t){var s;return(t==null||(s=t.ownerDocument)==null?void 0:s.defaultView)||window}function me(t){var s;return(s=(Rr(t)?t.ownerDocument:t.document)||window.document)==null?void 0:s.documentElement}function Rr(t){return Lt()?t instanceof Node||t instanceof se(t).Node:!1}function le(t){return Lt()?t instanceof Element||t instanceof se(t).Element:!1}function ue(t){return Lt()?t instanceof HTMLElement||t instanceof se(t).HTMLElement:!1}function sr(t){return!Lt()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof se(t).ShadowRoot}const Sl=new Set(["inline","contents"]);function ot(t){const{overflow:s,overflowX:r,overflowY:n,display:a}=ie(t);return/auto|scroll|overlay|hidden|clip/.test(s+n+r)&&!Sl.has(a)}const Cl=new Set(["table","td","th"]);function El(t){return Cl.has(ze(t))}const Tl=[":popover-open",":modal"];function It(t){return Tl.some(s=>{try{return t.matches(s)}catch{return!1}})}const Al=["transform","translate","scale","rotate","perspective"],Pl=["transform","translate","scale","rotate","perspective","filter"],Rl=["paint","layout","strict","content"];function Es(t){const s=Ts(),r=le(t)?ie(t):t;return Al.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!s&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!s&&(r.filter?r.filter!=="none":!1)||Pl.some(n=>(r.willChange||"").includes(n))||Rl.some(n=>(r.contain||"").includes(n))}function Ol(t){let s=Se(t);for(;ue(s)&&!Ye(s);){if(Es(s))return s;if(It(s))return null;s=Se(s)}return null}function Ts(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const kl=new Set(["html","body","#document"]);function Ye(t){return kl.has(ze(t))}function ie(t){return se(t).getComputedStyle(t)}function Dt(t){return le(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Se(t){if(ze(t)==="html")return t;const s=t.assignedSlot||t.parentNode||sr(t)&&t.host||me(t);return sr(s)?s.host:s}function Or(t){const s=Se(t);return Ye(s)?t.ownerDocument?t.ownerDocument.body:t.body:ue(s)&&ot(s)?s:Or(s)}function it(t,s,r){var n;s===void 0&&(s=[]),r===void 0&&(r=!0);const a=Or(t),i=a===((n=t.ownerDocument)==null?void 0:n.body),o=se(a);if(i){const l=as(o);return s.concat(o,o.visualViewport||[],ot(a)?a:[],l&&r?it(l):[])}return s.concat(a,it(a,[],r))}function as(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function kr(t){const s=ie(t);let r=parseFloat(s.width)||0,n=parseFloat(s.height)||0;const a=ue(t),i=a?t.offsetWidth:r,o=a?t.offsetHeight:n,l=Ct(r)!==i||Ct(n)!==o;return l&&(r=i,n=o),{width:r,height:n,$:l}}function As(t){return le(t)?t:t.contextElement}function We(t){const s=As(t);if(!ue(s))return de(1);const r=s.getBoundingClientRect(),{width:n,height:a,$:i}=kr(s);let o=(i?Ct(r.width):r.width)/n,l=(i?Ct(r.height):r.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const Ll=de(0);function Lr(t){const s=se(t);return!Ts()||!s.visualViewport?Ll:{x:s.visualViewport.offsetLeft,y:s.visualViewport.offsetTop}}function Il(t,s,r){return s===void 0&&(s=!1),!r||s&&r!==se(t)?!1:s}function Ie(t,s,r,n){s===void 0&&(s=!1),r===void 0&&(r=!1);const a=t.getBoundingClientRect(),i=As(t);let o=de(1);s&&(n?le(n)&&(o=We(n)):o=We(t));const l=Il(i,r,n)?Lr(i):de(0);let d=(a.left+l.x)/o.x,m=(a.top+l.y)/o.y,x=a.width/o.x,f=a.height/o.y;if(i){const v=se(i),h=n&&le(n)?se(n):n;let b=v,c=as(b);for(;c&&n&&h!==b;){const p=We(c),N=c.getBoundingClientRect(),y=ie(c),w=N.left+(c.clientLeft+parseFloat(y.paddingLeft))*p.x,T=N.top+(c.clientTop+parseFloat(y.paddingTop))*p.y;d*=p.x,m*=p.y,x*=p.x,f*=p.y,d+=w,m+=T,b=se(c),c=as(b)}}return St({width:x,height:f,x:d,y:m})}function Mt(t,s){const r=Dt(t).scrollLeft;return s?s.left+r:Ie(me(t)).left+r}function Ir(t,s){const r=t.getBoundingClientRect(),n=r.left+s.scrollLeft-Mt(t,r),a=r.top+s.scrollTop;return{x:n,y:a}}function Dl(t){let{elements:s,rect:r,offsetParent:n,strategy:a}=t;const i=a==="fixed",o=me(n),l=s?It(s.floating):!1;if(n===o||l&&i)return r;let d={scrollLeft:0,scrollTop:0},m=de(1);const x=de(0),f=ue(n);if((f||!f&&!i)&&((ze(n)!=="body"||ot(o))&&(d=Dt(n)),ue(n))){const h=Ie(n);m=We(n),x.x=h.x+n.clientLeft,x.y=h.y+n.clientTop}const v=o&&!f&&!i?Ir(o,d):de(0);return{width:r.width*m.x,height:r.height*m.y,x:r.x*m.x-d.scrollLeft*m.x+x.x+v.x,y:r.y*m.y-d.scrollTop*m.y+x.y+v.y}}function Ml(t){return Array.from(t.getClientRects())}function _l(t){const s=me(t),r=Dt(t),n=t.ownerDocument.body,a=He(s.scrollWidth,s.clientWidth,n.scrollWidth,n.clientWidth),i=He(s.scrollHeight,s.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+Mt(t);const l=-r.scrollTop;return ie(n).direction==="rtl"&&(o+=He(s.clientWidth,n.clientWidth)-a),{width:a,height:i,x:o,y:l}}const rr=25;function Fl(t,s){const r=se(t),n=me(t),a=r.visualViewport;let i=n.clientWidth,o=n.clientHeight,l=0,d=0;if(a){i=a.width,o=a.height;const x=Ts();(!x||x&&s==="fixed")&&(l=a.offsetLeft,d=a.offsetTop)}const m=Mt(n);if(m<=0){const x=n.ownerDocument,f=x.body,v=getComputedStyle(f),h=x.compatMode==="CSS1Compat"&&parseFloat(v.marginLeft)+parseFloat(v.marginRight)||0,b=Math.abs(n.clientWidth-f.clientWidth-h);b<=rr&&(i-=b)}else m<=rr&&(i+=m);return{width:i,height:o,x:l,y:d}}const $l=new Set(["absolute","fixed"]);function Bl(t,s){const r=Ie(t,!0,s==="fixed"),n=r.top+t.clientTop,a=r.left+t.clientLeft,i=ue(t)?We(t):de(1),o=t.clientWidth*i.x,l=t.clientHeight*i.y,d=a*i.x,m=n*i.y;return{width:o,height:l,x:d,y:m}}function nr(t,s,r){let n;if(s==="viewport")n=Fl(t,r);else if(s==="document")n=_l(me(t));else if(le(s))n=Bl(s,r);else{const a=Lr(t);n={x:s.x-a.x,y:s.y-a.y,width:s.width,height:s.height}}return St(n)}function Dr(t,s){const r=Se(t);return r===s||!le(r)||Ye(r)?!1:ie(r).position==="fixed"||Dr(r,s)}function Hl(t,s){const r=s.get(t);if(r)return r;let n=it(t,[],!1).filter(l=>le(l)&&ze(l)!=="body"),a=null;const i=ie(t).position==="fixed";let o=i?Se(t):t;for(;le(o)&&!Ye(o);){const l=ie(o),d=Es(o);!d&&l.position==="fixed"&&(a=null),(i?!d&&!a:!d&&l.position==="static"&&!!a&&$l.has(a.position)||ot(o)&&!d&&Dr(t,o))?n=n.filter(x=>x!==o):a=l,o=Se(o)}return s.set(t,n),n}function Wl(t){let{element:s,boundary:r,rootBoundary:n,strategy:a}=t;const o=[...r==="clippingAncestors"?It(s)?[]:Hl(s,this._c):[].concat(r),n],l=o[0],d=o.reduce((m,x)=>{const f=nr(s,x,a);return m.top=He(f.top,m.top),m.right=ns(f.right,m.right),m.bottom=ns(f.bottom,m.bottom),m.left=He(f.left,m.left),m},nr(s,l,a));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function Vl(t){const{width:s,height:r}=kr(t);return{width:s,height:r}}function Ul(t,s,r){const n=ue(s),a=me(s),i=r==="fixed",o=Ie(t,!0,i,s);let l={scrollLeft:0,scrollTop:0};const d=de(0);function m(){d.x=Mt(a)}if(n||!n&&!i)if((ze(s)!=="body"||ot(a))&&(l=Dt(s)),n){const h=Ie(s,!0,i,s);d.x=h.x+s.clientLeft,d.y=h.y+s.clientTop}else a&&m();i&&!n&&a&&m();const x=a&&!n&&!i?Ir(a,l):de(0),f=o.left+l.scrollLeft-d.x-x.x,v=o.top+l.scrollTop-d.y-x.y;return{x:f,y:v,width:o.width,height:o.height}}function Gt(t){return ie(t).position==="static"}function ar(t,s){if(!ue(t)||ie(t).position==="fixed")return null;if(s)return s(t);let r=t.offsetParent;return me(t)===r&&(r=r.ownerDocument.body),r}function Mr(t,s){const r=se(t);if(It(t))return r;if(!ue(t)){let a=Se(t);for(;a&&!Ye(a);){if(le(a)&&!Gt(a))return a;a=Se(a)}return r}let n=ar(t,s);for(;n&&El(n)&&Gt(n);)n=ar(n,s);return n&&Ye(n)&&Gt(n)&&!Es(n)?r:n||Ol(t)||r}const Kl=async function(t){const s=this.getOffsetParent||Mr,r=this.getDimensions,n=await r(t.floating);return{reference:Ul(t.reference,await s(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Yl(t){return ie(t).direction==="rtl"}const Gl={convertOffsetParentRelativeRectToViewportRelativeRect:Dl,getDocumentElement:me,getClippingRect:Wl,getOffsetParent:Mr,getElementRects:Kl,getClientRects:Ml,getDimensions:Vl,getScale:We,isElement:le,isRTL:Yl};function _r(t,s){return t.x===s.x&&t.y===s.y&&t.width===s.width&&t.height===s.height}function zl(t,s){let r=null,n;const a=me(t);function i(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function o(l,d){l===void 0&&(l=!1),d===void 0&&(d=1),i();const m=t.getBoundingClientRect(),{left:x,top:f,width:v,height:h}=m;if(l||s(),!v||!h)return;const b=dt(f),c=dt(a.clientWidth-(x+v)),p=dt(a.clientHeight-(f+h)),N=dt(x),w={rootMargin:-b+"px "+-c+"px "+-p+"px "+-N+"px",threshold:He(0,ns(1,d))||1};let T=!0;function P(j){const g=j[0].intersectionRatio;if(g!==d){if(!T)return o();g?o(!1,g):n=setTimeout(()=>{o(!1,1e-7)},1e3)}g===1&&!_r(m,t.getBoundingClientRect())&&o(),T=!1}try{r=new IntersectionObserver(P,{...w,root:a.ownerDocument})}catch{r=new IntersectionObserver(P,w)}r.observe(t)}return o(!0),i}function ql(t,s,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:d=!1}=n,m=As(t),x=a||i?[...m?it(m):[],...it(s)]:[];x.forEach(N=>{a&&N.addEventListener("scroll",r,{passive:!0}),i&&N.addEventListener("resize",r)});const f=m&&l?zl(m,r):null;let v=-1,h=null;o&&(h=new ResizeObserver(N=>{let[y]=N;y&&y.target===m&&h&&(h.unobserve(s),cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var w;(w=h)==null||w.observe(s)})),r()}),m&&!d&&h.observe(m),h.observe(s));let b,c=d?Ie(t):null;d&&p();function p(){const N=Ie(t);c&&!_r(c,N)&&r(),c=N,b=requestAnimationFrame(p)}return r(),()=>{var N;x.forEach(y=>{a&&y.removeEventListener("scroll",r),i&&y.removeEventListener("resize",r)}),f?.(),(N=h)==null||N.disconnect(),h=null,d&&cancelAnimationFrame(b)}}const Xl=yl,Ql=Nl,Zl=pl,Jl=wl,ei=vl,lr=gl,ti=jl,si=(t,s,r)=>{const n=new Map,a={platform:Gl,...r},i={...a.platform,_c:n};return hl(t,s,{...a,platform:i})};var ri=typeof document<"u",ni=function(){},gt=ri?u.useLayoutEffect:ni;function Et(t,s){if(t===s)return!0;if(typeof t!=typeof s)return!1;if(typeof t=="function"&&t.toString()===s.toString())return!0;let r,n,a;if(t&&s&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==s.length)return!1;for(n=r;n--!==0;)if(!Et(t[n],s[n]))return!1;return!0}if(a=Object.keys(t),r=a.length,r!==Object.keys(s).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(s,a[n]))return!1;for(n=r;n--!==0;){const i=a[n];if(!(i==="_owner"&&t.$$typeof)&&!Et(t[i],s[i]))return!1}return!0}return t!==t&&s!==s}function Fr(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function ir(t,s){const r=Fr(t);return Math.round(s*r)/r}function zt(t){const s=u.useRef(t);return gt(()=>{s.current=t}),s}function ai(t){t===void 0&&(t={});const{placement:s="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:d,open:m}=t,[x,f]=u.useState({x:0,y:0,strategy:r,placement:s,middlewareData:{},isPositioned:!1}),[v,h]=u.useState(n);Et(v,n)||h(n);const[b,c]=u.useState(null),[p,N]=u.useState(null),y=u.useCallback(k=>{k!==j.current&&(j.current=k,c(k))},[]),w=u.useCallback(k=>{k!==g.current&&(g.current=k,N(k))},[]),T=i||b,P=o||p,j=u.useRef(null),g=u.useRef(null),S=u.useRef(x),A=d!=null,C=zt(d),E=zt(a),L=zt(m),O=u.useCallback(()=>{if(!j.current||!g.current)return;const k={placement:s,strategy:r,middleware:v};E.current&&(k.platform=E.current),si(j.current,g.current,k).then(F=>{const J={...F,isPositioned:L.current!==!1};D.current&&!Et(S.current,J)&&(S.current=J,Rt.flushSync(()=>{f(J)}))})},[v,s,r,E,L]);gt(()=>{m===!1&&S.current.isPositioned&&(S.current.isPositioned=!1,f(k=>({...k,isPositioned:!1})))},[m]);const D=u.useRef(!1);gt(()=>(D.current=!0,()=>{D.current=!1}),[]),gt(()=>{if(T&&(j.current=T),P&&(g.current=P),T&&P){if(C.current)return C.current(T,P,O);O()}},[T,P,O,C,A]);const _=u.useMemo(()=>({reference:j,floating:g,setReference:y,setFloating:w}),[y,w]),I=u.useMemo(()=>({reference:T,floating:P}),[T,P]),M=u.useMemo(()=>{const k={position:r,left:0,top:0};if(!I.floating)return k;const F=ir(I.floating,x.x),J=ir(I.floating,x.y);return l?{...k,transform:"translate("+F+"px, "+J+"px)",...Fr(I.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:F,top:J}},[r,l,I.floating,x.x,x.y]);return u.useMemo(()=>({...x,update:O,refs:_,elements:I,floatingStyles:M}),[x,O,_,I,M])}const li=t=>{function s(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:n,padding:a}=typeof t=="function"?t(r):t;return n&&s(n)?n.current!=null?lr({element:n.current,padding:a}).fn(r):{}:n?lr({element:n,padding:a}).fn(r):{}}}},ii=(t,s)=>({...Xl(t),options:[t,s]}),oi=(t,s)=>({...Ql(t),options:[t,s]}),ci=(t,s)=>({...ti(t),options:[t,s]}),di=(t,s)=>({...Zl(t),options:[t,s]}),ui=(t,s)=>({...Jl(t),options:[t,s]}),mi=(t,s)=>({...ei(t),options:[t,s]}),xi=(t,s)=>({...li(t),options:[t,s]});var fi="Arrow",$r=u.forwardRef((t,s)=>{const{children:r,width:n=10,height:a=5,...i}=t;return e.jsx(K.svg,{...i,ref:s,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:e.jsx("polygon",{points:"0,0 30,0 15,10"})})});$r.displayName=fi;var hi=$r;function gi(t){const[s,r]=u.useState(void 0);return te(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,l;if("borderBoxSize"in i){const d=i.borderBoxSize,m=Array.isArray(d)?d[0]:d;o=m.inlineSize,l=m.blockSize}else o=t.offsetWidth,l=t.offsetHeight;r({width:o,height:l})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else r(void 0)},[t]),s}var Ps="Popper",[Br,Hr]=Ns(Ps),[pi,Wr]=Br(Ps),Vr=t=>{const{__scopePopper:s,children:r}=t,[n,a]=u.useState(null);return e.jsx(pi,{scope:s,anchor:n,onAnchorChange:a,children:r})};Vr.displayName=Ps;var Ur="PopperAnchor",Kr=u.forwardRef((t,s)=>{const{__scopePopper:r,virtualRef:n,...a}=t,i=Wr(Ur,r),o=u.useRef(null),l=q(s,o),d=u.useRef(null);return u.useEffect(()=>{const m=d.current;d.current=n?.current||o.current,m!==d.current&&i.onAnchorChange(d.current)}),n?null:e.jsx(K.div,{...a,ref:l})});Kr.displayName=Ur;var Rs="PopperContent",[vi,bi]=Br(Rs),Yr=u.forwardRef((t,s)=>{const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:d=!0,collisionBoundary:m=[],collisionPadding:x=0,sticky:f="partial",hideWhenDetached:v=!1,updatePositionStrategy:h="optimized",onPlaced:b,...c}=t,p=Wr(Rs,r),[N,y]=u.useState(null),w=q(s,R=>y(R)),[T,P]=u.useState(null),j=gi(T),g=j?.width??0,S=j?.height??0,A=n+(i!=="center"?"-"+i:""),C=typeof x=="number"?x:{top:0,right:0,bottom:0,left:0,...x},E=Array.isArray(m)?m:[m],L=E.length>0,O={padding:C,boundary:E.filter(Ni),altBoundary:L},{refs:D,floatingStyles:_,placement:I,isPositioned:M,middlewareData:k}=ai({strategy:"fixed",placement:A,whileElementsMounted:(...R)=>ql(...R,{animationFrame:h==="always"}),elements:{reference:p.anchor},middleware:[ii({mainAxis:a+S,alignmentAxis:o}),d&&oi({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?ci():void 0,...O}),d&&di({...O}),ui({...O,apply:({elements:R,rects:W,availableWidth:Q,availableHeight:$})=>{const{width:H,height:Y}=W.reference,re=R.floating.style;re.setProperty("--radix-popper-available-width",`${Q}px`),re.setProperty("--radix-popper-available-height",`${$}px`),re.setProperty("--radix-popper-anchor-width",`${H}px`),re.setProperty("--radix-popper-anchor-height",`${Y}px`)}}),T&&xi({element:T,padding:l}),ji({arrowWidth:g,arrowHeight:S}),v&&mi({strategy:"referenceHidden",...O})]}),[F,J]=qr(I),Te=Le(b);te(()=>{M&&Te?.()},[M,Te]);const Xe=k.arrow?.x,Qe=k.arrow?.y,ve=k.arrow?.centerOffset!==0,[_e,Ae]=u.useState();return te(()=>{N&&Ae(window.getComputedStyle(N).zIndex)},[N]),e.jsx("div",{ref:D.setFloating,"data-radix-popper-content-wrapper":"",style:{..._,transform:M?_.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:_e,"--radix-popper-transform-origin":[k.transformOrigin?.x,k.transformOrigin?.y].join(" "),...k.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:e.jsx(vi,{scope:r,placedSide:F,onArrowChange:P,arrowX:Xe,arrowY:Qe,shouldHideArrow:ve,children:e.jsx(K.div,{"data-side":F,"data-align":J,...c,ref:w,style:{...c.style,animation:M?void 0:"none"}})})})});Yr.displayName=Rs;var Gr="PopperArrow",yi={top:"bottom",right:"left",bottom:"top",left:"right"},zr=u.forwardRef(function(s,r){const{__scopePopper:n,...a}=s,i=bi(Gr,n),o=yi[i.placedSide];return e.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:e.jsx(hi,{...a,ref:r,style:{...a.style,display:"block"}})})});zr.displayName=Gr;function Ni(t){return t!==null}var ji=t=>({name:"transformOrigin",options:t,fn(s){const{placement:r,rects:n,middlewareData:a}=s,o=a.arrow?.centerOffset!==0,l=o?0:t.arrowWidth,d=o?0:t.arrowHeight,[m,x]=qr(r),f={start:"0%",center:"50%",end:"100%"}[x],v=(a.arrow?.x??0)+l/2,h=(a.arrow?.y??0)+d/2;let b="",c="";return m==="bottom"?(b=o?f:`${v}px`,c=`${-d}px`):m==="top"?(b=o?f:`${v}px`,c=`${n.floating.height+d}px`):m==="right"?(b=`${-d}px`,c=o?f:`${h}px`):m==="left"&&(b=`${n.floating.width+d}px`,c=o?f:`${h}px`),{data:{x:b,y:c}}}});function qr(t){const[s,r="center"]=t.split("-");return[s,r]}var wi=Vr,Si=Kr,Ci=Yr,Ei=zr,Ti="Portal",Xr=u.forwardRef((t,s)=>{const{container:r,...n}=t,[a,i]=u.useState(!1);te(()=>i(!0),[]);const o=r||a&&globalThis?.document?.body;return o?Gn.createPortal(e.jsx(K.div,{...n,ref:s}),o):null});Xr.displayName=Ti;var Ai=fr[" useInsertionEffect ".trim().toString()]||te;function or({prop:t,defaultProp:s,onChange:r=()=>{},caller:n}){const[a,i,o]=Pi({defaultProp:s,onChange:r}),l=t!==void 0,d=l?t:a;{const x=u.useRef(t!==void 0);u.useEffect(()=>{const f=x.current;f!==l&&console.warn(`${n} is changing from ${f?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),x.current=l},[l,n])}const m=u.useCallback(x=>{if(l){const f=Ri(x)?x(t):x;f!==t&&o.current?.(f)}else i(x)},[l,t,i,o]);return[d,m]}function Pi({defaultProp:t,onChange:s}){const[r,n]=u.useState(t),a=u.useRef(r),i=u.useRef(s);return Ai(()=>{i.current=s},[s]),u.useEffect(()=>{a.current!==r&&(i.current?.(r),a.current=r)},[r,a]),[r,n,i]}function Ri(t){return typeof t=="function"}function Oi(t){const s=u.useRef({value:t,previous:t});return u.useMemo(()=>(s.current.value!==t&&(s.current.previous=s.current.value,s.current.value=t),s.current.previous),[t])}var Qr=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),ki="VisuallyHidden",Li=u.forwardRef((t,s)=>e.jsx(K.span,{...t,ref:s,style:{...Qr,...t.style}}));Li.displayName=ki;var Ii=function(t){if(typeof document>"u")return null;var s=Array.isArray(t)?t[0]:t;return s.ownerDocument.body},Fe=new WeakMap,ut=new WeakMap,mt={},qt=0,Zr=function(t){return t&&(t.host||Zr(t.parentNode))},Di=function(t,s){return s.map(function(r){if(t.contains(r))return r;var n=Zr(r);return n&&t.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},Mi=function(t,s,r,n){var a=Di(s,Array.isArray(t)?t:[t]);mt[r]||(mt[r]=new WeakMap);var i=mt[r],o=[],l=new Set,d=new Set(a),m=function(f){!f||l.has(f)||(l.add(f),m(f.parentNode))};a.forEach(m);var x=function(f){!f||d.has(f)||Array.prototype.forEach.call(f.children,function(v){if(l.has(v))x(v);else try{var h=v.getAttribute(n),b=h!==null&&h!=="false",c=(Fe.get(v)||0)+1,p=(i.get(v)||0)+1;Fe.set(v,c),i.set(v,p),o.push(v),c===1&&b&&ut.set(v,!0),p===1&&v.setAttribute(r,"true"),b||v.setAttribute(n,"true")}catch(N){console.error("aria-hidden: cannot operate on ",v,N)}})};return x(s),l.clear(),qt++,function(){o.forEach(function(f){var v=Fe.get(f)-1,h=i.get(f)-1;Fe.set(f,v),i.set(f,h),v||(ut.has(f)||f.removeAttribute(n),ut.delete(f)),h||f.removeAttribute(r)}),qt--,qt||(Fe=new WeakMap,Fe=new WeakMap,ut=new WeakMap,mt={})}},_i=function(t,s,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),a=Ii(t);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live], script"))),Mi(n,a,r,"aria-hidden")):function(){return null}},oe=function(){return oe=Object.assign||function(s){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},oe.apply(this,arguments)};function Jr(t,s){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&s.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)s.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function Fi(t,s,r){if(r||arguments.length===2)for(var n=0,a=s.length,i;n<a;n++)(i||!(n in s))&&(i||(i=Array.prototype.slice.call(s,0,n)),i[n]=s[n]);return t.concat(i||Array.prototype.slice.call(s))}var pt="right-scroll-bar-position",vt="width-before-scroll-bar",$i="with-scroll-bars-hidden",Bi="--removed-body-scroll-bar-size";function Xt(t,s){return typeof t=="function"?t(s):t&&(t.current=s),t}function Hi(t,s){var r=u.useState(function(){return{value:t,callback:s,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=s,r.facade}var Wi=typeof window<"u"?u.useLayoutEffect:u.useEffect,cr=new WeakMap;function Vi(t,s){var r=Hi(null,function(n){return t.forEach(function(a){return Xt(a,n)})});return Wi(function(){var n=cr.get(r);if(n){var a=new Set(n),i=new Set(t),o=r.current;a.forEach(function(l){i.has(l)||Xt(l,null)}),i.forEach(function(l){a.has(l)||Xt(l,o)})}cr.set(r,t)},[t]),r}function Ui(t){return t}function Ki(t,s){s===void 0&&(s=Ui);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(i){var o=s(i,n);return r.push(o),function(){r=r.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(n=!0;r.length;){var o=r;r=[],o.forEach(i)}r={push:function(l){return i(l)},filter:function(){return r}}},assignMedium:function(i){n=!0;var o=[];if(r.length){var l=r;r=[],l.forEach(i),o=r}var d=function(){var x=o;o=[],x.forEach(i)},m=function(){return Promise.resolve().then(d)};m(),r={push:function(x){o.push(x),m()},filter:function(x){return o=o.filter(x),r}}}};return a}function Yi(t){t===void 0&&(t={});var s=Ki(null);return s.options=oe({async:!0,ssr:!1},t),s}var en=function(t){var s=t.sideCar,r=Jr(t,["sideCar"]);if(!s)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=s.read();if(!n)throw new Error("Sidecar medium not found");return u.createElement(n,oe({},r))};en.isSideCarExport=!0;function Gi(t,s){return t.useMedium(s),en}var tn=Yi(),Qt=function(){},_t=u.forwardRef(function(t,s){var r=u.useRef(null),n=u.useState({onScrollCapture:Qt,onWheelCapture:Qt,onTouchMoveCapture:Qt}),a=n[0],i=n[1],o=t.forwardProps,l=t.children,d=t.className,m=t.removeScrollBar,x=t.enabled,f=t.shards,v=t.sideCar,h=t.noRelative,b=t.noIsolation,c=t.inert,p=t.allowPinchZoom,N=t.as,y=N===void 0?"div":N,w=t.gapMode,T=Jr(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),P=v,j=Vi([r,s]),g=oe(oe({},T),a);return u.createElement(u.Fragment,null,x&&u.createElement(P,{sideCar:tn,removeScrollBar:m,shards:f,noRelative:h,noIsolation:b,inert:c,setCallbacks:i,allowPinchZoom:!!p,lockRef:r,gapMode:w}),o?u.cloneElement(u.Children.only(l),oe(oe({},g),{ref:j})):u.createElement(y,oe({},g,{className:d,ref:j}),l))});_t.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};_t.classNames={fullWidth:vt,zeroRight:pt};var zi=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function qi(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var s=zi();return s&&t.setAttribute("nonce",s),t}function Xi(t,s){t.styleSheet?t.styleSheet.cssText=s:t.appendChild(document.createTextNode(s))}function Qi(t){var s=document.head||document.getElementsByTagName("head")[0];s.appendChild(t)}var Zi=function(){var t=0,s=null;return{add:function(r){t==0&&(s=qi())&&(Xi(s,r),Qi(s)),t++},remove:function(){t--,!t&&s&&(s.parentNode&&s.parentNode.removeChild(s),s=null)}}},Ji=function(){var t=Zi();return function(s,r){u.useEffect(function(){return t.add(s),function(){t.remove()}},[s&&r])}},sn=function(){var t=Ji(),s=function(r){var n=r.styles,a=r.dynamic;return t(n,a),null};return s},eo={left:0,top:0,right:0,gap:0},Zt=function(t){return parseInt(t||"",10)||0},to=function(t){var s=window.getComputedStyle(document.body),r=s[t==="padding"?"paddingLeft":"marginLeft"],n=s[t==="padding"?"paddingTop":"marginTop"],a=s[t==="padding"?"paddingRight":"marginRight"];return[Zt(r),Zt(n),Zt(a)]},so=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return eo;var s=to(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:s[0],top:s[1],right:s[2],gap:Math.max(0,n-r+s[2]-s[0])}},ro=sn(),Ve="data-scroll-locked",no=function(t,s,r,n){var a=t.left,i=t.top,o=t.right,l=t.gap;return r===void 0&&(r="margin"),`
  .`.concat($i,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(Ve,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([s&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(pt,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(vt,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(pt," .").concat(pt,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(vt," .").concat(vt,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Ve,`] {
    `).concat(Bi,": ").concat(l,`px;
  }
`)},dr=function(){var t=parseInt(document.body.getAttribute(Ve)||"0",10);return isFinite(t)?t:0},ao=function(){u.useEffect(function(){return document.body.setAttribute(Ve,(dr()+1).toString()),function(){var t=dr()-1;t<=0?document.body.removeAttribute(Ve):document.body.setAttribute(Ve,t.toString())}},[])},lo=function(t){var s=t.noRelative,r=t.noImportant,n=t.gapMode,a=n===void 0?"margin":n;ao();var i=u.useMemo(function(){return so(a)},[a]);return u.createElement(ro,{styles:no(i,!s,a,r?"":"!important")})},ls=!1;if(typeof window<"u")try{var xt=Object.defineProperty({},"passive",{get:function(){return ls=!0,!0}});window.addEventListener("test",xt,xt),window.removeEventListener("test",xt,xt)}catch{ls=!1}var $e=ls?{passive:!1}:!1,io=function(t){return t.tagName==="TEXTAREA"},rn=function(t,s){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[s]!=="hidden"&&!(r.overflowY===r.overflowX&&!io(t)&&r[s]==="visible")},oo=function(t){return rn(t,"overflowY")},co=function(t){return rn(t,"overflowX")},ur=function(t,s){var r=s.ownerDocument,n=s;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=nn(t,n);if(a){var i=an(t,n),o=i[1],l=i[2];if(o>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},uo=function(t){var s=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[s,r,n]},mo=function(t){var s=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[s,r,n]},nn=function(t,s){return t==="v"?oo(s):co(s)},an=function(t,s){return t==="v"?uo(s):mo(s)},xo=function(t,s){return t==="h"&&s==="rtl"?-1:1},fo=function(t,s,r,n,a){var i=xo(t,window.getComputedStyle(s).direction),o=i*n,l=r.target,d=s.contains(l),m=!1,x=o>0,f=0,v=0;do{if(!l)break;var h=an(t,l),b=h[0],c=h[1],p=h[2],N=c-p-i*b;(b||N)&&nn(t,l)&&(f+=N,v+=b);var y=l.parentNode;l=y&&y.nodeType===Node.DOCUMENT_FRAGMENT_NODE?y.host:y}while(!d&&l!==document.body||d&&(s.contains(l)||s===l));return(x&&(Math.abs(f)<1||!a)||!x&&(Math.abs(v)<1||!a))&&(m=!0),m},ft=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},mr=function(t){return[t.deltaX,t.deltaY]},xr=function(t){return t&&"current"in t?t.current:t},ho=function(t,s){return t[0]===s[0]&&t[1]===s[1]},go=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},po=0,Be=[];function vo(t){var s=u.useRef([]),r=u.useRef([0,0]),n=u.useRef(),a=u.useState(po++)[0],i=u.useState(sn)[0],o=u.useRef(t);u.useEffect(function(){o.current=t},[t]),u.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(a));var c=Fi([t.lockRef.current],(t.shards||[]).map(xr),!0).filter(Boolean);return c.forEach(function(p){return p.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),c.forEach(function(p){return p.classList.remove("allow-interactivity-".concat(a))})}}},[t.inert,t.lockRef.current,t.shards]);var l=u.useCallback(function(c,p){if("touches"in c&&c.touches.length===2||c.type==="wheel"&&c.ctrlKey)return!o.current.allowPinchZoom;var N=ft(c),y=r.current,w="deltaX"in c?c.deltaX:y[0]-N[0],T="deltaY"in c?c.deltaY:y[1]-N[1],P,j=c.target,g=Math.abs(w)>Math.abs(T)?"h":"v";if("touches"in c&&g==="h"&&j.type==="range")return!1;var S=ur(g,j);if(!S)return!0;if(S?P=g:(P=g==="v"?"h":"v",S=ur(g,j)),!S)return!1;if(!n.current&&"changedTouches"in c&&(w||T)&&(n.current=P),!P)return!0;var A=n.current||P;return fo(A,p,c,A==="h"?w:T,!0)},[]),d=u.useCallback(function(c){var p=c;if(!(!Be.length||Be[Be.length-1]!==i)){var N="deltaY"in p?mr(p):ft(p),y=s.current.filter(function(P){return P.name===p.type&&(P.target===p.target||p.target===P.shadowParent)&&ho(P.delta,N)})[0];if(y&&y.should){p.cancelable&&p.preventDefault();return}if(!y){var w=(o.current.shards||[]).map(xr).filter(Boolean).filter(function(P){return P.contains(p.target)}),T=w.length>0?l(p,w[0]):!o.current.noIsolation;T&&p.cancelable&&p.preventDefault()}}},[]),m=u.useCallback(function(c,p,N,y){var w={name:c,delta:p,target:N,should:y,shadowParent:bo(N)};s.current.push(w),setTimeout(function(){s.current=s.current.filter(function(T){return T!==w})},1)},[]),x=u.useCallback(function(c){r.current=ft(c),n.current=void 0},[]),f=u.useCallback(function(c){m(c.type,mr(c),c.target,l(c,t.lockRef.current))},[]),v=u.useCallback(function(c){m(c.type,ft(c),c.target,l(c,t.lockRef.current))},[]);u.useEffect(function(){return Be.push(i),t.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:v}),document.addEventListener("wheel",d,$e),document.addEventListener("touchmove",d,$e),document.addEventListener("touchstart",x,$e),function(){Be=Be.filter(function(c){return c!==i}),document.removeEventListener("wheel",d,$e),document.removeEventListener("touchmove",d,$e),document.removeEventListener("touchstart",x,$e)}},[]);var h=t.removeScrollBar,b=t.inert;return u.createElement(u.Fragment,null,b?u.createElement(i,{styles:go(a)}):null,h?u.createElement(lo,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function bo(t){for(var s=null;t!==null;)t instanceof ShadowRoot&&(s=t.host,t=t.host),t=t.parentNode;return s}const yo=Gi(tn,vo);var ln=u.forwardRef(function(t,s){return u.createElement(_t,oe({},t,{ref:s,sideCar:yo}))});ln.classNames=_t.classNames;var No=[" ","Enter","ArrowUp","ArrowDown"],jo=[" ","Enter"],De="Select",[Ft,$t,wo]=_a(De),[qe,gc]=Ns(De,[wo,Hr]),Bt=Hr(),[So,Ce]=qe(De),[Co,Eo]=qe(De),on=t=>{const{__scopeSelect:s,children:r,open:n,defaultOpen:a,onOpenChange:i,value:o,defaultValue:l,onValueChange:d,dir:m,name:x,autoComplete:f,disabled:v,required:h,form:b}=t,c=Bt(s),[p,N]=u.useState(null),[y,w]=u.useState(null),[T,P]=u.useState(!1),j=$a(m),[g,S]=or({prop:n,defaultProp:a??!1,onChange:i,caller:De}),[A,C]=or({prop:o,defaultProp:l,onChange:d,caller:De}),E=u.useRef(null),L=p?b||!!p.closest("form"):!0,[O,D]=u.useState(new Set),_=Array.from(O).map(I=>I.props.value).join(";");return e.jsx(wi,{...c,children:e.jsxs(So,{required:h,scope:s,trigger:p,onTriggerChange:N,valueNode:y,onValueNodeChange:w,valueNodeHasChildren:T,onValueNodeHasChildrenChange:P,contentId:js(),value:A,onValueChange:C,open:g,onOpenChange:S,dir:j,triggerPointerDownPosRef:E,disabled:v,children:[e.jsx(Ft.Provider,{scope:s,children:e.jsx(Co,{scope:t.__scopeSelect,onNativeOptionAdd:u.useCallback(I=>{D(M=>new Set(M).add(I))},[]),onNativeOptionRemove:u.useCallback(I=>{D(M=>{const k=new Set(M);return k.delete(I),k})},[]),children:r})}),L?e.jsxs(kn,{"aria-hidden":!0,required:h,tabIndex:-1,name:x,autoComplete:f,value:A,onChange:I=>C(I.target.value),disabled:v,form:b,children:[A===void 0?e.jsx("option",{value:""}):null,Array.from(O)]},_):null]})})};on.displayName=De;var cn="SelectTrigger",dn=u.forwardRef((t,s)=>{const{__scopeSelect:r,disabled:n=!1,...a}=t,i=Bt(r),o=Ce(cn,r),l=o.disabled||n,d=q(s,o.onTriggerChange),m=$t(r),x=u.useRef("touch"),[f,v,h]=In(c=>{const p=m().filter(w=>!w.disabled),N=p.find(w=>w.value===o.value),y=Dn(p,c,N);y!==void 0&&o.onValueChange(y.value)}),b=c=>{l||(o.onOpenChange(!0),h()),c&&(o.triggerPointerDownPosRef.current={x:Math.round(c.pageX),y:Math.round(c.pageY)})};return e.jsx(Si,{asChild:!0,...i,children:e.jsx(K.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":Ln(o.value)?"":void 0,...a,ref:d,onClick:G(a.onClick,c=>{c.currentTarget.focus(),x.current!=="mouse"&&b(c)}),onPointerDown:G(a.onPointerDown,c=>{x.current=c.pointerType;const p=c.target;p.hasPointerCapture(c.pointerId)&&p.releasePointerCapture(c.pointerId),c.button===0&&c.ctrlKey===!1&&c.pointerType==="mouse"&&(b(c),c.preventDefault())}),onKeyDown:G(a.onKeyDown,c=>{const p=f.current!=="";!(c.ctrlKey||c.altKey||c.metaKey)&&c.key.length===1&&v(c.key),!(p&&c.key===" ")&&No.includes(c.key)&&(b(),c.preventDefault())})})})});dn.displayName=cn;var un="SelectValue",mn=u.forwardRef((t,s)=>{const{__scopeSelect:r,className:n,style:a,children:i,placeholder:o="",...l}=t,d=Ce(un,r),{onValueNodeHasChildrenChange:m}=d,x=i!==void 0,f=q(s,d.onValueNodeChange);return te(()=>{m(x)},[m,x]),e.jsx(K.span,{...l,ref:f,style:{pointerEvents:"none"},children:Ln(d.value)?e.jsx(e.Fragment,{children:o}):i})});mn.displayName=un;var To="SelectIcon",xn=u.forwardRef((t,s)=>{const{__scopeSelect:r,children:n,...a}=t;return e.jsx(K.span,{"aria-hidden":!0,...a,ref:s,children:n||"▼"})});xn.displayName=To;var Ao="SelectPortal",fn=t=>e.jsx(Xr,{asChild:!0,...t});fn.displayName=Ao;var Me="SelectContent",hn=u.forwardRef((t,s)=>{const r=Ce(Me,t.__scopeSelect),[n,a]=u.useState();if(te(()=>{a(new DocumentFragment)},[]),!r.open){const i=n;return i?Rt.createPortal(e.jsx(gn,{scope:t.__scopeSelect,children:e.jsx(Ft.Slot,{scope:t.__scopeSelect,children:e.jsx("div",{children:t.children})})}),i):null}return e.jsx(pn,{...t,ref:s})});hn.displayName=Me;var ae=10,[gn,Ee]=qe(Me),Po="SelectContentImpl",Ro=nt("SelectContent.RemoveScroll"),pn=u.forwardRef((t,s)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:d,align:m,alignOffset:x,arrowPadding:f,collisionBoundary:v,collisionPadding:h,sticky:b,hideWhenDetached:c,avoidCollisions:p,...N}=t,y=Ce(Me,r),[w,T]=u.useState(null),[P,j]=u.useState(null),g=q(s,R=>T(R)),[S,A]=u.useState(null),[C,E]=u.useState(null),L=$t(r),[O,D]=u.useState(!1),_=u.useRef(!1);u.useEffect(()=>{if(w)return _i(w)},[w]),za();const I=u.useCallback(R=>{const[W,...Q]=L().map(Y=>Y.ref.current),[$]=Q.slice(-1),H=document.activeElement;for(const Y of R)if(Y===H||(Y?.scrollIntoView({block:"nearest"}),Y===W&&P&&(P.scrollTop=0),Y===$&&P&&(P.scrollTop=P.scrollHeight),Y?.focus(),document.activeElement!==H))return},[L,P]),M=u.useCallback(()=>I([S,w]),[I,S,w]);u.useEffect(()=>{O&&M()},[O,M]);const{onOpenChange:k,triggerPointerDownPosRef:F}=y;u.useEffect(()=>{if(w){let R={x:0,y:0};const W=$=>{R={x:Math.abs(Math.round($.pageX)-(F.current?.x??0)),y:Math.abs(Math.round($.pageY)-(F.current?.y??0))}},Q=$=>{R.x<=10&&R.y<=10?$.preventDefault():w.contains($.target)||k(!1),document.removeEventListener("pointermove",W),F.current=null};return F.current!==null&&(document.addEventListener("pointermove",W),document.addEventListener("pointerup",Q,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",W),document.removeEventListener("pointerup",Q,{capture:!0})}}},[w,k,F]),u.useEffect(()=>{const R=()=>k(!1);return window.addEventListener("blur",R),window.addEventListener("resize",R),()=>{window.removeEventListener("blur",R),window.removeEventListener("resize",R)}},[k]);const[J,Te]=In(R=>{const W=L().filter(H=>!H.disabled),Q=W.find(H=>H.ref.current===document.activeElement),$=Dn(W,R,Q);$&&setTimeout(()=>$.ref.current.focus())}),Xe=u.useCallback((R,W,Q)=>{const $=!_.current&&!Q;(y.value!==void 0&&y.value===W||$)&&(A(R),$&&(_.current=!0))},[y.value]),Qe=u.useCallback(()=>w?.focus(),[w]),ve=u.useCallback((R,W,Q)=>{const $=!_.current&&!Q;(y.value!==void 0&&y.value===W||$)&&E(R)},[y.value]),_e=n==="popper"?is:vn,Ae=_e===is?{side:l,sideOffset:d,align:m,alignOffset:x,arrowPadding:f,collisionBoundary:v,collisionPadding:h,sticky:b,hideWhenDetached:c,avoidCollisions:p}:{};return e.jsx(gn,{scope:r,content:w,viewport:P,onViewportChange:j,itemRefCallback:Xe,selectedItem:S,onItemLeave:Qe,itemTextRefCallback:ve,focusSelectedItem:M,selectedItemText:C,position:n,isPositioned:O,searchRef:J,children:e.jsx(ln,{as:Ro,allowPinchZoom:!0,children:e.jsx(Er,{asChild:!0,trapped:y.open,onMountAutoFocus:R=>{R.preventDefault()},onUnmountAutoFocus:G(a,R=>{y.trigger?.focus({preventScroll:!0}),R.preventDefault()}),children:e.jsx(Sr,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:R=>R.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:e.jsx(_e,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:R=>R.preventDefault(),...N,...Ae,onPlaced:()=>D(!0),ref:g,style:{display:"flex",flexDirection:"column",outline:"none",...N.style},onKeyDown:G(N.onKeyDown,R=>{const W=R.ctrlKey||R.altKey||R.metaKey;if(R.key==="Tab"&&R.preventDefault(),!W&&R.key.length===1&&Te(R.key),["ArrowUp","ArrowDown","Home","End"].includes(R.key)){let $=L().filter(H=>!H.disabled).map(H=>H.ref.current);if(["ArrowUp","End"].includes(R.key)&&($=$.slice().reverse()),["ArrowUp","ArrowDown"].includes(R.key)){const H=R.target,Y=$.indexOf(H);$=$.slice(Y+1)}setTimeout(()=>I($)),R.preventDefault()}})})})})})})});pn.displayName=Po;var Oo="SelectItemAlignedPosition",vn=u.forwardRef((t,s)=>{const{__scopeSelect:r,onPlaced:n,...a}=t,i=Ce(Me,r),o=Ee(Me,r),[l,d]=u.useState(null),[m,x]=u.useState(null),f=q(s,g=>x(g)),v=$t(r),h=u.useRef(!1),b=u.useRef(!0),{viewport:c,selectedItem:p,selectedItemText:N,focusSelectedItem:y}=o,w=u.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&m&&c&&p&&N){const g=i.trigger.getBoundingClientRect(),S=m.getBoundingClientRect(),A=i.valueNode.getBoundingClientRect(),C=N.getBoundingClientRect();if(i.dir!=="rtl"){const H=C.left-S.left,Y=A.left-H,re=g.left-Y,Pe=g.width+re,Ht=Math.max(Pe,S.width),Wt=window.innerWidth-ae,Vt=Vs(Y,[ae,Math.max(ae,Wt-Ht)]);l.style.minWidth=Pe+"px",l.style.left=Vt+"px"}else{const H=S.right-C.right,Y=window.innerWidth-A.right-H,re=window.innerWidth-g.right-Y,Pe=g.width+re,Ht=Math.max(Pe,S.width),Wt=window.innerWidth-ae,Vt=Vs(Y,[ae,Math.max(ae,Wt-Ht)]);l.style.minWidth=Pe+"px",l.style.right=Vt+"px"}const E=v(),L=window.innerHeight-ae*2,O=c.scrollHeight,D=window.getComputedStyle(m),_=parseInt(D.borderTopWidth,10),I=parseInt(D.paddingTop,10),M=parseInt(D.borderBottomWidth,10),k=parseInt(D.paddingBottom,10),F=_+I+O+k+M,J=Math.min(p.offsetHeight*5,F),Te=window.getComputedStyle(c),Xe=parseInt(Te.paddingTop,10),Qe=parseInt(Te.paddingBottom,10),ve=g.top+g.height/2-ae,_e=L-ve,Ae=p.offsetHeight/2,R=p.offsetTop+Ae,W=_+I+R,Q=F-W;if(W<=ve){const H=E.length>0&&p===E[E.length-1].ref.current;l.style.bottom="0px";const Y=m.clientHeight-c.offsetTop-c.offsetHeight,re=Math.max(_e,Ae+(H?Qe:0)+Y+M),Pe=W+re;l.style.height=Pe+"px"}else{const H=E.length>0&&p===E[0].ref.current;l.style.top="0px";const re=Math.max(ve,_+c.offsetTop+(H?Xe:0)+Ae)+Q;l.style.height=re+"px",c.scrollTop=W-ve+c.offsetTop}l.style.margin=`${ae}px 0`,l.style.minHeight=J+"px",l.style.maxHeight=L+"px",n?.(),requestAnimationFrame(()=>h.current=!0)}},[v,i.trigger,i.valueNode,l,m,c,p,N,i.dir,n]);te(()=>w(),[w]);const[T,P]=u.useState();te(()=>{m&&P(window.getComputedStyle(m).zIndex)},[m]);const j=u.useCallback(g=>{g&&b.current===!0&&(w(),y?.(),b.current=!1)},[w,y]);return e.jsx(Lo,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:h,onScrollButtonChange:j,children:e.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:T},children:e.jsx(K.div,{...a,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});vn.displayName=Oo;var ko="SelectPopperPosition",is=u.forwardRef((t,s)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=ae,...i}=t,o=Bt(r);return e.jsx(Ci,{...o,...i,ref:s,align:n,collisionPadding:a,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});is.displayName=ko;var[Lo,Os]=qe(Me,{}),os="SelectViewport",bn=u.forwardRef((t,s)=>{const{__scopeSelect:r,nonce:n,...a}=t,i=Ee(os,r),o=Os(os,r),l=q(s,i.onViewportChange),d=u.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),e.jsx(Ft.Slot,{scope:r,children:e.jsx(K.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:G(a.onScroll,m=>{const x=m.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:v}=o;if(v?.current&&f){const h=Math.abs(d.current-x.scrollTop);if(h>0){const b=window.innerHeight-ae*2,c=parseFloat(f.style.minHeight),p=parseFloat(f.style.height),N=Math.max(c,p);if(N<b){const y=N+h,w=Math.min(b,y),T=y-w;f.style.height=w+"px",f.style.bottom==="0px"&&(x.scrollTop=T>0?T:0,f.style.justifyContent="flex-end")}}}d.current=x.scrollTop})})})]})});bn.displayName=os;var yn="SelectGroup",[Io,Do]=qe(yn),Mo=u.forwardRef((t,s)=>{const{__scopeSelect:r,...n}=t,a=js();return e.jsx(Io,{scope:r,id:a,children:e.jsx(K.div,{role:"group","aria-labelledby":a,...n,ref:s})})});Mo.displayName=yn;var Nn="SelectLabel",jn=u.forwardRef((t,s)=>{const{__scopeSelect:r,...n}=t,a=Do(Nn,r);return e.jsx(K.div,{id:a.id,...n,ref:s})});jn.displayName=Nn;var Tt="SelectItem",[_o,wn]=qe(Tt),Sn=u.forwardRef((t,s)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:i,...o}=t,l=Ce(Tt,r),d=Ee(Tt,r),m=l.value===n,[x,f]=u.useState(i??""),[v,h]=u.useState(!1),b=q(s,y=>d.itemRefCallback?.(y,n,a)),c=js(),p=u.useRef("touch"),N=()=>{a||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(_o,{scope:r,value:n,disabled:a,textId:c,isSelected:m,onItemTextChange:u.useCallback(y=>{f(w=>w||(y?.textContent??"").trim())},[]),children:e.jsx(Ft.ItemSlot,{scope:r,value:n,disabled:a,textValue:x,children:e.jsx(K.div,{role:"option","aria-labelledby":c,"data-highlighted":v?"":void 0,"aria-selected":m&&v,"data-state":m?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...o,ref:b,onFocus:G(o.onFocus,()=>h(!0)),onBlur:G(o.onBlur,()=>h(!1)),onClick:G(o.onClick,()=>{p.current!=="mouse"&&N()}),onPointerUp:G(o.onPointerUp,()=>{p.current==="mouse"&&N()}),onPointerDown:G(o.onPointerDown,y=>{p.current=y.pointerType}),onPointerMove:G(o.onPointerMove,y=>{p.current=y.pointerType,a?d.onItemLeave?.():p.current==="mouse"&&y.currentTarget.focus({preventScroll:!0})}),onPointerLeave:G(o.onPointerLeave,y=>{y.currentTarget===document.activeElement&&d.onItemLeave?.()}),onKeyDown:G(o.onKeyDown,y=>{d.searchRef?.current!==""&&y.key===" "||(jo.includes(y.key)&&N(),y.key===" "&&y.preventDefault())})})})})});Sn.displayName=Tt;var Ze="SelectItemText",Cn=u.forwardRef((t,s)=>{const{__scopeSelect:r,className:n,style:a,...i}=t,o=Ce(Ze,r),l=Ee(Ze,r),d=wn(Ze,r),m=Eo(Ze,r),[x,f]=u.useState(null),v=q(s,N=>f(N),d.onItemTextChange,N=>l.itemTextRefCallback?.(N,d.value,d.disabled)),h=x?.textContent,b=u.useMemo(()=>e.jsx("option",{value:d.value,disabled:d.disabled,children:h},d.value),[d.disabled,d.value,h]),{onNativeOptionAdd:c,onNativeOptionRemove:p}=m;return te(()=>(c(b),()=>p(b)),[c,p,b]),e.jsxs(e.Fragment,{children:[e.jsx(K.span,{id:d.textId,...i,ref:v}),d.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Rt.createPortal(i.children,o.valueNode):null]})});Cn.displayName=Ze;var En="SelectItemIndicator",Tn=u.forwardRef((t,s)=>{const{__scopeSelect:r,...n}=t;return wn(En,r).isSelected?e.jsx(K.span,{"aria-hidden":!0,...n,ref:s}):null});Tn.displayName=En;var cs="SelectScrollUpButton",An=u.forwardRef((t,s)=>{const r=Ee(cs,t.__scopeSelect),n=Os(cs,t.__scopeSelect),[a,i]=u.useState(!1),o=q(s,n.onScrollButtonChange);return te(()=>{if(r.viewport&&r.isPositioned){let l=function(){const m=d.scrollTop>0;i(m)};const d=r.viewport;return l(),d.addEventListener("scroll",l),()=>d.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?e.jsx(Rn,{...t,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:d}=r;l&&d&&(l.scrollTop=l.scrollTop-d.offsetHeight)}}):null});An.displayName=cs;var ds="SelectScrollDownButton",Pn=u.forwardRef((t,s)=>{const r=Ee(ds,t.__scopeSelect),n=Os(ds,t.__scopeSelect),[a,i]=u.useState(!1),o=q(s,n.onScrollButtonChange);return te(()=>{if(r.viewport&&r.isPositioned){let l=function(){const m=d.scrollHeight-d.clientHeight,x=Math.ceil(d.scrollTop)<m;i(x)};const d=r.viewport;return l(),d.addEventListener("scroll",l),()=>d.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?e.jsx(Rn,{...t,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:d}=r;l&&d&&(l.scrollTop=l.scrollTop+d.offsetHeight)}}):null});Pn.displayName=ds;var Rn=u.forwardRef((t,s)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=t,i=Ee("SelectScrollButton",r),o=u.useRef(null),l=$t(r),d=u.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return u.useEffect(()=>()=>d(),[d]),te(()=>{l().find(x=>x.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[l]),e.jsx(K.div,{"aria-hidden":!0,...a,ref:s,style:{flexShrink:0,...a.style},onPointerDown:G(a.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(n,50))}),onPointerMove:G(a.onPointerMove,()=>{i.onItemLeave?.(),o.current===null&&(o.current=window.setInterval(n,50))}),onPointerLeave:G(a.onPointerLeave,()=>{d()})})}),Fo="SelectSeparator",On=u.forwardRef((t,s)=>{const{__scopeSelect:r,...n}=t;return e.jsx(K.div,{"aria-hidden":!0,...n,ref:s})});On.displayName=Fo;var us="SelectArrow",$o=u.forwardRef((t,s)=>{const{__scopeSelect:r,...n}=t,a=Bt(r),i=Ce(us,r),o=Ee(us,r);return i.open&&o.position==="popper"?e.jsx(Ei,{...a,...n,ref:s}):null});$o.displayName=us;var Bo="SelectBubbleInput",kn=u.forwardRef(({__scopeSelect:t,value:s,...r},n)=>{const a=u.useRef(null),i=q(n,a),o=Oi(s);return u.useEffect(()=>{const l=a.current;if(!l)return;const d=window.HTMLSelectElement.prototype,x=Object.getOwnPropertyDescriptor(d,"value").set;if(o!==s&&x){const f=new Event("change",{bubbles:!0});x.call(l,s),l.dispatchEvent(f)}},[o,s]),e.jsx(K.select,{...r,style:{...Qr,...r.style},ref:i,defaultValue:s})});kn.displayName=Bo;function Ln(t){return t===""||t===void 0}function In(t){const s=Le(t),r=u.useRef(""),n=u.useRef(0),a=u.useCallback(o=>{const l=r.current+o;s(l),function d(m){r.current=m,window.clearTimeout(n.current),m!==""&&(n.current=window.setTimeout(()=>d(""),1e3))}(l)},[s]),i=u.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return u.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,i]}function Dn(t,s,r){const a=s.length>1&&Array.from(s).every(m=>m===s[0])?s[0]:s,i=r?t.indexOf(r):-1;let o=Ho(t,Math.max(i,0));a.length===1&&(o=o.filter(m=>m!==r));const d=o.find(m=>m.textValue.toLowerCase().startsWith(a.toLowerCase()));return d!==r?d:void 0}function Ho(t,s){return t.map((r,n)=>t[(s+n)%t.length])}var Wo=on,Mn=dn,Vo=mn,Uo=xn,Ko=fn,_n=hn,Yo=bn,Fn=jn,$n=Sn,Go=Cn,zo=Tn,Bn=An,Hn=Pn,Wn=On;const ms=Wo,xs=Vo,At=u.forwardRef(({className:t,children:s,...r},n)=>e.jsxs(Mn,{ref:n,className:X("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[s,e.jsx(Uo,{asChild:!0,children:e.jsx(gr,{className:"h-4 w-4 opacity-50"})})]}));At.displayName=Mn.displayName;const Vn=u.forwardRef(({className:t,...s},r)=>e.jsx(Bn,{ref:r,className:X("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Jn,{className:"h-4 w-4"})}));Vn.displayName=Bn.displayName;const Un=u.forwardRef(({className:t,...s},r)=>e.jsx(Hn,{ref:r,className:X("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(gr,{className:"h-4 w-4"})}));Un.displayName=Hn.displayName;const Pt=u.forwardRef(({className:t,children:s,position:r="popper",...n},a)=>e.jsx(Ko,{children:e.jsxs(_n,{ref:a,className:X("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[e.jsx(Vn,{}),e.jsx(Yo,{className:X("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(Un,{})]})}));Pt.displayName=_n.displayName;const qo=u.forwardRef(({className:t,...s},r)=>e.jsx(Fn,{ref:r,className:X("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s}));qo.displayName=Fn.displayName;const xe=u.forwardRef(({className:t,children:s,...r},n)=>e.jsxs($n,{ref:n,className:X("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(zo,{children:e.jsx(ea,{className:"h-4 w-4"})})}),e.jsx(Go,{children:s})]}));xe.displayName=$n.displayName;const Xo=u.forwardRef(({className:t,...s},r)=>e.jsx(Wn,{ref:r,className:X("-mx-1 my-1 h-px bg-muted",t),...s}));Xo.displayName=Wn.displayName;const Je=u.forwardRef(({className:t,value:s=0,max:r=100,...n},a)=>e.jsx("div",{ref:a,className:X("relative h-2 w-full overflow-hidden rounded-full bg-gray-200",t),...n,children:e.jsx("div",{className:"h-full w-full flex-1 bg-primary-600 transition-all duration-300 ease-in-out",style:{transform:`translateX(-${100-s/r*100}%)`}})}));Je.displayName="Progress";const Qo=kt("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500 text-white hover:bg-green-600"}},defaultVariants:{variant:"default"}});function et({className:t,variant:s,...r}){return e.jsx("div",{className:X(Qo({variant:s}),t),...r})}const Zo=kt("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-red-200 bg-red-50 text-red-800 [&>svg]:text-red-600"}},defaultVariants:{variant:"default"}}),Kn=u.forwardRef(({className:t,variant:s,...r},n)=>e.jsx("div",{ref:n,role:"alert",className:X(Zo({variant:s}),t),...r}));Kn.displayName="Alert";const Yn=u.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:X("text-sm [&_p]:leading-relaxed",t),...s}));Yn.displayName="AlertDescription";const Jo=({conservatoryName:t="מרכז המוסיקה רעננה",directorName:s="לימור אקטע",recitalField:r,recitalUnits:n,studentName:a,studentId:i,onRecitalFieldChange:o,onRecitalUnitsChange:l,onStudentNameChange:d,onStudentIdChange:m})=>e.jsxs(ee,{className:"p-6 mb-6 border-2 border-blue-200",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-blue-800 mb-2",children:"משרד החינוך"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-1",children:"מגן בגרות - מוסיקה"}),e.jsx("div",{className:"text-lg text-gray-700",children:t}),e.jsxs("div",{className:"text-md text-gray-600 mt-2",children:["מנהל/ת: ",s]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(z,{htmlFor:"recital-field",className:"text-right block mb-2 font-semibold",children:"תחום הרסיטל"}),e.jsxs(ms,{value:r,onValueChange:o,children:[e.jsx(At,{id:"recital-field",className:"text-right",children:e.jsx(xs,{placeholder:"בחר תחום רסיטל"})}),e.jsxs(Pt,{children:[e.jsx(xe,{value:"קלאסי",children:"קלאסי"}),e.jsx(xe,{value:"ג'אז",children:"ג'אז"}),e.jsx(xe,{value:"שירה",children:"שירה"})]})]})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"recital-units",className:"text-right block mb-2 font-semibold",children:"יחידות לימוד"}),e.jsxs(ms,{value:n?.toString(),onValueChange:x=>l?.(parseInt(x)),children:[e.jsx(At,{id:"recital-units",className:"text-right",children:e.jsx(xs,{placeholder:"בחר מספר יחידות"})}),e.jsxs(Pt,{children:[e.jsx(xe,{value:"3",children:"3 יחידות"}),e.jsx(xe,{value:"5",children:"5 יחידות"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(z,{htmlFor:"student-name",className:"text-right block mb-2 font-semibold",children:"שם התלמיד/ה"}),e.jsx(U,{id:"student-name",value:a||"",onChange:x=>d?.(x.target.value),placeholder:"הכנס שם התלמיד",className:"text-right",dir:"rtl"})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"student-id",className:"text-right block mb-2 font-semibold",children:"תעודת זהות"}),e.jsx(U,{id:"student-id",value:i||"",onChange:x=>m?.(x.target.value),placeholder:"הכנס מספר תעודת זהות",className:"text-right",dir:"rtl"})]})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"text-sm text-gray-600 text-center",children:[e.jsx("p",{className:"font-semibold mb-1",children:"הערות חשובות:"}),e.jsx("p",{children:"• הרסיטל יכלול 5 יצירות מתקופות שונות"}),e.jsx("p",{children:"• תלמידי 5 יחידות נדרשים לבצע יצירה אחת לפחות בעל פה"}),e.jsx("p",{children:"• ההשמעות 1-3 הן השמעות הכנה, ההשמעה הרביעית היא מגן הבגרות הסופי"})]})})]});function ec({program:t,onChange:s,requiredPieces:r,readonly:n=!1}){const[a,i]=u.useState(null),[o,l]=u.useState(null),[d,m]=u.useState(!1),[x,f]=u.useState({pieceTitle:"",composer:"",duration:"",movement:"",youtubeLink:null}),v=g=>{i(g),l({...t[g]})},h=()=>{i(null),l(null)},b=()=>{if(a!==null&&o){const g=[...t];g[a]=o,s(g),i(null),l(null)}},c=g=>{if(window.confirm("האם אתה בטוח שברצונך למחוק יצירה זו?")){const S=t.filter((A,C)=>C!==g);s(S)}},p=()=>{if(x.pieceTitle&&x.composer&&x.duration){const g=[...t,x];s(g),f({pieceTitle:"",composer:"",duration:"",movement:"",youtubeLink:null}),m(!1)}},N=()=>{f({pieceTitle:"",composer:"",duration:"",movement:"",youtubeLink:null}),m(!1)},y=g=>{const S=g.split(":");return S.length===2?parseInt(S[0])*60+parseInt(S[1]):0},w=g=>{const S=Math.floor(g/60),A=g%60;return`${S}:${A.toString().padStart(2,"0")}`},T=()=>{const g=t.reduce((S,A)=>S+y(A.duration),0);return w(g)},P=g=>g?/^(https?:\/\/)?(www\.)?(youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/).+/.test(g):!0,j=(g,S)=>{const A=a===S;return e.jsx(ee,{padding:"md",className:"relative",children:e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:"flex-1",children:A?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"שם היצירה *"}),e.jsx("input",{type:"text",value:o?.pieceTitle||"",onChange:C=>l(E=>E?{...E,pieceTitle:C.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"שם היצירה"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"מלחין *"}),e.jsx("input",{type:"text",value:o?.composer||"",onChange:C=>l(E=>E?{...E,composer:C.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"שם המלחין"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"משך זמן *"}),e.jsx("input",{type:"text",value:o?.duration||"",onChange:C=>l(E=>E?{...E,duration:C.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"5:30",pattern:"[0-9]+:[0-9]{2}"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"פרק (אופציונלי)"}),e.jsx("input",{type:"text",value:o?.movement||"",onChange:C=>l(E=>E?{...E,movement:C.target.value}:null),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"פרק ראשון"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"קישור YouTube (אופציונלי)"}),e.jsx("input",{type:"url",value:o?.youtubeLink||"",onChange:C=>l(E=>E?{...E,youtubeLink:C.target.value||null}:null),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ${o?.youtubeLink&&!P(o.youtubeLink)?"border-red-300 focus:ring-red-500":"border-gray-300"}`,placeholder:"https://www.youtube.com/watch?v=..."}),o?.youtubeLink&&!P(o.youtubeLink)&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"קישור YouTube לא תקין"})]})]}):e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:g.pieceTitle}),e.jsxs("div",{className:"flex items-center text-gray-600 mb-2",children:[e.jsx(Ue,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"text-sm",children:g.composer}),g.movement&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{className:"text-sm",children:g.movement})]})]}),e.jsxs("div",{className:"flex items-center text-gray-500 text-sm mb-3",children:[e.jsx(he,{className:"w-4 h-4 mr-1"}),g.duration]}),g.youtubeLink&&e.jsxs("a",{href:g.youtubeLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-red-600 hover:text-red-800 text-sm",children:[e.jsx(ta,{className:"w-4 h-4 mr-1"}),"צפה ב-YouTube",e.jsx(sa,{className:"w-3 h-3 mr-1"})]})]})}),!n&&e.jsx("div",{className:"flex items-center gap-2 mr-4",children:A?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:b,disabled:!o?.pieceTitle||!o?.composer||!o?.duration,className:"p-2 text-green-600 hover:text-green-800 disabled:text-gray-400",children:e.jsx(gs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:h,className:"p-2 text-gray-600 hover:text-gray-800",children:e.jsx(yt,{className:"w-4 h-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>v(S),className:"p-2 text-primary-600 hover:text-primary-800",children:e.jsx(hs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>c(S),className:"p-2 text-red-600 hover:text-red-800",children:e.jsx(ps,{className:"w-4 h-4"})})]})})]})},S)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(Z,{className:"w-6 h-6 mr-3 text-primary-600"}),"תוכנית הבגרות"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:'סה"כ זמן:'})," ",T()]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"יצירות:"})," ",t.length]}),!n&&e.jsxs("button",{onClick:()=>m(!0),className:"flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"הוסף יצירה"]})]})]}),e.jsx(ee,{padding:"md",className:"bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Z,{className:"w-5 h-5 text-blue-600 mr-3 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"דרישות התוכנית"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• לפחות 3 יצירות שונות"}),e.jsx("li",{children:"• משך זמן מינימלי: 15 דקות"}),e.jsx("li",{children:"• לכל יצירה חייב להיות קישור להשמעה (מומלץ YouTube)"}),e.jsx("li",{children:"• יש לציין פרק ספציפי אם היצירה מורכבת מכמה פרקים"})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-6",children:[e.jsxs("div",{className:`flex items-center text-sm ${t.length>=3?"text-green-700":"text-red-700"}`,children:[e.jsx("span",{className:"font-medium",children:"יצירות:"}),e.jsxs("span",{className:"mr-1",children:[t.length,"/3 (מינימום)"]}),t.length>=3?" ✓":" ⚠️"]}),e.jsxs("div",{className:`flex items-center text-sm ${y(T())>=900?"text-green-700":"text-red-700"}`,children:[e.jsx("span",{className:"font-medium",children:"זמן כולל:"}),e.jsxs("span",{className:"mr-1",children:[T()," (מינימום 15:00)"]}),y(T())>=900?" ✓":" ⚠️"]})]})]})]})}),d&&!n&&e.jsxs(ee,{padding:"md",className:"border-2 border-primary-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"הוספת יצירה חדשה"}),e.jsx("button",{onClick:N,className:"text-gray-500 hover:text-gray-700",children:e.jsx(yt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"שם היצירה *"}),e.jsx("input",{type:"text",value:x.pieceTitle,onChange:g=>f(S=>({...S,pieceTitle:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"שם היצירה"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"מלחין *"}),e.jsx("input",{type:"text",value:x.composer,onChange:g=>f(S=>({...S,composer:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"שם המלחין"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"משך זמן * (דק:שנ)"}),e.jsx("input",{type:"text",value:x.duration,onChange:g=>f(S=>({...S,duration:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"5:30",pattern:"[0-9]+:[0-9]{2}"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"פרק (אופציונלי)"}),e.jsx("input",{type:"text",value:x.movement||"",onChange:g=>f(S=>({...S,movement:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"פרק ראשון"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"קישור YouTube (אופציונלי)"}),e.jsx("input",{type:"url",value:x.youtubeLink||"",onChange:g=>f(S=>({...S,youtubeLink:g.target.value||null})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 ${x.youtubeLink&&!P(x.youtubeLink)?"border-red-300 focus:ring-red-500":"border-gray-300"}`,placeholder:"https://www.youtube.com/watch?v=..."}),x.youtubeLink&&!P(x.youtubeLink)&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"קישור YouTube לא תקין"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{onClick:N,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"ביטול"}),e.jsx("button",{onClick:p,disabled:!x.pieceTitle||!x.composer||!x.duration,className:"px-4 py-2 bg-primary-500 text-white rounded-md hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"הוסף יצירה"})]})]})]}),t.length>0?e.jsx("div",{className:"space-y-4",children:t.map((g,S)=>j(g,S))}):e.jsx(ee,{padding:"md",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Z,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"אין יצירות בתוכנית"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"הוסף יצירות לתוכנית הבגרות שלך"}),!n&&e.jsxs("button",{onClick:()=>m(!0),className:"inline-flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"הוסף יצירה ראשונה"]})]})})]})}const ks=u.forwardRef(({className:t,...s},r)=>e.jsx("textarea",{className:X("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...s}));ks.displayName="Textarea";const tc=({magenBagrut:t={},onUpdate:s,readonly:r=!1})=>{const[n,a]=u.useState({date:t.date,review:t.review||"",reviewedBy:t.reviewedBy||"",recordingLinks:t.recordingLinks||[""],completed:t.completed||!1,status:t.status||"pending",grade:t.grade,gradeLevel:t.gradeLevel,detailedGrading:{playingSkills:{points:t?.detailedGrading?.playingSkills?.points||void 0,maxPoints:40,comments:t?.detailedGrading?.playingSkills?.comments||""},musicalUnderstanding:{points:t?.detailedGrading?.musicalUnderstanding?.points||void 0,maxPoints:30,comments:t?.detailedGrading?.musicalUnderstanding?.comments||""},textKnowledge:{points:t?.detailedGrading?.textKnowledge?.points||void 0,maxPoints:20,comments:t?.detailedGrading?.textKnowledge?.comments||""},playingByHeart:{points:t?.detailedGrading?.playingByHeart?.points||void 0,maxPoints:10,comments:t?.detailedGrading?.playingByHeart?.comments||""}}}),[i,o]=u.useState({examiner1:"",examiner2:"",examiner3:""});u.useEffect(()=>{const c=l(),p={...n,grade:c,gradeLevel:d(c)};a(p),s(p)},[n.detailedGrading?.playingSkills.points,n.detailedGrading?.musicalUnderstanding.points,n.detailedGrading?.textKnowledge.points,n.detailedGrading?.playingByHeart.points]);const l=()=>{const{playingSkills:c,musicalUnderstanding:p,textKnowledge:N,playingByHeart:y}=n.detailedGrading;return(c.points||0)+(p.points||0)+(N.points||0)+(y.points||0)},d=c=>c>=95?"מצוין (95-100)":c>=85?"טוב מאוד (85-94)":c>=75?"טוב (75-84)":c>=65?"כמעט טוב (65-74)":c>=55?"מספק (55-64)":c>=45?"כמעט מספק (45-54)":c>=35?"לא מספק (35-44)":"גרוע (0-34)",m=(c,p)=>{const N={...n,[c]:p};a(N),s(N)},x=(c,p,N)=>{const y={...n,detailedGrading:{...n.detailedGrading,[c]:{...n.detailedGrading[c],[p]:N}}};a(y),s(y)},f=(c,p)=>{const N=[...n.recordingLinks||[""]];N[c]=p,c===N.length-1&&p&&N.push(""),m("recordingLinks",N.filter((y,w)=>y||w===N.length-1))},v=c=>c?new Date(c).toISOString().split("T")[0]:"",h=c=>c?new Date(c):void 0,b=()=>{const{playingSkills:c,musicalUnderstanding:p,textKnowledge:N,playingByHeart:y}=n.detailedGrading;return c.points!==void 0&&p.points!==void 0&&N.points!==void 0&&y.points!==void 0&&n.date&&n.reviewedBy};return e.jsxs(ee,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center",children:[e.jsx(bt,{className:"w-6 h-6 ml-3 text-gold-600"}),"מגן בגרות - השמעה סופית"]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${n.completed?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:n.completed?"הושלמה":"טרם הושלמה"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsxs(z,{htmlFor:"magen-date",className:"text-right block mb-2 font-semibold",children:[e.jsx(Ot,{className:"w-4 h-4 inline ml-2"}),"תאריך מגן הבגרות"]}),e.jsx(U,{id:"magen-date",type:"date",value:v(n.date),onChange:c=>m("date",h(c.target.value)),disabled:r,className:"text-right"})]}),e.jsxs("div",{children:[e.jsxs(z,{htmlFor:"magen-reviewedBy",className:"text-right block mb-2 font-semibold",children:[e.jsx(Oe,{className:"w-4 h-4 inline ml-2"}),"ועדת הבוחנים"]}),e.jsx(U,{id:"magen-reviewedBy",value:n.reviewedBy||"",onChange:c=>m("reviewedBy",c.target.value),placeholder:"שמות הבוחנים בוועדה",disabled:r,className:"text-right",dir:"rtl"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900 mb-4",children:"טבלת ציונים - מגן בגרות במוסיקה"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border-2 border-gray-400",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-blue-100",children:[e.jsx("th",{className:"border-2 border-gray-400 px-4 py-3 text-right font-bold text-gray-900",children:"קריטריון הערכה"}),e.jsx("th",{className:"border-2 border-gray-400 px-4 py-3 text-center font-bold text-gray-900",children:"ניקוד מקסימלי"}),e.jsx("th",{className:"border-2 border-gray-400 px-4 py-3 text-center font-bold text-gray-900",children:"ניקוד שהתקבל"}),e.jsx("th",{className:"border-2 border-gray-400 px-4 py-3 text-right font-bold text-gray-900",children:"הערות"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"border-2 border-gray-400 px-4 py-3 font-semibold text-right",children:"מיומנות נגינה"}),e.jsx("td",{className:"border-2 border-gray-400 px-4 py-3 text-center font-bold text-lg",children:"40"}),e.jsx("td",{className:"border-2 border-gray-400 px-2 py-2 text-center",children:e.jsx(U,{type:"number",min:"0",max:"40",value:n.detailedGrading?.playingSkills.points||"",onChange:c=>x("playingSkills","points",parseInt(c.target.value)||0),disabled:r,className:"w-20 mx-auto text-center font-bold text-lg border-2 focus:border-blue-500"})}),e.jsx("td",{className:"border-2 border-gray-400 px-2 py-2",children:e.jsx(U,{value:n.detailedGrading?.playingSkills.comments||"",onChange:c=>x("playingSkills","comments",c.target.value),disabled:r,placeholder:"הערות על מיומנות הנגינה",className:"border-0 text-right text-sm",dir:"rtl"})})]}),e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("td",{className:"border-2 border-gray-400 px-4 py-3 font-semibold text-right",children:"הבנה מוסיקלית"}),e.jsx("td",{className:"border-2 border-gray-400 px-4 py-3 text-center font-bold text-lg",children:"30"}),e.jsx("td",{className:"border-2 border-gray-400 px-2 py-2 text-center",children:e.jsx(U,{type:"number",min:"0",max:"30",value:n.detailedGrading?.musicalUnderstanding.points||"",onChange:c=>x("musicalUnderstanding","points",parseInt(c.target.value)||0),disabled:r,className:"w-20 mx-auto text-center font-bold text-lg border-2 focus:border-blue-500"})}),e.jsx("td",{className:"border-2 border-gray-400 px-2 py-2",children:e.jsx(U,{value:n.detailedGrading?.musicalUnderstanding.comments||"",onChange:c=>x("musicalUnderstanding","comments",c.target.value),disabled:r,placeholder:"הערות על הבנה מוסיקלית",className:"border-0 text-right text-sm",dir:"rtl"})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border-2 border-gray-400 px-4 py-3 font-semibold text-right",children:"ידיעת הטקסט"}),e.jsx("td",{className:"border-2 border-gray-400 px-4 py-3 text-center font-bold text-lg",children:"20"}),e.jsx("td",{className:"border-2 border-gray-400 px-2 py-2 text-center",children:e.jsx(U,{type:"number",min:"0",max:"20",value:n.detailedGrading?.textKnowledge.points||"",onChange:c=>x("textKnowledge","points",parseInt(c.target.value)||0),disabled:r,className:"w-20 mx-auto text-center font-bold text-lg border-2 focus:border-blue-500"})}),e.jsx("td",{className:"border-2 border-gray-400 px-2 py-2",children:e.jsx(U,{value:n.detailedGrading?.textKnowledge.comments||"",onChange:c=>x("textKnowledge","comments",c.target.value),disabled:r,placeholder:"הערות על ידיעת הטקסט",className:"border-0 text-right text-sm",dir:"rtl"})})]}),e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("td",{className:"border-2 border-gray-400 px-4 py-3 font-semibold text-right",children:'נגינה בע"פ'}),e.jsx("td",{className:"border-2 border-gray-400 px-4 py-3 text-center font-bold text-lg",children:"10"}),e.jsx("td",{className:"border-2 border-gray-400 px-2 py-2 text-center",children:e.jsx(U,{type:"number",min:"0",max:"10",value:n.detailedGrading?.playingByHeart.points||"",onChange:c=>x("playingByHeart","points",parseInt(c.target.value)||0),disabled:r,className:"w-20 mx-auto text-center font-bold text-lg border-2 focus:border-blue-500"})}),e.jsx("td",{className:"border-2 border-gray-400 px-2 py-2",children:e.jsx(U,{value:n.detailedGrading?.playingByHeart.comments||"",onChange:c=>x("playingByHeart","comments",c.target.value),disabled:r,placeholder:"הערות על נגינה בעל פה",className:"border-0 text-right text-sm",dir:"rtl"})})]}),e.jsxs("tr",{className:"bg-blue-200",children:[e.jsx("td",{className:"border-2 border-gray-400 px-4 py-3 font-bold text-right text-lg",children:'סה"כ ציון'}),e.jsx("td",{className:"border-2 border-gray-400 px-4 py-3 text-center font-bold text-xl",children:"100"}),e.jsx("td",{className:"border-2 border-gray-400 px-4 py-3 text-center",children:e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:l()})}),e.jsx("td",{className:"border-2 border-gray-400 px-4 py-3 text-right",children:e.jsx("div",{className:"font-semibold text-blue-800",children:d(l())})})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsxs(z,{className:"text-right block mb-2 font-semibold",children:[e.jsx(ra,{className:"w-4 h-4 inline ml-2"}),"קישורי הקלטות למגן"]}),e.jsx("div",{className:"space-y-2",children:(n.recordingLinks||[""]).map((c,p)=>e.jsx(U,{value:c,onChange:N=>f(p,N.target.value),placeholder:`קישור הקלטה ${p+1}`,disabled:r,className:"text-left",dir:"ltr"},p))})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"magen-review",className:"text-right block mb-2 font-semibold",children:"הערות כלליות של הוועדה"}),e.jsx(ks,{id:"magen-review",value:n.review||"",onChange:c=>m("review",c.target.value),placeholder:"הערות כלליות על הביצוע והרמה הכללית...",disabled:r,className:"text-right min-h-[120px]",dir:"rtl"})]})]}),e.jsxs("div",{className:"mb-6 p-4 border-2 border-gray-300 rounded-lg",children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-3",children:"חתימות ועדת הבוחנים"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(z,{className:"text-right block mb-2",children:"בוחן ראשי"}),e.jsx(U,{value:i.examiner1,onChange:c=>o(p=>({...p,examiner1:c.target.value})),placeholder:"חתימה",disabled:r,className:"text-right",dir:"rtl"})]}),e.jsxs("div",{children:[e.jsx(z,{className:"text-right block mb-2",children:"בוחן שני"}),e.jsx(U,{value:i.examiner2,onChange:c=>o(p=>({...p,examiner2:c.target.value})),placeholder:"חתימה",disabled:r,className:"text-right",dir:"rtl"})]}),e.jsxs("div",{children:[e.jsx(z,{className:"text-right block mb-2",children:"בוחן שלישי"}),e.jsx(U,{value:i.examiner3,onChange:c=>o(p=>({...p,examiner3:c.target.value})),placeholder:"חתימה",disabled:r,className:"text-right",dir:"rtl"})]})]})]}),!r&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(ys,{onClick:()=>m("completed",!n.completed),disabled:!b(),variant:n.completed?"destructive":"default",className:"flex items-center",children:n.completed?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 ml-2"}),"בטל השלמת מגן"]}):e.jsxs(e.Fragment,{children:[e.jsx(bt,{className:"w-4 h-4 ml-2"}),"השלם מגן בגרות"]})}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-800",children:["ציון סופי: ",l(),"/100"]}),e.jsx("div",{className:"text-sm text-gray-600",children:d(l())})]})]})]})},sc=({directorEvaluation:t={},directorName:s="לימור אקטע",onUpdate:r,readonly:n=!1})=>{const[a,i]=u.useState({points:t.points,percentage:t.percentage,comments:t.comments||""}),[o,l]=u.useState(""),[d,m]=u.useState("");u.useEffect(()=>{const h=a.points!==void 0?a.points/10*100:void 0,b={...a,percentage:h};i(b),r(b)},[a.points]);const x=(h,b)=>{const c={...a,[h]:b};i(c),r(c)},f=h=>h>=9?"מצוין":h>=8?"טוב מאוד":h>=7?"טוב":h>=6?"מספק":h>=5?"כמעט מספק":"לא מספק",v=h=>h>=8?"text-green-700":h>=6?"text-blue-700":h>=5?"text-yellow-700":"text-red-700";return e.jsxs(ee,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center",children:[e.jsx(na,{className:"w-6 h-6 ml-3 text-blue-600"}),"הערכת המנהל/ת"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"משקל:"})," 10% מהציון הסופי"]})]}),e.jsx("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(st,{className:"w-5 h-5 text-blue-600 ml-3 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"על הערכת המנהל/ת"}),e.jsx("p",{className:"text-sm text-blue-800 mb-2",children:"הערכת המנהל/ת מהווה 10% מהציון הסופי בבגרות המוסיקה ומבוססת על:"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• מעורבות והשתתפות בחיי בית הספר המוסיקלי"}),e.jsx("li",{children:"• התקדמות והתפתחות לאורך השנים"}),e.jsx("li",{children:"• יחס והתנהגות כלפי הלמידה והחברים"}),e.jsx("li",{children:"• תרומה לקהילה המוסיקלית"}),e.jsx("li",{children:"• מוכנות והקפדה על משימות"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(z,{htmlFor:"director-points",className:"text-right block mb-3 font-semibold text-lg",children:"ציון המנהל/ת (0-10 נקודות)"}),e.jsxs("div",{className:"relative",children:[e.jsx(U,{id:"director-points",type:"number",min:"0",max:"10",step:"0.1",value:a.points||"",onChange:h=>x("points",parseFloat(h.target.value)||void 0),disabled:n,className:"text-center text-2xl font-bold h-16 border-2 focus:border-blue-500",placeholder:"0.0"}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"/10"})]}),a.points!==void 0&&e.jsxs("div",{className:`text-center mt-2 font-semibold ${v(a.points)}`,children:[f(a.points),a.percentage!==void 0&&e.jsxs("span",{className:"block text-sm text-gray-600 mt-1",children:["(",a.percentage.toFixed(1),"%)"]})]})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"evaluation-date",className:"text-right block mb-2 font-semibold",children:"תאריך הערכה"}),e.jsx(U,{id:"evaluation-date",type:"date",value:d,onChange:h=>m(h.target.value),disabled:n,className:"text-right"})]}),e.jsxs("div",{children:[e.jsxs(z,{htmlFor:"director-signature",className:"text-right block mb-2 font-semibold",children:[e.jsx(aa,{className:"w-4 h-4 inline ml-2"}),"חתימת המנהל/ת"]}),e.jsx("div",{className:"text-sm text-gray-600 mb-2 text-right",children:s}),e.jsx(U,{id:"director-signature",value:o,onChange:h=>l(h.target.value),placeholder:"חתימה דיגיטלית",disabled:n,className:"text-right",dir:"rtl"})]})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"director-comments",className:"text-right block mb-2 font-semibold",children:"הערות והסבר להערכה"}),e.jsx(ks,{id:"director-comments",value:a.comments||"",onChange:h=>x("comments",h.target.value),placeholder:"הערות המנהל/ת על התלמיד/ה: התקדמות, מעורבות, יחס, תרומה לקהילה...",disabled:n,className:"text-right min-h-[200px] resize-y",dir:"rtl"})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"חישוב במסגרת הציון הסופי:"}),e.jsxs("div",{className:"text-sm text-yellow-700",children:[e.jsx("p",{children:"• ציון מגן הבגרות: 90% מהציון הסופי"}),e.jsx("p",{children:"• הערכת המנהל/ת: 10% מהציון הסופי"}),a.points!==void 0&&e.jsxs("p",{className:"mt-2 font-semibold",children:["תרומה לציון הסופי: ",(a.points/10*10).toFixed(1)," נקודות"]})]})]}),e.jsxs("div",{className:"mt-6 p-4 border-2 border-gray-300 rounded-lg",children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-3",children:"סולם הערכה"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between p-2 bg-green-100 rounded",children:[e.jsx("span",{className:"font-medium",children:"מצוין"}),e.jsx("span",{children:"9.0-10.0"})]}),e.jsxs("div",{className:"flex justify-between p-2 bg-blue-100 rounded",children:[e.jsx("span",{className:"font-medium",children:"טוב מאוד"}),e.jsx("span",{children:"8.0-8.9"})]}),e.jsxs("div",{className:"flex justify-between p-2 bg-blue-50 rounded",children:[e.jsx("span",{className:"font-medium",children:"טוב"}),e.jsx("span",{children:"7.0-7.9"})]}),e.jsxs("div",{className:"flex justify-between p-2 bg-yellow-100 rounded",children:[e.jsx("span",{className:"font-medium",children:"מספק"}),e.jsx("span",{children:"6.0-6.9"})]}),e.jsxs("div",{className:"flex justify-between p-2 bg-orange-100 rounded",children:[e.jsx("span",{className:"font-medium",children:"כמעט מספק"}),e.jsx("span",{children:"5.0-5.9"})]}),e.jsxs("div",{className:"flex justify-between p-2 bg-red-100 rounded",children:[e.jsx("span",{className:"font-medium",children:"לא מספק"}),e.jsx("span",{children:"0.0-4.9"})]})]})]}),!n&&a.points!==void 0&&e.jsxs("div",{className:"mt-6 text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-gray-900",children:["הערכת המנהל/ת: ",a.points,"/10"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["משמעות: ",f(a.points)," • תרומה לציון הסופי: ",(a.points/10*10).toFixed(1)," נקודות"]})]})]})},rc=({bagrut:t,completionStatus:s,validationErrors:r})=>{const n=()=>{const x=t.presentations?.[3];if(!x?.grade)return 0;const f=x.grade*.9,v=(t.directorEvaluation?.points||0)*.1*10;return Math.round(f+v)},a=x=>{const f=[{level:"מצוין",range:"95-100",description:"רמה יוצאת דופן",min:95,color:"bg-green-600"},{level:"טוב מאוד",range:"85-94",description:"רמה גבוהה מאוד",min:85,color:"bg-green-500"},{level:"טוב",range:"75-84",description:"רמה טובה",min:75,color:"bg-blue-500"},{level:"כמעט טוב",range:"65-74",description:"רמה מעל הממוצע",min:65,color:"bg-blue-400"},{level:"מספק",range:"55-64",description:"רמה מספקת",min:55,color:"bg-yellow-500"},{level:"כמעט מספק",range:"45-54",description:"רמה מתחת לממוצע",min:45,color:"bg-orange-500"},{level:"לא מספק",range:"35-44",description:"רמה נמוכה",min:35,color:"bg-red-500"},{level:"גרוע",range:"0-34",description:"רמה לא מתאימה",min:0,color:"bg-red-600"}];for(const v of f)if(x>=v.min)return v;return f[f.length-1]},i=n(),o=a(i),l=t.presentations?.[3],d=!!(l?.grade&&t.directorEvaluation?.points);r.filter(x=>x.type==="error").length>0;const m=()=>[{level:"מצוין",range:"95-100",description:"רמה יוצאת דופן",color:"bg-green-600"},{level:"טוב מאוד",range:"85-94",description:"רמה גבוהה מאוד",color:"bg-green-500"},{level:"טוב",range:"75-84",description:"רמה טובה",color:"bg-blue-500"},{level:"כמעט טוב",range:"65-74",description:"רמה מעל הממוצע",color:"bg-blue-400"},{level:"מספק",range:"55-64",description:"רמה מספקת",color:"bg-yellow-500"},{level:"כמעט מספק",range:"45-54",description:"רמה מתחת לממוצע",color:"bg-orange-500"},{level:"לא מספק",range:"35-44",description:"רמה נמוכה",color:"bg-red-500"},{level:"גרוע",range:"0-34",description:"רמה לא מתאימה",color:"bg-red-600"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ee,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(la,{className:"w-7 h-7 ml-3 text-blue-600"}),"סיכום ציונים - בגרות במוסיקה"]}),d&&e.jsxs(et,{variant:"success",className:"text-lg px-4 py-2",children:[e.jsx(Ds,{className:"w-5 h-5 ml-2"}),"הושלם"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border-2 border-blue-200",children:[e.jsx(bt,{className:"w-8 h-8 mx-auto text-blue-600 mb-2"}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"ציון מגן בגרות"}),e.jsxs("div",{className:"text-3xl font-bold text-blue-800",children:[l?.grade!==void 0?l.grade:"--","/100"]}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"90% מהציון הסופי"}),l?.grade!==void 0&&e.jsxs("div",{className:"text-xs text-blue-700 mt-1",children:["תרומה: ",(l.grade*.9).toFixed(1)," נקודות"]})]})}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border-2 border-green-200",children:[e.jsx(st,{className:"w-8 h-8 mx-auto text-green-600 mb-2"}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"הערכת המנהל/ת"}),e.jsxs("div",{className:"text-3xl font-bold text-green-800",children:[t.directorEvaluation?.points!==void 0?t.directorEvaluation.points:"--","/10"]}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"10% מהציון הסופי"}),t.directorEvaluation?.points!==void 0&&e.jsxs("div",{className:"text-xs text-green-700 mt-1",children:["תרומה: ",(t.directorEvaluation.points*.1*10).toFixed(1)," נקודות"]})]})}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:`rounded-lg p-4 border-2 ${d?`${o.color} text-white`:"bg-gray-50 border-gray-200"}`,children:[e.jsx(Ds,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("h4",{className:"font-semibold mb-1",children:"ציון סופי"}),e.jsxs("div",{className:"text-3xl font-bold",children:[d?i.toFixed(1):"--","/100"]}),d&&e.jsx("div",{className:"text-sm mt-1 font-medium",children:o.level})]})})]}),e.jsxs("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3 text-center",children:"נוסחת החישוב"}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"inline-flex items-center gap-4 text-lg",children:[e.jsxs("div",{className:"bg-blue-100 px-3 py-1 rounded",children:[e.jsx("span",{className:"font-semibold",children:"ציון מגן בגרות"})," × 90%"]}),e.jsx("span",{className:"text-xl",children:"+"}),e.jsxs("div",{className:"bg-green-100 px-3 py-1 rounded",children:[e.jsx("span",{className:"font-semibold",children:"הערכת המנהל/ת"})," × 10%"]}),e.jsx("span",{className:"text-xl",children:"="}),e.jsx("div",{className:`px-3 py-1 rounded font-bold ${d?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:"ציון סופי"})]})}),d&&e.jsxs("div",{className:"text-center mt-4 text-sm text-gray-700",children:[e.jsxs("div",{className:"font-mono",children:[l.grade," × 0.9 + ",t.directorEvaluation.points," × 1.0 = ",i.toFixed(1)]}),e.jsxs("div",{className:"mt-1",children:["(",(l.grade*.9).toFixed(1)," + ",(t.directorEvaluation.points*1).toFixed(1)," = ",i.toFixed(1),")"]})]}),r.length>0&&e.jsx("div",{className:"mt-4 space-y-2",children:r.map((x,f)=>e.jsxs("div",{className:`flex items-center p-3 rounded-lg ${x.type==="error"?"bg-red-50 border border-red-200 text-red-800":"bg-yellow-50 border border-yellow-200 text-yellow-800"}`,children:[e.jsx(pr,{className:"w-4 h-4 ml-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:x.message})]},f))}),s&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"סטטוס השלמה"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"השמעות"}),e.jsxs("div",{className:`text-lg ${s.presentations.completed===4?"text-green-600":"text-gray-600"}`,children:[s.presentations.completed,"/4"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"תכנית"}),e.jsxs("div",{className:`text-lg ${s.programPieces.percentage===100?"text-green-600":"text-gray-600"}`,children:[s.programPieces.completed,"/",s.programPieces.required]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:"הערכת מנהל"}),e.jsx("div",{className:`text-lg ${s.directorEvaluation.completed?"text-green-600":"text-gray-600"}`,children:s.directorEvaluation.completed?"✓":"✗"})]})]})]})]}),d&&e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("div",{className:"inline-block p-6 rounded-lg border-2 border-blue-200 bg-blue-50",children:[e.jsx("h4",{className:"text-xl font-bold text-blue-900 mb-2",children:"תוצאה סופית"}),e.jsx("div",{className:"text-4xl font-bold text-blue-800 mb-2",children:i.toFixed(1)}),e.jsxs("div",{className:"text-lg font-semibold mb-1",children:[o.level," (",o.range,")"]}),e.jsx("div",{className:"text-sm text-blue-700",children:o.description})]})})]}),e.jsxs(ee,{className:"p-6",children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900 mb-4 text-center",children:"סולם הציונים - משרד החינוך"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:m().map((x,f)=>e.jsxs("div",{className:`p-3 rounded-lg border-2 ${d&&i>=x.range.split("-")[0]?`${x.color} text-white border-transparent`:"bg-white border-gray-200 text-gray-700"}`,children:[e.jsx("div",{className:"font-semibold text-sm",children:x.level}),e.jsx("div",{className:"text-xs mt-1",children:x.range}),e.jsx("div",{className:"text-xs mt-1 opacity-90",children:x.description})]},f))})]})]})},nc=({student:t,studentId:s,onStudentUpdate:r})=>{const[n,a]=u.useState(null),[i,o]=u.useState(!0),[l,d]=u.useState([]),[m,x]=u.useState(null),f=()=>[{completed:!1,status:"pending",notes:"",recordingLinks:[]},{completed:!1,status:"pending",notes:"",recordingLinks:[]},{completed:!1,status:"pending",notes:"",recordingLinks:[]},{completed:!1,status:"pending",notes:"",recordingLinks:[],grade:0,gradeLevel:""}];u.useEffect(()=>{v()},[s]),u.useEffect(()=>{n&&(h(),b())},[n]);const v=async()=>{o(!0);try{const g={_id:`bagrut_${s}`,studentId:s,teacherId:t.teacherId||"",conservatoryName:"מרכז המוסיקה רעננה",directorName:"לימור אקטע",recitalField:void 0,recitalUnits:void 0,program:[],accompaniment:{type:"נגן מלווה",accompanists:[]},presentations:f(),directorEvaluation:{points:void 0,percentage:void 0,comments:""},isCompleted:!1,isActive:!0,createdAt:new Date,updatedAt:new Date};a(g)}catch(g){console.error("Failed to load Bagrut data:",g)}finally{o(!1)}},h=()=>{if(!n)return;const g=[];n.recitalField||g.push({field:"recitalField",message:"יש לבחור תחום רסיטל",type:"error"}),n.recitalUnits||g.push({field:"recitalUnits",message:"יש לבחור מספר יחידות לימוד",type:"error"});const S=n.recitalUnits===5?5:3;n.program.length<S&&g.push({field:"program",message:`נדרשות ${S} יצירות לתכנית`,type:"error"});const A=n.presentations||[];for(let E=1;E<A.length;E++)A[E].completed&&!A[E-1].completed&&g.push({field:`presentation_${E}`,message:`לא ניתן להשלים השמעה ${E+1} לפני השלמת השמעה ${E}`,type:"error"});const C=A[3];if(C?.completed){const E=C?.detailedGrading;if(E){const L=(E.playingSkills.points||0)+(E.musicalUnderstanding.points||0)+(E.textKnowledge.points||0)+(E.playingByHeart.points||0);L>100&&g.push({field:"magenGrading",message:"סך הנקודות חורג מ-100",type:"warning"}),L<55&&g.push({field:"magenGrading",message:"ציון נמוך מהמינימום הנדרש",type:"warning"}),(E.playingSkills.points||0)>E.playingSkills.maxPoints&&g.push({field:"playingSkills",message:`נקודות מיומנות נגינה חורגות מהמקסימום (${E.playingSkills.maxPoints})`,type:"error"}),(E.musicalUnderstanding.points||0)>E.musicalUnderstanding.maxPoints&&g.push({field:"musicalUnderstanding",message:`נקודות הבנה מוסיקלית חורגות מהמקסימום (${E.musicalUnderstanding.maxPoints})`,type:"error"}),(E.textKnowledge.points||0)>E.textKnowledge.maxPoints&&g.push({field:"textKnowledge",message:`נקודות ידיעת טקסט חורגות מהמקסימום (${E.textKnowledge.maxPoints})`,type:"error"}),(E.playingByHeart.points||0)>E.playingByHeart.maxPoints&&g.push({field:"playingByHeart",message:`נקודות נגינה בע״פ חורגות מהמקסימום (${E.playingByHeart.maxPoints})`,type:"error"})}}A.filter(E=>E.completed).length===4&&(n.directorEvaluation?.points||g.push({field:"directorEvaluation",message:"נדרשת הערכת מנהל לפני סיום התהליך",type:"error"})),n.recitalUnits===5&&!n.program.some(L=>L.movement?.toLowerCase().includes("בעל פה")||L.pieceTitle?.toLowerCase().includes("בעל פה"))&&n.program.length>=5&&g.push({field:"program",message:"תלמידי 5 יחידות נדרשים לבצע יצירה אחת לפחות בעל פה",type:"warning"}),d(g)},b=()=>{if(!n)return;const S=(n.presentations||[]).filter(I=>I.completed).length,A=n.recitalUnits===5?5:3,C=Math.min(n.program.length/A*100,100),E=!!n.directorEvaluation?.points,L=S/4*100,O=E?100:0,D=L*.6+C*.3+O*.1,_=S===4&&E&&n.program.length>=A&&l.filter(I=>I.type==="error").length===0;x({presentations:{completed:S,total:4,percentage:L},programPieces:{completed:n.program.length,required:A,percentage:C},directorEvaluation:{completed:E,percentage:O},overall:{percentage:D,canComplete:_}})},c=g=>{if(!n)return;const S={...n,...g,updatedAt:new Date};a(S)},p=(g,S)=>{if(!n)return;const A=[...n.presentations||[]];A[g]={...A[g],...S},c({presentations:A})},N=g=>{c({directorEvaluation:g})},y=g=>n?.presentations?g===0?!0:n.presentations[g-1]?.completed||!1:!1,w=()=>e.jsxs(ee,{className:"p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(Z,{className:"w-6 h-6 ml-3 text-primary-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"הגדרת רסיטל"})]}),e.jsx(Jo,{conservatoryName:n?.conservatoryName,directorName:n?.directorName,recitalField:n?.recitalField,recitalUnits:n?.recitalUnits,studentName:t.name,studentId:s,onRecitalFieldChange:g=>c({recitalField:g}),onRecitalUnitsChange:g=>c({recitalUnits:g})})]}),T=()=>m?e.jsxs(ee,{className:"p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(oa,{className:"w-6 h-6 ml-3 text-green-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"התקדמות כללית"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:[m.presentations.completed,"/4"]}),e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"השמעות הושלמו"}),e.jsx(Je,{value:m.presentations.percentage,className:"h-2"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600 mb-1",children:[m.programPieces.completed,"/",m.programPieces.required]}),e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"יצירות בתכנית"}),e.jsx(Je,{value:m.programPieces.percentage,className:"h-2"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:m.directorEvaluation.completed?"✓":"✗"}),e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"הערכת מנהל"}),e.jsx(Je,{value:m.directorEvaluation.percentage,className:"h-2"})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-primary-600 mb-2",children:[Math.round(m.overall.percentage),"%"]}),e.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"השלמה כללית"}),e.jsx(Je,{value:m.overall.percentage,className:"h-3 mb-4"}),m.overall.canComplete?e.jsxs(et,{variant:"success",className:"text-sm",children:[e.jsx(fe,{className:"w-4 h-4 ml-1"}),"מוכן להשלמה"]}):e.jsxs(et,{variant:"secondary",className:"text-sm",children:[e.jsx(he,{className:"w-4 h-4 ml-1"}),"בתהליך"]})]})]}):null,P=()=>l.length===0?null:e.jsx("div",{className:"mb-6 space-y-2",children:l.map((g,S)=>e.jsxs(Kn,{variant:g.type==="error"?"destructive":"default",children:[e.jsx(pr,{className:"h-4 w-4"}),e.jsx(Yn,{children:g.message})]},S))}),j=()=>n?.presentations?e.jsxs("div",{className:"space-y-6 mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ot,{className:"w-6 h-6 ml-3 text-orange-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"השמעות"})]}),n.presentations.map((g,S)=>{const A=y(S),C=S===3;return e.jsxs(ee,{className:`p-6 relative ${A?"":"opacity-50"}`,children:[!A&&e.jsx("div",{className:"absolute inset-0 bg-gray-100/50 flex items-center justify-center z-10 rounded-lg",children:e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-lg flex items-center",children:[e.jsx(Ms,{className:"w-5 h-5 ml-2 text-gray-500"}),e.jsxs("span",{className:"text-gray-600",children:["השלם את השמעה ",S," תחילה"]})]})}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[C?e.jsx(st,{className:"w-6 h-6 ml-3 text-yellow-500"}):e.jsx(Z,{className:"w-6 h-6 ml-3 text-blue-500"}),e.jsx("h4",{className:"text-lg font-bold",children:C?"מגן בגרות":`השמעה ${S+1}`})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[g.completed?e.jsxs(et,{variant:"success",children:[e.jsx(fe,{className:"w-4 h-4 ml-1"}),"הושלמה"]}):e.jsxs(et,{variant:"secondary",children:[e.jsx(he,{className:"w-4 h-4 ml-1"}),"ממתינה"]}),A?e.jsx(ca,{className:"w-4 h-4 text-green-500"}):e.jsx(Ms,{className:"w-4 h-4 text-gray-400"})]})]}),C&&A?e.jsx(tc,{magenBagrut:g,onUpdate:E=>p(S,E),readonly:!A}):A?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(z,{className:"text-right",children:"תאריך השמעה"}),e.jsx(U,{type:"date",value:g.date?new Date(g.date).toISOString().split("T")[0]:"",onChange:E=>p(S,{date:E.target.value?new Date(E.target.value):void 0,completed:!!E.target.value}),className:"text-right"})]}),e.jsxs("div",{children:[e.jsx(z,{className:"text-right",children:"סטטוס"}),e.jsxs(ms,{value:g.status||"pending",onValueChange:E=>p(S,{status:E}),children:[e.jsx(At,{className:"text-right",children:e.jsx(xs,{})}),e.jsxs(Pt,{children:[e.jsx(xe,{value:"pending",children:"ממתין"}),e.jsx(xe,{value:"completed",children:"הושלם"}),e.jsx(xe,{value:"needs_improvement",children:"זקוק שיפור"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(z,{className:"text-right",children:"הערות ומשוב"}),e.jsx(U,{value:g.notes||"",onChange:E=>p(S,{notes:E.target.value}),placeholder:"הערות על ההשמעה...",className:"text-right",dir:"rtl"})]})]}):null]},S)})]}):null;return i?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Z,{className:"w-8 h-8 animate-pulse mx-auto mb-4 text-primary-600"}),e.jsx("div",{className:"text-lg font-semibold text-gray-700 mb-2",children:"טוען נתוני בגרות..."})]})}):n?e.jsxs("div",{className:"space-y-6",children:[w(),T(),P(),e.jsxs(ee,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(fs,{className:"w-6 h-6 ml-3 text-purple-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"תכנית הרסיטל"})]}),e.jsx(ec,{program:n.program||[],onChange:g=>c({program:g}),requiredPieces:n.recitalUnits===5?5:3,readonly:!1})]}),j(),e.jsxs(ee,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(ia,{className:"w-6 h-6 ml-3 text-indigo-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"הערכת מנהל"})]}),e.jsx(sc,{evaluation:n.directorEvaluation||{points:void 0,comments:""},onUpdate:N,readonly:!1})]}),e.jsx(rc,{bagrut:n,completionStatus:m,validationErrors:l})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-red-600 text-lg mb-2",children:"⚠️ שגיאה בטעינת נתוני בגרות"}),e.jsx(ys,{onClick:v,variant:"outline",children:"נסה שוב"})]})},ac=({student:t})=>e.jsxs("div",{className:"p-6 text-center text-gray-500",children:[e.jsx("div",{className:"text-4xl mb-4",children:"✅"}),e.jsx("div",{children:"נוכחות - בפיתוח"})]}),lc=({student:t})=>e.jsxs("div",{className:"p-6 text-center text-gray-500",children:[e.jsx("div",{className:"text-4xl mb-4",children:"📄"}),e.jsx("div",{children:"מסמכים - בפיתוח"})]}),be=()=>e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(da,{className:"w-6 h-6 animate-spin mx-auto mb-3 text-primary-600"}),e.jsx("div",{className:"text-sm text-gray-600",children:"טוען נתונים..."})]})}),ic=({error:t,resetError:s,tabName:r})=>e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("div",{className:"text-red-600 text-lg mb-2",children:["⚠️ שגיאה בטעינת ",r]}),e.jsx("div",{className:"text-gray-600 mb-4 text-sm",children:t.message}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors text-sm",children:"נסה שוב"})]});class ye extends Ne.Component{constructor(s){super(s),this.state={hasError:!1,error:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,r){console.error(`Error in ${this.props.tabName} tab:`,s,r)}render(){return this.state.hasError&&this.state.error?e.jsx(ic,{error:this.state.error,resetError:()=>this.setState({hasError:!1,error:null}),tabName:this.props.tabName}):this.props.children}}const oc=({activeTab:t,studentId:s,student:r,isLoading:n,errors:a={},actions:i={},fileHandling:o={},onStudentUpdate:l})=>{const d=()=>{switch(t){case"documents":return e.jsx(ht.DocumentsList,{});case"schedule":return e.jsx(ht.Schedule,{});default:return e.jsx(ht.TabContent,{})}},m=typeof n=="object"?n[t]||n.student:n;if(m)return e.jsx(br,{isLoading:!0,skeleton:d(),minHeight:"400px",children:e.jsx("div",{})});if(!r)return e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-400 text-lg mb-2",children:"📄"}),e.jsx("div",{className:"text-gray-600",children:"אין נתונים להצגה"})]})});const x=()=>{switch(t){case"personal":return e.jsx(ye,{tabName:"פרטים אישיים",children:e.jsx(u.Suspense,{fallback:e.jsx(be,{}),children:e.jsx(va,{student:r,studentId:s,onStudentUpdate:l})})});case"academic":return e.jsx(ye,{tabName:"פרטים אקדמיים",children:e.jsx(u.Suspense,{fallback:e.jsx(be,{}),children:e.jsx(ba,{student:r,studentId:s,onStudentUpdate:l})})});case"schedule":return e.jsx(ye,{tabName:"לוח זמנים",children:e.jsx(u.Suspense,{fallback:e.jsx(be,{}),children:e.jsx(wa,{student:r,studentId:s,isLoading:m})})});case"attendance":return e.jsx(ye,{tabName:"נוכחות",children:e.jsx(u.Suspense,{fallback:e.jsx(be,{}),children:e.jsx(ac,{student:r})})});case"orchestra":return e.jsx(ye,{tabName:"תזמורות",children:e.jsx(u.Suspense,{fallback:e.jsx(be,{}),children:e.jsx(Sa,{student:r,studentId:s,isLoading:m})})});case"theory":return e.jsx(ye,{tabName:"תיאוריה",children:e.jsx(u.Suspense,{fallback:e.jsx(be,{}),children:e.jsx(Na,{student:r,studentId:s})})});case"bagrut":return e.jsx(ye,{tabName:"בגרות",children:e.jsx(u.Suspense,{fallback:e.jsx(be,{}),children:e.jsx(nc,{student:r,studentId:s,onStudentUpdate:l})})});case"documents":return e.jsx(ye,{tabName:"מסמכים",children:e.jsx(u.Suspense,{fallback:e.jsx(be,{}),children:e.jsx(lc,{student:r})})});default:return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 text-lg mb-2",children:"🚧"}),e.jsx("div",{className:"text-gray-600",children:"תוכן טרם פותח"})]})}};return e.jsx("div",{className:"min-h-96",children:x()})},pc=()=>{console.log("🔍 StudentDetailsPage component loading...");const{studentId:t}=zn();console.log("📝 Student ID from params:",t);const s=qn(),[r,n]=u.useState("personal"),[a,i]=u.useState(null),[o,l]=u.useState(!0),[d,m]=u.useState(null),x=[{id:"personal",label:"פרטים אישיים",component:()=>null},{id:"academic",label:"מידע אקדמי",component:()=>null},{id:"schedule",label:"לוח זמנים",component:()=>null},{id:"attendance",label:"נוכחות",component:()=>null},{id:"orchestra",label:"תזמורות",component:()=>null},{id:"theory",label:"תאוריה",component:()=>null},{id:"documents",label:"מסמכים",component:()=>null}];return!t||t.trim()===""?e.jsx(Xn,{to:"/students",replace:!0}):(u.useEffect(()=>{t&&(async()=>{try{l(!0),m(null),console.log("🌐 Fetching student data for ID:",t);const v=await B.students.getStudentById(t);console.log("✅ Student data received:",v),i(v)}catch(v){console.error("❌ Error fetching student:",v),m(v.message||"Failed to load student data")}finally{l(!1)}})()},[t]),o?e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx(rt,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-primary-600"}),e.jsx("div",{className:"text-lg text-gray-600",children:"טוען פרטי תלמיד..."})]})}):d?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-96 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"❌"}),e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-2",children:"שגיאה בטעינת הנתונים"}),e.jsx("p",{className:"text-gray-600 mb-6",children:d}),e.jsxs("button",{onClick:()=>window.location.reload(),className:"flex items-center gap-2 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600",children:[e.jsx(rt,{className:"w-4 h-4"}),"נסה שוב"]})]}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("nav",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("button",{onClick:()=>s("/students"),className:"hover:text-primary-600 transition-colors",children:"תלמידים"}),e.jsx(_s,{className:"w-4 h-4 rotate-180"}),e.jsx("span",{className:"text-gray-900 font-medium",children:"פרטי תלמיד"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"w-20 h-20 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-primary-600",children:a.personalInfo?.fullName?.charAt(0)||"?"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:a.personalInfo?.fullName||"שם לא זמין"}),e.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.isActive?"פעיל":"לא פעיל"})})]})]})}),e.jsx(ga,{activeTab:r,onTabChange:n,tabs:x}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:e.jsx(oc,{activeTab:r,studentId:t,student:a,isLoading:!1})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-96 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🔍"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"תלמיד לא נמצא"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"לא נמצאו פרטים עבור התלמיד המבוקש"}),e.jsxs("button",{onClick:()=>s("/students"),className:"flex items-center gap-2 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600",children:[e.jsx(_s,{className:"w-4 h-4"}),"חזור לרשימת התלמידים"]})]}))};export{pc as default};
