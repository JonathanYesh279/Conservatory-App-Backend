import{j as e}from"../assets/index-BAwpfw4Y.js";import{r as i,b as Te}from"./vendor-E-WBaSU9.js";import{C as ie}from"./Card-Cf_Ok3Ft.js";import{S as xe}from"./StatsCard-ikajD79x.js";import{T as Le}from"./TheoryLessonForm-CCXn4jaD.js";import{B as ce,E as ye,b as Ie,v as $e,T as ue,C as fe,m as be,n as Ne,I as Ae,R as Be,J as ze,F as ve,K as Me,N as Ee,o as _e,O as Re,Q as Fe,U as he,q as we,g as Oe,d as Ue,P as je,S as qe}from"./ui-BeR0qYie.js";import{M as ke,C as Se}from"./ConfirmationModal-FX2Cuwnj.js";import{t as Pe,b as L}from"./cascade-deletion-C-2LBfWA.js";import"./query-CMzvnXZ6.js";import"./utils-x1PSU_OZ.js";const He=n=>new Date(n.date).toLocaleDateString("he-IL"),Ve=n=>`${n.startTime} - ${n.endTime}`,We=n=>{if(!n.isActive)return{text:"לא פעיל",colorClass:"bg-gray-100 text-gray-800"};const c=new Date,p=new Date(`${n.date}T${n.startTime}:00`),y=new Date(`${n.date}T${n.endTime}:00`);return c<p?{text:"עתיד",colorClass:"bg-blue-100 text-blue-800"}:c>=p&&c<=y?{text:"מתקיים",colorClass:"bg-green-100 text-green-800"}:c>y?{text:"הסתיים",colorClass:"bg-orange-100 text-orange-800"}:{text:"לא ידוע",colorClass:"bg-gray-100 text-gray-800"}},Ce=(n,c)=>n.filter(p=>{if(c.searchQuery){const y=c.searchQuery.toLowerCase();if(!(p.title?.toLowerCase().includes(y)||p.teacherName?.toLowerCase().includes(y)||p.category?.toLowerCase().includes(y)||p.description?.toLowerCase().includes(y)))return!1}if(c.category&&p.category!==c.category||c.teacherId&&p.teacherId!==c.teacherId)return!1;if(c.date){const y=new Date(c.date).toDateString(),l=new Date(p.date).toDateString();if(y!==l)return!1}return!(c.isActive!==void 0&&p.isActive!==c.isActive)});function pe({lesson:n,onView:c,onEdit:p,onDelete:y,onViewAttendance:l,selectable:z,selected:f,onSelect:W}){const u=He(n),B=Ve(n),I=We(n);return e.jsxs("div",{className:`bg-white rounded-lg border shadow-sm hover:shadow-md transition-all duration-200 ${f?"border-primary-400 ring-2 ring-primary-100":"border-gray-200"}`,children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-start justify-between",children:[z&&e.jsx("div",{className:"flex items-center ml-3",children:e.jsx("input",{type:"checkbox",checked:f,onChange:()=>W?.(n._id),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ce,{className:"w-4 h-4 text-primary-600"}),e.jsx("span",{className:"text-xs font-medium text-primary-600 bg-primary-50 px-2 py-1 rounded-full",children:n.category}),e.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded-full ${I.colorClass}`,children:I.text})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:n.title}),n.description&&e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:n.description})]}),e.jsxs("div",{className:"flex items-center gap-1 mr-2",children:[c&&e.jsx("button",{onClick:()=>c(n),className:"p-2 text-gray-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"צפה בפרטים",children:e.jsx(ye,{className:"w-4 h-4"})}),l&&e.jsx("button",{onClick:()=>l(n),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"צפה בנוכחות",children:e.jsx(Ie,{className:"w-4 h-4"})}),p&&e.jsx("button",{onClick:()=>p(n),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"ערוך שיעור",children:e.jsx($e,{className:"w-4 h-4"})}),y&&e.jsx("button",{onClick:()=>y(n._id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"מחק שיעור",children:e.jsx(ue,{className:"w-4 h-4"})})]})]})}),e.jsxs("div",{className:"p-4 space-y-3",children:[n.teacherName&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium text-gray-900 ml-1",children:"מורה:"}),n.teacherName]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(fe,{className:"w-4 h-4 ml-2 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900 ml-1",children:"תאריך:"}),u]}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(be,{className:"w-4 h-4 ml-2 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900 ml-1",children:"שעה:"}),B]})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(Ne,{className:"w-4 h-4 ml-2 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900 ml-1",children:"מיקום:"}),n.location||"לא צוין"]})]})]})}function Qe({lessons:n,onRefresh:c,searchQuery:p,filters:y}){const[l,z]=i.useState(new Set),[f,W]=i.useState(!1),[u,B]=i.useState({category:"",teacherId:"",dateRange:{start:"",end:""},status:"all"}),[I,Q]=i.useState(!1),[b,v]=i.useState({}),[$,M]=i.useState(!1),[de,w]=i.useState(!1),[R,K]=i.useState(null),[oe,A]=i.useState(!1),[te,h]=i.useState(""),[Y,J]=i.useState(""),[F,E]=i.useState([]),[D,O]=i.useState({isRunning:!1,current:0,total:0,operation:"",details:""}),H=["תלמידים חדשים ב-ד","מתחילים","מתחילים ב","מתחילים ד","מתקדמים ב","מתקדמים א","מתקדמים ג","תלמידים חדשים בוגרים (ה - ט)","תלמידים חדשים צעירים","הכנה לרסיטל קלאסי יא","הכנה לרסיטל רוק\\פופ\\ג'אז יא","הכנה לרסיטל רוק\\פופ\\ג'אז יב","מגמה","תאוריה כלי"],T=["אולם ערן","סטודיו קאמרי 1","סטודיו קאמרי 2","אולפן הקלטות","חדר חזרות 1","חדר חזרות 2","חדר מחשבים","חדר תאוריה א","חדר תאוריה ב"];i.useEffect(()=>{se()},[]);const se=async()=>{try{const a=(await Pe.getTeachers()).filter(x=>x.roles&&x.roles.includes("מורה תאוריה"));E(a)}catch(t){console.error("Error loading teachers:",t)}},m=i.useMemo(()=>{let t=Ce(n,{searchQuery:p,category:u.category||y.category,teacherId:u.teacherId||y.teacherId,date:y.date});if(u.dateRange.start&&u.dateRange.end){const a=new Date(u.dateRange.start),x=new Date(u.dateRange.end);t=t.filter(j=>{const g=new Date(j.date);return g>=a&&g<=x})}return u.status!=="all"&&(t=t.filter(a=>u.status==="active"?a.isActive:!a.isActive)),t.sort((a,x)=>new Date(a.date).getTime()-new Date(x.date).getTime())},[n,p,y,u]),U=t=>{const a=new Set(l);a.has(t)?a.delete(t):a.add(t),z(a)},q=()=>{z(f?new Set:new Set(m.map(t=>t._id))),W(!f)},P=()=>{z(new Set),W(!1)},k=i.useMemo(()=>n.filter(t=>l.has(t._id)),[n,l]),G=()=>{if(l.size===0){h("אנא בחר שיעורים לעדכון");return}Q(!0)},V=async()=>{if(!$){M(!0);return}A(!0),h("");try{const t=Object.entries(b).reduce((a,[x,j])=>(j!==void 0&&j!==""&&j!==null&&(a[x]=j),a),{});if(Object.keys(t).length===0){h("אנא בחר לפחות שדה אחד לעדכון");return}await L.bulkUpdateTheoryLessons(Array.from(l),t),K({success:!0,affectedCount:l.size,errors:[],summary:`עודכנו ${l.size} שיעורים בהצלחה`}),J(`עודכנו ${l.size} שיעורי תיאוריה בהצלחה`),Q(!1),M(!1),v({}),P(),await c()}catch(t){h(t.message||"שגיאה בעדכון השיעורים")}finally{A(!1)}},me=async()=>{if(l.size===0){h("אנא בחר שיעורים למחיקה");return}w(!0)},ae=async()=>{A(!0),h(""),O({isRunning:!0,current:0,total:l.size,operation:"מוחק שיעורים",details:"מתחיל מחיקה..."});try{const t=Array.from(l);let a=0;const x=[];for(const j of t)try{await L.deleteTheoryLesson(j),a++,O(g=>({...g,current:a,details:`נמחק שיעור ${a} מתוך ${t.length}`}))}catch(g){x.push(`שגיאה במחיקת שיעור: ${g.message}`)}K({success:x.length===0,affectedCount:a,errors:x,summary:`נמחקו ${a} שיעורים${x.length>0?` (${x.length} שגיאות)`:""}`}),x.length===0?J(`נמחקו ${a} שיעורי תיאוריה בהצלחה`):h(`הושלמה המחיקה עם ${x.length} שגיאות`),w(!1),P(),await c()}catch(t){h(t.message||"שגיאה במחיקת השיעורים")}finally{A(!1),O(t=>({...t,isRunning:!1}))}},X=async t=>{if(l.size===0){h("אנא בחר שיעורים לעדכון סטטוס");return}A(!0),h("");try{await L.bulkUpdateTheoryLessons(Array.from(l),{isActive:t}),J(`${t?"הופעלו":"הושבתו"} ${l.size} שיעורי תיאוריה בהצלחה`),P(),await c()}catch(a){h(a.message||"שגיאה בעדכון סטטוס השיעורים")}finally{A(!1)}},ge=()=>{if(l.size===0){h("אנא בחר שיעורים לייצוא");return}O({isRunning:!0,current:0,total:l.size,operation:"מייצא נתונים",details:"מכין קובץ CSV..."});try{const t=k.map((r,o)=>{O(S=>({...S,current:o+1,details:`מעבד שיעור ${o+1} מתוך ${k.length}`}));const d=F.find(S=>S._id===r.teacherId);return{מזהה:r._id,תאריך:new Date(r.date).toLocaleDateString("he-IL"),"יום בשבוע":["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת"][new Date(r.date).getDay()],קטגוריה:r.category,מורה:d?.personalInfo?.fullName||r.teacherId,"שעת התחלה":r.startTime,"שעת סיום":r.endTime,"משך (דקות)":re(r.startTime,r.endTime),מיקום:r.location,"תלמידים רשומים":r.studentIds?.length||0,"מספר נוכחים":r.attendanceList?.filter(S=>S.status==="הגיע/ה").length||0,"אחוז נוכחות":r.studentIds?.length>0?Math.round((r.attendanceList?.filter(S=>S.status==="הגיע/ה").length||0)/r.studentIds.length*100):0,סטטוס:r.isActive?"פעיל":"לא פעיל",תיאור:(r.description||"").replace(/,/g,";").replace(/\n/g," "),כותרת:r.title||"","שנת לימודים":r.schoolYearId}}),x="\uFEFF"+[Object.keys(t[0]).join(","),...t.map(r=>Object.values(r).map(o=>`"${o}"`).join(","))].join(`
`),j=new Blob([x],{type:"text/csv;charset=utf-8;"}),g=document.createElement("a"),Z=URL.createObjectURL(j),s=new Date().toISOString().split("T")[0];g.setAttribute("href",Z),g.setAttribute("download",`theory-lessons-bulk-export-${s}.csv`),g.style.visibility="hidden",document.body.appendChild(g),g.click(),document.body.removeChild(g),J(`יוצאו ${l.size} שיעורים לקובץ CSV בהצלחה`)}catch(t){h("שגיאה בייצוא הקובץ: "+t.message)}finally{O(t=>({...t,isRunning:!1}))}},re=(t,a)=>{if(!t||!a)return 0;const[x,j]=t.split(":").map(Number),[g,Z]=a.split(":").map(Number),s=x*60+j;return g*60+Z-s};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"עדכון שיעורים קבוצתי"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"נהל מספר שיעורי תיאוריה בו זמנית"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[l.size>0&&e.jsxs("span",{className:"text-sm text-gray-600 bg-gray-100 px-3 py-1 rounded-full",children:[l.size," נבחרו"]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 max-w-md",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ae,{className:"w-4 h-4 text-blue-600 ml-2 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"הוראות שימוש:"}),e.jsxs("ul",{className:"text-xs space-y-1",children:[e.jsx("li",{children:"• השתמש במסננים לאיתור השיעורים הרלוונטיים"}),e.jsx("li",{children:"• בחר שיעורים על ידי לחיצה על תיבות הסימון"}),e.jsx("li",{children:"• השתמש בפעולות הקבוצתיות לעריכה, מחיקה או ייצוא"}),e.jsx("li",{children:"• כל עדכון יציג תצוגה מקדימה לפני הביצוע"})]})]})]})})]})]}),te&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800",children:te})}),Y&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center justify-between",children:[e.jsx("p",{className:"text-green-800",children:Y}),R&&e.jsxs("button",{onClick:()=>{},className:"text-green-700 hover:text-green-900 text-sm font-medium",children:[e.jsx(Be,{className:"w-4 h-4 inline ml-1"}),"ביטול פעולה"]})]}),D.isRunning&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ze,{className:"w-5 h-5 text-blue-600 animate-spin ml-2"}),e.jsx("span",{className:"text-blue-800 font-medium",children:D.operation})]}),e.jsxs("span",{className:"text-blue-600 text-sm",children:[D.current," / ",D.total]})]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${D.total>0?D.current/D.total*100:0}%`}})}),e.jsx("p",{className:"text-blue-700 text-sm",children:D.details})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(ve,{className:"w-5 h-5 ml-2"}),"מסננים מתקדמים"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"קטגוריה"}),e.jsxs("select",{value:u.category,onChange:t=>B(a=>({...a,category:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"כל הקטגוריות"}),H.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"מורה"}),e.jsxs("select",{value:u.teacherId,onChange:t=>B(a=>({...a,teacherId:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"כל המורים"}),F.map(t=>e.jsx("option",{value:t._id,children:t.personalInfo?.fullName},t._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"סטטוס"}),e.jsxs("select",{value:u.status,onChange:t=>B(a=>({...a,status:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"all",children:"כל השיעורים"}),e.jsx("option",{value:"active",children:"פעילים"}),e.jsx("option",{value:"inactive",children:"לא פעילים"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>B({category:"",teacherId:"",dateRange:{start:"",end:""},status:"all"}),className:"w-full px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"נקה מסננים"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"תאריך התחלה"}),e.jsx("input",{type:"date",value:u.dateRange.start,onChange:t=>B(a=>({...a,dateRange:{...a.dateRange,start:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"תאריך סיום"}),e.jsx("input",{type:"date",value:u.dateRange.end,onChange:t=>B(a=>({...a,dateRange:{...a.dateRange,end:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]})]})]})}),l.size>0&&e.jsx(ie,{children:e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold text-blue-900 mb-3 flex items-center",children:[e.jsx(Me,{className:"w-5 h-5 ml-2"}),"סיכום בחירה"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:l.size}),e.jsx("div",{className:"text-sm text-blue-600",children:"שיעורים נבחרו"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:k.reduce((t,a)=>t+(a.studentIds?.length||0),0)}),e.jsx("div",{className:"text-sm text-blue-600",children:"תלמידים מושפעים"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:new Set(k.map(t=>t.category)).size}),e.jsx("div",{className:"text-sm text-blue-600",children:"קטגוריות"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:new Set(k.map(t=>t.teacherId)).size}),e.jsx("div",{className:"text-sm text-blue-600",children:"מורים"})]})]})]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:f,onChange:q,className:"ml-2 rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),"בחר הכל (",m.length," שיעורים)"]}),l.size>0&&e.jsx("button",{onClick:P,className:"text-sm text-gray-500 hover:text-gray-700",children:"בטל בחירה"})]}),e.jsx("div",{className:"flex items-center gap-2",children:l.size>0&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:ge,className:"flex items-center px-3 py-2 text-green-700 border border-green-300 rounded-lg hover:bg-green-50",children:[e.jsx(Ee,{className:"w-4 h-4 ml-1"}),"ייצוא"]}),e.jsx("button",{onClick:()=>X(!1),className:"flex items-center px-3 py-2 text-orange-700 border border-orange-300 rounded-lg hover:bg-orange-50",children:"השבת"}),e.jsx("button",{onClick:()=>X(!0),className:"flex items-center px-3 py-2 text-blue-700 border border-blue-300 rounded-lg hover:bg-blue-50",children:"הפעל"}),e.jsxs("button",{onClick:G,className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(_e,{className:"w-4 h-4 ml-1"}),"עדכון (",l.size,")"]}),e.jsxs("button",{onClick:me,className:"flex items-center px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:[e.jsx(ue,{className:"w-4 h-4 ml-1"}),"מחיקה (",l.size,")"]})]})})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["שיעורי תיאוריה (",m.length,")"]}),m.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ce,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"לא נמצאו שיעורים"}),e.jsx("p",{className:"text-gray-600",children:"נסה לשנות את המסננים או הוסף שיעורים חדשים"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-700",children:"בחירה"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-700",children:"תאריך"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-700",children:"קטגוריה"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-700",children:"שעות"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-700",children:"מיקום"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-700",children:"תלמידים"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-700",children:"סטטוס"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-700",children:"פעולות"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:m.map(t=>e.jsxs("tr",{className:`hover:bg-gray-50 ${l.has(t._id)?"bg-blue-50":""}`,children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>U(t._id),className:"p-1 hover:bg-gray-100 rounded",children:l.has(t._id)?e.jsx(Re,{className:"w-5 h-5 text-blue-600"}):e.jsx(Fe,{className:"w-5 h-5 text-gray-400"})})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:new Date(t.date).toLocaleDateString("he-IL")}),e.jsx("div",{className:"text-gray-500 text-xs",children:["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת"][new Date(t.date).getDay()]})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"inline-block max-w-32 truncate",children:t.category})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(be,{className:"w-4 h-4 ml-1"}),t.startTime," - ",t.endTime]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(Ne,{className:"w-4 h-4 ml-1"}),e.jsx("span",{className:"truncate max-w-20",children:t.location})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(he,{className:"w-4 h-4 ml-1"}),t.studentIds?.length||0]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs ${t.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.isActive?"פעיל":"לא פעיל"})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("button",{onClick:()=>{},className:"p-1 hover:bg-gray-100 rounded text-blue-600",title:"צפייה בפרטים",children:e.jsx(ye,{className:"w-4 h-4"})})})]},t._id))})]})})]})}),I&&e.jsx(ke,{isOpen:I,onClose:()=>{Q(!1),M(!1),v({})},title:$?"תצוגה מקדימה - עדכון קבוצתי":"עדכון קבוצתי",maxWidth:"2xl",children:e.jsxs("div",{className:"p-6",children:[$?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(we,{className:"w-5 h-5 text-yellow-600 ml-2"}),e.jsxs("p",{className:"text-yellow-800 font-medium",children:["תצוגה מקדימה - השינויים יחולו על ",l.size," שיעורים"]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"שינויים שיבוצעו:"}),Object.entries(b).filter(([,t])=>t!==void 0&&t!==""&&t!==null).length===0?e.jsx("p",{className:"text-gray-600",children:"לא נבחרו שדות לעדכון"}):e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:Object.entries(b).map(([t,a],x)=>{if(a===void 0||a===""||a===null)return null;const j={category:"קטגוריה",teacherId:"מורה",location:"מיקום",startTime:"שעת התחלה",endTime:"שעת סיום",title:"כותרת השיעור",description:"תיאור השיעור",maxStudents:"מקסימום תלמידים",isActive:"סטטוס"};let g=a;return t==="teacherId"?g=F.find(s=>s._id===a)?.personalInfo?.fullName||a:t==="isActive"&&(g=a?"פעיל":"לא פעיל"),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-medium",children:[j[t]||t,":"]}),e.jsx("span",{children:g})]},`${t}-${x}`)})})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(he,{className:"w-5 h-5 text-blue-600 ml-2"}),e.jsxs("p",{className:"text-blue-800",children:["עדכון קבוצתי של ",l.size," שיעורי תיאוריה"]})]}),e.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"שדות ריקים יישארו ללא שינוי"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"קטגוריה"}),e.jsxs("select",{value:b.category||"",onChange:t=>v(a=>({...a,category:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"ללא שינוי"}),H.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"מורה"}),e.jsxs("select",{value:b.teacherId||"",onChange:t=>v(a=>({...a,teacherId:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"ללא שינוי"}),F.map(t=>e.jsx("option",{value:t._id,children:t.personalInfo?.fullName},t._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"מיקום"}),e.jsxs("select",{value:b.location||"",onChange:t=>v(a=>({...a,location:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"ללא שינוי"}),T.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"סטטוס"}),e.jsxs("select",{value:b.isActive===void 0?"":b.isActive.toString(),onChange:t=>v(a=>({...a,isActive:t.target.value===""?void 0:t.target.value==="true"})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"ללא שינוי"}),e.jsx("option",{value:"true",children:"פעיל"}),e.jsx("option",{value:"false",children:"לא פעיל"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"שעת התחלה"}),e.jsx("input",{type:"time",value:b.startTime||"",onChange:t=>v(a=>({...a,startTime:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"שעת סיום"}),e.jsx("input",{type:"time",value:b.endTime||"",onChange:t=>v(a=>({...a,endTime:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"כותרת השיעור"}),e.jsx("input",{type:"text",value:b.title||"",onChange:t=>v(a=>({...a,title:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"ללא שינוי"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"מקסימום תלמידים"}),e.jsx("input",{type:"number",min:"1",max:"50",value:b.maxStudents||"",onChange:t=>v(a=>({...a,maxStudents:t.target.value?parseInt(t.target.value):void 0})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"ללא שינוי"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"תיאור השיעור"}),e.jsx("textarea",{value:b.description||"",onChange:t=>v(a=>({...a,description:t.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"ללא שינוי"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t",children:[e.jsx("button",{onClick:()=>{Q(!1),M(!1),v({})},className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"ביטול"}),!$&&e.jsxs("button",{onClick:V,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(ye,{className:"w-4 h-4 ml-1 inline"}),"תצוגה מקדימה"]}),$&&e.jsxs("button",{onClick:V,disabled:oe,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:[oe?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white ml-2"}):e.jsx(Oe,{className:"w-4 h-4 ml-1"}),"אישור עדכון"]})]})]})}),e.jsx(Se,{isOpen:de,title:"מחיקה קבוצתית",message:`האם אתה בטוח שברצונך למחוק ${l.size} שיעורי תיאוריה?

פעולה זו לא ניתנת לביטול.`,confirmText:`מחק ${l.size} שיעורים`,cancelText:"ביטול",onConfirm:ae,onCancel:()=>w(!1),variant:"danger"})]})}const Ke=`
  .custom-scrollbar::-webkit-scrollbar {
    height: 8px;
  }
  .custom-scrollbar::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 10px;
  }
  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 10px;
  }
  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: #555;
  }
`;function lt(){const n=Te(),[c,p]=i.useState([]),[y,l]=i.useState(!0),[z,f]=i.useState(null),[W,u]=i.useState(!1),[B,I]=i.useState(null),[Q,b]=i.useState([]),[v,$]=i.useState("create"),[M,de]=i.useState("lessons"),[w,R]=i.useState(new Set),[K,oe]=i.useState(!1),[A,te]=i.useState(""),[h,Y]=i.useState({category:"",teacherId:"",date:""}),[J,F]=i.useState(!1),[E,D]=i.useState(null),[O,H]=i.useState(!1),[T,se]=i.useState("date"),[m,U]=i.useState({startDate:"",endDate:"",category:"",teacherId:""});i.useEffect(()=>{q()},[]);const q=async()=>{try{l(!0),f(null);const s=await L.getTheoryLessons(h);p(s)}catch(s){console.error("Error loading theory lessons:",s),f("שגיאה בטעינת שיעורי התיאוריה")}finally{l(!1)}},P=s=>{const r=new Date(s),o=new Date;o.setHours(0,0,0,0);const d=new Date(r);d.setHours(0,0,0,0);const S=["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת"],le=["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],ne=S[r.getDay()],ee=r.getDate(),N=le[r.getMonth()],C=r.getFullYear();let _="";return d.getTime()===o.getTime()?_="היום - ":d.getTime()===o.getTime()+864e5&&(_="מחר - "),{prefix:_,main:`יום ${ne}, ${ee} ב${N} ${C}`,isToday:d.getTime()===o.getTime(),isPast:d<o}},k=i.useMemo(()=>{const s=Ce(c,{searchQuery:A,category:h.category,teacherId:h.teacherId,date:h.date}),r=new Map;s.forEach(N=>{const C=N.date;r.has(C)||r.set(C,[]),r.get(C).push(N)});const o=(N,C)=>{const _=N.startTime||"00:00",De=C.startTime||"00:00";return _.localeCompare(De)};r.forEach(N=>{N.sort(o)});const d=Array.from(r.entries()).sort((N,C)=>new Date(N[0]).getTime()-new Date(C[0]).getTime()),S=new Date;S.setHours(0,0,0,0);const le=[],ne=[],ee=[];return d.forEach(([N,C])=>{const _=new Date(N);_.setHours(0,0,0,0),_.getTime()===S.getTime()?le.push([N,C]):_>S?ne.push([N,C]):ee.push([N,C])}),ee.reverse(),{today:le,future:ne,past:ee,all:[...le,...ne,...ee],flatList:d.flatMap(([,N])=>N)}},[c,A,h]),G=k.flatList,V={totalLessons:c.length,activeLessons:c.filter(s=>s.isActive).length,totalStudents:c.reduce((s,r)=>s+(r.studentIds?.length||0),0),averageAttendance:c.length>0?Math.round(c.reduce((s,r)=>{const o=r.attendanceList?.filter(d=>d.status==="הגיע/ה").length||0;return s+o/(r.maxStudents||1)},0)*100/c.length):0},me=()=>{I(null),b([]),$("create"),u(!0)},ae=s=>{n(`/theory-lessons/${s._id}`)},X=s=>{I(s),b([]),$("edit"),u(!0)},ge=async s=>{try{if(s.mode==="edit"){const{mode:r,lessonId:o,...d}=s;await L.updateTheoryLesson(o,d)}else if(s.mode==="bulk-edit"){const{mode:r,lessonIds:o,updateData:d}=s;await L.bulkUpdateTheoryLessons(o,d)}else if(s.mode==="bulk-create"||s.isBulk){const{isBulk:r,mode:o,...d}=s;await L.bulkCreateTheoryLessons(d)}else{const{mode:r,...o}=s;await L.createTheoryLesson(o)}u(!1),I(null),b([]),$("create"),R(new Set),await q()}catch(r){throw console.error("Error saving theory lesson:",r),r}},re=s=>{D(s),F(!0)},t=async()=>{if(E)try{await L.deleteTheoryLesson(E._id),await q(),F(!1),D(null)}catch(s){console.error("Error deleting theory lesson:",s),f("שגיאה במחיקת שיעור התיאוריה")}},a=async()=>{try{let s;switch(T){case"date":if(!m.startDate||!m.endDate){f("נדרש לבחור תאריכי התחלה וסיום");return}s=await L.deleteTheoryLessonsByDateRange(m.startDate,m.endDate);break;case"category":if(!m.category){f("נדרש לבחור קטגוריה");return}s=await L.deleteTheoryLessonsByCategory(m.category);break;case"teacher":if(!m.teacherId){f("נדרש לבחור מורה");return}s=await L.deleteTheoryLessonsByTeacher(m.teacherId);break;default:f("סוג מחיקה לא תקין");return}await q(),H(!1),U({startDate:"",endDate:"",category:"",teacherId:""}),f(null),console.log(`✅ נמחקו ${s.deletedCount} שיעורי תיאוריה בהצלחה`)}catch(s){f(s.message||"שגיאה במחיקת שיעורי התיאוריה"),H(!1)}},x=()=>{H(!1),U({startDate:"",endDate:"",category:"",teacherId:""})},j=s=>{const r=new Set(w);r.has(s)?r.delete(s):r.add(s),R(r)},g=()=>{R(K?new Set:new Set(G.map(s=>s._id))),oe(!K)},Z=()=>{const s=c.filter(r=>w.has(r._id));if(s.length===0){f("אנא בחר שיעורים לעריכה");return}b(s),I(null),$("bulk-edit"),u(!0)};return y?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:"טוען שיעורי תיאוריה..."})]})}):e.jsxs(e.Fragment,{children:[e.jsx("style",{children:Ke}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"שיעורי תיאוריה"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"ניהול שיעורי תיאוריה ומעקב נוכחות"}),e.jsxs("div",{className:"flex space-x-4 rtl:space-x-reverse mt-4",children:[e.jsxs("button",{onClick:()=>de("lessons"),className:`flex items-center px-4 py-2 rounded-lg font-medium transition-colors ${M==="lessons"?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(ce,{className:"w-4 h-4 ml-2"}),"רשימת שיעורים"]}),e.jsxs("button",{onClick:()=>de("bulk"),className:`flex items-center px-4 py-2 rounded-lg font-medium transition-colors ${M==="bulk"?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(Ue,{className:"w-4 h-4 ml-2"}),"עדכון שיעורים קבוצתי"]})]})]}),e.jsx("div",{className:"flex gap-2",children:M==="lessons"&&e.jsxs(e.Fragment,{children:[w.size>0&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:Z,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:`עריכה קבוצתית של ${w.size} שיעורים`,children:[e.jsx(he,{className:"w-4 h-4 ml-1"}),"עריכה קבוצתית (",w.size,")"]}),e.jsx("button",{onClick:()=>R(new Set),className:"flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",title:"בטל בחירה",children:"ביטול בחירה"})]}),e.jsxs("button",{onClick:()=>H(!0),className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",title:"מחיקה קבוצתית של שיעורי תיאוריה",children:[e.jsx(ue,{className:"w-4 h-4 ml-1"}),"מחיקת שיעורים"]}),e.jsxs("button",{onClick:me,className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[e.jsx(je,{className:"w-4 h-4 ml-2"}),"שיעור חדש"]})]})})]}),z&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800",children:z})}),M==="lessons"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(xe,{title:"סה״כ שיעורים",value:V.totalLessons.toString(),subtitle:"שיעורי תיאוריה",icon:e.jsx(ce,{}),color:"blue"}),e.jsx(xe,{title:"שיעורים פעילים",value:V.activeLessons.toString(),subtitle:"שיעורים פעילים",icon:e.jsx(fe,{}),color:"green"}),e.jsx(xe,{title:"סה״כ תלמידים",value:V.totalStudents.toString(),subtitle:"נרשמים לשיעורים",icon:e.jsx(he,{}),color:"purple"}),e.jsx(xe,{title:"נוכחות ממוצעת",value:`${V.averageAttendance}%`,subtitle:"אחוז נוכחות",icon:e.jsx(be,{}),color:"orange"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(qe,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"חיפוש שיעורים...",value:A,onChange:s=>te(s.target.value),className:"w-full pr-10 pl-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})}),e.jsx("div",{className:"md:w-48",children:e.jsxs("select",{value:h.category,onChange:s=>Y(r=>({...r,category:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"כל הקטגוריות"}),e.jsx("option",{value:"תיאוריה כללית",children:"תיאוריה כללית"}),e.jsx("option",{value:"הרמוניה",children:"הרמוניה"}),e.jsx("option",{value:"קומפוזיציה",children:"קומפוזיציה"}),e.jsx("option",{value:"היסטוריה של המוזיקה",children:"היסטוריה של המוזיקה"}),e.jsx("option",{value:"אימון אוזן",children:"אימון אוזן"})]})}),e.jsx("div",{className:"md:w-48",children:e.jsx("input",{type:"date",value:h.date,onChange:s=>Y(r=>({...r,date:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})}),e.jsx("button",{onClick:()=>{Y({category:"",teacherId:"",date:""}),te("")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:e.jsx(ve,{className:"w-4 h-4"})})]})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["שיעורי תיאוריה (",G.length,")"]}),G.length>0&&e.jsxs("label",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:K,onChange:g,className:"ml-2 rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),"בחר הכל (",w.size," נבחרו)"]})]}),e.jsx("button",{onClick:q,className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"רענן"})]}),G.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ce,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"אין שיעורי תיאוריה"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"התחל על ידי יצירת שיעור התיאוריה הראשון"}),e.jsxs("button",{onClick:me,className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[e.jsx(je,{className:"w-4 h-4 ml-2"}),"צור שיעור ראשון"]})]}):e.jsxs("div",{className:"space-y-6",children:[k.today.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-1 bg-primary-600 rounded-full"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"להיום"})]}),k.today.map(([s,r])=>{const o=P(s);return e.jsxs("div",{className:"bg-primary-50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-900",children:o.main}),e.jsxs("span",{className:"text-sm text-primary-700 font-medium",children:[r.length," שיעורים",r.length>1&&e.jsx("span",{className:"mr-2 text-xs text-primary-600",children:"← גלל"})]})]}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"overflow-x-auto pb-2 custom-scrollbar",children:e.jsx("div",{className:"flex gap-4 px-1",style:{minWidth:"max-content"},children:r.map(d=>e.jsx("div",{className:"w-80 flex-shrink-0",children:e.jsx(pe,{lesson:d,onView:ae,onEdit:X,onDelete:re,selectable:!0,selected:w.has(d._id),onSelect:j})},d._id))})})})]},s)})]}),k.future.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-1 bg-blue-600 rounded-full"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"שיעורים עתידיים"})]}),k.future.map(([s,r])=>{const o=P(s);return e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-blue-900",children:[e.jsx("span",{className:"text-blue-700",children:o.prefix}),o.main]}),e.jsxs("span",{className:"text-sm text-blue-700 font-medium",children:[r.length," שיעורים",r.length>1&&e.jsx("span",{className:"mr-2 text-xs text-blue-600",children:"← גלל"})]})]}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"overflow-x-auto pb-2 custom-scrollbar",children:e.jsx("div",{className:"flex gap-4 px-1",style:{minWidth:"max-content"},children:r.map(d=>e.jsx("div",{className:"w-80 flex-shrink-0",children:e.jsx(pe,{lesson:d,onView:ae,onEdit:X,onDelete:re,selectable:!0,selected:w.has(d._id),onSelect:j})},d._id))})})})]},s)})]}),k.past.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-1 bg-gray-400 rounded-full"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"שיעורים שהסתיימו"})]}),k.past.map(([s,r])=>{const o=P(s);return e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:o.main}),e.jsxs("span",{className:"text-sm text-gray-600 font-medium",children:[r.length," שיעורים",r.length>1&&e.jsx("span",{className:"mr-2 text-xs text-gray-500",children:"← גלל"})]})]}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"overflow-x-auto pb-2 custom-scrollbar",children:e.jsx("div",{className:"flex gap-4 px-1",style:{minWidth:"max-content"},children:r.map(d=>e.jsx("div",{className:"w-80 flex-shrink-0",children:e.jsx(pe,{lesson:d,onView:ae,onEdit:X,onDelete:re,selectable:!0,selected:w.has(d._id),onSelect:j})},d._id))})})})]},s)})]})]})]})]}):e.jsx(Qe,{lessons:c,onRefresh:q,searchQuery:A,filters:h}),W&&e.jsx(Le,{theoryLesson:B,theoryLessons:Q,mode:v,onSubmit:ge,onCancel:()=>{u(!1),I(null),b([]),$("create"),R(new Set)}}),e.jsx(Se,{isOpen:J,title:"מחיקת שיעור תיאוריה",message:E?`האם אתה בטוח שברצונך למחוק את שיעור התיאוריה "${E.title}"?

פרטי השיעור:
• תאריך: ${new Date(E.date).toLocaleDateString("he-IL")}
• משך: ${E.duration} דקות
• תלמידים רשומים: ${E.registeredStudents?.length||0}

פעולה זו לא ניתנת לביטול.`:"האם אתה בטוח שברצונך למחוק את שיעור התיאוריה?",confirmText:"מחק שיעור",cancelText:"ביטול",onConfirm:t,onCancel:()=>{F(!1),D(null)},variant:"danger"}),e.jsx(ke,{isOpen:O,onClose:x,title:"מחיקה קבוצתית של שיעורי תיאוריה",maxWidth:"lg",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(we,{className:"w-5 h-5 text-yellow-600 ml-2"}),e.jsx("p",{className:"text-yellow-800",children:"⚠️ פעולה זו תמחק שיעורי תיאוריה על בסיס הקריטריונים שנבחרו. פעולה זו אינה ניתנת לביטול!"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"סוג מחיקה"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"date",checked:T==="date",onChange:s=>se(s.target.value),className:"ml-2"}),"טווח תאריכים"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"category",checked:T==="category",onChange:s=>se(s.target.value),className:"ml-2"}),"לפי קטגוריה"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"teacher",checked:T==="teacher",onChange:s=>se(s.target.value),className:"ml-2"}),"לפי מורה"]})]})]}),T==="date"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"תאריך התחלה"}),e.jsx("input",{type:"date",value:m.startDate,onChange:s=>U({...m,startDate:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"תאריך סיום"}),e.jsx("input",{type:"date",value:m.endDate,onChange:s=>U({...m,endDate:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]})]}),T==="category"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"קטגוריה"}),e.jsxs("select",{value:m.category,onChange:s=>U({...m,category:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0,children:[e.jsx("option",{value:"",children:"בחר קטגוריה"}),e.jsx("option",{value:"תלמידים חדשים ב-ד",children:"תלמידים חדשים ב-ד"}),e.jsx("option",{value:"מתחילים",children:"מתחילים"}),e.jsx("option",{value:"מתחילים ב",children:"מתחילים ב"}),e.jsx("option",{value:"מתחילים ד",children:"מתחילים ד"}),e.jsx("option",{value:"מתקדמים ב",children:"מתקדמים ב"}),e.jsx("option",{value:"מתקדמים א",children:"מתקדמים א"}),e.jsx("option",{value:"מתקדמים ג",children:"מתקדמים ג"}),e.jsx("option",{value:"תלמידים חדשים בוגרים (ה - ט)",children:"תלמידים חדשים בוגרים (ה - ט)"}),e.jsx("option",{value:"תלמידים חדשים צעירים",children:"תלמידים חדשים צעירים"}),e.jsx("option",{value:"הכנה לרסיטל קלאסי יא",children:"הכנה לרסיטל קלאסי יא"}),e.jsx("option",{value:"הכנה לרסיטל רוק\\פופ\\ג'אז יא",children:"הכנה לרסיטל רוק\\פופ\\ג'אז יא"}),e.jsx("option",{value:"הכנה לרסיטל רוק\\פופ\\ג'אז יב",children:"הכנה לרסיטל רוק\\פופ\\ג'אז יב"}),e.jsx("option",{value:"מגמה",children:"מגמה"}),e.jsx("option",{value:"תאוריה כלי",children:"תאוריה כלי"})]})]}),T==="teacher"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"מורה"}),e.jsx("input",{type:"text",placeholder:"הזן מזהה מורה או שם",value:m.teacherId,onChange:s=>U({...m,teacherId:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ניתן להזין מזהה מורה או לחפש לפי שם"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:x,className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"ביטול"}),e.jsxs("button",{onClick:a,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",disabled:T==="date"&&(!m.startDate||!m.endDate)||T==="category"&&!m.category||T==="teacher"&&!m.teacherId,children:[e.jsx(ue,{className:"w-4 h-4 ml-2 inline"}),"מחק שיעורי תיאוריה"]})]})]})})]})]})}export{lt as default};
